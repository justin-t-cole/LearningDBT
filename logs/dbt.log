2021-11-16 14:34:05.937644 (MainThread): Running with dbt=0.21.0
2021-11-16 14:34:06.040322 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/vscode/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-16 14:34:06.050813 (MainThread): Tracking: tracking
2021-11-16 14:34:06.053329 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff999c2130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b261580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b261fa0>]}
2021-11-16 14:34:06.064726 (MainThread): Partial parsing not enabled
2021-11-16 14:34:06.085679 (MainThread): Parsing macros/catalog.sql
2021-11-16 14:34:06.088242 (MainThread): Parsing macros/adapters.sql
2021-11-16 14:34:06.098541 (MainThread): Parsing macros/materializations/seed.sql
2021-11-16 14:34:06.102338 (MainThread): Parsing macros/materializations/snapshot.sql
2021-11-16 14:34:06.103573 (MainThread): Parsing macros/materializations/table.sql
2021-11-16 14:34:06.106533 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-16 14:34:06.119079 (MainThread): Parsing macros/materializations/view.sql
2021-11-16 14:34:06.122503 (MainThread): Parsing macros/core.sql
2021-11-16 14:34:06.125139 (MainThread): Parsing macros/materializations/test.sql
2021-11-16 14:34:06.129199 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-16 14:34:06.135389 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-16 14:34:06.139358 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-16 14:34:06.143500 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-16 14:34:06.144841 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-16 14:34:06.151839 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-16 14:34:06.162446 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-16 14:34:06.174328 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-16 14:34:06.179061 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-16 14:34:06.187795 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-16 14:34:06.204774 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-16 14:34:06.213812 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-16 14:34:06.216156 (MainThread): Parsing macros/etc/query.sql
2021-11-16 14:34:06.217264 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-16 14:34:06.222285 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-16 14:34:06.224400 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-16 14:34:06.226536 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-16 14:34:06.228160 (MainThread): Parsing macros/etc/datetime.sql
2021-11-16 14:34:06.233327 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-16 14:34:06.235501 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-16 14:34:06.237989 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-16 14:34:06.239286 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-16 14:34:06.241240 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-16 14:34:06.243553 (MainThread): Parsing macros/adapters/common.sql
2021-11-16 14:34:06.354201 (MainThread): Acquiring new athena connection "model.my_new_project.customers".
2021-11-16 14:34:06.363952 (MainThread): Acquiring new athena connection "model.my_new_project.sample_nrel".
2021-11-16 14:34:06.366749 (MainThread): Acquiring new athena connection "model.my_new_project.stg_customers".
2021-11-16 14:34:06.369084 (MainThread): Acquiring new athena connection "model.my_new_project.stg_orders".
2021-11-16 14:34:06.371173 (MainThread): Acquiring new athena connection "model.my_new_project.my_first_dbt_model".
2021-11-16 14:34:06.373807 (MainThread): Acquiring new athena connection "model.my_new_project.my_second_dbt_model".
2021-11-16 14:34:06.389608 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-11-16 14:34:06.391359 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-11-16 14:34:06.393204 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-11-16 14:34:06.395580 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-11-16 14:34:06.415840 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '94436566-1ec1-44fd-aadd-c252b3e1ee42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff993e3c40>]}
2021-11-16 14:34:06.432873 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-11-16 14:34:06.434723 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '94436566-1ec1-44fd-aadd-c252b3e1ee42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff993e3af0>]}
2021-11-16 14:34:06.435397 (MainThread): Found 6 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-16 14:34:06.438296 (MainThread): 
2021-11-16 14:34:06.439844 (MainThread): Acquiring new athena connection "master".
2021-11-16 14:34:06.442150 (ThreadPoolExecutor-0_0): Acquiring new athena connection "list_awsdatacatalog".
2021-11-16 14:34:06.449820 (ThreadPoolExecutor-0_0): Using athena connection "list_awsdatacatalog".
2021-11-16 14:34:06.450435 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
  
2021-11-16 14:34:06.452413 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-16 14:34:06.458918 (ThreadPoolExecutor-0_0): Got an error when attempting to open a Athena connection: 'The config profile (default) could not be found'
2021-11-16 14:34:06.460129 (ThreadPoolExecutor-0_0): Error running SQL: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
  
2021-11-16 14:34:06.461997 (ThreadPoolExecutor-0_0): Error running SQL: macro list_schemas
2021-11-16 14:34:06.464042 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: No close available on handle
2021-11-16 14:34:06.466166 (MainThread): Connection 'master' was properly closed.
2021-11-16 14:34:06.466789 (MainThread): Connection 'list_awsdatacatalog' was properly closed.
2021-11-16 14:34:06.468360 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff993f0670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff993e3430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff993e3f70>]}
2021-11-16 14:34:06.469807 (MainThread): Flushing usage events
2021-11-16 14:34:06.791261 (MainThread): Encountered an error:
2021-11-16 14:34:06.794441 (MainThread): Runtime Error
  Runtime Error
    Database Error
      The config profile (default) could not be found
2021-11-16 14:34:06.808890 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 114, in open
    handle = AthenaConnection(
  File "/usr/local/lib/python3.8/site-packages/pyathena/connection.py", line 130, in __init__
    self._session = Session(profile_name=self.profile_name, **self._session_kwargs)
  File "/usr/local/lib/python3.8/site-packages/boto3/session.py", line 80, in __init__
    self._setup_loader()
  File "/usr/local/lib/python3.8/site-packages/boto3/session.py", line 120, in _setup_loader
    self._loader = self._session.get_component('data_loader')
  File "/usr/local/lib/python3.8/site-packages/botocore/session.py", line 682, in get_component
    return self._components.get_component(name)
  File "/usr/local/lib/python3.8/site-packages/botocore/session.py", line 919, in get_component
    self._components[name] = factory()
  File "/usr/local/lib/python3.8/site-packages/botocore/session.py", line 155, in <lambda>
    lambda:  create_loader(self.get_config_variable('data_path')))
  File "/usr/local/lib/python3.8/site-packages/botocore/session.py", line 237, in get_config_variable
    return self.get_component('config_store').get_config_variable(
  File "/usr/local/lib/python3.8/site-packages/botocore/configprovider.py", line 290, in get_config_variable
    return provider.provide()
  File "/usr/local/lib/python3.8/site-packages/botocore/configprovider.py", line 387, in provide
    value = provider.provide()
  File "/usr/local/lib/python3.8/site-packages/botocore/configprovider.py", line 448, in provide
    scoped_config = self._session.get_scoped_config()
  File "/usr/local/lib/python3.8/site-packages/botocore/session.py", line 337, in get_scoped_config
    raise ProfileNotFound(profile=profile_name)
botocore.exceptions.ProfileNotFound: The config profile (default) could not be found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 100, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 79, in add_query
    cursor = connection.handle.cursor()
  File "/usr/local/lib/python3.8/site-packages/dbt/contracts/connection.py", line 82, in handle
    self._handle.resolve(self)
  File "/usr/local/lib/python3.8/site-packages/dbt/contracts/connection.py", line 108, in resolve
    return self.opener(connection)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 143, in open
    raise FailedToConnectException(str(e))
dbt.exceptions.FailedToConnectException: Database Error
  The config profile (default) could not be found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 100, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 1000, in execute_macro
    result = macro_function(**kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 20, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 31, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 103, in exception_handler
    raise RuntimeException(str(e)) from e
dbt.exceptions.RuntimeException: Runtime Error
  Database Error
    The config profile (default) could not be found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 452, in run
    result = self.execute_with_hooks(selected_uids)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 410, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 410, in before_run
    self.create_schemas(adapter, selected_uids)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 541, in create_schemas
    existing_schemas_lowered.update(ls_future.result())
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/concurrent/futures/thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/utils.py", line 482, in connected
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 518, in list_schemas
    for s in adapter.list_schemas(database_quoted)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/impl.py", line 230, in list_schemas
    results = self.execute_macro(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 1000, in execute_macro
    result = macro_function(**kwargs)
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 103, in exception_handler
    raise RuntimeException(str(e)) from e
dbt.exceptions.RuntimeException: Runtime Error
  Runtime Error
    Database Error
      The config profile (default) could not be found

2021-11-16 15:40:12.532285 (MainThread): Running with dbt=0.21.0
2021-11-16 15:40:12.628793 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/vscode/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-16 15:40:12.636201 (MainThread): Tracking: tracking
2021-11-16 15:40:12.638487 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b01e520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c8b7c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c8b7d90>]}
2021-11-16 15:40:12.648625 (MainThread): Partial parsing not enabled
2021-11-16 15:40:12.664584 (MainThread): Parsing macros/catalog.sql
2021-11-16 15:40:12.667458 (MainThread): Parsing macros/adapters.sql
2021-11-16 15:40:12.675721 (MainThread): Parsing macros/materializations/seed.sql
2021-11-16 15:40:12.678636 (MainThread): Parsing macros/materializations/snapshot.sql
2021-11-16 15:40:12.679780 (MainThread): Parsing macros/materializations/table.sql
2021-11-16 15:40:12.683154 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-16 15:40:12.695891 (MainThread): Parsing macros/materializations/view.sql
2021-11-16 15:40:12.699260 (MainThread): Parsing macros/core.sql
2021-11-16 15:40:12.702137 (MainThread): Parsing macros/materializations/test.sql
2021-11-16 15:40:12.706538 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-16 15:40:12.712229 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-16 15:40:12.715792 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-16 15:40:12.720224 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-16 15:40:12.721738 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-16 15:40:12.727652 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-16 15:40:12.738764 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-16 15:40:12.751452 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-16 15:40:12.756965 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-16 15:40:12.765140 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-16 15:40:12.781965 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-16 15:40:12.791511 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-16 15:40:12.793764 (MainThread): Parsing macros/etc/query.sql
2021-11-16 15:40:12.795022 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-16 15:40:12.797768 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-16 15:40:12.799425 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-16 15:40:12.801007 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-16 15:40:12.803975 (MainThread): Parsing macros/etc/datetime.sql
2021-11-16 15:40:12.809428 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-16 15:40:12.810965 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-16 15:40:12.813608 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-16 15:40:12.815502 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-16 15:40:12.817372 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-16 15:40:12.818737 (MainThread): Parsing macros/adapters/common.sql
2021-11-16 15:40:12.925031 (MainThread): Acquiring new athena connection "model.my_new_project.customers".
2021-11-16 15:40:12.933071 (MainThread): Acquiring new athena connection "model.my_new_project.sample_nrel".
2021-11-16 15:40:12.935389 (MainThread): Acquiring new athena connection "model.my_new_project.stg_customers".
2021-11-16 15:40:12.938044 (MainThread): Acquiring new athena connection "model.my_new_project.stg_orders".
2021-11-16 15:40:12.941081 (MainThread): Acquiring new athena connection "model.my_new_project.my_first_dbt_model".
2021-11-16 15:40:12.944315 (MainThread): Acquiring new athena connection "model.my_new_project.my_second_dbt_model".
2021-11-16 15:40:12.959319 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-11-16 15:40:12.961233 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-11-16 15:40:12.963013 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-11-16 15:40:12.965680 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-11-16 15:40:12.980625 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f5a5dad3-c320-4024-a9a4-bf16de602b95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9aa43760>]}
2021-11-16 15:40:12.993387 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-11-16 15:40:12.995330 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f5a5dad3-c320-4024-a9a4-bf16de602b95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c8db910>]}
2021-11-16 15:40:12.997153 (MainThread): Found 6 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-16 15:40:13.000577 (MainThread): 
2021-11-16 15:40:13.001726 (MainThread): Acquiring new athena connection "master".
2021-11-16 15:40:13.004228 (ThreadPoolExecutor-0_0): Acquiring new athena connection "list_awsdatacatalog".
2021-11-16 15:40:13.013375 (ThreadPoolExecutor-0_0): Using athena connection "list_awsdatacatalog".
2021-11-16 15:40:13.014790 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
  
2021-11-16 15:40:13.016820 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-16 15:40:13.049652 (ThreadPoolExecutor-0_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
2021-11-16 15:40:22.398146 (ThreadPoolExecutor-0_0): Failed to execute query.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/urllib3/connection.py", line 159, in _new_conn
    conn = connection.create_connection(
  File "/usr/local/lib/python3.8/site-packages/urllib3/util/connection.py", line 61, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/local/lib/python3.8/socket.py", line 918, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -2] Name or service not known

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/botocore/httpsession.py", line 254, in send
    urllib_response = conn.urlopen(
  File "/usr/local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 726, in urlopen
    retries = retries.increment(
  File "/usr/local/lib/python3.8/site-packages/urllib3/util/retry.py", line 386, in increment
    raise six.reraise(type(error), error, _stacktrace)
  File "/usr/local/lib/python3.8/site-packages/urllib3/packages/six.py", line 735, in reraise
    raise value
  File "/usr/local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 670, in urlopen
    httplib_response = self._make_request(
  File "/usr/local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 381, in _make_request
    self._validate_conn(conn)
  File "/usr/local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 978, in _validate_conn
    conn.connect()
  File "/usr/local/lib/python3.8/site-packages/urllib3/connection.py", line 309, in connect
    conn = self._new_conn()
  File "/usr/local/lib/python3.8/site-packages/urllib3/connection.py", line 171, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <botocore.awsrequest.AWSHTTPSConnection object at 0xffff99f5bb50>: Failed to establish a new connection: [Errno -2] Name or service not known

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 307, in _execute
    query_id = retry_api_call(
  File "/usr/local/lib/python3.8/site-packages/pyathena/util.py", line 84, in retry_api_call
    return retry(func, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 404, in __call__
    do = self.iter(retry_state=retry_state)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 349, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 407, in __call__
    result = fn(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 276, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 572, in _make_api_call
    http, parsed_response = self._make_request(
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 592, in _make_request
    return self._endpoint.make_request(operation_model, request_dict)
  File "/usr/local/lib/python3.8/site-packages/botocore/endpoint.py", line 102, in make_request
    return self._send_request(request_dict, operation_model)
  File "/usr/local/lib/python3.8/site-packages/botocore/endpoint.py", line 136, in _send_request
    while self._needs_retry(attempts, operation_model, request_dict,
  File "/usr/local/lib/python3.8/site-packages/botocore/endpoint.py", line 228, in _needs_retry
    responses = self._event_emitter.emit(
  File "/usr/local/lib/python3.8/site-packages/botocore/hooks.py", line 356, in emit
    return self._emitter.emit(aliased_event_name, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/hooks.py", line 228, in emit
    return self._emit(event_name, kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/hooks.py", line 211, in _emit
    response = handler(**kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/retryhandler.py", line 183, in __call__
    if self._checker(attempts, response, caught_exception):
  File "/usr/local/lib/python3.8/site-packages/botocore/retryhandler.py", line 250, in __call__
    should_retry = self._should_retry(attempt_number, response,
  File "/usr/local/lib/python3.8/site-packages/botocore/retryhandler.py", line 277, in _should_retry
    return self._checker(attempt_number, response, caught_exception)
  File "/usr/local/lib/python3.8/site-packages/botocore/retryhandler.py", line 316, in __call__
    checker_response = checker(attempt_number, response,
  File "/usr/local/lib/python3.8/site-packages/botocore/retryhandler.py", line 222, in __call__
    return self._check_caught_exception(
  File "/usr/local/lib/python3.8/site-packages/botocore/retryhandler.py", line 359, in _check_caught_exception
    raise caught_exception
  File "/usr/local/lib/python3.8/site-packages/botocore/endpoint.py", line 200, in _do_get_response
    http_response = self._send(request)
  File "/usr/local/lib/python3.8/site-packages/botocore/endpoint.py", line 244, in _send
    return self.http_session.send(request)
  File "/usr/local/lib/python3.8/site-packages/botocore/httpsession.py", line 283, in send
    raise EndpointConnectionError(endpoint_url=request.url, error=e)
botocore.exceptions.EndpointConnectionError: Could not connect to the endpoint URL: "https://athena.eu-east-1.amazonaws.com/"
2021-11-16 15:40:22.405582 (ThreadPoolExecutor-0_0): Error running SQL: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
  
2021-11-16 15:40:22.407677 (ThreadPoolExecutor-0_0): Error running SQL: macro list_schemas
2021-11-16 15:40:22.409216 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: Close
2021-11-16 15:40:22.411223 (MainThread): Connection 'master' was properly closed.
2021-11-16 15:40:22.413193 (MainThread): Connection 'list_awsdatacatalog' was properly closed.
2021-11-16 15:40:22.414860 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9aa495e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9aa43640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9aa3ac10>]}
2021-11-16 15:40:22.416672 (MainThread): Flushing usage events
2021-11-16 15:40:22.747377 (MainThread): Encountered an error:
2021-11-16 15:40:22.752204 (MainThread): Runtime Error
  Runtime Error
    Could not connect to the endpoint URL: "https://athena.eu-east-1.amazonaws.com/"
2021-11-16 15:40:22.766738 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/urllib3/connection.py", line 159, in _new_conn
    conn = connection.create_connection(
  File "/usr/local/lib/python3.8/site-packages/urllib3/util/connection.py", line 61, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/local/lib/python3.8/socket.py", line 918, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -2] Name or service not known

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/botocore/httpsession.py", line 254, in send
    urllib_response = conn.urlopen(
  File "/usr/local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 726, in urlopen
    retries = retries.increment(
  File "/usr/local/lib/python3.8/site-packages/urllib3/util/retry.py", line 386, in increment
    raise six.reraise(type(error), error, _stacktrace)
  File "/usr/local/lib/python3.8/site-packages/urllib3/packages/six.py", line 735, in reraise
    raise value
  File "/usr/local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 670, in urlopen
    httplib_response = self._make_request(
  File "/usr/local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 381, in _make_request
    self._validate_conn(conn)
  File "/usr/local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 978, in _validate_conn
    conn.connect()
  File "/usr/local/lib/python3.8/site-packages/urllib3/connection.py", line 309, in connect
    conn = self._new_conn()
  File "/usr/local/lib/python3.8/site-packages/urllib3/connection.py", line 171, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <botocore.awsrequest.AWSHTTPSConnection object at 0xffff99f5bb50>: Failed to establish a new connection: [Errno -2] Name or service not known

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 307, in _execute
    query_id = retry_api_call(
  File "/usr/local/lib/python3.8/site-packages/pyathena/util.py", line 84, in retry_api_call
    return retry(func, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 404, in __call__
    do = self.iter(retry_state=retry_state)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 349, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 407, in __call__
    result = fn(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 276, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 572, in _make_api_call
    http, parsed_response = self._make_request(
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 592, in _make_request
    return self._endpoint.make_request(operation_model, request_dict)
  File "/usr/local/lib/python3.8/site-packages/botocore/endpoint.py", line 102, in make_request
    return self._send_request(request_dict, operation_model)
  File "/usr/local/lib/python3.8/site-packages/botocore/endpoint.py", line 136, in _send_request
    while self._needs_retry(attempts, operation_model, request_dict,
  File "/usr/local/lib/python3.8/site-packages/botocore/endpoint.py", line 228, in _needs_retry
    responses = self._event_emitter.emit(
  File "/usr/local/lib/python3.8/site-packages/botocore/hooks.py", line 356, in emit
    return self._emitter.emit(aliased_event_name, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/hooks.py", line 228, in emit
    return self._emit(event_name, kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/hooks.py", line 211, in _emit
    response = handler(**kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/retryhandler.py", line 183, in __call__
    if self._checker(attempts, response, caught_exception):
  File "/usr/local/lib/python3.8/site-packages/botocore/retryhandler.py", line 250, in __call__
    should_retry = self._should_retry(attempt_number, response,
  File "/usr/local/lib/python3.8/site-packages/botocore/retryhandler.py", line 277, in _should_retry
    return self._checker(attempt_number, response, caught_exception)
  File "/usr/local/lib/python3.8/site-packages/botocore/retryhandler.py", line 316, in __call__
    checker_response = checker(attempt_number, response,
  File "/usr/local/lib/python3.8/site-packages/botocore/retryhandler.py", line 222, in __call__
    return self._check_caught_exception(
  File "/usr/local/lib/python3.8/site-packages/botocore/retryhandler.py", line 359, in _check_caught_exception
    raise caught_exception
  File "/usr/local/lib/python3.8/site-packages/botocore/endpoint.py", line 200, in _do_get_response
    http_response = self._send(request)
  File "/usr/local/lib/python3.8/site-packages/botocore/endpoint.py", line 244, in _send
    return self.http_session.send(request)
  File "/usr/local/lib/python3.8/site-packages/botocore/httpsession.py", line 283, in send
    raise EndpointConnectionError(endpoint_url=request.url, error=e)
botocore.exceptions.EndpointConnectionError: Could not connect to the endpoint URL: "https://athena.eu-east-1.amazonaws.com/"

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 100, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 72, in execute
    query_id = self._execute(
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 315, in _execute
    raise DatabaseError(*e.args) from e
pyathena.error.DatabaseError: Could not connect to the endpoint URL: "https://athena.eu-east-1.amazonaws.com/"

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 100, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 1000, in execute_macro
    result = macro_function(**kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 20, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 31, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 103, in exception_handler
    raise RuntimeException(str(e)) from e
dbt.exceptions.RuntimeException: Runtime Error
  Could not connect to the endpoint URL: "https://athena.eu-east-1.amazonaws.com/"

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 452, in run
    result = self.execute_with_hooks(selected_uids)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 410, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 410, in before_run
    self.create_schemas(adapter, selected_uids)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 541, in create_schemas
    existing_schemas_lowered.update(ls_future.result())
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/concurrent/futures/thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/utils.py", line 482, in connected
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 518, in list_schemas
    for s in adapter.list_schemas(database_quoted)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/impl.py", line 230, in list_schemas
    results = self.execute_macro(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 1000, in execute_macro
    result = macro_function(**kwargs)
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 103, in exception_handler
    raise RuntimeException(str(e)) from e
dbt.exceptions.RuntimeException: Runtime Error
  Runtime Error
    Could not connect to the endpoint URL: "https://athena.eu-east-1.amazonaws.com/"

2021-11-16 15:48:56.218281 (MainThread): Running with dbt=0.21.0
2021-11-16 15:48:56.286070 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/vscode/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-16 15:48:56.290664 (MainThread): Tracking: tracking
2021-11-16 15:48:56.292887 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8fc95b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba8641f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba864dc0>]}
2021-11-16 15:48:56.301126 (MainThread): Partial parsing not enabled
2021-11-16 15:48:56.315151 (MainThread): Parsing macros/catalog.sql
2021-11-16 15:48:56.317892 (MainThread): Parsing macros/adapters.sql
2021-11-16 15:48:56.327353 (MainThread): Parsing macros/materializations/seed.sql
2021-11-16 15:48:56.331159 (MainThread): Parsing macros/materializations/snapshot.sql
2021-11-16 15:48:56.332372 (MainThread): Parsing macros/materializations/table.sql
2021-11-16 15:48:56.336310 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-16 15:48:56.348924 (MainThread): Parsing macros/materializations/view.sql
2021-11-16 15:48:56.353015 (MainThread): Parsing macros/core.sql
2021-11-16 15:48:56.356227 (MainThread): Parsing macros/materializations/test.sql
2021-11-16 15:48:56.360711 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-16 15:48:56.366248 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-16 15:48:56.370391 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-16 15:48:56.376049 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-16 15:48:56.378669 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-16 15:48:56.384905 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-16 15:48:56.395706 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-16 15:48:56.408254 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-16 15:48:56.412704 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-16 15:48:56.420635 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-16 15:48:56.436601 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-16 15:48:56.445356 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-16 15:48:56.447088 (MainThread): Parsing macros/etc/query.sql
2021-11-16 15:48:56.448989 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-16 15:48:56.451368 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-16 15:48:56.454797 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-16 15:48:56.456202 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-16 15:48:56.458331 (MainThread): Parsing macros/etc/datetime.sql
2021-11-16 15:48:56.463908 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-16 15:48:56.465952 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-16 15:48:56.468650 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-16 15:48:56.469954 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-16 15:48:56.471930 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-16 15:48:56.473436 (MainThread): Parsing macros/adapters/common.sql
2021-11-16 15:48:56.581045 (MainThread): Acquiring new athena connection "model.my_new_project.customers".
2021-11-16 15:48:56.589268 (MainThread): Acquiring new athena connection "model.my_new_project.sample_nrel".
2021-11-16 15:48:56.591659 (MainThread): Acquiring new athena connection "model.my_new_project.stg_customers".
2021-11-16 15:48:56.594272 (MainThread): Acquiring new athena connection "model.my_new_project.stg_orders".
2021-11-16 15:48:56.596295 (MainThread): Acquiring new athena connection "model.my_new_project.my_first_dbt_model".
2021-11-16 15:48:56.599441 (MainThread): Acquiring new athena connection "model.my_new_project.my_second_dbt_model".
2021-11-16 15:48:56.616129 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-11-16 15:48:56.617966 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-11-16 15:48:56.619752 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-11-16 15:48:56.622225 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-11-16 15:48:56.637414 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a2e42eb3-5320-4965-86cc-11309784a7a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8abff40>]}
2021-11-16 15:48:56.651082 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-11-16 15:48:56.652994 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a2e42eb3-5320-4965-86cc-11309784a7a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8a685b0>]}
2021-11-16 15:48:56.653949 (MainThread): Found 6 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-16 15:48:56.656855 (MainThread): 
2021-11-16 15:48:56.657770 (MainThread): Acquiring new athena connection "master".
2021-11-16 15:48:56.660109 (ThreadPoolExecutor-0_0): Acquiring new athena connection "list_awsdatacatalog".
2021-11-16 15:48:56.667668 (ThreadPoolExecutor-0_0): Using athena connection "list_awsdatacatalog".
2021-11-16 15:48:56.668894 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
  
2021-11-16 15:48:56.671695 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-16 15:48:56.692117 (ThreadPoolExecutor-0_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
2021-11-16 15:48:58.551297 (ThreadPoolExecutor-0_0): SQL status: OK -1 in 1.88 seconds
2021-11-16 15:48:58.558951 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: Close
2021-11-16 15:48:58.568163 (ThreadPoolExecutor-2_0): Acquiring new athena connection "list_awsdatacatalog_dbt".
2021-11-16 15:48:58.571416 (ThreadPoolExecutor-2_0): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 56866), raddr=('52.22.38.12', 443)>
2021-11-16 15:48:58.585493 (ThreadPoolExecutor-2_0): Using athena connection "list_awsdatacatalog_dbt".
2021-11-16 15:48:58.587437 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
2021-11-16 15:48:58.591106 (ThreadPoolExecutor-2_0): Opening a new connection, currently in state closed
2021-11-16 15:48:58.618242 (ThreadPoolExecutor-2_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
2021-11-16 15:49:01.507285 (ThreadPoolExecutor-2_0): SQL status: OK -1 in 2.92 seconds
2021-11-16 15:49:01.511087 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: Close
2021-11-16 15:49:01.516953 (MainThread): 15:49:01 | Concurrency: 1 threads (target='dev')
2021-11-16 15:49:01.523138 (MainThread): 15:49:01 | 
2021-11-16 15:49:01.529718 (Thread-1): Began running node model.my_new_project.my_first_dbt_model
2021-11-16 15:49:01.531232 (Thread-1): 15:49:01 | 1 of 6 START table model dbt.my_first_dbt_model...................... [RUN]
2021-11-16 15:49:01.533271 (Thread-1): Acquiring new athena connection "model.my_new_project.my_first_dbt_model".
2021-11-16 15:49:01.537732 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 56868), raddr=('52.22.38.12', 443)>
2021-11-16 15:49:01.540494 (Thread-1): Compiling model.my_new_project.my_first_dbt_model
2021-11-16 15:49:01.544801 (Thread-1): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2021-11-16 15:49:01.564325 (Thread-1): finished collecting timing info
2021-11-16 15:49:01.575985 (Thread-1): Opening a new connection, currently in state closed
2021-11-16 15:49:02.089040 (Thread-1): Deleting table data from's3://justin-dbt-testing/dbt/tables/c05bc5dd-f036-45a9-98ea-70a293200441/'
2021-11-16 15:49:02.162508 (Thread-1): Loading s3:s3
2021-11-16 15:49:02.164313 (Thread-1): Loading s3:Bucket
2021-11-16 15:49:02.166516 (Thread-1): Renaming Bucket attribute name
2021-11-16 15:49:02.175899 (Thread-1): Calling paginated s3:list_objects with {'Bucket': 'justin-dbt-testing', 'Prefix': 'dbt/tables/c05bc5dd-f036-45a9-98ea-70a293200441/'}
2021-11-16 15:49:02.543656 (Thread-1): Loading s3:ObjectSummary
2021-11-16 15:49:02.544649 (Thread-1): Renaming ObjectSummary attribute key
2021-11-16 15:49:02.546683 (Thread-1): Calling s3:delete_objects with {'Bucket': 'justin-dbt-testing', 'Delete': {'Objects': [{'Key': 'dbt/tables/c05bc5dd-f036-45a9-98ea-70a293200441/20211116_044314_00098_dq8mc_7c4f1539-8f90-4e6b-a64f-2f5f04a542da'}, {'Key': 'dbt/tables/c05bc5dd-f036-45a9-98ea-70a293200441/20211116_044314_00098_dq8mc_dd006fe0-76b9-4167-901d-74acdb89a4e8'}]}}
2021-11-16 15:49:02.664854 (Thread-1): Response: {'ResponseMetadata': {'RequestId': 'RJG3577EDV93BK8N', 'HostId': 'vFSrx3nFnoUuj5JLcEcSq7h2aCpVRnAwI3LRciSxGg3w1hlAwr5tEMLnmTmPa50d+QTQrV/v8iI=', 'HTTPStatusCode': 200, 'HTTPHeaders': {'x-amz-id-2': 'vFSrx3nFnoUuj5JLcEcSq7h2aCpVRnAwI3LRciSxGg3w1hlAwr5tEMLnmTmPa50d+QTQrV/v8iI=', 'x-amz-request-id': 'RJG3577EDV93BK8N', 'date': 'Tue, 16 Nov 2021 15:49:03 GMT', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'server': 'AmazonS3', 'connection': 'close'}, 'RetryAttempts': 0}, 'Deleted': [{'Key': 'dbt/tables/c05bc5dd-f036-45a9-98ea-70a293200441/20211116_044314_00098_dq8mc_7c4f1539-8f90-4e6b-a64f-2f5f04a542da'}, {'Key': 'dbt/tables/c05bc5dd-f036-45a9-98ea-70a293200441/20211116_044314_00098_dq8mc_dd006fe0-76b9-4167-901d-74acdb89a4e8'}]}
2021-11-16 15:49:02.666835 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 54232), raddr=('34.206.102.215', 443)>
2021-11-16 15:49:02.669806 (Thread-1): Using athena connection "model.my_new_project.my_first_dbt_model".
2021-11-16 15:49:02.671984 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists dbt.my_first_dbt_model
2021-11-16 15:49:02.674844 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists dbt.my_first_dbt_model
2021-11-16 15:49:04.412415 (Thread-1): SQL status: OK -1 in 1.74 seconds
2021-11-16 15:49:04.444967 (Thread-1): Writing runtime SQL for node "model.my_new_project.my_first_dbt_model"
2021-11-16 15:49:04.477459 (Thread-1): Using athena connection "model.my_new_project.my_first_dbt_model".
2021-11-16 15:49:04.479906 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
create table
    dbt.my_first_dbt_model

    with (
        format='parquet'
    )
  as
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null

  
2021-11-16 15:49:04.484483 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
create table
    dbt.my_first_dbt_model

    with (
        format='parquet'
    )
  as
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
2021-11-16 15:49:07.085418 (Thread-1): SQL status: OK -1 in 2.60 seconds
2021-11-16 15:49:07.101178 (Thread-1): Using athena connection "model.my_new_project.my_first_dbt_model".
2021-11-16 15:49:07.103704 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table dbt.my_first_dbt_model set tblproperties ('classification' = 'parquet')
2021-11-16 15:49:07.108066 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table dbt.my_first_dbt_model set tblproperties ('classification' = 'parquet')
2021-11-16 15:49:08.644930 (Thread-1): SQL status: OK -1 in 1.54 seconds
2021-11-16 15:49:08.667186 (Thread-1): finished collecting timing info
2021-11-16 15:49:08.670524 (Thread-1): On model.my_new_project.my_first_dbt_model: Close
2021-11-16 15:49:08.676783 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2e42eb3-5320-4965-86cc-11309784a7a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb344df40>]}
2021-11-16 15:49:08.681381 (Thread-1): 15:49:08 | 1 of 6 OK created table model dbt.my_first_dbt_model................. [OK -1 in 7.14s]
2021-11-16 15:49:08.685797 (Thread-1): Finished running node model.my_new_project.my_first_dbt_model
2021-11-16 15:49:08.689721 (Thread-1): Began running node model.my_new_project.sample_nrel
2021-11-16 15:49:08.693698 (Thread-1): 15:49:08 | 2 of 6 START view model dbt.sample_nrel.............................. [RUN]
2021-11-16 15:49:08.697828 (Thread-1): Acquiring new athena connection "model.my_new_project.sample_nrel".
2021-11-16 15:49:08.700278 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 56874), raddr=('52.22.38.12', 443)>
2021-11-16 15:49:08.704368 (Thread-1): Compiling model.my_new_project.sample_nrel
2021-11-16 15:49:08.707977 (Thread-1): Writing injected SQL for node "model.my_new_project.sample_nrel"
2021-11-16 15:49:08.717015 (Thread-1): finished collecting timing info
2021-11-16 15:49:08.730785 (Thread-1): Dropping relation dbt.sample_nrel because it is of type table
2021-11-16 15:49:08.733222 (Thread-1): Opening a new connection, currently in state closed
2021-11-16 15:49:09.184988 (Thread-1): Deleting table data from's3://justin-dbt-testing/dbt/tables/f3ca7dcc-6dce-46d2-803f-26c9fa1c9130/'
2021-11-16 15:49:09.191260 (Thread-1): Loading s3:s3
2021-11-16 15:49:09.193083 (Thread-1): Loading s3:Bucket
2021-11-16 15:49:09.195866 (Thread-1): Renaming Bucket attribute name
2021-11-16 15:49:09.199574 (Thread-1): Calling paginated s3:list_objects with {'Bucket': 'justin-dbt-testing', 'Prefix': 'dbt/tables/f3ca7dcc-6dce-46d2-803f-26c9fa1c9130/'}
2021-11-16 15:49:09.508299 (Thread-1): Loading s3:ObjectSummary
2021-11-16 15:49:09.511944 (Thread-1): Renaming ObjectSummary attribute key
2021-11-16 15:49:09.518666 (Thread-1): Calling s3:delete_objects with {'Bucket': 'justin-dbt-testing', 'Delete': {'Objects': [{'Key': 'dbt/tables/f3ca7dcc-6dce-46d2-803f-26c9fa1c9130/20211116_044321_00020_5n6bn_04ea6ddb-7702-4079-8ef3-5fba56c6872f'}, {'Key': 'dbt/tables/f3ca7dcc-6dce-46d2-803f-26c9fa1c9130/20211116_044321_00020_5n6bn_80d18e73-706f-4962-a436-6476d8bf1f55'}]}}
2021-11-16 15:49:09.639288 (Thread-1): Response: {'ResponseMetadata': {'RequestId': 'RMBWWWKWD872N44T', 'HostId': '3SglQJZJDb2rwGXT6wypH558/PMqzdYj7S8eDNJPu+YJEEmNCP9zxK7Bi2i/j7+KNY1kkUHYdfE=', 'HTTPStatusCode': 200, 'HTTPHeaders': {'x-amz-id-2': '3SglQJZJDb2rwGXT6wypH558/PMqzdYj7S8eDNJPu+YJEEmNCP9zxK7Bi2i/j7+KNY1kkUHYdfE=', 'x-amz-request-id': 'RMBWWWKWD872N44T', 'date': 'Tue, 16 Nov 2021 15:49:10 GMT', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'server': 'AmazonS3', 'connection': 'close'}, 'RetryAttempts': 0}, 'Deleted': [{'Key': 'dbt/tables/f3ca7dcc-6dce-46d2-803f-26c9fa1c9130/20211116_044321_00020_5n6bn_80d18e73-706f-4962-a436-6476d8bf1f55'}, {'Key': 'dbt/tables/f3ca7dcc-6dce-46d2-803f-26c9fa1c9130/20211116_044321_00020_5n6bn_04ea6ddb-7702-4079-8ef3-5fba56c6872f'}]}
2021-11-16 15:49:09.645029 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 54238), raddr=('34.206.102.215', 443)>
2021-11-16 15:49:09.655227 (Thread-1): Using athena connection "model.my_new_project.sample_nrel".
2021-11-16 15:49:09.658259 (Thread-1): On model.my_new_project.sample_nrel: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.sample_nrel"} */
drop table if exists dbt.sample_nrel
2021-11-16 15:49:09.663417 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.sample_nrel"} */
drop table if exists dbt.sample_nrel
2021-11-16 15:49:11.424423 (Thread-1): SQL status: OK -1 in 1.76 seconds
2021-11-16 15:49:11.441808 (Thread-1): Writing runtime SQL for node "model.my_new_project.sample_nrel"
2021-11-16 15:49:11.454955 (Thread-1): Using athena connection "model.my_new_project.sample_nrel".
2021-11-16 15:49:11.458266 (Thread-1): On model.my_new_project.sample_nrel: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.sample_nrel"} */
create or replace view
    dbt.sample_nrel
  as
    SELECT bldg_id, sum("out.electricity.interior_lighting.energy_consumption") as total_interior_lighting_consumption 
FROM "defaultdb"."upgrade_0" where county='G5500690' 
group by bldg_id;

2021-11-16 15:49:11.468355 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.sample_nrel"} */
create or replace view
    dbt.sample_nrel
  as
    SELECT bldg_id, sum("out.electricity.interior_lighting.energy_consumption") as total_interior_lighting_consumption 
FROM "defaultdb"."upgrade_0" where county='G5500690' 
group by bldg_id;
2021-11-16 15:49:13.089094 (Thread-1): SQL status: OK -1 in 1.62 seconds
2021-11-16 15:49:13.097931 (Thread-1): Using athena connection "model.my_new_project.sample_nrel".
2021-11-16 15:49:13.101984 (Thread-1): On model.my_new_project.sample_nrel: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.sample_nrel"} */
alter table dbt.sample_nrel set tblproperties ('classification' = 'view')
2021-11-16 15:49:13.111187 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.sample_nrel"} */
alter table dbt.sample_nrel set tblproperties ('classification' = 'view')
2021-11-16 15:49:14.651147 (Thread-1): SQL status: OK -1 in 1.54 seconds
2021-11-16 15:49:14.663036 (Thread-1): finished collecting timing info
2021-11-16 15:49:14.666391 (Thread-1): On model.my_new_project.sample_nrel: Close
2021-11-16 15:49:14.674032 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2e42eb3-5320-4965-86cc-11309784a7a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1cae730>]}
2021-11-16 15:49:14.683072 (Thread-1): 15:49:14 | 2 of 6 OK created view model dbt.sample_nrel......................... [OK -1 in 5.98s]
2021-11-16 15:49:14.689105 (Thread-1): Finished running node model.my_new_project.sample_nrel
2021-11-16 15:49:14.693453 (Thread-1): Began running node model.my_new_project.stg_customers
2021-11-16 15:49:14.697918 (Thread-1): 15:49:14 | 3 of 6 START view model dbt.stg_customers............................ [RUN]
2021-11-16 15:49:14.703306 (Thread-1): Acquiring new athena connection "model.my_new_project.stg_customers".
2021-11-16 15:49:14.706710 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 56880), raddr=('52.22.38.12', 443)>
2021-11-16 15:49:14.710060 (Thread-1): Compiling model.my_new_project.stg_customers
2021-11-16 15:49:14.715981 (Thread-1): Writing injected SQL for node "model.my_new_project.stg_customers"
2021-11-16 15:49:14.725124 (Thread-1): finished collecting timing info
2021-11-16 15:49:14.728492 (Thread-1): Writing runtime SQL for node "model.my_new_project.stg_customers"
2021-11-16 15:49:14.733985 (Thread-1): Using athena connection "model.my_new_project.stg_customers".
2021-11-16 15:49:14.735446 (Thread-1): On model.my_new_project.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.stg_customers"} */
create or replace view
    dbt.stg_customers
  as
    select
    id as customer_id,
    first_name,
    last_name

from `dbt-tutorial`.jaffle_shop.customers

2021-11-16 15:49:14.738813 (Thread-1): Opening a new connection, currently in state closed
2021-11-16 15:49:14.755493 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.stg_customers"} */
create or replace view
    dbt.stg_customers
  as
    select
    id as customer_id,
    first_name,
    last_name

from `dbt-tutorial`.jaffle_shop.customers
2021-11-16 15:49:15.004048 (Thread-1): Failed to execute query.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 307, in _execute
    query_id = retry_api_call(
  File "/usr/local/lib/python3.8/site-packages/pyathena/util.py", line 84, in retry_api_call
    return retry(func, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 404, in __call__
    do = self.iter(retry_state=retry_state)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 349, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 407, in __call__
    result = fn(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 276, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 586, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 10:6: backquoted identifiers are not supported; use double quotes to quote identifiers
2021-11-16 15:49:15.007691 (Thread-1): Error running SQL: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.stg_customers"} */
create or replace view
    dbt.stg_customers
  as
    select
    id as customer_id,
    first_name,
    last_name

from `dbt-tutorial`.jaffle_shop.customers

2021-11-16 15:49:15.010699 (Thread-1): finished collecting timing info
2021-11-16 15:49:15.014726 (Thread-1): On model.my_new_project.stg_customers: Close
2021-11-16 15:49:15.017859 (Thread-1): Runtime Error in model stg_customers (models/stg_customers.sql)
  An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 10:6: backquoted identifiers are not supported; use double quotes to quote identifiers
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 307, in _execute
    query_id = retry_api_call(
  File "/usr/local/lib/python3.8/site-packages/pyathena/util.py", line 84, in retry_api_call
    return retry(func, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 404, in __call__
    do = self.iter(retry_state=retry_state)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 349, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 407, in __call__
    result = fn(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 276, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 586, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 10:6: backquoted identifiers are not supported; use double quotes to quote identifiers

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 100, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 72, in execute
    query_id = self._execute(
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 315, in _execute
    raise DatabaseError(*e.args) from e
pyathena.error.DatabaseError: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 10:6: backquoted identifiers are not supported; use double quotes to quote identifiers

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 66, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 103, in exception_handler
    raise RuntimeException(str(e)) from e
dbt.exceptions.RuntimeException: Runtime Error in model stg_customers (models/stg_customers.sql)
  An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 10:6: backquoted identifiers are not supported; use double quotes to quote identifiers
2021-11-16 15:49:15.022338 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2e42eb3-5320-4965-86cc-11309784a7a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8a21c70>]}
2021-11-16 15:49:15.025308 (Thread-1): 15:49:15 | 3 of 6 ERROR creating view model dbt.stg_customers................... [ERROR in 0.32s]
2021-11-16 15:49:15.027505 (Thread-1): Finished running node model.my_new_project.stg_customers
2021-11-16 15:49:15.029836 (Thread-1): Began running node model.my_new_project.stg_orders
2021-11-16 15:49:15.031712 (Thread-1): 15:49:15 | 4 of 6 START view model dbt.stg_orders............................... [RUN]
2021-11-16 15:49:15.033792 (Thread-1): Acquiring new athena connection "model.my_new_project.stg_orders".
2021-11-16 15:49:15.035963 (Thread-1): Compiling model.my_new_project.stg_orders
2021-11-16 15:49:15.039275 (Thread-1): Writing injected SQL for node "model.my_new_project.stg_orders"
2021-11-16 15:49:15.044688 (Thread-1): finished collecting timing info
2021-11-16 15:49:15.046620 (Thread-1): Writing runtime SQL for node "model.my_new_project.stg_orders"
2021-11-16 15:49:15.053172 (Thread-1): Using athena connection "model.my_new_project.stg_orders".
2021-11-16 15:49:15.054123 (Thread-1): On model.my_new_project.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.stg_orders"} */
create or replace view
    dbt.stg_orders
  as
    select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from `dbt-tutorial`.jaffle_shop.orders

2021-11-16 15:49:15.056300 (Thread-1): Opening a new connection, currently in state closed
2021-11-16 15:49:15.065225 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 56882), raddr=('52.22.38.12', 443)>
2021-11-16 15:49:15.075390 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.stg_orders"} */
create or replace view
    dbt.stg_orders
  as
    select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from `dbt-tutorial`.jaffle_shop.orders
2021-11-16 15:49:15.301022 (Thread-1): Failed to execute query.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 307, in _execute
    query_id = retry_api_call(
  File "/usr/local/lib/python3.8/site-packages/pyathena/util.py", line 84, in retry_api_call
    return retry(func, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 404, in __call__
    do = self.iter(retry_state=retry_state)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 349, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 407, in __call__
    result = fn(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 276, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 586, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 11:6: backquoted identifiers are not supported; use double quotes to quote identifiers
2021-11-16 15:49:15.302076 (Thread-1): Error running SQL: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.stg_orders"} */
create or replace view
    dbt.stg_orders
  as
    select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from `dbt-tutorial`.jaffle_shop.orders

2021-11-16 15:49:15.304773 (Thread-1): finished collecting timing info
2021-11-16 15:49:15.306716 (Thread-1): On model.my_new_project.stg_orders: Close
2021-11-16 15:49:15.308958 (Thread-1): Runtime Error in model stg_orders (models/stg_orders.sql)
  An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 11:6: backquoted identifiers are not supported; use double quotes to quote identifiers
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 307, in _execute
    query_id = retry_api_call(
  File "/usr/local/lib/python3.8/site-packages/pyathena/util.py", line 84, in retry_api_call
    return retry(func, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 404, in __call__
    do = self.iter(retry_state=retry_state)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 349, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 407, in __call__
    result = fn(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 276, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 586, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 11:6: backquoted identifiers are not supported; use double quotes to quote identifiers

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 100, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 72, in execute
    query_id = self._execute(
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 315, in _execute
    raise DatabaseError(*e.args) from e
pyathena.error.DatabaseError: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 11:6: backquoted identifiers are not supported; use double quotes to quote identifiers

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 66, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 103, in exception_handler
    raise RuntimeException(str(e)) from e
dbt.exceptions.RuntimeException: Runtime Error in model stg_orders (models/stg_orders.sql)
  An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 11:6: backquoted identifiers are not supported; use double quotes to quote identifiers
2021-11-16 15:49:15.311347 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2e42eb3-5320-4965-86cc-11309784a7a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb34ab670>]}
2021-11-16 15:49:15.314412 (Thread-1): 15:49:15 | 4 of 6 ERROR creating view model dbt.stg_orders...................... [ERROR in 0.28s]
2021-11-16 15:49:15.316172 (Thread-1): Finished running node model.my_new_project.stg_orders
2021-11-16 15:49:15.317985 (Thread-1): Began running node model.my_new_project.my_second_dbt_model
2021-11-16 15:49:15.319839 (Thread-1): 15:49:15 | 5 of 6 START view model dbt.my_second_dbt_model...................... [RUN]
2021-11-16 15:49:15.321399 (Thread-1): Acquiring new athena connection "model.my_new_project.my_second_dbt_model".
2021-11-16 15:49:15.323011 (Thread-1): Compiling model.my_new_project.my_second_dbt_model
2021-11-16 15:49:15.325366 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 56884), raddr=('52.22.38.12', 443)>
2021-11-16 15:49:15.328062 (Thread-1): Writing injected SQL for node "model.my_new_project.my_second_dbt_model"
2021-11-16 15:49:15.332356 (Thread-1): finished collecting timing info
2021-11-16 15:49:15.333806 (Thread-1): Dropping relation dbt.my_second_dbt_model because it is of type table
2021-11-16 15:49:15.335786 (Thread-1): Opening a new connection, currently in state closed
2021-11-16 15:49:15.730097 (Thread-1): Deleting table data from's3://justin-dbt-testing/dbt/tables/8336fe50-69b4-4571-9fdb-67055dc6d49e/'
2021-11-16 15:49:15.737989 (Thread-1): Loading s3:s3
2021-11-16 15:49:15.743340 (Thread-1): Loading s3:Bucket
2021-11-16 15:49:15.745178 (Thread-1): Renaming Bucket attribute name
2021-11-16 15:49:15.749030 (Thread-1): Calling paginated s3:list_objects with {'Bucket': 'justin-dbt-testing', 'Prefix': 'dbt/tables/8336fe50-69b4-4571-9fdb-67055dc6d49e/'}
2021-11-16 15:49:16.065071 (Thread-1): Loading s3:ObjectSummary
2021-11-16 15:49:16.067205 (Thread-1): Renaming ObjectSummary attribute key
2021-11-16 15:49:16.071526 (Thread-1): Calling s3:delete_objects with {'Bucket': 'justin-dbt-testing', 'Delete': {'Objects': [{'Key': 'dbt/tables/8336fe50-69b4-4571-9fdb-67055dc6d49e/20211116_044331_00039_49kqq_6078b4b6-9c5b-4919-8277-00cf67cb1ca0'}]}}
2021-11-16 15:49:16.176555 (Thread-1): Response: {'ResponseMetadata': {'RequestId': 'NJ3X4N236TQCFXJH', 'HostId': 'lIrOGXLFTLzYN0QntiRyyYAR5fx6TEEs1RvIbCA7mtKOsnfd8Qx871G1c1Iv5oo4tPhSKa/Zi5Y=', 'HTTPStatusCode': 200, 'HTTPHeaders': {'x-amz-id-2': 'lIrOGXLFTLzYN0QntiRyyYAR5fx6TEEs1RvIbCA7mtKOsnfd8Qx871G1c1Iv5oo4tPhSKa/Zi5Y=', 'x-amz-request-id': 'NJ3X4N236TQCFXJH', 'date': 'Tue, 16 Nov 2021 15:49:17 GMT', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'server': 'AmazonS3', 'connection': 'close'}, 'RetryAttempts': 0}, 'Deleted': [{'Key': 'dbt/tables/8336fe50-69b4-4571-9fdb-67055dc6d49e/20211116_044331_00039_49kqq_6078b4b6-9c5b-4919-8277-00cf67cb1ca0'}]}
2021-11-16 15:49:16.177793 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 54248), raddr=('34.206.102.215', 443)>
2021-11-16 15:49:16.181277 (Thread-1): Using athena connection "model.my_new_project.my_second_dbt_model".
2021-11-16 15:49:16.183838 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop table if exists dbt.my_second_dbt_model
2021-11-16 15:49:16.187145 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop table if exists dbt.my_second_dbt_model
2021-11-16 15:49:17.950400 (Thread-1): SQL status: OK -1 in 1.76 seconds
2021-11-16 15:49:17.957105 (Thread-1): Writing runtime SQL for node "model.my_new_project.my_second_dbt_model"
2021-11-16 15:49:18.181005 (Thread-1): Using athena connection "model.my_new_project.my_second_dbt_model".
2021-11-16 15:49:18.184200 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
create or replace view
    dbt.my_second_dbt_model
  as
    -- Use the `ref` function to select from other models

select *
from dbt.my_first_dbt_model
where id = 1

2021-11-16 15:49:18.191161 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
create or replace view
    dbt.my_second_dbt_model
  as
    -- Use the `ref` function to select from other models

select *
from dbt.my_first_dbt_model
where id = 1
2021-11-16 15:49:19.747838 (Thread-1): SQL status: OK -1 in 1.56 seconds
2021-11-16 15:49:19.761709 (Thread-1): Using athena connection "model.my_new_project.my_second_dbt_model".
2021-11-16 15:49:19.767150 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
alter table dbt.my_second_dbt_model set tblproperties ('classification' = 'view')
2021-11-16 15:49:19.773906 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
alter table dbt.my_second_dbt_model set tblproperties ('classification' = 'view')
2021-11-16 15:49:21.269368 (Thread-1): SQL status: OK -1 in 1.50 seconds
2021-11-16 15:49:21.279403 (Thread-1): finished collecting timing info
2021-11-16 15:49:21.282736 (Thread-1): On model.my_new_project.my_second_dbt_model: Close
2021-11-16 15:49:21.289108 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2e42eb3-5320-4965-86cc-11309784a7a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb114edf0>]}
2021-11-16 15:49:21.296995 (Thread-1): 15:49:21 | 5 of 6 OK created view model dbt.my_second_dbt_model................. [OK -1 in 5.97s]
2021-11-16 15:49:21.302381 (Thread-1): Finished running node model.my_new_project.my_second_dbt_model
2021-11-16 15:49:21.308142 (Thread-1): Began running node model.my_new_project.customers
2021-11-16 15:49:21.312303 (Thread-1): 15:49:21 | 6 of 6 SKIP relation dbt.customers................................... [SKIP]
2021-11-16 15:49:21.315059 (Thread-1): Finished running node model.my_new_project.customers
2021-11-16 15:49:21.321962 (MainThread): Acquiring new athena connection "master".
2021-11-16 15:49:21.323644 (MainThread): 15:49:21 | 
2021-11-16 15:49:21.325879 (MainThread): 15:49:21 | Finished running 1 table model, 5 view models in 24.67s.
2021-11-16 15:49:21.328881 (MainThread): Connection 'master' was properly closed.
2021-11-16 15:49:21.332341 (MainThread): Connection 'model.my_new_project.my_second_dbt_model' was properly closed.
2021-11-16 15:49:21.335410 (MainThread): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 56890), raddr=('52.22.38.12', 443)>
2021-11-16 15:49:21.358124 (MainThread): 
2021-11-16 15:49:21.358921 (MainThread): Completed with 2 errors and 0 warnings:
2021-11-16 15:49:21.361021 (MainThread): 
2021-11-16 15:49:21.363279 (MainThread): Runtime Error in model stg_customers (models/stg_customers.sql)
2021-11-16 15:49:21.367758 (MainThread):   An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 10:6: backquoted identifiers are not supported; use double quotes to quote identifiers
2021-11-16 15:49:21.371601 (MainThread): 
2021-11-16 15:49:21.373715 (MainThread): Runtime Error in model stg_orders (models/stg_orders.sql)
2021-11-16 15:49:21.375611 (MainThread):   An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 11:6: backquoted identifiers are not supported; use double quotes to quote identifiers
2021-11-16 15:49:21.378794 (MainThread): 
Done. PASS=3 WARN=0 ERROR=2 SKIP=1 TOTAL=6
2021-11-16 15:49:21.381307 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba8858e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba8858b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3ec8f10>]}
2021-11-16 15:49:21.384952 (MainThread): Flushing usage events
2021-11-16 16:12:51.486515 (MainThread): Running with dbt=0.21.0
2021-11-16 16:12:51.557307 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/vscode/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-16 16:12:51.562501 (MainThread): Tracking: tracking
2021-11-16 16:12:51.564928 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98947880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a1e3c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a1e3e80>]}
2021-11-16 16:12:51.574794 (MainThread): Partial parsing not enabled
2021-11-16 16:12:51.584011 (MainThread): Parsing macros/catalog.sql
2021-11-16 16:12:51.587075 (MainThread): Parsing macros/adapters.sql
2021-11-16 16:12:51.602054 (MainThread): Parsing macros/materializations/seed.sql
2021-11-16 16:12:51.614041 (MainThread): Parsing macros/materializations/snapshot.sql
2021-11-16 16:12:51.615945 (MainThread): Parsing macros/materializations/table.sql
2021-11-16 16:12:51.620115 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-16 16:12:51.636372 (MainThread): Parsing macros/materializations/view.sql
2021-11-16 16:12:51.640967 (MainThread): Parsing macros/core.sql
2021-11-16 16:12:51.643796 (MainThread): Parsing macros/materializations/test.sql
2021-11-16 16:12:51.648706 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-16 16:12:51.655778 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-16 16:12:51.659506 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-16 16:12:51.664623 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-16 16:12:51.666544 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-16 16:12:51.673734 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-16 16:12:51.688980 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-16 16:12:51.705184 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-16 16:12:51.711150 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-16 16:12:51.722001 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-16 16:12:51.745080 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-16 16:12:51.755459 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-16 16:12:51.757116 (MainThread): Parsing macros/etc/query.sql
2021-11-16 16:12:51.759274 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-16 16:12:51.762113 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-16 16:12:51.764617 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-16 16:12:51.766843 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-16 16:12:51.768779 (MainThread): Parsing macros/etc/datetime.sql
2021-11-16 16:12:51.774580 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-16 16:12:51.776103 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-16 16:12:51.779795 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-16 16:12:51.781604 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-16 16:12:51.783683 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-16 16:12:51.785515 (MainThread): Parsing macros/adapters/common.sql
2021-11-16 16:12:51.901944 (MainThread): Acquiring new athena connection "model.my_new_project.Test_model".
2021-11-16 16:12:51.924523 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-11-16 16:12:51.928455 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b72ca3ce-2282-48e2-a306-8b3938b86aeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98300610>]}
2021-11-16 16:12:51.941294 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-11-16 16:12:51.943684 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b72ca3ce-2282-48e2-a306-8b3938b86aeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98300460>]}
2021-11-16 16:12:51.945949 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-11-16 16:12:51.949033 (MainThread): 
2021-11-16 16:12:51.949921 (MainThread): Acquiring new athena connection "master".
2021-11-16 16:12:51.952870 (ThreadPoolExecutor-0_0): Acquiring new athena connection "list_awsdatacatalog".
2021-11-16 16:12:51.961065 (ThreadPoolExecutor-0_0): Using athena connection "list_awsdatacatalog".
2021-11-16 16:12:51.962278 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
  
2021-11-16 16:12:51.964282 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-16 16:12:51.995424 (ThreadPoolExecutor-0_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
2021-11-16 16:12:53.787916 (ThreadPoolExecutor-0_0): SQL status: OK -1 in 1.82 seconds
2021-11-16 16:12:53.793066 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: Close
2021-11-16 16:12:53.796451 (ThreadPoolExecutor-2_0): Acquiring new athena connection "list_awsdatacatalog_dbt".
2021-11-16 16:12:53.799662 (ThreadPoolExecutor-2_0): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 33196), raddr=('54.81.133.81', 443)>
2021-11-16 16:12:53.808666 (ThreadPoolExecutor-2_0): Using athena connection "list_awsdatacatalog_dbt".
2021-11-16 16:12:53.809757 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
2021-11-16 16:12:53.812830 (ThreadPoolExecutor-2_0): Opening a new connection, currently in state closed
2021-11-16 16:12:53.834264 (ThreadPoolExecutor-2_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
2021-11-16 16:12:56.735568 (ThreadPoolExecutor-2_0): SQL status: OK -1 in 2.92 seconds
2021-11-16 16:12:56.745424 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: Close
2021-11-16 16:12:56.752118 (MainThread): 16:12:56 | Concurrency: 1 threads (target='dev')
2021-11-16 16:12:56.756726 (MainThread): 16:12:56 | 
2021-11-16 16:12:56.768948 (Thread-1): Began running node model.my_new_project.Test_model
2021-11-16 16:12:56.771441 (Thread-1): 16:12:56 | 1 of 1 START view model dbt.Test_model............................... [RUN]
2021-11-16 16:12:56.778109 (Thread-1): Acquiring new athena connection "model.my_new_project.Test_model".
2021-11-16 16:12:56.782023 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 33198), raddr=('54.81.133.81', 443)>
2021-11-16 16:12:56.785796 (Thread-1): Compiling model.my_new_project.Test_model
2021-11-16 16:12:56.790542 (Thread-1): Writing injected SQL for node "model.my_new_project.Test_model"
2021-11-16 16:12:56.801078 (Thread-1): finished collecting timing info
2021-11-16 16:12:56.817150 (Thread-1): Writing runtime SQL for node "model.my_new_project.Test_model"
2021-11-16 16:12:56.823779 (Thread-1): Using athena connection "model.my_new_project.Test_model".
2021-11-16 16:12:56.825460 (Thread-1): On model.my_new_project.Test_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.Test_model"} */
create or replace view
    dbt.Test_model
  as
    SELECT bldg_id, sum("out.electricity.interior_lighting.energy_consumption") as total_interior_lighting_consumption FROM "defaultdb"."upgrade_0" where county='G5500690' group by bldg_id;

2021-11-16 16:12:56.827475 (Thread-1): Opening a new connection, currently in state closed
2021-11-16 16:12:56.844195 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.Test_model"} */
create or replace view
    dbt.Test_model
  as
    SELECT bldg_id, sum("out.electricity.interior_lighting.energy_consumption") as total_interior_lighting_consumption FROM "defaultdb"."upgrade_0" where county='G5500690' group by bldg_id;
2021-11-16 16:12:58.506185 (Thread-1): SQL status: OK -1 in 1.68 seconds
2021-11-16 16:12:58.508978 (Thread-1): Using athena connection "model.my_new_project.Test_model".
2021-11-16 16:12:58.511468 (Thread-1): On model.my_new_project.Test_model: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.Test_model"} */
alter table dbt.Test_model set tblproperties ('classification' = 'view')
2021-11-16 16:12:58.513283 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.Test_model"} */
alter table dbt.Test_model set tblproperties ('classification' = 'view')
2021-11-16 16:13:00.025471 (Thread-1): SQL status: OK -1 in 1.51 seconds
2021-11-16 16:13:00.034267 (Thread-1): finished collecting timing info
2021-11-16 16:13:00.036076 (Thread-1): On model.my_new_project.Test_model: Close
2021-11-16 16:13:00.039000 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b72ca3ce-2282-48e2-a306-8b3938b86aeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96e25520>]}
2021-11-16 16:13:00.041408 (Thread-1): 16:13:00 | 1 of 1 OK created view model dbt.Test_model.......................... [OK -1 in 3.26s]
2021-11-16 16:13:00.043468 (Thread-1): Finished running node model.my_new_project.Test_model
2021-11-16 16:13:00.046898 (MainThread): Acquiring new athena connection "master".
2021-11-16 16:13:00.048643 (MainThread): 16:13:00 | 
2021-11-16 16:13:00.051114 (MainThread): 16:13:00 | Finished running 1 view model in 8.10s.
2021-11-16 16:13:00.055291 (MainThread): Connection 'master' was properly closed.
2021-11-16 16:13:00.058421 (MainThread): Connection 'model.my_new_project.Test_model' was properly closed.
2021-11-16 16:13:00.060444 (MainThread): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 33200), raddr=('54.81.133.81', 443)>
2021-11-16 16:13:00.075236 (MainThread): 
2021-11-16 16:13:00.077349 (MainThread): Completed successfully
2021-11-16 16:13:00.079344 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-11-16 16:13:00.080953 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96e82460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff982f8640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96e0f970>]}
2021-11-16 16:13:00.082552 (MainThread): Flushing usage events
2021-11-19 14:37:32.292143 (MainThread): Running with dbt=0.21.0
2021-11-19 14:37:32.369228 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/vscode/.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', select=None, selector_name=None, show=False, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='seed', write_json=True)
2021-11-19 14:37:32.379470 (MainThread): Tracking: tracking
2021-11-19 14:37:32.383796 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9add610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab379ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab379e20>]}
2021-11-19 14:37:32.393453 (MainThread): Partial parsing not enabled
2021-11-19 14:37:32.403723 (MainThread): Parsing macros/catalog.sql
2021-11-19 14:37:32.406274 (MainThread): Parsing macros/adapters.sql
2021-11-19 14:37:32.416208 (MainThread): Parsing macros/materializations/seed.sql
2021-11-19 14:37:32.419271 (MainThread): Parsing macros/materializations/snapshot.sql
2021-11-19 14:37:32.420362 (MainThread): Parsing macros/materializations/table.sql
2021-11-19 14:37:32.423361 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-19 14:37:32.436502 (MainThread): Parsing macros/materializations/view.sql
2021-11-19 14:37:32.441030 (MainThread): Parsing macros/core.sql
2021-11-19 14:37:32.445102 (MainThread): Parsing macros/materializations/test.sql
2021-11-19 14:37:32.449804 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-19 14:37:32.456111 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-19 14:37:32.460148 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-19 14:37:32.464857 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-19 14:37:32.466371 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-19 14:37:32.472176 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-19 14:37:32.483253 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-19 14:37:32.495887 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-19 14:37:32.501067 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-19 14:37:32.509660 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-19 14:37:32.526859 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-19 14:37:32.536806 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-19 14:37:32.539054 (MainThread): Parsing macros/etc/query.sql
2021-11-19 14:37:32.540316 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-19 14:37:32.542953 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-19 14:37:32.544731 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-19 14:37:32.546746 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-19 14:37:32.548859 (MainThread): Parsing macros/etc/datetime.sql
2021-11-19 14:37:32.554117 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-19 14:37:32.555588 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-19 14:37:32.557771 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-19 14:37:32.559191 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-19 14:37:32.560973 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-19 14:37:32.563018 (MainThread): Parsing macros/adapters/common.sql
2021-11-19 14:37:32.669774 (MainThread): Acquiring new athena connection "model.my_new_project.Test_model".
2021-11-19 14:37:32.698932 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-11-19 14:37:32.703228 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b6928c6-234c-4c64-87ee-e27d3d51037b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa94c1760>]}
2021-11-19 14:37:32.716791 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-11-19 14:37:32.718565 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b6928c6-234c-4c64-87ee-e27d3d51037b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa94a14f0>]}
2021-11-19 14:37:32.720339 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 1 seed file, 0 sources, 0 exposures
2021-11-19 14:37:32.725328 (MainThread): 
2021-11-19 14:37:32.726337 (MainThread): Acquiring new athena connection "master".
2021-11-19 14:37:32.728960 (ThreadPoolExecutor-0_0): Acquiring new athena connection "list_awsdatacatalog".
2021-11-19 14:37:32.736888 (ThreadPoolExecutor-0_0): Using athena connection "list_awsdatacatalog".
2021-11-19 14:37:32.737880 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
  
2021-11-19 14:37:32.739955 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-19 14:37:32.764030 (ThreadPoolExecutor-0_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
2021-11-19 14:37:34.681057 (ThreadPoolExecutor-0_0): SQL status: OK -1 in 1.94 seconds
2021-11-19 14:37:34.689895 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: Close
2021-11-19 14:37:34.697552 (ThreadPoolExecutor-2_0): Acquiring new athena connection "list_awsdatacatalog_dbt".
2021-11-19 14:37:34.699966 (ThreadPoolExecutor-2_0): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 54136), raddr=('35.153.76.70', 443)>
2021-11-19 14:37:34.717153 (ThreadPoolExecutor-2_0): Using athena connection "list_awsdatacatalog_dbt".
2021-11-19 14:37:34.718849 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
2021-11-19 14:37:34.722668 (ThreadPoolExecutor-2_0): Opening a new connection, currently in state closed
2021-11-19 14:37:34.749983 (ThreadPoolExecutor-2_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
2021-11-19 14:37:37.635714 (ThreadPoolExecutor-2_0): SQL status: OK -1 in 2.91 seconds
2021-11-19 14:37:37.644981 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: Close
2021-11-19 14:37:37.651310 (MainThread): 14:37:37 | Concurrency: 1 threads (target='dev')
2021-11-19 14:37:37.656345 (MainThread): 14:37:37 | 
2021-11-19 14:37:37.669454 (Thread-1): Began running node seed.my_new_project.Region_Table
2021-11-19 14:37:37.671489 (Thread-1): 14:37:37 | 1 of 1 START seed file dbt.Region_Table.............................. [RUN]
2021-11-19 14:37:37.678739 (Thread-1): Acquiring new athena connection "seed.my_new_project.Region_Table".
2021-11-19 14:37:37.684165 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 54138), raddr=('35.153.76.70', 443)>
2021-11-19 14:37:37.688375 (Thread-1): finished collecting timing info
2021-11-19 14:37:37.718232 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-11-19 14:37:37.719598 (Thread-1): * Deprecation Warning: The quote_columns parameter was not set for seeds, so the
default value of False was chosen. The default will change to True in a future
release.

For more information, see:
https://docs.getdbt.com/v0.15/docs/seeds#section-specify-column-quoting
2021-11-19 14:37:37.722403 (Thread-1): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8b6928c6-234c-4c64-87ee-e27d3d51037b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3f930a0>]}
2021-11-19 14:37:37.724462 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-11-19 14:37:37.725980 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-11-19 14:37:37.729187 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-11-19 14:37:37.731788 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-11-19 14:37:37.734458 (Thread-1): Opening a new connection, currently in state closed
2021-11-19 14:37:37.753918 (Thread-1): Using athena connection "seed.my_new_project.Region_Table".
2021-11-19 14:37:37.754995 (Thread-1): On seed.my_new_project.Region_Table: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "seed.my_new_project.Region_Table"} */

    create external table dbt.Region_Table (Zip Code integer, City string, County string, State string, Region string)
    stored as parquet
    location 's3://justin-dbt-testing/Targettables/5c0a10d5-d4a3-46aa-b0c8-58efaa864a60/'
    tblproperties ('classification'='parquet')
  
2021-11-19 14:37:37.757141 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "seed.my_new_project.Region_Table"} */

    create external table dbt.Region_Table (Zip Code integer, City string, County string, State string, Region string)
    stored as parquet
    location 's3://justin-dbt-testing/Targettables/5c0a10d5-d4a3-46aa-b0c8-58efaa864a60/'
    tblproperties ('classification'='parquet')
2021-11-19 14:37:38.011564 (Thread-1): Failed to execute query.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 307, in _execute
    query_id = retry_api_call(
  File "/usr/local/lib/python3.8/site-packages/pyathena/util.py", line 84, in retry_api_call
    return retry(func, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 404, in __call__
    do = self.iter(retry_state=retry_state)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 349, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 407, in __call__
    result = fn(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 276, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 586, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 3:12: mismatched input 'external'. Expecting: 'OR', 'SCHEMA', 'TABLE', 'VIEW'
2021-11-19 14:37:38.014018 (Thread-1): Error running SQL: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "seed.my_new_project.Region_Table"} */

    create external table dbt.Region_Table (Zip Code integer, City string, County string, State string, Region string)
    stored as parquet
    location 's3://justin-dbt-testing/Targettables/5c0a10d5-d4a3-46aa-b0c8-58efaa864a60/'
    tblproperties ('classification'='parquet')
  
2021-11-19 14:37:38.015478 (Thread-1): finished collecting timing info
2021-11-19 14:37:38.017062 (Thread-1): On seed.my_new_project.Region_Table: Close
2021-11-19 14:37:38.019345 (Thread-1): Runtime Error in seed Region_Table (data/Region_Table.csv)
  An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 3:12: mismatched input 'external'. Expecting: 'OR', 'SCHEMA', 'TABLE', 'VIEW'
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 307, in _execute
    query_id = retry_api_call(
  File "/usr/local/lib/python3.8/site-packages/pyathena/util.py", line 84, in retry_api_call
    return retry(func, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 404, in __call__
    do = self.iter(retry_state=retry_state)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 349, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 407, in __call__
    result = fn(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 276, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 586, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 3:12: mismatched input 'external'. Expecting: 'OR', 'SCHEMA', 'TABLE', 'VIEW'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 100, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 72, in execute
    query_id = self._execute(
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 315, in _execute
    raise DatabaseError(*e.args) from e
pyathena.error.DatabaseError: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 3:12: mismatched input 'external'. Expecting: 'OR', 'SCHEMA', 'TABLE', 'VIEW'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 75, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 70, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 103, in exception_handler
    raise RuntimeException(str(e)) from e
dbt.exceptions.RuntimeException: Runtime Error in seed Region_Table (data/Region_Table.csv)
  An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 3:12: mismatched input 'external'. Expecting: 'OR', 'SCHEMA', 'TABLE', 'VIEW'
2021-11-19 14:37:38.022165 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b6928c6-234c-4c64-87ee-e27d3d51037b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3f59eb0>]}
2021-11-19 14:37:38.023952 (Thread-1): 14:37:38 | 1 of 1 ERROR loading seed file dbt.Region_Table...................... [ERROR in 0.34s]
2021-11-19 14:37:38.025490 (Thread-1): Finished running node seed.my_new_project.Region_Table
2021-11-19 14:37:38.028509 (MainThread): Acquiring new athena connection "master".
2021-11-19 14:37:38.030159 (MainThread): 14:37:38 | 
2021-11-19 14:37:38.031662 (MainThread): 14:37:38 | Finished running 1 seed in 5.30s.
2021-11-19 14:37:38.032964 (MainThread): Connection 'master' was properly closed.
2021-11-19 14:37:38.034952 (MainThread): Connection 'seed.my_new_project.Region_Table' was properly closed.
2021-11-19 14:37:38.050369 (MainThread): 
2021-11-19 14:37:38.051342 (MainThread): Completed with 1 error and 0 warnings:
2021-11-19 14:37:38.054173 (MainThread): 
2021-11-19 14:37:38.055908 (MainThread): Runtime Error in seed Region_Table (data/Region_Table.csv)
2021-11-19 14:37:38.058557 (MainThread):   An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 3:12: mismatched input 'external'. Expecting: 'OR', 'SCHEMA', 'TABLE', 'VIEW'
2021-11-19 14:37:38.060186 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-11-19 14:37:38.061988 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa948ef70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa948efd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3fb9610>]}
2021-11-19 14:37:38.066953 (MainThread): Flushing usage events
2021-11-19 14:48:20.227153 (MainThread): Running with dbt=0.21.0
2021-11-19 14:48:20.309661 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/vscode/.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', select=None, selector_name=None, show=False, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='seed', write_json=True)
2021-11-19 14:48:20.314528 (MainThread): Tracking: tracking
2021-11-19 14:48:20.316840 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8019f580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81a4aa30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81a4acd0>]}
2021-11-19 14:48:20.326200 (MainThread): Partial parsing not enabled
2021-11-19 14:48:20.342525 (MainThread): Parsing macros/catalog.sql
2021-11-19 14:48:20.345264 (MainThread): Parsing macros/adapters.sql
2021-11-19 14:48:20.353944 (MainThread): Parsing macros/materializations/seed.sql
2021-11-19 14:48:20.358116 (MainThread): Parsing macros/materializations/snapshot.sql
2021-11-19 14:48:20.359519 (MainThread): Parsing macros/materializations/table.sql
2021-11-19 14:48:20.362745 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-19 14:48:20.375699 (MainThread): Parsing macros/materializations/view.sql
2021-11-19 14:48:20.379062 (MainThread): Parsing macros/core.sql
2021-11-19 14:48:20.381643 (MainThread): Parsing macros/materializations/test.sql
2021-11-19 14:48:20.385917 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-19 14:48:20.391693 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-19 14:48:20.394871 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-19 14:48:20.399090 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-19 14:48:20.400724 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-19 14:48:20.406737 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-19 14:48:20.417596 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-19 14:48:20.430109 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-19 14:48:20.435700 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-19 14:48:20.443701 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-19 14:48:20.461000 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-19 14:48:20.471085 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-19 14:48:20.472643 (MainThread): Parsing macros/etc/query.sql
2021-11-19 14:48:20.474748 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-19 14:48:20.477328 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-19 14:48:20.478922 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-19 14:48:20.480353 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-19 14:48:20.482389 (MainThread): Parsing macros/etc/datetime.sql
2021-11-19 14:48:20.487843 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-19 14:48:20.489316 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-19 14:48:20.491933 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-19 14:48:20.493387 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-19 14:48:20.495366 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-19 14:48:20.497946 (MainThread): Parsing macros/adapters/common.sql
2021-11-19 14:48:20.604511 (MainThread): Acquiring new athena connection "model.my_new_project.Test_model".
2021-11-19 14:48:20.633722 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-11-19 14:48:20.637467 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eae88dc9-65e2-4cdf-8375-108086260804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fb8f610>]}
2021-11-19 14:48:20.650282 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-11-19 14:48:20.652405 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eae88dc9-65e2-4cdf-8375-108086260804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fb712b0>]}
2021-11-19 14:48:20.654125 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 1 seed file, 0 sources, 0 exposures
2021-11-19 14:48:20.656182 (MainThread): 
2021-11-19 14:48:20.657353 (MainThread): Acquiring new athena connection "master".
2021-11-19 14:48:20.659688 (ThreadPoolExecutor-0_0): Acquiring new athena connection "list_awsdatacatalog".
2021-11-19 14:48:20.667932 (ThreadPoolExecutor-0_0): Using athena connection "list_awsdatacatalog".
2021-11-19 14:48:20.668751 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
  
2021-11-19 14:48:20.674105 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-19 14:48:20.707912 (ThreadPoolExecutor-0_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
2021-11-19 14:48:23.697254 (ThreadPoolExecutor-0_0): SQL status: OK -1 in 3.02 seconds
2021-11-19 14:48:23.705155 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: Close
2021-11-19 14:48:23.711509 (ThreadPoolExecutor-2_0): Acquiring new athena connection "list_awsdatacatalog_dbt".
2021-11-19 14:48:23.714849 (ThreadPoolExecutor-2_0): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 56988), raddr=('52.22.38.12', 443)>
2021-11-19 14:48:23.731181 (ThreadPoolExecutor-2_0): Using athena connection "list_awsdatacatalog_dbt".
2021-11-19 14:48:23.733223 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
2021-11-19 14:48:23.736844 (ThreadPoolExecutor-2_0): Opening a new connection, currently in state closed
2021-11-19 14:48:23.764688 (ThreadPoolExecutor-2_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
2021-11-19 14:48:26.613422 (ThreadPoolExecutor-2_0): SQL status: OK -1 in 2.88 seconds
2021-11-19 14:48:26.623409 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: Close
2021-11-19 14:48:26.631495 (MainThread): 14:48:26 | Concurrency: 1 threads (target='dev')
2021-11-19 14:48:26.634821 (MainThread): 14:48:26 | 
2021-11-19 14:48:26.645071 (Thread-1): Began running node seed.my_new_project.Region_Table
2021-11-19 14:48:26.647296 (Thread-1): 14:48:26 | 1 of 1 START seed file dbt.Region_Table.............................. [RUN]
2021-11-19 14:48:26.652148 (Thread-1): Acquiring new athena connection "seed.my_new_project.Region_Table".
2021-11-19 14:48:26.656306 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 56990), raddr=('52.22.38.12', 443)>
2021-11-19 14:48:26.660743 (Thread-1): finished collecting timing info
2021-11-19 14:48:26.695151 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-11-19 14:48:26.696427 (Thread-1): * Deprecation Warning: The quote_columns parameter was not set for seeds, so the
default value of False was chosen. The default will change to True in a future
release.

For more information, see:
https://docs.getdbt.com/v0.15/docs/seeds#section-specify-column-quoting
2021-11-19 14:48:26.699274 (Thread-1): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'eae88dc9-65e2-4cdf-8375-108086260804', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e682160>]}
2021-11-19 14:48:26.701158 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-11-19 14:48:26.702854 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-11-19 14:48:26.704448 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-11-19 14:48:26.705959 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-11-19 14:48:26.708211 (Thread-1): Opening a new connection, currently in state closed
2021-11-19 14:48:26.727478 (Thread-1): Using athena connection "seed.my_new_project.Region_Table".
2021-11-19 14:48:26.728883 (Thread-1): On seed.my_new_project.Region_Table: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "seed.my_new_project.Region_Table"} */

    create external table dbt.Region_Table (Zip integer, City string, County string, State string, Region string)
    stored as parquet
    location 's3://justin-dbt-testing/Targettables/8df91a4e-25cb-4183-bf41-ed4d295b99f5/'
    tblproperties ('classification'='parquet')
  
2021-11-19 14:48:26.730866 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "seed.my_new_project.Region_Table"} */

    create external table dbt.Region_Table (Zip integer, City string, County string, State string, Region string)
    stored as parquet
    location 's3://justin-dbt-testing/Targettables/8df91a4e-25cb-4183-bf41-ed4d295b99f5/'
    tblproperties ('classification'='parquet')
2021-11-19 14:48:28.459285 (Thread-1): SQL status: OK -1 in 1.73 seconds
2021-11-19 14:48:28.509644 (Thread-1): Using athena connection "seed.my_new_project.Region_Table".
2021-11-19 14:48:28.511511 (Thread-1): On seed.my_new_project.Region_Table: 
          insert into dbt.Region_Table (Zip, City, County, State, Region) values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s)
      ...
2021-11-19 14:48:28.515370 (Thread-1): insert into dbt.Region_Table (Zip, City, County, State, Region) values
          (4101,'Portland','Cumberland','ME','Northeast'),(4027,'Lebanon','York','ME','Northeast'),(4430,'Millinocket','Penobscot','ME','Northeast'),(33514,'Center Hill','Sumter','FL','Southeast'),(33935,'Muce','Glades','FL','Southeast'),(33040,'Key West','Monroe','FL','Southeast'),(54751,'Menomonie','Dunn','WI','Midwest'),(54011,'El Paso','Pierce','WI','Midwest'),(55043,'Lakeland','Washington','MN','Midwest'),(86321,'Bagdad','Yavapai','AZ','Southwest'),(85937,'Snowflake','Navajo','AZ','Southwest'),(85539,'Miami','Gila','AZ','Southwest'),(98851,'Soap Lake','Grant','WA','Northwest'),(99022,'Medical Lake','Spokane','WA','Northwest'),(99148,'Loon Lake','Stevens','WA','Northwest'),(99723,'Utqiagvik','North Slope','AK','Alaska'),(99762,'Nome','Unorganized','AK','Alaska'),(99686,'Valdez','Chugach','AK','Alaska'),(96777,'Phala','Hawaii','HI','Hawaii'),(96761,'Kapalua','Maui','HI','Hawaii'),(96769,'Puuwai','Kauai','HI','Hawaii')
2021-11-19 14:48:31.195242 (Thread-1): SQL status: OK -1 in 2.68 seconds
2021-11-19 14:48:31.211362 (Thread-1): Writing runtime SQL for node "seed.my_new_project.Region_Table"
2021-11-19 14:48:31.248528 (Thread-1): finished collecting timing info
2021-11-19 14:48:31.249735 (Thread-1): On seed.my_new_project.Region_Table: Close
2021-11-19 14:48:31.252609 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eae88dc9-65e2-4cdf-8375-108086260804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e6888e0>]}
2021-11-19 14:48:31.254922 (Thread-1): 14:48:31 | 1 of 1 OK loaded seed file dbt.Region_Table.......................... [INSERT 21 in 4.60s]
2021-11-19 14:48:31.257726 (Thread-1): Finished running node seed.my_new_project.Region_Table
2021-11-19 14:48:31.261680 (MainThread): Acquiring new athena connection "master".
2021-11-19 14:48:31.264015 (MainThread): 14:48:31 | 
2021-11-19 14:48:31.266311 (MainThread): 14:48:31 | Finished running 1 seed in 10.61s.
2021-11-19 14:48:31.268883 (MainThread): Connection 'master' was properly closed.
2021-11-19 14:48:31.271978 (MainThread): Connection 'seed.my_new_project.Region_Table' was properly closed.
2021-11-19 14:48:31.274275 (MainThread): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 56992), raddr=('52.22.38.12', 443)>
2021-11-19 14:48:31.289398 (MainThread): 
2021-11-19 14:48:31.290458 (MainThread): Completed successfully
2021-11-19 14:48:31.295716 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-11-19 14:48:31.298316 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e6888e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e67bd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fbac400>]}
2021-11-19 14:48:31.300294 (MainThread): Flushing usage events
2021-11-19 14:50:04.230871 (MainThread): Running with dbt=0.21.0
2021-11-19 14:50:04.302903 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/vscode/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-19 14:50:04.310793 (MainThread): Tracking: tracking
2021-11-19 14:50:04.315548 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb04b3520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1d30070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1d30d90>]}
2021-11-19 14:50:04.324842 (MainThread): Partial parsing not enabled
2021-11-19 14:50:04.338554 (MainThread): Parsing macros/catalog.sql
2021-11-19 14:50:04.341715 (MainThread): Parsing macros/adapters.sql
2021-11-19 14:50:04.351144 (MainThread): Parsing macros/materializations/seed.sql
2021-11-19 14:50:04.354943 (MainThread): Parsing macros/materializations/snapshot.sql
2021-11-19 14:50:04.356429 (MainThread): Parsing macros/materializations/table.sql
2021-11-19 14:50:04.360373 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-19 14:50:04.373098 (MainThread): Parsing macros/materializations/view.sql
2021-11-19 14:50:04.376747 (MainThread): Parsing macros/core.sql
2021-11-19 14:50:04.379298 (MainThread): Parsing macros/materializations/test.sql
2021-11-19 14:50:04.383462 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-19 14:50:04.389920 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-19 14:50:04.393347 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-19 14:50:04.398686 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-19 14:50:04.400323 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-19 14:50:04.407411 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-19 14:50:04.419735 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-19 14:50:04.432956 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-19 14:50:04.437810 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-19 14:50:04.445851 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-19 14:50:04.462424 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-19 14:50:04.472265 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-19 14:50:04.473807 (MainThread): Parsing macros/etc/query.sql
2021-11-19 14:50:04.475232 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-19 14:50:04.478368 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-19 14:50:04.479925 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-19 14:50:04.481764 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-19 14:50:04.484370 (MainThread): Parsing macros/etc/datetime.sql
2021-11-19 14:50:04.490399 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-19 14:50:04.491873 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-19 14:50:04.494145 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-19 14:50:04.495335 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-19 14:50:04.497444 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-19 14:50:04.499583 (MainThread): Parsing macros/adapters/common.sql
2021-11-19 14:50:04.611638 (MainThread): Acquiring new athena connection "model.my_new_project.Test_model".
2021-11-19 14:50:04.640652 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-11-19 14:50:04.644229 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '63d6a6d4-d9db-405e-bf56-e66063659d7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafe6d6a0>]}
2021-11-19 14:50:04.659676 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-11-19 14:50:04.661225 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '63d6a6d4-d9db-405e-bf56-e66063659d7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafe4c430>]}
2021-11-19 14:50:04.662712 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 1 seed file, 0 sources, 0 exposures
2021-11-19 14:50:04.664779 (MainThread): 
2021-11-19 14:50:04.665851 (MainThread): Acquiring new athena connection "master".
2021-11-19 14:50:04.672145 (ThreadPoolExecutor-0_0): Acquiring new athena connection "list_awsdatacatalog".
2021-11-19 14:50:04.680630 (ThreadPoolExecutor-0_0): Using athena connection "list_awsdatacatalog".
2021-11-19 14:50:04.681488 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
  
2021-11-19 14:50:04.683143 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-19 14:50:04.715915 (ThreadPoolExecutor-0_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
2021-11-19 14:50:06.729434 (ThreadPoolExecutor-0_0): SQL status: OK -1 in 2.05 seconds
2021-11-19 14:50:06.738154 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: Close
2021-11-19 14:50:06.748422 (ThreadPoolExecutor-2_0): Acquiring new athena connection "list_awsdatacatalog_dbt".
2021-11-19 14:50:06.751540 (ThreadPoolExecutor-2_0): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 33092), raddr=('3.226.93.250', 443)>
2021-11-19 14:50:06.764473 (ThreadPoolExecutor-2_0): Using athena connection "list_awsdatacatalog_dbt".
2021-11-19 14:50:06.766272 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
2021-11-19 14:50:06.769383 (ThreadPoolExecutor-2_0): Opening a new connection, currently in state closed
2021-11-19 14:50:06.796057 (ThreadPoolExecutor-2_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
2021-11-19 14:50:09.671163 (ThreadPoolExecutor-2_0): SQL status: OK -1 in 2.90 seconds
2021-11-19 14:50:09.679596 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: Close
2021-11-19 14:50:09.687631 (MainThread): 14:50:09 | Concurrency: 1 threads (target='dev')
2021-11-19 14:50:09.691422 (MainThread): 14:50:09 | 
2021-11-19 14:50:09.703217 (Thread-1): Began running node model.my_new_project.Test_model
2021-11-19 14:50:09.706264 (Thread-1): 14:50:09 | 1 of 1 START view model dbt.Test_model............................... [RUN]
2021-11-19 14:50:09.710929 (Thread-1): Acquiring new athena connection "model.my_new_project.Test_model".
2021-11-19 14:50:09.716839 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 33094), raddr=('3.226.93.250', 443)>
2021-11-19 14:50:09.721456 (Thread-1): Compiling model.my_new_project.Test_model
2021-11-19 14:50:09.728644 (Thread-1): Writing injected SQL for node "model.my_new_project.Test_model"
2021-11-19 14:50:09.739811 (Thread-1): finished collecting timing info
2021-11-19 14:50:09.749836 (Thread-1): finished collecting timing info
2021-11-19 14:50:09.751542 (Thread-1): Compilation Error in model Test_model (models/Test_model.sql)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete dbt.test_model, or rename it to be less ambiguous.
  Searched for: dbt.Test_model
  Found: dbt.test_model
  
  > in macro create_or_replace_view (macros/materializations/view.sql)
  > called by macro materialization_view_athena (macros/materializations/view.sql)
  > called by model Test_model (models/Test_model.sql)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 734, in get_relation
    matches = self._make_match(relations_list, database, schema,
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 723, in _make_match
    if relation.matches(**search):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/relation.py", line 99, in matches
    dbt.exceptions.approximate_relation_match(target, self)
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 741, in approximate_relation_match
    raise_compiler_error(
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 444, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model Test_model (models/Test_model.sql)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete dbt.test_model, or rename it to be less ambiguous.
  Searched for: dbt.Test_model
  Found: dbt.test_model
  
  > in macro create_or_replace_view (macros/materializations/view.sql)
  > called by macro materialization_view_athena (macros/materializations/view.sql)
  > called by model Test_model (models/Test_model.sql)
2021-11-19 14:50:09.756935 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63d6a6d4-d9db-405e-bf56-e66063659d7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf3e8a60>]}
2021-11-19 14:50:09.758438 (Thread-1): 14:50:09 | 1 of 1 ERROR creating view model dbt.Test_model...................... [ERROR in 0.05s]
2021-11-19 14:50:09.759878 (Thread-1): Finished running node model.my_new_project.Test_model
2021-11-19 14:50:09.762485 (MainThread): Acquiring new athena connection "master".
2021-11-19 14:50:09.763866 (MainThread): 14:50:09 | 
2021-11-19 14:50:09.766110 (MainThread): 14:50:09 | Finished running 1 view model in 5.10s.
2021-11-19 14:50:09.768478 (MainThread): Connection 'master' was properly closed.
2021-11-19 14:50:09.770184 (MainThread): Connection 'model.my_new_project.Test_model' was properly closed.
2021-11-19 14:50:09.783635 (MainThread): 
2021-11-19 14:50:09.785079 (MainThread): Completed with 1 error and 0 warnings:
2021-11-19 14:50:09.786180 (MainThread): 
2021-11-19 14:50:09.788128 (MainThread): Compilation Error in model Test_model (models/Test_model.sql)
2021-11-19 14:50:09.790712 (MainThread):   When searching for a relation, dbt found an approximate match. Instead of guessing 
2021-11-19 14:50:09.793334 (MainThread):   which relation to use, dbt will move on. Please delete dbt.test_model, or rename it to be less ambiguous.
2021-11-19 14:50:09.795263 (MainThread):   Searched for: dbt.Test_model
2021-11-19 14:50:09.797410 (MainThread):   Found: dbt.test_model
2021-11-19 14:50:09.799565 (MainThread):   
2021-11-19 14:50:09.802019 (MainThread):   > in macro create_or_replace_view (macros/materializations/view.sql)
2021-11-19 14:50:09.805503 (MainThread):   > called by macro materialization_view_athena (macros/materializations/view.sql)
2021-11-19 14:50:09.807739 (MainThread):   > called by model Test_model (models/Test_model.sql)
2021-11-19 14:50:09.810970 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-11-19 14:50:09.813607 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafe39c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafe4c2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf3e8a60>]}
2021-11-19 14:50:09.815461 (MainThread): Flushing usage events
2021-11-19 14:51:47.529312 (MainThread): Running with dbt=0.21.0
2021-11-19 14:51:47.604891 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/vscode/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-19 14:51:47.610399 (MainThread): Tracking: tracking
2021-11-19 14:51:47.612259 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9111e370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff929ba3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff929bae20>]}
2021-11-19 14:51:47.622342 (MainThread): Partial parsing not enabled
2021-11-19 14:51:47.634746 (MainThread): Parsing macros/catalog.sql
2021-11-19 14:51:47.638779 (MainThread): Parsing macros/adapters.sql
2021-11-19 14:51:47.648432 (MainThread): Parsing macros/materializations/seed.sql
2021-11-19 14:51:47.651344 (MainThread): Parsing macros/materializations/snapshot.sql
2021-11-19 14:51:47.652485 (MainThread): Parsing macros/materializations/table.sql
2021-11-19 14:51:47.655585 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-19 14:51:47.668378 (MainThread): Parsing macros/materializations/view.sql
2021-11-19 14:51:47.672352 (MainThread): Parsing macros/core.sql
2021-11-19 14:51:47.674974 (MainThread): Parsing macros/materializations/test.sql
2021-11-19 14:51:47.679273 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-19 14:51:47.685191 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-19 14:51:47.688365 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-19 14:51:47.693693 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-19 14:51:47.695374 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-19 14:51:47.701212 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-19 14:51:47.713210 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-19 14:51:47.725741 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-19 14:51:47.730341 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-19 14:51:47.738377 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-19 14:51:47.754989 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-19 14:51:47.764327 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-19 14:51:47.765808 (MainThread): Parsing macros/etc/query.sql
2021-11-19 14:51:47.767907 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-19 14:51:47.770825 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-19 14:51:47.772582 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-19 14:51:47.774188 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-19 14:51:47.775655 (MainThread): Parsing macros/etc/datetime.sql
2021-11-19 14:51:47.781489 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-19 14:51:47.783631 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-19 14:51:47.785454 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-19 14:51:47.786665 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-19 14:51:47.789042 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-19 14:51:47.790698 (MainThread): Parsing macros/adapters/common.sql
2021-11-19 14:51:47.901695 (MainThread): Acquiring new athena connection "model.my_new_project.Test_model".
2021-11-19 14:51:47.930237 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-11-19 14:51:47.934290 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7e1e0eff-867c-4c8d-bdb5-12e909155d89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90b01730>]}
2021-11-19 14:51:47.947181 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-11-19 14:51:47.948493 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7e1e0eff-867c-4c8d-bdb5-12e909155d89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90ae24c0>]}
2021-11-19 14:51:47.950297 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 1 seed file, 0 sources, 0 exposures
2021-11-19 14:51:47.952288 (MainThread): 
2021-11-19 14:51:47.954528 (MainThread): Acquiring new athena connection "master".
2021-11-19 14:51:47.956944 (ThreadPoolExecutor-0_0): Acquiring new athena connection "list_awsdatacatalog".
2021-11-19 14:51:47.964350 (ThreadPoolExecutor-0_0): Using athena connection "list_awsdatacatalog".
2021-11-19 14:51:47.965113 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
  
2021-11-19 14:51:47.966893 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-19 14:51:47.992797 (ThreadPoolExecutor-0_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
2021-11-19 14:51:49.765125 (ThreadPoolExecutor-0_0): SQL status: OK -1 in 1.80 seconds
2021-11-19 14:51:49.779034 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: Close
2021-11-19 14:51:49.787845 (ThreadPoolExecutor-2_0): Acquiring new athena connection "list_awsdatacatalog_dbt".
2021-11-19 14:51:49.790760 (ThreadPoolExecutor-2_0): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 44236), raddr=('54.156.232.244', 443)>
2021-11-19 14:51:49.805855 (ThreadPoolExecutor-2_0): Using athena connection "list_awsdatacatalog_dbt".
2021-11-19 14:51:49.807694 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
2021-11-19 14:51:49.812344 (ThreadPoolExecutor-2_0): Opening a new connection, currently in state closed
2021-11-19 14:51:49.841674 (ThreadPoolExecutor-2_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
2021-11-19 14:51:52.716614 (ThreadPoolExecutor-2_0): SQL status: OK -1 in 2.90 seconds
2021-11-19 14:51:52.728898 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: Close
2021-11-19 14:51:52.734375 (MainThread): 14:51:52 | Concurrency: 1 threads (target='dev')
2021-11-19 14:51:52.736607 (MainThread): 14:51:52 | 
2021-11-19 14:51:52.750547 (Thread-1): Began running node model.my_new_project.Test_model
2021-11-19 14:51:52.752447 (Thread-1): 14:51:52 | 1 of 1 START view model dbt.Test_model............................... [RUN]
2021-11-19 14:51:52.757571 (Thread-1): Acquiring new athena connection "model.my_new_project.Test_model".
2021-11-19 14:51:52.761151 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 44238), raddr=('54.156.232.244', 443)>
2021-11-19 14:51:52.764252 (Thread-1): Compiling model.my_new_project.Test_model
2021-11-19 14:51:52.772624 (Thread-1): Writing injected SQL for node "model.my_new_project.Test_model"
2021-11-19 14:51:52.780206 (Thread-1): finished collecting timing info
2021-11-19 14:51:52.791227 (Thread-1): finished collecting timing info
2021-11-19 14:51:52.792650 (Thread-1): Compilation Error in model Test_model (models/Test_model.sql)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete dbt.test_model, or rename it to be less ambiguous.
  Searched for: dbt.Test_model
  Found: dbt.test_model
  
  > in macro create_or_replace_view (macros/materializations/view.sql)
  > called by macro materialization_view_athena (macros/materializations/view.sql)
  > called by model Test_model (models/Test_model.sql)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 734, in get_relation
    matches = self._make_match(relations_list, database, schema,
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 723, in _make_match
    if relation.matches(**search):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/relation.py", line 99, in matches
    dbt.exceptions.approximate_relation_match(target, self)
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 741, in approximate_relation_match
    raise_compiler_error(
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 444, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model Test_model (models/Test_model.sql)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete dbt.test_model, or rename it to be less ambiguous.
  Searched for: dbt.Test_model
  Found: dbt.test_model
  
  > in macro create_or_replace_view (macros/materializations/view.sql)
  > called by macro materialization_view_athena (macros/materializations/view.sql)
  > called by model Test_model (models/Test_model.sql)
2021-11-19 14:51:52.796439 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e1e0eff-867c-4c8d-bdb5-12e909155d89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b5de3d0>]}
2021-11-19 14:51:52.799819 (Thread-1): 14:51:52 | 1 of 1 ERROR creating view model dbt.Test_model...................... [ERROR in 0.04s]
2021-11-19 14:51:52.805028 (Thread-1): Finished running node model.my_new_project.Test_model
2021-11-19 14:51:52.808444 (MainThread): Acquiring new athena connection "master".
2021-11-19 14:51:52.809869 (MainThread): 14:51:52 | 
2021-11-19 14:51:52.811608 (MainThread): 14:51:52 | Finished running 1 view model in 4.86s.
2021-11-19 14:51:52.813295 (MainThread): Connection 'master' was properly closed.
2021-11-19 14:51:52.815402 (MainThread): Connection 'model.my_new_project.Test_model' was properly closed.
2021-11-19 14:51:52.830500 (MainThread): 
2021-11-19 14:51:52.831463 (MainThread): Completed with 1 error and 0 warnings:
2021-11-19 14:51:52.833054 (MainThread): 
2021-11-19 14:51:52.836007 (MainThread): Compilation Error in model Test_model (models/Test_model.sql)
2021-11-19 14:51:52.838679 (MainThread):   When searching for a relation, dbt found an approximate match. Instead of guessing 
2021-11-19 14:51:52.840578 (MainThread):   which relation to use, dbt will move on. Please delete dbt.test_model, or rename it to be less ambiguous.
2021-11-19 14:51:52.843683 (MainThread):   Searched for: dbt.Test_model
2021-11-19 14:51:52.845397 (MainThread):   Found: dbt.test_model
2021-11-19 14:51:52.846941 (MainThread):   
2021-11-19 14:51:52.848891 (MainThread):   > in macro create_or_replace_view (macros/materializations/view.sql)
2021-11-19 14:51:52.853305 (MainThread):   > called by macro materialization_view_athena (macros/materializations/view.sql)
2021-11-19 14:51:52.855400 (MainThread):   > called by model Test_model (models/Test_model.sql)
2021-11-19 14:51:52.856920 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-11-19 14:51:52.859293 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90acee50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90aced00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b5e9d30>]}
2021-11-19 14:51:52.861030 (MainThread): Flushing usage events
2021-11-19 14:57:38.353112 (MainThread): Running with dbt=0.21.0
2021-11-19 14:57:38.425101 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/vscode/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-19 14:57:38.430814 (MainThread): Tracking: tracking
2021-11-19 14:57:38.434945 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e3358b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fbeac40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fbead60>]}
2021-11-19 14:57:38.446150 (MainThread): Partial parsing not enabled
2021-11-19 14:57:38.457251 (MainThread): Parsing macros/catalog.sql
2021-11-19 14:57:38.460069 (MainThread): Parsing macros/adapters.sql
2021-11-19 14:57:38.469089 (MainThread): Parsing macros/materializations/seed.sql
2021-11-19 14:57:38.472202 (MainThread): Parsing macros/materializations/snapshot.sql
2021-11-19 14:57:38.473280 (MainThread): Parsing macros/materializations/table.sql
2021-11-19 14:57:38.476792 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-19 14:57:38.489109 (MainThread): Parsing macros/materializations/view.sql
2021-11-19 14:57:38.492813 (MainThread): Parsing macros/core.sql
2021-11-19 14:57:38.495436 (MainThread): Parsing macros/materializations/test.sql
2021-11-19 14:57:38.499588 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-19 14:57:38.505341 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-19 14:57:38.508530 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-19 14:57:38.513815 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-19 14:57:38.515564 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-19 14:57:38.521886 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-19 14:57:38.532473 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-19 14:57:38.546103 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-19 14:57:38.550584 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-19 14:57:38.558938 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-19 14:57:38.574937 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-19 14:57:38.584221 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-19 14:57:38.585603 (MainThread): Parsing macros/etc/query.sql
2021-11-19 14:57:38.587776 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-19 14:57:38.592287 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-19 14:57:38.593920 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-19 14:57:38.595353 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-19 14:57:38.597523 (MainThread): Parsing macros/etc/datetime.sql
2021-11-19 14:57:38.602696 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-19 14:57:38.604111 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-19 14:57:38.606744 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-19 14:57:38.607946 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-19 14:57:38.611117 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-19 14:57:38.613436 (MainThread): Parsing macros/adapters/common.sql
2021-11-19 14:57:38.728701 (MainThread): Acquiring new athena connection "model.my_new_project.test_model1".
2021-11-19 14:57:38.757265 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-11-19 14:57:38.760924 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '708daeea-ce50-4263-9a08-46a9dba488ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dd34670>]}
2021-11-19 14:57:38.772162 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-11-19 14:57:38.774600 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '708daeea-ce50-4263-9a08-46a9dba488ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dd13400>]}
2021-11-19 14:57:38.775800 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 1 seed file, 0 sources, 0 exposures
2021-11-19 14:57:38.778639 (MainThread): 
2021-11-19 14:57:38.779725 (MainThread): Acquiring new athena connection "master".
2021-11-19 14:57:38.782155 (ThreadPoolExecutor-0_0): Acquiring new athena connection "list_awsdatacatalog".
2021-11-19 14:57:38.788922 (ThreadPoolExecutor-0_0): Using athena connection "list_awsdatacatalog".
2021-11-19 14:57:38.789812 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
  
2021-11-19 14:57:38.791459 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-19 14:57:38.822524 (ThreadPoolExecutor-0_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
2021-11-19 14:57:40.773290 (ThreadPoolExecutor-0_0): SQL status: OK -1 in 1.98 seconds
2021-11-19 14:57:40.784648 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: Close
2021-11-19 14:57:40.790162 (ThreadPoolExecutor-2_0): Acquiring new athena connection "list_awsdatacatalog_dbt".
2021-11-19 14:57:40.796981 (ThreadPoolExecutor-2_0): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 34900), raddr=('54.204.36.110', 443)>
2021-11-19 14:57:40.812109 (ThreadPoolExecutor-2_0): Using athena connection "list_awsdatacatalog_dbt".
2021-11-19 14:57:40.813500 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
2021-11-19 14:57:40.817030 (ThreadPoolExecutor-2_0): Opening a new connection, currently in state closed
2021-11-19 14:57:40.849639 (ThreadPoolExecutor-2_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
2021-11-19 14:57:43.711017 (ThreadPoolExecutor-2_0): SQL status: OK -1 in 2.89 seconds
2021-11-19 14:57:43.718339 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: Close
2021-11-19 14:57:43.726792 (MainThread): 14:57:43 | Concurrency: 1 threads (target='dev')
2021-11-19 14:57:43.730971 (MainThread): 14:57:43 | 
2021-11-19 14:57:43.739343 (Thread-1): Began running node model.my_new_project.test_model1
2021-11-19 14:57:43.741321 (Thread-1): 14:57:43 | 1 of 1 START view model dbt.test_model1.............................. [RUN]
2021-11-19 14:57:43.745173 (Thread-1): Acquiring new athena connection "model.my_new_project.test_model1".
2021-11-19 14:57:43.749396 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 34902), raddr=('54.204.36.110', 443)>
2021-11-19 14:57:43.756205 (Thread-1): Compiling model.my_new_project.test_model1
2021-11-19 14:57:43.761973 (Thread-1): Writing injected SQL for node "model.my_new_project.test_model1"
2021-11-19 14:57:43.769125 (Thread-1): finished collecting timing info
2021-11-19 14:57:43.784493 (Thread-1): Writing runtime SQL for node "model.my_new_project.test_model1"
2021-11-19 14:57:43.789499 (Thread-1): Using athena connection "model.my_new_project.test_model1".
2021-11-19 14:57:43.790368 (Thread-1): On model.my_new_project.test_model1: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    SELECT bldg_id, sum("out.electricity.interior_lighting.energy_consumption") as total_interior_lighting_consumption FROM "defaultdb"."upgrade_0" where county='G5500690' group by bldg_id;

2021-11-19 14:57:43.792449 (Thread-1): Opening a new connection, currently in state closed
2021-11-19 14:57:43.809487 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    SELECT bldg_id, sum("out.electricity.interior_lighting.energy_consumption") as total_interior_lighting_consumption FROM "defaultdb"."upgrade_0" where county='G5500690' group by bldg_id;
2021-11-19 14:57:45.530008 (Thread-1): SQL status: OK -1 in 1.74 seconds
2021-11-19 14:57:45.546653 (Thread-1): Using athena connection "model.my_new_project.test_model1".
2021-11-19 14:57:45.550149 (Thread-1): On model.my_new_project.test_model1: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
alter table dbt.test_model1 set tblproperties ('classification' = 'view')
2021-11-19 14:57:45.557335 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
alter table dbt.test_model1 set tblproperties ('classification' = 'view')
2021-11-19 14:57:47.106034 (Thread-1): SQL status: OK -1 in 1.55 seconds
2021-11-19 14:57:47.131599 (Thread-1): finished collecting timing info
2021-11-19 14:57:47.134927 (Thread-1): On model.my_new_project.test_model1: Close
2021-11-19 14:57:47.140537 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '708daeea-ce50-4263-9a08-46a9dba488ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c81c310>]}
2021-11-19 14:57:47.145091 (Thread-1): 14:57:47 | 1 of 1 OK created view model dbt.test_model1......................... [OK -1 in 3.40s]
2021-11-19 14:57:47.148903 (Thread-1): Finished running node model.my_new_project.test_model1
2021-11-19 14:57:47.155840 (MainThread): Acquiring new athena connection "master".
2021-11-19 14:57:47.157832 (MainThread): 14:57:47 | 
2021-11-19 14:57:47.161334 (MainThread): 14:57:47 | Finished running 1 view model in 8.38s.
2021-11-19 14:57:47.165518 (MainThread): Connection 'master' was properly closed.
2021-11-19 14:57:47.168210 (MainThread): Connection 'model.my_new_project.test_model1' was properly closed.
2021-11-19 14:57:47.172262 (MainThread): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 34904), raddr=('54.204.36.110', 443)>
2021-11-19 14:57:47.191623 (MainThread): 
2021-11-19 14:57:47.193242 (MainThread): Completed successfully
2021-11-19 14:57:47.195386 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-11-19 14:57:47.197544 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c830c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c850700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c8505b0>]}
2021-11-19 14:57:47.199760 (MainThread): Flushing usage events
2021-11-26 21:53:21.479841 (MainThread): Running with dbt=0.21.0
2021-11-26 21:53:21.582182 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/vscode/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-26 21:53:21.587508 (MainThread): Tracking: tracking
2021-11-26 21:53:21.592584 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bbf76a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d493b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d493df0>]}
2021-11-26 21:53:21.601902 (MainThread): Partial parsing not enabled
2021-11-26 21:53:21.619990 (MainThread): Parsing macros/catalog.sql
2021-11-26 21:53:21.623046 (MainThread): Parsing macros/adapters.sql
2021-11-26 21:53:21.632912 (MainThread): Parsing macros/materializations/seed.sql
2021-11-26 21:53:21.637066 (MainThread): Parsing macros/materializations/snapshot.sql
2021-11-26 21:53:21.638339 (MainThread): Parsing macros/materializations/table.sql
2021-11-26 21:53:21.642344 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-26 21:53:21.655730 (MainThread): Parsing macros/materializations/view.sql
2021-11-26 21:53:21.660098 (MainThread): Parsing macros/core.sql
2021-11-26 21:53:21.663537 (MainThread): Parsing macros/materializations/test.sql
2021-11-26 21:53:21.668632 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-26 21:53:21.675452 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-26 21:53:21.679381 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-26 21:53:21.683966 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-26 21:53:21.685332 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-26 21:53:21.691948 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-26 21:53:21.704612 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-26 21:53:21.718649 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-26 21:53:21.723812 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-26 21:53:21.731675 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-26 21:53:21.750619 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-26 21:53:21.760375 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-26 21:53:21.762100 (MainThread): Parsing macros/etc/query.sql
2021-11-26 21:53:21.763203 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-26 21:53:21.765986 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-26 21:53:21.767898 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-26 21:53:21.769160 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-26 21:53:21.770650 (MainThread): Parsing macros/etc/datetime.sql
2021-11-26 21:53:21.776581 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-26 21:53:21.778242 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-26 21:53:21.781102 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-26 21:53:21.782166 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-26 21:53:21.784145 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-26 21:53:21.785445 (MainThread): Parsing macros/adapters/common.sql
2021-11-26 21:53:21.901985 (MainThread): Acquiring new athena connection "model.my_new_project.test_model1".
2021-11-26 21:53:21.912873 (MainThread): 1699: statically parsed test_model2.sql
2021-11-26 21:53:21.913770 (MainThread): Acquiring new athena connection "model.my_new_project.test_model2".
2021-11-26 21:53:21.916592 (MainThread): Sending event: {'category': 'dbt', 'action': 'experimental_parser', 'label': '5ba6af21-653e-44db-80f0-5ea06ba0c807', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b6507f0>]}
2021-11-26 21:53:21.918078 (MainThread): Acquiring new athena connection "model.my_new_project.test_model3".
2021-11-26 21:53:21.921247 (MainThread): Acquiring new athena connection "model.my_new_project.test_model4".
2021-11-26 21:53:21.923949 (MainThread): Acquiring new athena connection "model.my_new_project.test_model5".
2021-11-26 21:53:21.949732 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-11-26 21:53:21.955852 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5ba6af21-653e-44db-80f0-5ea06ba0c807', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b65cdf0>]}
2021-11-26 21:53:21.966966 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-11-26 21:53:21.968615 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5ba6af21-653e-44db-80f0-5ea06ba0c807', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b65c9a0>]}
2021-11-26 21:53:21.969737 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 1 seed file, 0 sources, 0 exposures
2021-11-26 21:53:21.972250 (MainThread): 
2021-11-26 21:53:21.973374 (MainThread): Acquiring new athena connection "master".
2021-11-26 21:53:21.975711 (ThreadPoolExecutor-0_0): Acquiring new athena connection "list_awsdatacatalog".
2021-11-26 21:53:21.983702 (ThreadPoolExecutor-0_0): Using athena connection "list_awsdatacatalog".
2021-11-26 21:53:21.984860 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
  
2021-11-26 21:53:21.987045 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-26 21:53:22.012171 (ThreadPoolExecutor-0_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
2021-11-26 21:53:23.913229 (ThreadPoolExecutor-0_0): SQL status: OK -1 in 1.93 seconds
2021-11-26 21:53:23.919255 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: Close
2021-11-26 21:53:23.931867 (ThreadPoolExecutor-2_0): Acquiring new athena connection "list_awsdatacatalog_dbt".
2021-11-26 21:53:23.935286 (ThreadPoolExecutor-2_0): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 49738), raddr=('50.16.19.176', 443)>
2021-11-26 21:53:23.944199 (ThreadPoolExecutor-2_0): Using athena connection "list_awsdatacatalog_dbt".
2021-11-26 21:53:23.945511 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
2021-11-26 21:53:23.947981 (ThreadPoolExecutor-2_0): Opening a new connection, currently in state closed
2021-11-26 21:53:23.967491 (ThreadPoolExecutor-2_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
2021-11-26 21:53:26.825362 (ThreadPoolExecutor-2_0): SQL status: OK -1 in 2.88 seconds
2021-11-26 21:53:26.833950 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: Close
2021-11-26 21:53:26.839839 (MainThread): 21:53:26 | Concurrency: 1 threads (target='dev')
2021-11-26 21:53:26.846036 (MainThread): 21:53:26 | 
2021-11-26 21:53:26.854957 (Thread-1): Began running node model.my_new_project.test_model1
2021-11-26 21:53:26.856779 (Thread-1): 21:53:26 | 1 of 5 START view model dbt.test_model1.............................. [RUN]
2021-11-26 21:53:26.865158 (Thread-1): Acquiring new athena connection "model.my_new_project.test_model1".
2021-11-26 21:53:26.872276 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 49740), raddr=('50.16.19.176', 443)>
2021-11-26 21:53:26.875943 (Thread-1): Compiling model.my_new_project.test_model1
2021-11-26 21:53:26.881520 (Thread-1): Writing injected SQL for node "model.my_new_project.test_model1"
2021-11-26 21:53:26.892242 (Thread-1): finished collecting timing info
2021-11-26 21:53:26.906219 (Thread-1): Writing runtime SQL for node "model.my_new_project.test_model1"
2021-11-26 21:53:26.912057 (Thread-1): Using athena connection "model.my_new_project.test_model1".
2021-11-26 21:53:26.913887 (Thread-1): On model.my_new_project.test_model1: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    SELECT 
bldg_id, sum("out.electricity.interior_lighting.energy_consumption") as total_interior_lighting_consumption 
FROM "defaultdb"."buildings" 
where /*county='G5500690' */

Left Join bldg_id on "defaultdb"."resby_puma_northeast".bldg_id = bldg_id

group by bldg_id;

2021-11-26 21:53:26.916785 (Thread-1): Opening a new connection, currently in state closed
2021-11-26 21:53:26.933419 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    SELECT 
bldg_id, sum("out.electricity.interior_lighting.energy_consumption") as total_interior_lighting_consumption 
FROM "defaultdb"."buildings" 
where /*county='G5500690' */

Left Join bldg_id on "defaultdb"."resby_puma_northeast".bldg_id = bldg_id

group by bldg_id;
2021-11-26 21:53:27.218612 (Thread-1): Failed to execute query.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 307, in _execute
    query_id = retry_api_call(
  File "/usr/local/lib/python3.8/site-packages/pyathena/util.py", line 84, in retry_api_call
    return retry(func, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 404, in __call__
    do = self.iter(retry_state=retry_state)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 349, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 407, in __call__
    result = fn(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 276, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 586, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 10:1: mismatched input 'Left'. Expecting: <expression>
2021-11-26 21:53:27.222332 (Thread-1): Error running SQL: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    SELECT 
bldg_id, sum("out.electricity.interior_lighting.energy_consumption") as total_interior_lighting_consumption 
FROM "defaultdb"."buildings" 
where /*county='G5500690' */

Left Join bldg_id on "defaultdb"."resby_puma_northeast".bldg_id = bldg_id

group by bldg_id;

2021-11-26 21:53:27.225804 (Thread-1): finished collecting timing info
2021-11-26 21:53:27.228042 (Thread-1): On model.my_new_project.test_model1: Close
2021-11-26 21:53:27.230804 (Thread-1): Runtime Error in model test_model1 (models/test_model1.sql)
  An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 10:1: mismatched input 'Left'. Expecting: <expression>
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 307, in _execute
    query_id = retry_api_call(
  File "/usr/local/lib/python3.8/site-packages/pyathena/util.py", line 84, in retry_api_call
    return retry(func, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 404, in __call__
    do = self.iter(retry_state=retry_state)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 349, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 407, in __call__
    result = fn(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 276, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 586, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 10:1: mismatched input 'Left'. Expecting: <expression>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 100, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 72, in execute
    query_id = self._execute(
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 315, in _execute
    raise DatabaseError(*e.args) from e
pyathena.error.DatabaseError: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 10:1: mismatched input 'Left'. Expecting: <expression>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 66, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 103, in exception_handler
    raise RuntimeException(str(e)) from e
dbt.exceptions.RuntimeException: Runtime Error in model test_model1 (models/test_model1.sql)
  An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 10:1: mismatched input 'Left'. Expecting: <expression>
2021-11-26 21:53:27.235206 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ba6af21-653e-44db-80f0-5ea06ba0c807', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89aaf2b0>]}
2021-11-26 21:53:27.237358 (Thread-1): 21:53:27 | 1 of 5 ERROR creating view model dbt.test_model1..................... [ERROR in 0.37s]
2021-11-26 21:53:27.238997 (Thread-1): Finished running node model.my_new_project.test_model1
2021-11-26 21:53:27.241770 (Thread-1): Began running node model.my_new_project.test_model2
2021-11-26 21:53:27.244014 (Thread-1): 21:53:27 | 2 of 5 START view model dbt.test_model2.............................. [RUN]
2021-11-26 21:53:27.247121 (Thread-1): Acquiring new athena connection "model.my_new_project.test_model2".
2021-11-26 21:53:27.248304 (Thread-1): Compiling model.my_new_project.test_model2
2021-11-26 21:53:27.250652 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 49742), raddr=('50.16.19.176', 443)>
2021-11-26 21:53:27.252908 (Thread-1): Writing injected SQL for node "model.my_new_project.test_model2"
2021-11-26 21:53:27.257310 (Thread-1): finished collecting timing info
2021-11-26 21:53:27.260299 (Thread-1): Writing runtime SQL for node "model.my_new_project.test_model2"
2021-11-26 21:53:27.264450 (Thread-1): Using athena connection "model.my_new_project.test_model2".
2021-11-26 21:53:27.265403 (Thread-1): On model.my_new_project.test_model2: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    /*
from somewhere - get bldg_id and zip code --> bldg_locations
*/

2021-11-26 21:53:27.268304 (Thread-1): Opening a new connection, currently in state closed
2021-11-26 21:53:27.285853 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    /*
from somewhere - get bldg_id and zip code --> bldg_locations
*/
2021-11-26 21:53:27.514906 (Thread-1): Failed to execute query.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 307, in _execute
    query_id = retry_api_call(
  File "/usr/local/lib/python3.8/site-packages/pyathena/util.py", line 84, in retry_api_call
    return retry(func, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 404, in __call__
    do = self.iter(retry_state=retry_state)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 349, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 407, in __call__
    result = fn(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 276, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 586, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
2021-11-26 21:53:27.516226 (Thread-1): Error running SQL: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    /*
from somewhere - get bldg_id and zip code --> bldg_locations
*/

2021-11-26 21:53:27.518093 (Thread-1): finished collecting timing info
2021-11-26 21:53:27.519895 (Thread-1): On model.my_new_project.test_model2: Close
2021-11-26 21:53:27.521887 (Thread-1): Runtime Error in model test_model2 (models/test_model2.sql)
  An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 307, in _execute
    query_id = retry_api_call(
  File "/usr/local/lib/python3.8/site-packages/pyathena/util.py", line 84, in retry_api_call
    return retry(func, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 404, in __call__
    do = self.iter(retry_state=retry_state)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 349, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 407, in __call__
    result = fn(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 276, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 586, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 100, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 72, in execute
    query_id = self._execute(
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 315, in _execute
    raise DatabaseError(*e.args) from e
pyathena.error.DatabaseError: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 66, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 103, in exception_handler
    raise RuntimeException(str(e)) from e
dbt.exceptions.RuntimeException: Runtime Error in model test_model2 (models/test_model2.sql)
  An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
2021-11-26 21:53:27.525043 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ba6af21-653e-44db-80f0-5ea06ba0c807', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89c7da90>]}
2021-11-26 21:53:27.526854 (Thread-1): 21:53:27 | 2 of 5 ERROR creating view model dbt.test_model2..................... [ERROR in 0.28s]
2021-11-26 21:53:27.528342 (Thread-1): Finished running node model.my_new_project.test_model2
2021-11-26 21:53:27.530779 (Thread-1): Began running node model.my_new_project.test_model3
2021-11-26 21:53:27.532934 (Thread-1): 21:53:27 | 3 of 5 SKIP relation dbt.test_model3................................. [SKIP]
2021-11-26 21:53:27.534786 (Thread-1): Finished running node model.my_new_project.test_model3
2021-11-26 21:53:27.537933 (Thread-1): Began running node model.my_new_project.test_model4
2021-11-26 21:53:27.539424 (Thread-1): 21:53:27 | 4 of 5 SKIP relation dbt.test_model4................................. [SKIP]
2021-11-26 21:53:27.541250 (Thread-1): Finished running node model.my_new_project.test_model4
2021-11-26 21:53:27.543917 (Thread-1): Began running node model.my_new_project.test_model5
2021-11-26 21:53:27.544485 (Thread-1): 21:53:27 | 5 of 5 SKIP relation dbt.test_model5................................. [SKIP]
2021-11-26 21:53:27.545924 (Thread-1): Finished running node model.my_new_project.test_model5
2021-11-26 21:53:27.548852 (MainThread): Acquiring new athena connection "master".
2021-11-26 21:53:27.550299 (MainThread): 21:53:27 | 
2021-11-26 21:53:27.554012 (MainThread): 21:53:27 | Finished running 5 view models in 5.58s.
2021-11-26 21:53:27.556370 (MainThread): Connection 'master' was properly closed.
2021-11-26 21:53:27.559164 (MainThread): Connection 'model.my_new_project.test_model2' was properly closed.
2021-11-26 21:53:27.573415 (MainThread): 
2021-11-26 21:53:27.574369 (MainThread): Completed with 2 errors and 0 warnings:
2021-11-26 21:53:27.576130 (MainThread): 
2021-11-26 21:53:27.577821 (MainThread): Runtime Error in model test_model1 (models/test_model1.sql)
2021-11-26 21:53:27.579987 (MainThread):   An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 10:1: mismatched input 'Left'. Expecting: <expression>
2021-11-26 21:53:27.583687 (MainThread): 
2021-11-26 21:53:27.585658 (MainThread): Runtime Error in model test_model2 (models/test_model2.sql)
2021-11-26 21:53:27.587116 (MainThread):   An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
2021-11-26 21:53:27.590166 (MainThread): 
Done. PASS=0 WARN=0 ERROR=2 SKIP=3 TOTAL=5
2021-11-26 21:53:27.592089 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8afadb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d4b32b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b6ecd00>]}
2021-11-26 21:53:27.594148 (MainThread): Flushing usage events
2021-11-26 21:55:58.527537 (MainThread): Running with dbt=0.21.0
2021-11-26 21:55:58.607020 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/vscode/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-26 21:55:58.612764 (MainThread): Tracking: tracking
2021-11-26 21:55:58.615315 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff886348b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89ed0280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89ed0df0>]}
2021-11-26 21:55:58.624489 (MainThread): Partial parsing not enabled
2021-11-26 21:55:58.640550 (MainThread): Parsing macros/catalog.sql
2021-11-26 21:55:58.642944 (MainThread): Parsing macros/adapters.sql
2021-11-26 21:55:58.651466 (MainThread): Parsing macros/materializations/seed.sql
2021-11-26 21:55:58.655046 (MainThread): Parsing macros/materializations/snapshot.sql
2021-11-26 21:55:58.656537 (MainThread): Parsing macros/materializations/table.sql
2021-11-26 21:55:58.660002 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-26 21:55:58.671907 (MainThread): Parsing macros/materializations/view.sql
2021-11-26 21:55:58.675681 (MainThread): Parsing macros/core.sql
2021-11-26 21:55:58.678689 (MainThread): Parsing macros/materializations/test.sql
2021-11-26 21:55:58.682989 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-26 21:55:58.688653 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-26 21:55:58.691768 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-26 21:55:58.696323 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-26 21:55:58.698948 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-26 21:55:58.705031 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-26 21:55:58.716534 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-26 21:55:58.729288 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-26 21:55:58.734491 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-26 21:55:58.742202 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-26 21:55:58.759999 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-26 21:55:58.769236 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-26 21:55:58.770690 (MainThread): Parsing macros/etc/query.sql
2021-11-26 21:55:58.773531 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-26 21:55:58.775446 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-26 21:55:58.777096 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-26 21:55:58.778509 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-26 21:55:58.780730 (MainThread): Parsing macros/etc/datetime.sql
2021-11-26 21:55:58.786767 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-26 21:55:58.789161 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-26 21:55:58.790964 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-26 21:55:58.793053 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-26 21:55:58.795040 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-26 21:55:58.797110 (MainThread): Parsing macros/adapters/common.sql
2021-11-26 21:55:58.904301 (MainThread): Acquiring new athena connection "model.my_new_project.test_model1".
2021-11-26 21:55:58.911771 (MainThread): Acquiring new athena connection "model.my_new_project.test_model2".
2021-11-26 21:55:58.914130 (MainThread): Acquiring new athena connection "model.my_new_project.test_model3".
2021-11-26 21:55:58.917199 (MainThread): Acquiring new athena connection "model.my_new_project.test_model4".
2021-11-26 21:55:58.920095 (MainThread): Acquiring new athena connection "model.my_new_project.test_model5".
2021-11-26 21:55:58.943643 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-11-26 21:55:58.947458 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8d0281df-a3a9-40db-8f2f-35753da5e2f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8812b670>]}
2021-11-26 21:55:58.959992 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-11-26 21:55:58.961479 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8d0281df-a3a9-40db-8f2f-35753da5e2f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8812b610>]}
2021-11-26 21:55:58.962610 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 1 seed file, 0 sources, 0 exposures
2021-11-26 21:55:58.965397 (MainThread): 
2021-11-26 21:55:58.968300 (MainThread): Acquiring new athena connection "master".
2021-11-26 21:55:58.970537 (ThreadPoolExecutor-0_0): Acquiring new athena connection "list_awsdatacatalog".
2021-11-26 21:55:58.978418 (ThreadPoolExecutor-0_0): Using athena connection "list_awsdatacatalog".
2021-11-26 21:55:58.979543 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
  
2021-11-26 21:55:58.982779 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-26 21:55:59.007280 (ThreadPoolExecutor-0_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
2021-11-26 21:56:00.804327 (ThreadPoolExecutor-0_0): SQL status: OK -1 in 1.82 seconds
2021-11-26 21:56:00.812113 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: Close
2021-11-26 21:56:00.819696 (ThreadPoolExecutor-2_0): Acquiring new athena connection "list_awsdatacatalog_dbt".
2021-11-26 21:56:00.822545 (ThreadPoolExecutor-2_0): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 36180), raddr=('3.209.8.104', 443)>
2021-11-26 21:56:00.837138 (ThreadPoolExecutor-2_0): Using athena connection "list_awsdatacatalog_dbt".
2021-11-26 21:56:00.838551 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
2021-11-26 21:56:00.843546 (ThreadPoolExecutor-2_0): Opening a new connection, currently in state closed
2021-11-26 21:56:00.873037 (ThreadPoolExecutor-2_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
2021-11-26 21:56:03.731743 (ThreadPoolExecutor-2_0): SQL status: OK -1 in 2.89 seconds
2021-11-26 21:56:03.736161 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: Close
2021-11-26 21:56:03.743137 (MainThread): 21:56:03 | Concurrency: 1 threads (target='dev')
2021-11-26 21:56:03.744587 (MainThread): 21:56:03 | 
2021-11-26 21:56:03.750818 (Thread-1): Began running node model.my_new_project.test_model1
2021-11-26 21:56:03.752403 (Thread-1): 21:56:03 | 1 of 5 START view model dbt.test_model1.............................. [RUN]
2021-11-26 21:56:03.755403 (Thread-1): Acquiring new athena connection "model.my_new_project.test_model1".
2021-11-26 21:56:03.759403 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 36182), raddr=('3.209.8.104', 443)>
2021-11-26 21:56:03.763545 (Thread-1): Compiling model.my_new_project.test_model1
2021-11-26 21:56:03.768257 (Thread-1): Writing injected SQL for node "model.my_new_project.test_model1"
2021-11-26 21:56:03.774623 (Thread-1): finished collecting timing info
2021-11-26 21:56:03.787154 (Thread-1): Writing runtime SQL for node "model.my_new_project.test_model1"
2021-11-26 21:56:03.791935 (Thread-1): Using athena connection "model.my_new_project.test_model1".
2021-11-26 21:56:03.792655 (Thread-1): On model.my_new_project.test_model1: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    SELECT 
bldg_id, sum("out.electricity.interior_lighting.energy_consumption") as total_interior_lighting_consumption 
FROM "defaultdb"."buildings" 
where /*county='G5500690' */

Left Join "defaultdb"."resby_puma_northeast".bldg_id using bldg_id

group by bldg_id;

2021-11-26 21:56:03.794092 (Thread-1): Opening a new connection, currently in state closed
2021-11-26 21:56:03.811423 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    SELECT 
bldg_id, sum("out.electricity.interior_lighting.energy_consumption") as total_interior_lighting_consumption 
FROM "defaultdb"."buildings" 
where /*county='G5500690' */

Left Join "defaultdb"."resby_puma_northeast".bldg_id using bldg_id

group by bldg_id;
2021-11-26 21:56:04.048918 (Thread-1): Failed to execute query.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 307, in _execute
    query_id = retry_api_call(
  File "/usr/local/lib/python3.8/site-packages/pyathena/util.py", line 84, in retry_api_call
    return retry(func, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 404, in __call__
    do = self.iter(retry_state=retry_state)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 349, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 407, in __call__
    result = fn(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 276, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 586, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 10:1: mismatched input 'Left'. Expecting: <expression>
2021-11-26 21:56:04.051546 (Thread-1): Error running SQL: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    SELECT 
bldg_id, sum("out.electricity.interior_lighting.energy_consumption") as total_interior_lighting_consumption 
FROM "defaultdb"."buildings" 
where /*county='G5500690' */

Left Join "defaultdb"."resby_puma_northeast".bldg_id using bldg_id

group by bldg_id;

2021-11-26 21:56:04.054719 (Thread-1): finished collecting timing info
2021-11-26 21:56:04.056592 (Thread-1): On model.my_new_project.test_model1: Close
2021-11-26 21:56:04.058980 (Thread-1): Runtime Error in model test_model1 (models/test_model1.sql)
  An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 10:1: mismatched input 'Left'. Expecting: <expression>
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 307, in _execute
    query_id = retry_api_call(
  File "/usr/local/lib/python3.8/site-packages/pyathena/util.py", line 84, in retry_api_call
    return retry(func, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 404, in __call__
    do = self.iter(retry_state=retry_state)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 349, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 407, in __call__
    result = fn(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 276, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 586, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 10:1: mismatched input 'Left'. Expecting: <expression>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 100, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 72, in execute
    query_id = self._execute(
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 315, in _execute
    raise DatabaseError(*e.args) from e
pyathena.error.DatabaseError: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 10:1: mismatched input 'Left'. Expecting: <expression>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 66, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 103, in exception_handler
    raise RuntimeException(str(e)) from e
dbt.exceptions.RuntimeException: Runtime Error in model test_model1 (models/test_model1.sql)
  An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 10:1: mismatched input 'Left'. Expecting: <expression>
2021-11-26 21:56:04.062739 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d0281df-a3a9-40db-8f2f-35753da5e2f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86aec2b0>]}
2021-11-26 21:56:04.065452 (Thread-1): 21:56:04 | 1 of 5 ERROR creating view model dbt.test_model1..................... [ERROR in 0.31s]
2021-11-26 21:56:04.067193 (Thread-1): Finished running node model.my_new_project.test_model1
2021-11-26 21:56:04.068535 (Thread-1): Began running node model.my_new_project.test_model2
2021-11-26 21:56:04.069780 (Thread-1): 21:56:04 | 2 of 5 START view model dbt.test_model2.............................. [RUN]
2021-11-26 21:56:04.071164 (Thread-1): Acquiring new athena connection "model.my_new_project.test_model2".
2021-11-26 21:56:04.073019 (Thread-1): Compiling model.my_new_project.test_model2
2021-11-26 21:56:04.075481 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 36184), raddr=('3.209.8.104', 443)>
2021-11-26 21:56:04.077341 (Thread-1): Writing injected SQL for node "model.my_new_project.test_model2"
2021-11-26 21:56:04.081398 (Thread-1): finished collecting timing info
2021-11-26 21:56:04.083964 (Thread-1): Writing runtime SQL for node "model.my_new_project.test_model2"
2021-11-26 21:56:04.089547 (Thread-1): Using athena connection "model.my_new_project.test_model2".
2021-11-26 21:56:04.090581 (Thread-1): On model.my_new_project.test_model2: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    /*
from somewhere - get bldg_id and zip code --> bldg_locations
*/

2021-11-26 21:56:04.095377 (Thread-1): Opening a new connection, currently in state closed
2021-11-26 21:56:04.113414 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    /*
from somewhere - get bldg_id and zip code --> bldg_locations
*/
2021-11-26 21:56:04.357467 (Thread-1): Failed to execute query.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 307, in _execute
    query_id = retry_api_call(
  File "/usr/local/lib/python3.8/site-packages/pyathena/util.py", line 84, in retry_api_call
    return retry(func, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 404, in __call__
    do = self.iter(retry_state=retry_state)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 349, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 407, in __call__
    result = fn(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 276, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 586, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
2021-11-26 21:56:04.360197 (Thread-1): Error running SQL: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    /*
from somewhere - get bldg_id and zip code --> bldg_locations
*/

2021-11-26 21:56:04.367051 (Thread-1): finished collecting timing info
2021-11-26 21:56:04.371567 (Thread-1): On model.my_new_project.test_model2: Close
2021-11-26 21:56:04.375856 (Thread-1): Runtime Error in model test_model2 (models/test_model2.sql)
  An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 307, in _execute
    query_id = retry_api_call(
  File "/usr/local/lib/python3.8/site-packages/pyathena/util.py", line 84, in retry_api_call
    return retry(func, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 404, in __call__
    do = self.iter(retry_state=retry_state)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 349, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 407, in __call__
    result = fn(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 276, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 586, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 100, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 72, in execute
    query_id = self._execute(
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 315, in _execute
    raise DatabaseError(*e.args) from e
pyathena.error.DatabaseError: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 66, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 103, in exception_handler
    raise RuntimeException(str(e)) from e
dbt.exceptions.RuntimeException: Runtime Error in model test_model2 (models/test_model2.sql)
  An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
2021-11-26 21:56:04.382825 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d0281df-a3a9-40db-8f2f-35753da5e2f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86cbfa90>]}
2021-11-26 21:56:04.385613 (Thread-1): 21:56:04 | 2 of 5 ERROR creating view model dbt.test_model2..................... [ERROR in 0.31s]
2021-11-26 21:56:04.388609 (Thread-1): Finished running node model.my_new_project.test_model2
2021-11-26 21:56:04.391572 (Thread-1): Began running node model.my_new_project.test_model3
2021-11-26 21:56:04.394657 (Thread-1): 21:56:04 | 3 of 5 SKIP relation dbt.test_model3................................. [SKIP]
2021-11-26 21:56:04.400236 (Thread-1): Finished running node model.my_new_project.test_model3
2021-11-26 21:56:04.402174 (Thread-1): Began running node model.my_new_project.test_model4
2021-11-26 21:56:04.404549 (Thread-1): 21:56:04 | 4 of 5 SKIP relation dbt.test_model4................................. [SKIP]
2021-11-26 21:56:04.406541 (Thread-1): Finished running node model.my_new_project.test_model4
2021-11-26 21:56:04.409592 (Thread-1): Began running node model.my_new_project.test_model5
2021-11-26 21:56:04.410727 (Thread-1): 21:56:04 | 5 of 5 SKIP relation dbt.test_model5................................. [SKIP]
2021-11-26 21:56:04.412193 (Thread-1): Finished running node model.my_new_project.test_model5
2021-11-26 21:56:04.417724 (MainThread): Acquiring new athena connection "master".
2021-11-26 21:56:04.419191 (MainThread): 21:56:04 | 
2021-11-26 21:56:04.421027 (MainThread): 21:56:04 | Finished running 5 view models in 5.45s.
2021-11-26 21:56:04.423119 (MainThread): Connection 'master' was properly closed.
2021-11-26 21:56:04.425118 (MainThread): Connection 'model.my_new_project.test_model2' was properly closed.
2021-11-26 21:56:04.438214 (MainThread): 
2021-11-26 21:56:04.439467 (MainThread): Completed with 2 errors and 0 warnings:
2021-11-26 21:56:04.441955 (MainThread): 
2021-11-26 21:56:04.444068 (MainThread): Runtime Error in model test_model1 (models/test_model1.sql)
2021-11-26 21:56:04.445396 (MainThread):   An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 10:1: mismatched input 'Left'. Expecting: <expression>
2021-11-26 21:56:04.446900 (MainThread): 
2021-11-26 21:56:04.448450 (MainThread): Runtime Error in model test_model2 (models/test_model2.sql)
2021-11-26 21:56:04.452168 (MainThread):   An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
2021-11-26 21:56:04.455085 (MainThread): 
Done. PASS=0 WARN=0 ERROR=2 SKIP=3 TOTAL=5
2021-11-26 21:56:04.457666 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89ef0850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87ff5fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88069b20>]}
2021-11-26 21:56:04.458558 (MainThread): Flushing usage events
2021-11-26 21:59:02.452028 (MainThread): Running with dbt=0.21.0
2021-11-26 21:59:02.518828 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/vscode/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-26 21:59:02.523841 (MainThread): Tracking: tracking
2021-11-26 21:59:02.526167 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93a39610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff952d5250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff952d5e20>]}
2021-11-26 21:59:02.535305 (MainThread): Partial parsing not enabled
2021-11-26 21:59:02.549242 (MainThread): Parsing macros/catalog.sql
2021-11-26 21:59:02.551994 (MainThread): Parsing macros/adapters.sql
2021-11-26 21:59:02.560436 (MainThread): Parsing macros/materializations/seed.sql
2021-11-26 21:59:02.563434 (MainThread): Parsing macros/materializations/snapshot.sql
2021-11-26 21:59:02.564836 (MainThread): Parsing macros/materializations/table.sql
2021-11-26 21:59:02.567818 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-26 21:59:02.580702 (MainThread): Parsing macros/materializations/view.sql
2021-11-26 21:59:02.584313 (MainThread): Parsing macros/core.sql
2021-11-26 21:59:02.587261 (MainThread): Parsing macros/materializations/test.sql
2021-11-26 21:59:02.591742 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-26 21:59:02.598248 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-26 21:59:02.601494 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-26 21:59:02.606536 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-26 21:59:02.610900 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-26 21:59:02.616837 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-26 21:59:02.627161 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-26 21:59:02.640730 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-26 21:59:02.645146 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-26 21:59:02.653128 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-26 21:59:02.670431 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-26 21:59:02.679895 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-26 21:59:02.681298 (MainThread): Parsing macros/etc/query.sql
2021-11-26 21:59:02.683088 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-26 21:59:02.686061 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-26 21:59:02.687801 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-26 21:59:02.689303 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-26 21:59:02.690906 (MainThread): Parsing macros/etc/datetime.sql
2021-11-26 21:59:02.696540 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-26 21:59:02.698115 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-26 21:59:02.701038 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-26 21:59:02.702821 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-26 21:59:02.704129 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-26 21:59:02.705664 (MainThread): Parsing macros/adapters/common.sql
2021-11-26 21:59:02.811880 (MainThread): Acquiring new athena connection "model.my_new_project.test_model1".
2021-11-26 21:59:02.819229 (MainThread): Acquiring new athena connection "model.my_new_project.test_model2".
2021-11-26 21:59:02.821301 (MainThread): Acquiring new athena connection "model.my_new_project.test_model3".
2021-11-26 21:59:02.824388 (MainThread): Acquiring new athena connection "model.my_new_project.test_model4".
2021-11-26 21:59:02.829804 (MainThread): 1699: statically parsed test_model5.sql
2021-11-26 21:59:02.830639 (MainThread): Acquiring new athena connection "model.my_new_project.test_model5".
2021-11-26 21:59:02.834535 (MainThread): Sending event: {'category': 'dbt', 'action': 'experimental_parser', 'label': 'a5feeb81-308a-4cb8-8e22-8fa85ebe8ff5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9349e850>]}
2021-11-26 21:59:02.857071 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-11-26 21:59:02.860776 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a5feeb81-308a-4cb8-8e22-8fa85ebe8ff5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93462520>]}
2021-11-26 21:59:02.871388 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-11-26 21:59:02.873026 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a5feeb81-308a-4cb8-8e22-8fa85ebe8ff5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9349aee0>]}
2021-11-26 21:59:02.873948 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 1 seed file, 0 sources, 0 exposures
2021-11-26 21:59:02.876182 (MainThread): 
2021-11-26 21:59:02.877097 (MainThread): Acquiring new athena connection "master".
2021-11-26 21:59:02.880862 (ThreadPoolExecutor-0_0): Acquiring new athena connection "list_awsdatacatalog".
2021-11-26 21:59:02.888365 (ThreadPoolExecutor-0_0): Using athena connection "list_awsdatacatalog".
2021-11-26 21:59:02.889094 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
  
2021-11-26 21:59:02.891481 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-26 21:59:02.912540 (ThreadPoolExecutor-0_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
2021-11-26 21:59:04.803086 (ThreadPoolExecutor-0_0): SQL status: OK -1 in 1.91 seconds
2021-11-26 21:59:04.813305 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: Close
2021-11-26 21:59:04.820471 (ThreadPoolExecutor-2_0): Acquiring new athena connection "list_awsdatacatalog_dbt".
2021-11-26 21:59:04.823199 (ThreadPoolExecutor-2_0): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 36428), raddr=('34.198.233.109', 443)>
2021-11-26 21:59:04.839655 (ThreadPoolExecutor-2_0): Using athena connection "list_awsdatacatalog_dbt".
2021-11-26 21:59:04.841326 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
2021-11-26 21:59:04.845721 (ThreadPoolExecutor-2_0): Opening a new connection, currently in state closed
2021-11-26 21:59:04.873764 (ThreadPoolExecutor-2_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
2021-11-26 21:59:07.868280 (ThreadPoolExecutor-2_0): SQL status: OK -1 in 3.02 seconds
2021-11-26 21:59:07.877102 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: Close
2021-11-26 21:59:07.884896 (MainThread): 21:59:07 | Concurrency: 1 threads (target='dev')
2021-11-26 21:59:07.888424 (MainThread): 21:59:07 | 
2021-11-26 21:59:07.899628 (Thread-1): Began running node model.my_new_project.test_model1
2021-11-26 21:59:07.901186 (Thread-1): 21:59:07 | 1 of 5 START view model dbt.test_model1.............................. [RUN]
2021-11-26 21:59:07.908014 (Thread-1): Acquiring new athena connection "model.my_new_project.test_model1".
2021-11-26 21:59:07.912756 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 36430), raddr=('34.198.233.109', 443)>
2021-11-26 21:59:07.919273 (Thread-1): Compiling model.my_new_project.test_model1
2021-11-26 21:59:07.922306 (Thread-1): Writing injected SQL for node "model.my_new_project.test_model1"
2021-11-26 21:59:07.934260 (Thread-1): finished collecting timing info
2021-11-26 21:59:07.949655 (Thread-1): Writing runtime SQL for node "model.my_new_project.test_model1"
2021-11-26 21:59:07.954607 (Thread-1): Using athena connection "model.my_new_project.test_model1".
2021-11-26 21:59:07.955811 (Thread-1): On model.my_new_project.test_model1: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    SELECT 
bldg_id, sum("out.electricity.interior_lighting.energy_consumption") as total_interior_lighting_consumption 
FROM "defaultdb"."buildings" 
where /*county='G5500690' */

left join "defaultdb"."resby_puma_northeast".bldg_id using (bldg_id)

group by bldg_id

2021-11-26 21:59:07.957181 (Thread-1): Opening a new connection, currently in state closed
2021-11-26 21:59:07.974986 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    SELECT 
bldg_id, sum("out.electricity.interior_lighting.energy_consumption") as total_interior_lighting_consumption 
FROM "defaultdb"."buildings" 
where /*county='G5500690' */

left join "defaultdb"."resby_puma_northeast".bldg_id using (bldg_id)

group by bldg_id
2021-11-26 21:59:08.350962 (Thread-1): Failed to execute query.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 307, in _execute
    query_id = retry_api_call(
  File "/usr/local/lib/python3.8/site-packages/pyathena/util.py", line 84, in retry_api_call
    return retry(func, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 404, in __call__
    do = self.iter(retry_state=retry_state)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 349, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 407, in __call__
    result = fn(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 276, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 586, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 10:1: mismatched input 'left'. Expecting: <expression>
2021-11-26 21:59:08.355710 (Thread-1): Error running SQL: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    SELECT 
bldg_id, sum("out.electricity.interior_lighting.energy_consumption") as total_interior_lighting_consumption 
FROM "defaultdb"."buildings" 
where /*county='G5500690' */

left join "defaultdb"."resby_puma_northeast".bldg_id using (bldg_id)

group by bldg_id

2021-11-26 21:59:08.362071 (Thread-1): finished collecting timing info
2021-11-26 21:59:08.366435 (Thread-1): On model.my_new_project.test_model1: Close
2021-11-26 21:59:08.370845 (Thread-1): Runtime Error in model test_model1 (models/test_model1.sql)
  An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 10:1: mismatched input 'left'. Expecting: <expression>
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 307, in _execute
    query_id = retry_api_call(
  File "/usr/local/lib/python3.8/site-packages/pyathena/util.py", line 84, in retry_api_call
    return retry(func, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 404, in __call__
    do = self.iter(retry_state=retry_state)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 349, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 407, in __call__
    result = fn(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 276, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 586, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 10:1: mismatched input 'left'. Expecting: <expression>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 100, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 72, in execute
    query_id = self._execute(
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 315, in _execute
    raise DatabaseError(*e.args) from e
pyathena.error.DatabaseError: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 10:1: mismatched input 'left'. Expecting: <expression>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 66, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 103, in exception_handler
    raise RuntimeException(str(e)) from e
dbt.exceptions.RuntimeException: Runtime Error in model test_model1 (models/test_model1.sql)
  An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 10:1: mismatched input 'left'. Expecting: <expression>
2021-11-26 21:59:08.377382 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5feeb81-308a-4cb8-8e22-8fa85ebe8ff5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff916f02e0>]}
2021-11-26 21:59:08.381457 (Thread-1): 21:59:08 | 1 of 5 ERROR creating view model dbt.test_model1..................... [ERROR in 0.47s]
2021-11-26 21:59:08.384708 (Thread-1): Finished running node model.my_new_project.test_model1
2021-11-26 21:59:08.387014 (Thread-1): Began running node model.my_new_project.test_model2
2021-11-26 21:59:08.389893 (Thread-1): 21:59:08 | 2 of 5 START view model dbt.test_model2.............................. [RUN]
2021-11-26 21:59:08.394665 (Thread-1): Acquiring new athena connection "model.my_new_project.test_model2".
2021-11-26 21:59:08.395428 (Thread-1): Compiling model.my_new_project.test_model2
2021-11-26 21:59:08.397926 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 36432), raddr=('34.198.233.109', 443)>
2021-11-26 21:59:08.402715 (Thread-1): Writing injected SQL for node "model.my_new_project.test_model2"
2021-11-26 21:59:08.407692 (Thread-1): finished collecting timing info
2021-11-26 21:59:08.410125 (Thread-1): Writing runtime SQL for node "model.my_new_project.test_model2"
2021-11-26 21:59:08.414827 (Thread-1): Using athena connection "model.my_new_project.test_model2".
2021-11-26 21:59:08.416144 (Thread-1): On model.my_new_project.test_model2: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    /*
from somewhere - get bldg_id and zip code --> bldg_locations
*/

2021-11-26 21:59:08.417428 (Thread-1): Opening a new connection, currently in state closed
2021-11-26 21:59:08.432942 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    /*
from somewhere - get bldg_id and zip code --> bldg_locations
*/
2021-11-26 21:59:08.683881 (Thread-1): Failed to execute query.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 307, in _execute
    query_id = retry_api_call(
  File "/usr/local/lib/python3.8/site-packages/pyathena/util.py", line 84, in retry_api_call
    return retry(func, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 404, in __call__
    do = self.iter(retry_state=retry_state)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 349, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 407, in __call__
    result = fn(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 276, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 586, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
2021-11-26 21:59:08.690834 (Thread-1): Error running SQL: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    /*
from somewhere - get bldg_id and zip code --> bldg_locations
*/

2021-11-26 21:59:08.697495 (Thread-1): finished collecting timing info
2021-11-26 21:59:08.704796 (Thread-1): On model.my_new_project.test_model2: Close
2021-11-26 21:59:08.713019 (Thread-1): Runtime Error in model test_model2 (models/test_model2.sql)
  An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 307, in _execute
    query_id = retry_api_call(
  File "/usr/local/lib/python3.8/site-packages/pyathena/util.py", line 84, in retry_api_call
    return retry(func, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 404, in __call__
    do = self.iter(retry_state=retry_state)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 349, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 407, in __call__
    result = fn(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 276, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 586, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 100, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 72, in execute
    query_id = self._execute(
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 315, in _execute
    raise DatabaseError(*e.args) from e
pyathena.error.DatabaseError: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 66, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 103, in exception_handler
    raise RuntimeException(str(e)) from e
dbt.exceptions.RuntimeException: Runtime Error in model test_model2 (models/test_model2.sql)
  An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
2021-11-26 21:59:08.719380 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5feeb81-308a-4cb8-8e22-8fa85ebe8ff5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90530d90>]}
2021-11-26 21:59:08.723391 (Thread-1): 21:59:08 | 2 of 5 ERROR creating view model dbt.test_model2..................... [ERROR in 0.33s]
2021-11-26 21:59:08.727182 (Thread-1): Finished running node model.my_new_project.test_model2
2021-11-26 21:59:08.730658 (Thread-1): Began running node model.my_new_project.test_model3
2021-11-26 21:59:08.732002 (Thread-1): 21:59:08 | 3 of 5 SKIP relation dbt.test_model3................................. [SKIP]
2021-11-26 21:59:08.734916 (Thread-1): Finished running node model.my_new_project.test_model3
2021-11-26 21:59:08.738284 (Thread-1): Began running node model.my_new_project.test_model4
2021-11-26 21:59:08.740687 (Thread-1): 21:59:08 | 4 of 5 SKIP relation dbt.test_model4................................. [SKIP]
2021-11-26 21:59:08.744132 (Thread-1): Finished running node model.my_new_project.test_model4
2021-11-26 21:59:08.749473 (Thread-1): Began running node model.my_new_project.test_model5
2021-11-26 21:59:08.751947 (Thread-1): 21:59:08 | 5 of 5 SKIP relation dbt.test_model5................................. [SKIP]
2021-11-26 21:59:08.753883 (Thread-1): Finished running node model.my_new_project.test_model5
2021-11-26 21:59:08.756385 (MainThread): Acquiring new athena connection "master".
2021-11-26 21:59:08.757600 (MainThread): 21:59:08 | 
2021-11-26 21:59:08.759227 (MainThread): 21:59:08 | Finished running 5 view models in 5.88s.
2021-11-26 21:59:08.761787 (MainThread): Connection 'master' was properly closed.
2021-11-26 21:59:08.764944 (MainThread): Connection 'model.my_new_project.test_model2' was properly closed.
2021-11-26 21:59:08.780062 (MainThread): 
2021-11-26 21:59:08.782727 (MainThread): Completed with 2 errors and 0 warnings:
2021-11-26 21:59:08.784628 (MainThread): 
2021-11-26 21:59:08.786102 (MainThread): Runtime Error in model test_model1 (models/test_model1.sql)
2021-11-26 21:59:08.787723 (MainThread):   An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 10:1: mismatched input 'left'. Expecting: <expression>
2021-11-26 21:59:08.789421 (MainThread): 
2021-11-26 21:59:08.791374 (MainThread): Runtime Error in model test_model2 (models/test_model2.sql)
2021-11-26 21:59:08.793413 (MainThread):   An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
2021-11-26 21:59:08.794939 (MainThread): 
Done. PASS=0 WARN=0 ERROR=2 SKIP=3 TOTAL=5
2021-11-26 21:59:08.797947 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff952f6340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93527d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92bf7fd0>]}
2021-11-26 21:59:08.800542 (MainThread): Flushing usage events
2021-11-26 22:08:01.722965 (MainThread): Running with dbt=0.21.0
2021-11-26 22:08:01.808349 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/vscode/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-26 22:08:01.814536 (MainThread): Tracking: tracking
2021-11-26 22:08:01.817995 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d8a0880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f13d0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f13ddc0>]}
2021-11-26 22:08:01.828208 (MainThread): Partial parsing not enabled
2021-11-26 22:08:01.844347 (MainThread): Parsing macros/catalog.sql
2021-11-26 22:08:01.846926 (MainThread): Parsing macros/adapters.sql
2021-11-26 22:08:01.855611 (MainThread): Parsing macros/materializations/seed.sql
2021-11-26 22:08:01.858584 (MainThread): Parsing macros/materializations/snapshot.sql
2021-11-26 22:08:01.859933 (MainThread): Parsing macros/materializations/table.sql
2021-11-26 22:08:01.863009 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-26 22:08:01.875573 (MainThread): Parsing macros/materializations/view.sql
2021-11-26 22:08:01.878763 (MainThread): Parsing macros/core.sql
2021-11-26 22:08:01.881358 (MainThread): Parsing macros/materializations/test.sql
2021-11-26 22:08:01.885568 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-26 22:08:01.891198 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-26 22:08:01.894368 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-26 22:08:01.899508 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-26 22:08:01.901025 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-26 22:08:01.908754 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-26 22:08:01.920183 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-26 22:08:01.932831 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-26 22:08:01.937482 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-26 22:08:01.945714 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-26 22:08:01.962118 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-26 22:08:01.971314 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-26 22:08:01.972958 (MainThread): Parsing macros/etc/query.sql
2021-11-26 22:08:01.974533 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-26 22:08:01.978548 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-26 22:08:01.980321 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-26 22:08:01.981790 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-26 22:08:01.983380 (MainThread): Parsing macros/etc/datetime.sql
2021-11-26 22:08:01.989852 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-26 22:08:01.992290 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-26 22:08:01.994123 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-26 22:08:01.995203 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-26 22:08:01.996560 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-26 22:08:01.999718 (MainThread): Parsing macros/adapters/common.sql
2021-11-26 22:08:02.105367 (MainThread): Acquiring new athena connection "model.my_new_project.test_model1".
2021-11-26 22:08:02.112753 (MainThread): Acquiring new athena connection "model.my_new_project.test_model2".
2021-11-26 22:08:02.114918 (MainThread): Acquiring new athena connection "model.my_new_project.test_model3".
2021-11-26 22:08:02.117715 (MainThread): Acquiring new athena connection "model.my_new_project.test_model4".
2021-11-26 22:08:02.121025 (MainThread): Acquiring new athena connection "model.my_new_project.test_model5".
2021-11-26 22:08:02.147839 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-11-26 22:08:02.151566 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1778761f-b9a8-4c79-9b49-5c3b132cdcb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d2a66d0>]}
2021-11-26 22:08:02.163160 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-11-26 22:08:02.165085 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1778761f-b9a8-4c79-9b49-5c3b132cdcb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d2a6280>]}
2021-11-26 22:08:02.165933 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 1 seed file, 0 sources, 0 exposures
2021-11-26 22:08:02.168105 (MainThread): 
2021-11-26 22:08:02.168888 (MainThread): Acquiring new athena connection "master".
2021-11-26 22:08:02.170861 (ThreadPoolExecutor-0_0): Acquiring new athena connection "list_awsdatacatalog".
2021-11-26 22:08:02.178345 (ThreadPoolExecutor-0_0): Using athena connection "list_awsdatacatalog".
2021-11-26 22:08:02.179318 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
  
2021-11-26 22:08:02.181247 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-26 22:08:02.215776 (ThreadPoolExecutor-0_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
2021-11-26 22:08:04.114079 (ThreadPoolExecutor-0_0): SQL status: OK -1 in 1.93 seconds
2021-11-26 22:08:04.116993 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: Close
2021-11-26 22:08:04.121144 (ThreadPoolExecutor-2_0): Acquiring new athena connection "list_awsdatacatalog_dbt".
2021-11-26 22:08:04.122193 (ThreadPoolExecutor-2_0): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 46646), raddr=('54.204.43.5', 443)>
2021-11-26 22:08:04.129353 (ThreadPoolExecutor-2_0): Using athena connection "list_awsdatacatalog_dbt".
2021-11-26 22:08:04.130268 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
2021-11-26 22:08:04.133695 (ThreadPoolExecutor-2_0): Opening a new connection, currently in state closed
2021-11-26 22:08:04.150908 (ThreadPoolExecutor-2_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
2021-11-26 22:08:08.142677 (ThreadPoolExecutor-2_0): SQL status: OK -1 in 4.01 seconds
2021-11-26 22:08:08.154272 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: Close
2021-11-26 22:08:08.160203 (MainThread): 22:08:08 | Concurrency: 1 threads (target='dev')
2021-11-26 22:08:08.162629 (MainThread): 22:08:08 | 
2021-11-26 22:08:08.172924 (Thread-1): Began running node model.my_new_project.test_model1
2021-11-26 22:08:08.175003 (Thread-1): 22:08:08 | 1 of 5 START view model dbt.test_model1.............................. [RUN]
2021-11-26 22:08:08.180117 (Thread-1): Acquiring new athena connection "model.my_new_project.test_model1".
2021-11-26 22:08:08.185017 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 46648), raddr=('54.204.43.5', 443)>
2021-11-26 22:08:08.189992 (Thread-1): Compiling model.my_new_project.test_model1
2021-11-26 22:08:08.194484 (Thread-1): Writing injected SQL for node "model.my_new_project.test_model1"
2021-11-26 22:08:08.203147 (Thread-1): finished collecting timing info
2021-11-26 22:08:08.219626 (Thread-1): Writing runtime SQL for node "model.my_new_project.test_model1"
2021-11-26 22:08:08.225652 (Thread-1): Using athena connection "model.my_new_project.test_model1".
2021-11-26 22:08:08.226959 (Thread-1): On model.my_new_project.test_model1: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    With sample_buildings as (
    SELECT 
        bldg_id,
        city,
        state
    FROM "defaultdb"."buildings" 
    group by 1
)
/*where county='G5500690' */

Select 
    sum(out.electricity.clothes_dryer.energy_consumption),
    bldg_id
from "defaultdb"."resby_puma_northeast"


left join sample_buildings  using (bldg_id)

2021-11-26 22:08:08.228970 (Thread-1): Opening a new connection, currently in state closed
2021-11-26 22:08:08.245503 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    With sample_buildings as (
    SELECT 
        bldg_id,
        city,
        state
    FROM "defaultdb"."buildings" 
    group by 1
)
/*where county='G5500690' */

Select 
    sum(out.electricity.clothes_dryer.energy_consumption),
    bldg_id
from "defaultdb"."resby_puma_northeast"


left join sample_buildings  using (bldg_id)
2021-11-26 22:08:09.731325 (Thread-1): Error running SQL: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    With sample_buildings as (
    SELECT 
        bldg_id,
        city,
        state
    FROM "defaultdb"."buildings" 
    group by 1
)
/*where county='G5500690' */

Select 
    sum(out.electricity.clothes_dryer.energy_consumption),
    bldg_id
from "defaultdb"."resby_puma_northeast"


left join sample_buildings  using (bldg_id)

2021-11-26 22:08:09.736662 (Thread-1): finished collecting timing info
2021-11-26 22:08:09.743327 (Thread-1): On model.my_new_project.test_model1: Close
2021-11-26 22:08:09.749161 (Thread-1): Runtime Error in model test_model1 (models/test_model1.sql)
  com.facebook.presto.v217.sql.analyzer.SemanticException: line 7:9: Column 'bldg_id' cannot be resolved
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 100, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 90, in execute
    raise OperationalError(query_execution.state_change_reason)
pyathena.error.OperationalError: com.facebook.presto.v217.sql.analyzer.SemanticException: line 7:9: Column 'bldg_id' cannot be resolved

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 66, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 103, in exception_handler
    raise RuntimeException(str(e)) from e
dbt.exceptions.RuntimeException: Runtime Error in model test_model1 (models/test_model1.sql)
  com.facebook.presto.v217.sql.analyzer.SemanticException: line 7:9: Column 'bldg_id' cannot be resolved
2021-11-26 22:08:09.761914 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1778761f-b9a8-4c79-9b49-5c3b132cdcb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c82c850>]}
2021-11-26 22:08:09.771640 (Thread-1): 22:08:09 | 1 of 5 ERROR creating view model dbt.test_model1..................... [ERROR in 1.58s]
2021-11-26 22:08:09.773463 (Thread-1): Finished running node model.my_new_project.test_model1
2021-11-26 22:08:09.776624 (Thread-1): Began running node model.my_new_project.test_model2
2021-11-26 22:08:09.780650 (Thread-1): 22:08:09 | 2 of 5 START view model dbt.test_model2.............................. [RUN]
2021-11-26 22:08:09.783570 (Thread-1): Acquiring new athena connection "model.my_new_project.test_model2".
2021-11-26 22:08:09.786646 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 46650), raddr=('54.204.43.5', 443)>
2021-11-26 22:08:09.790019 (Thread-1): Compiling model.my_new_project.test_model2
2021-11-26 22:08:09.793379 (Thread-1): Writing injected SQL for node "model.my_new_project.test_model2"
2021-11-26 22:08:09.801329 (Thread-1): finished collecting timing info
2021-11-26 22:08:09.804661 (Thread-1): Writing runtime SQL for node "model.my_new_project.test_model2"
2021-11-26 22:08:09.809698 (Thread-1): Using athena connection "model.my_new_project.test_model2".
2021-11-26 22:08:09.810585 (Thread-1): On model.my_new_project.test_model2: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    /*
from somewhere - get bldg_id and zip code --> bldg_locations
*/

2021-11-26 22:08:09.811913 (Thread-1): Opening a new connection, currently in state closed
2021-11-26 22:08:09.829339 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    /*
from somewhere - get bldg_id and zip code --> bldg_locations
*/
2021-11-26 22:08:10.073207 (Thread-1): Failed to execute query.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 307, in _execute
    query_id = retry_api_call(
  File "/usr/local/lib/python3.8/site-packages/pyathena/util.py", line 84, in retry_api_call
    return retry(func, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 404, in __call__
    do = self.iter(retry_state=retry_state)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 349, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 407, in __call__
    result = fn(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 276, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 586, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
2021-11-26 22:08:10.074783 (Thread-1): Error running SQL: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    /*
from somewhere - get bldg_id and zip code --> bldg_locations
*/

2021-11-26 22:08:10.079299 (Thread-1): finished collecting timing info
2021-11-26 22:08:10.080992 (Thread-1): On model.my_new_project.test_model2: Close
2021-11-26 22:08:10.082867 (Thread-1): Runtime Error in model test_model2 (models/test_model2.sql)
  An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 307, in _execute
    query_id = retry_api_call(
  File "/usr/local/lib/python3.8/site-packages/pyathena/util.py", line 84, in retry_api_call
    return retry(func, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 404, in __call__
    do = self.iter(retry_state=retry_state)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 349, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 407, in __call__
    result = fn(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 276, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 586, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 100, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 72, in execute
    query_id = self._execute(
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 315, in _execute
    raise DatabaseError(*e.args) from e
pyathena.error.DatabaseError: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 66, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 103, in exception_handler
    raise RuntimeException(str(e)) from e
dbt.exceptions.RuntimeException: Runtime Error in model test_model2 (models/test_model2.sql)
  An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
2021-11-26 22:08:10.085212 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1778761f-b9a8-4c79-9b49-5c3b132cdcb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c39df70>]}
2021-11-26 22:08:10.087082 (Thread-1): 22:08:10 | 2 of 5 ERROR creating view model dbt.test_model2..................... [ERROR in 0.30s]
2021-11-26 22:08:10.088721 (Thread-1): Finished running node model.my_new_project.test_model2
2021-11-26 22:08:10.090980 (Thread-1): Began running node model.my_new_project.test_model3
2021-11-26 22:08:10.092501 (Thread-1): 22:08:10 | 3 of 5 SKIP relation dbt.test_model3................................. [SKIP]
2021-11-26 22:08:10.093817 (Thread-1): Finished running node model.my_new_project.test_model3
2021-11-26 22:08:10.095877 (Thread-1): Began running node model.my_new_project.test_model4
2021-11-26 22:08:10.097651 (Thread-1): 22:08:10 | 4 of 5 SKIP relation dbt.test_model4................................. [SKIP]
2021-11-26 22:08:10.099339 (Thread-1): Finished running node model.my_new_project.test_model4
2021-11-26 22:08:10.102867 (Thread-1): Began running node model.my_new_project.test_model5
2021-11-26 22:08:10.105624 (Thread-1): 22:08:10 | 5 of 5 SKIP relation dbt.test_model5................................. [SKIP]
2021-11-26 22:08:10.107199 (Thread-1): Finished running node model.my_new_project.test_model5
2021-11-26 22:08:10.110988 (MainThread): Acquiring new athena connection "master".
2021-11-26 22:08:10.112113 (MainThread): 22:08:10 | 
2021-11-26 22:08:10.114093 (MainThread): 22:08:10 | Finished running 5 view models in 7.94s.
2021-11-26 22:08:10.115988 (MainThread): Connection 'master' was properly closed.
2021-11-26 22:08:10.118528 (MainThread): Connection 'model.my_new_project.test_model2' was properly closed.
2021-11-26 22:08:10.133197 (MainThread): 
2021-11-26 22:08:10.134091 (MainThread): Completed with 2 errors and 0 warnings:
2021-11-26 22:08:10.136838 (MainThread): 
2021-11-26 22:08:10.140052 (MainThread): Runtime Error in model test_model1 (models/test_model1.sql)
2021-11-26 22:08:10.142343 (MainThread):   com.facebook.presto.v217.sql.analyzer.SemanticException: line 7:9: Column 'bldg_id' cannot be resolved
2021-11-26 22:08:10.144737 (MainThread): 
2021-11-26 22:08:10.147284 (MainThread): Runtime Error in model test_model2 (models/test_model2.sql)
2021-11-26 22:08:10.149235 (MainThread):   An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
2021-11-26 22:08:10.150860 (MainThread): 
Done. PASS=0 WARN=0 ERROR=2 SKIP=3 TOTAL=5
2021-11-26 22:08:10.154605 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f15d910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d2a10a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f0dce20>]}
2021-11-26 22:08:10.157561 (MainThread): Flushing usage events
2021-11-29 13:24:45.395989 (MainThread): Running with dbt=0.21.0
2021-11-29 13:24:45.473652 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/vscode/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-29 13:24:45.480379 (MainThread): Tracking: tracking
2021-11-29 13:24:45.483153 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c35d8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dc13be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dc13d30>]}
2021-11-29 13:24:45.493352 (MainThread): Partial parsing not enabled
2021-11-29 13:24:45.507775 (MainThread): Parsing macros/catalog.sql
2021-11-29 13:24:45.510272 (MainThread): Parsing macros/adapters.sql
2021-11-29 13:24:45.518684 (MainThread): Parsing macros/materializations/seed.sql
2021-11-29 13:24:45.521609 (MainThread): Parsing macros/materializations/snapshot.sql
2021-11-29 13:24:45.522603 (MainThread): Parsing macros/materializations/table.sql
2021-11-29 13:24:45.525411 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-29 13:24:45.538405 (MainThread): Parsing macros/materializations/view.sql
2021-11-29 13:24:45.541847 (MainThread): Parsing macros/core.sql
2021-11-29 13:24:45.544602 (MainThread): Parsing macros/materializations/test.sql
2021-11-29 13:24:45.550087 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-29 13:24:45.556170 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-29 13:24:45.559640 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-29 13:24:45.564176 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-29 13:24:45.565719 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-29 13:24:45.571680 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-29 13:24:45.582936 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-29 13:24:45.595698 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-29 13:24:45.600380 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-29 13:24:45.609996 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-29 13:24:45.626644 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-29 13:24:45.636137 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-29 13:24:45.637839 (MainThread): Parsing macros/etc/query.sql
2021-11-29 13:24:45.639877 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-29 13:24:45.642180 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-29 13:24:45.643853 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-29 13:24:45.645235 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-29 13:24:45.648056 (MainThread): Parsing macros/etc/datetime.sql
2021-11-29 13:24:45.653366 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-29 13:24:45.654958 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-29 13:24:45.657624 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-29 13:24:45.658890 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-29 13:24:45.661378 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-29 13:24:45.662884 (MainThread): Parsing macros/adapters/common.sql
2021-11-29 13:24:45.768696 (MainThread): Acquiring new athena connection "model.my_new_project.test_model1".
2021-11-29 13:24:45.779418 (MainThread): 1699: statically parsed test_model2.sql
2021-11-29 13:24:45.780324 (MainThread): Acquiring new athena connection "model.my_new_project.test_model2".
2021-11-29 13:24:45.783088 (MainThread): Sending event: {'category': 'dbt', 'action': 'experimental_parser', 'label': 'd2643a73-9a94-4c1f-8255-b57dae0b08e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bdd0730>]}
2021-11-29 13:24:45.784761 (MainThread): Acquiring new athena connection "model.my_new_project.test_model3".
2021-11-29 13:24:45.789386 (MainThread): Acquiring new athena connection "model.my_new_project.test_model4".
2021-11-29 13:24:45.792961 (MainThread): Acquiring new athena connection "model.my_new_project.test_model5".
2021-11-29 13:24:45.824290 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-11-29 13:24:45.828434 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd2643a73-9a94-4c1f-8255-b57dae0b08e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b579550>]}
2021-11-29 13:24:45.842701 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-11-29 13:24:45.844638 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd2643a73-9a94-4c1f-8255-b57dae0b08e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b579730>]}
2021-11-29 13:24:45.845612 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 1 seed file, 0 sources, 0 exposures
2021-11-29 13:24:45.848574 (MainThread): 
2021-11-29 13:24:45.849716 (MainThread): Acquiring new athena connection "master".
2021-11-29 13:24:45.852158 (ThreadPoolExecutor-0_0): Acquiring new athena connection "list_awsdatacatalog".
2021-11-29 13:24:45.860377 (ThreadPoolExecutor-0_0): Using athena connection "list_awsdatacatalog".
2021-11-29 13:24:45.861918 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
  
2021-11-29 13:24:45.864734 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-29 13:24:45.898127 (ThreadPoolExecutor-0_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
2021-11-29 13:24:47.793296 (ThreadPoolExecutor-0_0): SQL status: OK -1 in 1.93 seconds
2021-11-29 13:24:47.807900 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: Close
2021-11-29 13:24:47.816378 (ThreadPoolExecutor-2_0): Acquiring new athena connection "list_awsdatacatalog_dbt".
2021-11-29 13:24:47.820043 (ThreadPoolExecutor-2_0): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 53478), raddr=('34.202.38.208', 443)>
2021-11-29 13:24:47.838888 (ThreadPoolExecutor-2_0): Using athena connection "list_awsdatacatalog_dbt".
2021-11-29 13:24:47.840352 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
2021-11-29 13:24:47.846100 (ThreadPoolExecutor-2_0): Opening a new connection, currently in state closed
2021-11-29 13:24:47.872569 (ThreadPoolExecutor-2_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
2021-11-29 13:24:50.724342 (ThreadPoolExecutor-2_0): SQL status: OK -1 in 2.88 seconds
2021-11-29 13:24:50.736897 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: Close
2021-11-29 13:24:50.745100 (MainThread): 13:24:50 | Concurrency: 1 threads (target='dev')
2021-11-29 13:24:50.748289 (MainThread): 13:24:50 | 
2021-11-29 13:24:50.761183 (Thread-1): Began running node model.my_new_project.test_model1
2021-11-29 13:24:50.764281 (Thread-1): 13:24:50 | 1 of 5 START view model dbt.test_model1.............................. [RUN]
2021-11-29 13:24:50.768969 (Thread-1): Acquiring new athena connection "model.my_new_project.test_model1".
2021-11-29 13:24:50.775042 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 53480), raddr=('34.202.38.208', 443)>
2021-11-29 13:24:50.779923 (Thread-1): Compiling model.my_new_project.test_model1
2021-11-29 13:24:50.784008 (Thread-1): Writing injected SQL for node "model.my_new_project.test_model1"
2021-11-29 13:24:50.798759 (Thread-1): finished collecting timing info
2021-11-29 13:24:50.812511 (Thread-1): Writing runtime SQL for node "model.my_new_project.test_model1"
2021-11-29 13:24:50.821052 (Thread-1): Using athena connection "model.my_new_project.test_model1".
2021-11-29 13:24:50.822152 (Thread-1): On model.my_new_project.test_model1: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    With sample_buildings as (
    SELECT 
        bldg_id,
        city,
        state
    FROM "defaultdb"."sample_buildings" 
    group by 1
)
/*where county='G5500690' */

Select 
    sum(out.electricity.clothes_dryer.energy_consumption),
    bldg_id
from "defaultdb"."resby_puma_northeast"


left join sample_buildings  using (bldg_id)

2021-11-29 13:24:50.823861 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 13:24:50.841582 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    With sample_buildings as (
    SELECT 
        bldg_id,
        city,
        state
    FROM "defaultdb"."sample_buildings" 
    group by 1
)
/*where county='G5500690' */

Select 
    sum(out.electricity.clothes_dryer.energy_consumption),
    bldg_id
from "defaultdb"."resby_puma_northeast"


left join sample_buildings  using (bldg_id)
2021-11-29 13:24:53.134799 (Thread-1): Error running SQL: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    With sample_buildings as (
    SELECT 
        bldg_id,
        city,
        state
    FROM "defaultdb"."sample_buildings" 
    group by 1
)
/*where county='G5500690' */

Select 
    sum(out.electricity.clothes_dryer.energy_consumption),
    bldg_id
from "defaultdb"."resby_puma_northeast"


left join sample_buildings  using (bldg_id)

2021-11-29 13:24:53.139911 (Thread-1): finished collecting timing info
2021-11-29 13:24:53.147627 (Thread-1): On model.my_new_project.test_model1: Close
2021-11-29 13:24:53.155222 (Thread-1): Runtime Error in model test_model1 (models/test_model1.sql)
  com.facebook.presto.v217.sql.analyzer.SemanticException: line 10:10: Table 459120389451.defaultdb.sample_buildings does not exist
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 100, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 90, in execute
    raise OperationalError(query_execution.state_change_reason)
pyathena.error.OperationalError: com.facebook.presto.v217.sql.analyzer.SemanticException: line 10:10: Table 459120389451.defaultdb.sample_buildings does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 66, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 103, in exception_handler
    raise RuntimeException(str(e)) from e
dbt.exceptions.RuntimeException: Runtime Error in model test_model1 (models/test_model1.sql)
  com.facebook.presto.v217.sql.analyzer.SemanticException: line 10:10: Table 459120389451.defaultdb.sample_buildings does not exist
2021-11-29 13:24:53.165991 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2643a73-9a94-4c1f-8255-b57dae0b08e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ab01790>]}
2021-11-29 13:24:53.172694 (Thread-1): 13:24:53 | 1 of 5 ERROR creating view model dbt.test_model1..................... [ERROR in 2.40s]
2021-11-29 13:24:53.176895 (Thread-1): Finished running node model.my_new_project.test_model1
2021-11-29 13:24:53.180601 (Thread-1): Began running node model.my_new_project.test_model2
2021-11-29 13:24:53.184320 (Thread-1): 13:24:53 | 2 of 5 START view model dbt.test_model2.............................. [RUN]
2021-11-29 13:24:53.187074 (Thread-1): Acquiring new athena connection "model.my_new_project.test_model2".
2021-11-29 13:24:53.190392 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 53482), raddr=('34.202.38.208', 443)>
2021-11-29 13:24:53.193224 (Thread-1): Compiling model.my_new_project.test_model2
2021-11-29 13:24:53.198983 (Thread-1): Writing injected SQL for node "model.my_new_project.test_model2"
2021-11-29 13:24:53.205832 (Thread-1): finished collecting timing info
2021-11-29 13:24:53.209240 (Thread-1): Writing runtime SQL for node "model.my_new_project.test_model2"
2021-11-29 13:24:53.215934 (Thread-1): Using athena connection "model.my_new_project.test_model2".
2021-11-29 13:24:53.217604 (Thread-1): On model.my_new_project.test_model2: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    /*
from somewhere - get bldg_id and zip code --> bldg_locations
*/

2021-11-29 13:24:53.218903 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 13:24:53.236340 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    /*
from somewhere - get bldg_id and zip code --> bldg_locations
*/
2021-11-29 13:24:55.155755 (Thread-1): Failed to execute query.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 307, in _execute
    query_id = retry_api_call(
  File "/usr/local/lib/python3.8/site-packages/pyathena/util.py", line 84, in retry_api_call
    return retry(func, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 404, in __call__
    do = self.iter(retry_state=retry_state)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 349, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 407, in __call__
    result = fn(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 276, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 586, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
2021-11-29 13:24:55.164747 (Thread-1): Error running SQL: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    /*
from somewhere - get bldg_id and zip code --> bldg_locations
*/

2021-11-29 13:24:55.171247 (Thread-1): finished collecting timing info
2021-11-29 13:24:55.178423 (Thread-1): On model.my_new_project.test_model2: Close
2021-11-29 13:24:55.189445 (Thread-1): Runtime Error in model test_model2 (models/test_model2.sql)
  An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 307, in _execute
    query_id = retry_api_call(
  File "/usr/local/lib/python3.8/site-packages/pyathena/util.py", line 84, in retry_api_call
    return retry(func, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 404, in __call__
    do = self.iter(retry_state=retry_state)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 349, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 407, in __call__
    result = fn(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 276, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 586, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 100, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 72, in execute
    query_id = self._execute(
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 315, in _execute
    raise DatabaseError(*e.args) from e
pyathena.error.DatabaseError: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 66, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 103, in exception_handler
    raise RuntimeException(str(e)) from e
dbt.exceptions.RuntimeException: Runtime Error in model test_model2 (models/test_model2.sql)
  An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
2021-11-29 13:24:55.197363 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2643a73-9a94-4c1f-8255-b57dae0b08e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88e0a790>]}
2021-11-29 13:24:55.202136 (Thread-1): 13:24:55 | 2 of 5 ERROR creating view model dbt.test_model2..................... [ERROR in 2.01s]
2021-11-29 13:24:55.205758 (Thread-1): Finished running node model.my_new_project.test_model2
2021-11-29 13:24:55.210761 (Thread-1): Began running node model.my_new_project.test_model3
2021-11-29 13:24:55.212289 (Thread-1): 13:24:55 | 3 of 5 SKIP relation dbt.test_model3................................. [SKIP]
2021-11-29 13:24:55.215776 (Thread-1): Finished running node model.my_new_project.test_model3
2021-11-29 13:24:55.218653 (Thread-1): Began running node model.my_new_project.test_model4
2021-11-29 13:24:55.222251 (Thread-1): 13:24:55 | 4 of 5 SKIP relation dbt.test_model4................................. [SKIP]
2021-11-29 13:24:55.228673 (Thread-1): Finished running node model.my_new_project.test_model4
2021-11-29 13:24:55.233241 (Thread-1): Began running node model.my_new_project.test_model5
2021-11-29 13:24:55.235345 (Thread-1): 13:24:55 | 5 of 5 SKIP relation dbt.test_model5................................. [SKIP]
2021-11-29 13:24:55.237864 (Thread-1): Finished running node model.my_new_project.test_model5
2021-11-29 13:24:55.242313 (MainThread): Acquiring new athena connection "master".
2021-11-29 13:24:55.244665 (MainThread): 13:24:55 | 
2021-11-29 13:24:55.247030 (MainThread): 13:24:55 | Finished running 5 view models in 9.39s.
2021-11-29 13:24:55.248700 (MainThread): Connection 'master' was properly closed.
2021-11-29 13:24:55.250859 (MainThread): Connection 'model.my_new_project.test_model2' was properly closed.
2021-11-29 13:24:55.265487 (MainThread): 
2021-11-29 13:24:55.266563 (MainThread): Completed with 2 errors and 0 warnings:
2021-11-29 13:24:55.267838 (MainThread): 
2021-11-29 13:24:55.269422 (MainThread): Runtime Error in model test_model1 (models/test_model1.sql)
2021-11-29 13:24:55.271032 (MainThread):   com.facebook.presto.v217.sql.analyzer.SemanticException: line 10:10: Table 459120389451.defaultdb.sample_buildings does not exist
2021-11-29 13:24:55.272998 (MainThread): 
2021-11-29 13:24:55.276613 (MainThread): Runtime Error in model test_model2 (models/test_model2.sql)
2021-11-29 13:24:55.297966 (MainThread):   An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
2021-11-29 13:24:55.304317 (MainThread): 
Done. PASS=0 WARN=0 ERROR=2 SKIP=3 TOTAL=5
2021-11-29 13:24:55.307886 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dc337f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b535fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b52ca90>]}
2021-11-29 13:24:55.312118 (MainThread): Flushing usage events
2021-11-29 13:28:38.997902 (MainThread): Running with dbt=0.21.0
2021-11-29 13:28:39.080026 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/vscode/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-29 13:28:39.086163 (MainThread): Tracking: tracking
2021-11-29 13:28:39.090537 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97894370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9912fd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9912fe20>]}
2021-11-29 13:28:39.100046 (MainThread): Partial parsing not enabled
2021-11-29 13:28:39.115461 (MainThread): Parsing macros/catalog.sql
2021-11-29 13:28:39.118048 (MainThread): Parsing macros/adapters.sql
2021-11-29 13:28:39.126523 (MainThread): Parsing macros/materializations/seed.sql
2021-11-29 13:28:39.129575 (MainThread): Parsing macros/materializations/snapshot.sql
2021-11-29 13:28:39.130489 (MainThread): Parsing macros/materializations/table.sql
2021-11-29 13:28:39.133213 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-29 13:28:39.145901 (MainThread): Parsing macros/materializations/view.sql
2021-11-29 13:28:39.149618 (MainThread): Parsing macros/core.sql
2021-11-29 13:28:39.152661 (MainThread): Parsing macros/materializations/test.sql
2021-11-29 13:28:39.156981 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-29 13:28:39.162801 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-29 13:28:39.166390 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-29 13:28:39.171083 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-29 13:28:39.173050 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-29 13:28:39.180606 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-29 13:28:39.191570 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-29 13:28:39.203996 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-29 13:28:39.208892 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-29 13:28:39.217539 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-29 13:28:39.233607 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-29 13:28:39.243630 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-29 13:28:39.245777 (MainThread): Parsing macros/etc/query.sql
2021-11-29 13:28:39.248595 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-29 13:28:39.252414 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-29 13:28:39.255602 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-29 13:28:39.259935 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-29 13:28:39.262277 (MainThread): Parsing macros/etc/datetime.sql
2021-11-29 13:28:39.268277 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-29 13:28:39.271331 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-29 13:28:39.274963 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-29 13:28:39.276336 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-29 13:28:39.278361 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-29 13:28:39.280825 (MainThread): Parsing macros/adapters/common.sql
2021-11-29 13:28:39.390515 (MainThread): Acquiring new athena connection "model.my_new_project.test_model1".
2021-11-29 13:28:39.399216 (MainThread): Acquiring new athena connection "model.my_new_project.test_model2".
2021-11-29 13:28:39.402717 (MainThread): Acquiring new athena connection "model.my_new_project.test_model3".
2021-11-29 13:28:39.406681 (MainThread): Acquiring new athena connection "model.my_new_project.test_model4".
2021-11-29 13:28:39.409627 (MainThread): Acquiring new athena connection "model.my_new_project.test_model5".
2021-11-29 13:28:39.433586 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-11-29 13:28:39.437498 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a79d3ceb-b4b1-4178-af78-fb82bc535839', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97293400>]}
2021-11-29 13:28:39.457525 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-11-29 13:28:39.460628 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a79d3ceb-b4b1-4178-af78-fb82bc535839', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff972f5b50>]}
2021-11-29 13:28:39.461782 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 1 seed file, 0 sources, 0 exposures
2021-11-29 13:28:39.464131 (MainThread): 
2021-11-29 13:28:39.465441 (MainThread): Acquiring new athena connection "master".
2021-11-29 13:28:39.468671 (ThreadPoolExecutor-0_0): Acquiring new athena connection "list_awsdatacatalog".
2021-11-29 13:28:39.476505 (ThreadPoolExecutor-0_0): Using athena connection "list_awsdatacatalog".
2021-11-29 13:28:39.477669 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
  
2021-11-29 13:28:39.479428 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-29 13:28:39.512702 (ThreadPoolExecutor-0_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
2021-11-29 13:28:41.355015 (ThreadPoolExecutor-0_0): SQL status: OK -1 in 1.88 seconds
2021-11-29 13:28:41.360572 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: Close
2021-11-29 13:28:41.369195 (ThreadPoolExecutor-2_0): Acquiring new athena connection "list_awsdatacatalog_dbt".
2021-11-29 13:28:41.372123 (ThreadPoolExecutor-2_0): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 40738), raddr=('3.219.162.41', 443)>
2021-11-29 13:28:41.382463 (ThreadPoolExecutor-2_0): Using athena connection "list_awsdatacatalog_dbt".
2021-11-29 13:28:41.383665 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
2021-11-29 13:28:41.386854 (ThreadPoolExecutor-2_0): Opening a new connection, currently in state closed
2021-11-29 13:28:41.411593 (ThreadPoolExecutor-2_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
2021-11-29 13:28:44.270828 (ThreadPoolExecutor-2_0): SQL status: OK -1 in 2.88 seconds
2021-11-29 13:28:44.279238 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: Close
2021-11-29 13:28:44.287596 (MainThread): 13:28:44 | Concurrency: 1 threads (target='dev')
2021-11-29 13:28:44.295496 (MainThread): 13:28:44 | 
2021-11-29 13:28:44.304516 (Thread-1): Began running node model.my_new_project.test_model1
2021-11-29 13:28:44.306490 (Thread-1): 13:28:44 | 1 of 5 START view model dbt.test_model1.............................. [RUN]
2021-11-29 13:28:44.313372 (Thread-1): Acquiring new athena connection "model.my_new_project.test_model1".
2021-11-29 13:28:44.315468 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 40740), raddr=('3.219.162.41', 443)>
2021-11-29 13:28:44.319158 (Thread-1): Compiling model.my_new_project.test_model1
2021-11-29 13:28:44.324099 (Thread-1): Writing injected SQL for node "model.my_new_project.test_model1"
2021-11-29 13:28:44.335042 (Thread-1): finished collecting timing info
2021-11-29 13:28:44.350533 (Thread-1): Writing runtime SQL for node "model.my_new_project.test_model1"
2021-11-29 13:28:44.356612 (Thread-1): Using athena connection "model.my_new_project.test_model1".
2021-11-29 13:28:44.357426 (Thread-1): On model.my_new_project.test_model1: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    With sample_buildings as (
    SELECT 
        bldg_id,
        city,
        state
    FROM "defaultdb"."sample_buildings" 
    group by 1
)
/*where county='G5500690' */

Select 
    sum(out.electricity.clothes_dryer.energy_consumption),
    bldg_id
from "defaultdb"."resby_puma_northeast"


left join sample_buildings  using (bldg_id)

2021-11-29 13:28:44.358811 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 13:28:44.374813 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    With sample_buildings as (
    SELECT 
        bldg_id,
        city,
        state
    FROM "defaultdb"."sample_buildings" 
    group by 1
)
/*where county='G5500690' */

Select 
    sum(out.electricity.clothes_dryer.energy_consumption),
    bldg_id
from "defaultdb"."resby_puma_northeast"


left join sample_buildings  using (bldg_id)
2021-11-29 13:28:45.852041 (Thread-1): Error running SQL: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    With sample_buildings as (
    SELECT 
        bldg_id,
        city,
        state
    FROM "defaultdb"."sample_buildings" 
    group by 1
)
/*where county='G5500690' */

Select 
    sum(out.electricity.clothes_dryer.energy_consumption),
    bldg_id
from "defaultdb"."resby_puma_northeast"


left join sample_buildings  using (bldg_id)

2021-11-29 13:28:45.853338 (Thread-1): finished collecting timing info
2021-11-29 13:28:45.855630 (Thread-1): On model.my_new_project.test_model1: Close
2021-11-29 13:28:45.857438 (Thread-1): Runtime Error in model test_model1 (models/test_model1.sql)
  com.facebook.presto.v217.sql.analyzer.SemanticException: line 10:10: Table 459120389451.defaultdb.sample_buildings does not exist
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 100, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 90, in execute
    raise OperationalError(query_execution.state_change_reason)
pyathena.error.OperationalError: com.facebook.presto.v217.sql.analyzer.SemanticException: line 10:10: Table 459120389451.defaultdb.sample_buildings does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 66, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 103, in exception_handler
    raise RuntimeException(str(e)) from e
dbt.exceptions.RuntimeException: Runtime Error in model test_model1 (models/test_model1.sql)
  com.facebook.presto.v217.sql.analyzer.SemanticException: line 10:10: Table 459120389451.defaultdb.sample_buildings does not exist
2021-11-29 13:28:45.864008 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a79d3ceb-b4b1-4178-af78-fb82bc535839', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9681e8b0>]}
2021-11-29 13:28:45.866663 (Thread-1): 13:28:45 | 1 of 5 ERROR creating view model dbt.test_model1..................... [ERROR in 1.55s]
2021-11-29 13:28:45.868695 (Thread-1): Finished running node model.my_new_project.test_model1
2021-11-29 13:28:45.870182 (Thread-1): Began running node model.my_new_project.test_model2
2021-11-29 13:28:45.873011 (Thread-1): 13:28:45 | 2 of 5 START view model dbt.test_model2.............................. [RUN]
2021-11-29 13:28:45.874677 (Thread-1): Acquiring new athena connection "model.my_new_project.test_model2".
2021-11-29 13:28:45.876894 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 40742), raddr=('3.219.162.41', 443)>
2021-11-29 13:28:45.879963 (Thread-1): Compiling model.my_new_project.test_model2
2021-11-29 13:28:45.883410 (Thread-1): Writing injected SQL for node "model.my_new_project.test_model2"
2021-11-29 13:28:45.889195 (Thread-1): finished collecting timing info
2021-11-29 13:28:45.892579 (Thread-1): Writing runtime SQL for node "model.my_new_project.test_model2"
2021-11-29 13:28:45.899996 (Thread-1): Using athena connection "model.my_new_project.test_model2".
2021-11-29 13:28:45.901024 (Thread-1): On model.my_new_project.test_model2: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    /*
from somewhere - get bldg_id and zip code --> bldg_locations
*/

2021-11-29 13:28:45.902845 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 13:28:45.923500 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    /*
from somewhere - get bldg_id and zip code --> bldg_locations
*/
2021-11-29 13:28:46.172564 (Thread-1): Failed to execute query.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 307, in _execute
    query_id = retry_api_call(
  File "/usr/local/lib/python3.8/site-packages/pyathena/util.py", line 84, in retry_api_call
    return retry(func, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 404, in __call__
    do = self.iter(retry_state=retry_state)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 349, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 407, in __call__
    result = fn(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 276, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 586, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
2021-11-29 13:28:46.174684 (Thread-1): Error running SQL: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    /*
from somewhere - get bldg_id and zip code --> bldg_locations
*/

2021-11-29 13:28:46.176980 (Thread-1): finished collecting timing info
2021-11-29 13:28:46.178854 (Thread-1): On model.my_new_project.test_model2: Close
2021-11-29 13:28:46.180648 (Thread-1): Runtime Error in model test_model2 (models/test_model2.sql)
  An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 307, in _execute
    query_id = retry_api_call(
  File "/usr/local/lib/python3.8/site-packages/pyathena/util.py", line 84, in retry_api_call
    return retry(func, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 404, in __call__
    do = self.iter(retry_state=retry_state)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 349, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 407, in __call__
    result = fn(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 276, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 586, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 100, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 72, in execute
    query_id = self._execute(
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 315, in _execute
    raise DatabaseError(*e.args) from e
pyathena.error.DatabaseError: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 66, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 103, in exception_handler
    raise RuntimeException(str(e)) from e
dbt.exceptions.RuntimeException: Runtime Error in model test_model2 (models/test_model2.sql)
  An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
2021-11-29 13:28:46.183059 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a79d3ceb-b4b1-4178-af78-fb82bc535839', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94b8dfd0>]}
2021-11-29 13:28:46.184822 (Thread-1): 13:28:46 | 2 of 5 ERROR creating view model dbt.test_model2..................... [ERROR in 0.31s]
2021-11-29 13:28:46.186836 (Thread-1): Finished running node model.my_new_project.test_model2
2021-11-29 13:28:46.189184 (Thread-1): Began running node model.my_new_project.test_model3
2021-11-29 13:28:46.190436 (Thread-1): 13:28:46 | 3 of 5 SKIP relation dbt.test_model3................................. [SKIP]
2021-11-29 13:28:46.192185 (Thread-1): Finished running node model.my_new_project.test_model3
2021-11-29 13:28:46.194065 (Thread-1): Began running node model.my_new_project.test_model4
2021-11-29 13:28:46.196510 (Thread-1): 13:28:46 | 4 of 5 SKIP relation dbt.test_model4................................. [SKIP]
2021-11-29 13:28:46.200563 (Thread-1): Finished running node model.my_new_project.test_model4
2021-11-29 13:28:46.202915 (Thread-1): Began running node model.my_new_project.test_model5
2021-11-29 13:28:46.204382 (Thread-1): 13:28:46 | 5 of 5 SKIP relation dbt.test_model5................................. [SKIP]
2021-11-29 13:28:46.206871 (Thread-1): Finished running node model.my_new_project.test_model5
2021-11-29 13:28:46.212216 (MainThread): Acquiring new athena connection "master".
2021-11-29 13:28:46.213971 (MainThread): 13:28:46 | 
2021-11-29 13:28:46.215631 (MainThread): 13:28:46 | Finished running 5 view models in 6.75s.
2021-11-29 13:28:46.217477 (MainThread): Connection 'master' was properly closed.
2021-11-29 13:28:46.219530 (MainThread): Connection 'model.my_new_project.test_model2' was properly closed.
2021-11-29 13:28:46.233993 (MainThread): 
2021-11-29 13:28:46.234963 (MainThread): Completed with 2 errors and 0 warnings:
2021-11-29 13:28:46.237994 (MainThread): 
2021-11-29 13:28:46.241159 (MainThread): Runtime Error in model test_model1 (models/test_model1.sql)
2021-11-29 13:28:46.243222 (MainThread):   com.facebook.presto.v217.sql.analyzer.SemanticException: line 10:10: Table 459120389451.defaultdb.sample_buildings does not exist
2021-11-29 13:28:46.245370 (MainThread): 
2021-11-29 13:28:46.247205 (MainThread): Runtime Error in model test_model2 (models/test_model2.sql)
2021-11-29 13:28:46.249347 (MainThread):   An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
2021-11-29 13:28:46.251477 (MainThread): 
Done. PASS=0 WARN=0 ERROR=2 SKIP=3 TOTAL=5
2021-11-29 13:28:46.254273 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97338640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97322430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97381d90>]}
2021-11-29 13:28:46.256401 (MainThread): Flushing usage events
2021-11-29 13:28:58.654803 (MainThread): Running with dbt=0.21.0
2021-11-29 13:28:58.721247 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/vscode/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-29 13:28:58.726538 (MainThread): Tracking: tracking
2021-11-29 13:28:58.729518 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1fdd610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3879be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3879e20>]}
2021-11-29 13:28:58.738014 (MainThread): Partial parsing not enabled
2021-11-29 13:28:58.754762 (MainThread): Parsing macros/catalog.sql
2021-11-29 13:28:58.757414 (MainThread): Parsing macros/adapters.sql
2021-11-29 13:28:58.766702 (MainThread): Parsing macros/materializations/seed.sql
2021-11-29 13:28:58.769869 (MainThread): Parsing macros/materializations/snapshot.sql
2021-11-29 13:28:58.771147 (MainThread): Parsing macros/materializations/table.sql
2021-11-29 13:28:58.774024 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-29 13:28:58.785863 (MainThread): Parsing macros/materializations/view.sql
2021-11-29 13:28:58.790138 (MainThread): Parsing macros/core.sql
2021-11-29 13:28:58.793054 (MainThread): Parsing macros/materializations/test.sql
2021-11-29 13:28:58.797494 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-29 13:28:58.803576 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-29 13:28:58.806893 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-29 13:28:58.811275 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-29 13:28:58.813496 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-29 13:28:58.819219 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-29 13:28:58.830032 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-29 13:28:58.842243 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-29 13:28:58.846697 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-29 13:28:58.854586 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-29 13:28:58.871584 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-29 13:28:58.881519 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-29 13:28:58.883352 (MainThread): Parsing macros/etc/query.sql
2021-11-29 13:28:58.884399 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-29 13:28:58.886912 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-29 13:28:58.889355 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-29 13:28:58.891267 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-29 13:28:58.893442 (MainThread): Parsing macros/etc/datetime.sql
2021-11-29 13:28:58.898565 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-29 13:28:58.900022 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-29 13:28:58.902970 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-29 13:28:58.904330 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-29 13:28:58.907015 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-29 13:28:58.909094 (MainThread): Parsing macros/adapters/common.sql
2021-11-29 13:28:59.014992 (MainThread): Acquiring new athena connection "model.my_new_project.test_model1".
2021-11-29 13:28:59.023401 (MainThread): Acquiring new athena connection "model.my_new_project.test_model2".
2021-11-29 13:28:59.027319 (MainThread): 1699: statically parsed test_model3.sql
2021-11-29 13:28:59.028173 (MainThread): Acquiring new athena connection "model.my_new_project.test_model3".
2021-11-29 13:28:59.032431 (MainThread): Sending event: {'category': 'dbt', 'action': 'experimental_parser', 'label': 'da38ef65-cd05-40ee-92fa-0afe34482f30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1a06550>]}
2021-11-29 13:28:59.033688 (MainThread): Acquiring new athena connection "model.my_new_project.test_model4".
2021-11-29 13:28:59.037245 (MainThread): Acquiring new athena connection "model.my_new_project.test_model5".
2021-11-29 13:28:59.059051 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-11-29 13:28:59.063764 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da38ef65-cd05-40ee-92fa-0afe34482f30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa19dd3d0>]}
2021-11-29 13:28:59.077455 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-11-29 13:28:59.079062 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da38ef65-cd05-40ee-92fa-0afe34482f30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1a3e490>]}
2021-11-29 13:28:59.080030 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 1 seed file, 0 sources, 0 exposures
2021-11-29 13:28:59.083079 (MainThread): 
2021-11-29 13:28:59.083985 (MainThread): Acquiring new athena connection "master".
2021-11-29 13:28:59.086625 (ThreadPoolExecutor-0_0): Acquiring new athena connection "list_awsdatacatalog".
2021-11-29 13:28:59.095554 (ThreadPoolExecutor-0_0): Using athena connection "list_awsdatacatalog".
2021-11-29 13:28:59.096556 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
  
2021-11-29 13:28:59.098462 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-29 13:28:59.118693 (ThreadPoolExecutor-0_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
2021-11-29 13:29:00.914652 (ThreadPoolExecutor-0_0): SQL status: OK -1 in 1.82 seconds
2021-11-29 13:29:00.921063 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: Close
2021-11-29 13:29:00.932314 (ThreadPoolExecutor-2_0): Acquiring new athena connection "list_awsdatacatalog_dbt".
2021-11-29 13:29:00.935485 (ThreadPoolExecutor-2_0): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 40748), raddr=('3.219.162.41', 443)>
2021-11-29 13:29:00.952635 (ThreadPoolExecutor-2_0): Using athena connection "list_awsdatacatalog_dbt".
2021-11-29 13:29:00.954458 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
2021-11-29 13:29:00.959707 (ThreadPoolExecutor-2_0): Opening a new connection, currently in state closed
2021-11-29 13:29:00.989390 (ThreadPoolExecutor-2_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
2021-11-29 13:29:03.820494 (ThreadPoolExecutor-2_0): SQL status: OK -1 in 2.86 seconds
2021-11-29 13:29:03.829027 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: Close
2021-11-29 13:29:03.834694 (MainThread): 13:29:03 | Concurrency: 1 threads (target='dev')
2021-11-29 13:29:03.838453 (MainThread): 13:29:03 | 
2021-11-29 13:29:03.851618 (Thread-1): Began running node model.my_new_project.test_model1
2021-11-29 13:29:03.854450 (Thread-1): 13:29:03 | 1 of 5 START view model dbt.test_model1.............................. [RUN]
2021-11-29 13:29:03.863023 (Thread-1): Acquiring new athena connection "model.my_new_project.test_model1".
2021-11-29 13:29:03.867097 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 40750), raddr=('3.219.162.41', 443)>
2021-11-29 13:29:03.870308 (Thread-1): Compiling model.my_new_project.test_model1
2021-11-29 13:29:03.874532 (Thread-1): Writing injected SQL for node "model.my_new_project.test_model1"
2021-11-29 13:29:03.884213 (Thread-1): finished collecting timing info
2021-11-29 13:29:03.898456 (Thread-1): Writing runtime SQL for node "model.my_new_project.test_model1"
2021-11-29 13:29:03.903344 (Thread-1): Using athena connection "model.my_new_project.test_model1".
2021-11-29 13:29:03.904174 (Thread-1): On model.my_new_project.test_model1: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    With sample_buildings as (
    SELECT 
        bldg_id,
        city,
        state
    FROM "defaultdb"."buildings" 
    group by 1
)
/*where county='G5500690' */

Select 
    sum(out.electricity.clothes_dryer.energy_consumption),
    bldg_id
from "defaultdb"."resby_puma_northeast"


left join sample_buildings  using (bldg_id)

2021-11-29 13:29:03.906112 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 13:29:03.922624 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    With sample_buildings as (
    SELECT 
        bldg_id,
        city,
        state
    FROM "defaultdb"."buildings" 
    group by 1
)
/*where county='G5500690' */

Select 
    sum(out.electricity.clothes_dryer.energy_consumption),
    bldg_id
from "defaultdb"."resby_puma_northeast"


left join sample_buildings  using (bldg_id)
2021-11-29 13:29:05.451204 (Thread-1): Error running SQL: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    With sample_buildings as (
    SELECT 
        bldg_id,
        city,
        state
    FROM "defaultdb"."buildings" 
    group by 1
)
/*where county='G5500690' */

Select 
    sum(out.electricity.clothes_dryer.energy_consumption),
    bldg_id
from "defaultdb"."resby_puma_northeast"


left join sample_buildings  using (bldg_id)

2021-11-29 13:29:05.453935 (Thread-1): finished collecting timing info
2021-11-29 13:29:05.457511 (Thread-1): On model.my_new_project.test_model1: Close
2021-11-29 13:29:05.462184 (Thread-1): Runtime Error in model test_model1 (models/test_model1.sql)
  com.facebook.presto.v217.sql.analyzer.SemanticException: line 7:9: Column 'bldg_id' cannot be resolved
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 100, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 90, in execute
    raise OperationalError(query_execution.state_change_reason)
pyathena.error.OperationalError: com.facebook.presto.v217.sql.analyzer.SemanticException: line 7:9: Column 'bldg_id' cannot be resolved

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 66, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 103, in exception_handler
    raise RuntimeException(str(e)) from e
dbt.exceptions.RuntimeException: Runtime Error in model test_model1 (models/test_model1.sql)
  com.facebook.presto.v217.sql.analyzer.SemanticException: line 7:9: Column 'bldg_id' cannot be resolved
2021-11-29 13:29:05.466921 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da38ef65-cd05-40ee-92fa-0afe34482f30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa07648b0>]}
2021-11-29 13:29:05.470374 (Thread-1): 13:29:05 | 1 of 5 ERROR creating view model dbt.test_model1..................... [ERROR in 1.60s]
2021-11-29 13:29:05.473251 (Thread-1): Finished running node model.my_new_project.test_model1
2021-11-29 13:29:05.475600 (Thread-1): Began running node model.my_new_project.test_model2
2021-11-29 13:29:05.478243 (Thread-1): 13:29:05 | 2 of 5 START view model dbt.test_model2.............................. [RUN]
2021-11-29 13:29:05.482305 (Thread-1): Acquiring new athena connection "model.my_new_project.test_model2".
2021-11-29 13:29:05.483335 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 40752), raddr=('3.219.162.41', 443)>
2021-11-29 13:29:05.485397 (Thread-1): Compiling model.my_new_project.test_model2
2021-11-29 13:29:05.488829 (Thread-1): Writing injected SQL for node "model.my_new_project.test_model2"
2021-11-29 13:29:05.493900 (Thread-1): finished collecting timing info
2021-11-29 13:29:05.497127 (Thread-1): Writing runtime SQL for node "model.my_new_project.test_model2"
2021-11-29 13:29:05.501416 (Thread-1): Using athena connection "model.my_new_project.test_model2".
2021-11-29 13:29:05.503001 (Thread-1): On model.my_new_project.test_model2: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    /*
from somewhere - get bldg_id and zip code --> bldg_locations
*/

2021-11-29 13:29:05.504459 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 13:29:05.520987 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    /*
from somewhere - get bldg_id and zip code --> bldg_locations
*/
2021-11-29 13:29:05.765679 (Thread-1): Failed to execute query.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 307, in _execute
    query_id = retry_api_call(
  File "/usr/local/lib/python3.8/site-packages/pyathena/util.py", line 84, in retry_api_call
    return retry(func, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 404, in __call__
    do = self.iter(retry_state=retry_state)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 349, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 407, in __call__
    result = fn(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 276, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 586, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
2021-11-29 13:29:05.771639 (Thread-1): Error running SQL: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    /*
from somewhere - get bldg_id and zip code --> bldg_locations
*/

2021-11-29 13:29:05.777620 (Thread-1): finished collecting timing info
2021-11-29 13:29:05.785968 (Thread-1): On model.my_new_project.test_model2: Close
2021-11-29 13:29:05.788517 (Thread-1): Runtime Error in model test_model2 (models/test_model2.sql)
  An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 307, in _execute
    query_id = retry_api_call(
  File "/usr/local/lib/python3.8/site-packages/pyathena/util.py", line 84, in retry_api_call
    return retry(func, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 404, in __call__
    do = self.iter(retry_state=retry_state)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 349, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 407, in __call__
    result = fn(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 276, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 586, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 100, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 72, in execute
    query_id = self._execute(
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 315, in _execute
    raise DatabaseError(*e.args) from e
pyathena.error.DatabaseError: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 66, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 103, in exception_handler
    raise RuntimeException(str(e)) from e
dbt.exceptions.RuntimeException: Runtime Error in model test_model2 (models/test_model2.sql)
  An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
2021-11-29 13:29:05.794342 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da38ef65-cd05-40ee-92fa-0afe34482f30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa02d7fd0>]}
2021-11-29 13:29:05.796913 (Thread-1): 13:29:05 | 2 of 5 ERROR creating view model dbt.test_model2..................... [ERROR in 0.31s]
2021-11-29 13:29:05.799448 (Thread-1): Finished running node model.my_new_project.test_model2
2021-11-29 13:29:05.802192 (Thread-1): Began running node model.my_new_project.test_model3
2021-11-29 13:29:05.804369 (Thread-1): 13:29:05 | 3 of 5 SKIP relation dbt.test_model3................................. [SKIP]
2021-11-29 13:29:05.806554 (Thread-1): Finished running node model.my_new_project.test_model3
2021-11-29 13:29:05.810105 (Thread-1): Began running node model.my_new_project.test_model4
2021-11-29 13:29:05.811919 (Thread-1): 13:29:05 | 4 of 5 SKIP relation dbt.test_model4................................. [SKIP]
2021-11-29 13:29:05.813994 (Thread-1): Finished running node model.my_new_project.test_model4
2021-11-29 13:29:05.817981 (Thread-1): Began running node model.my_new_project.test_model5
2021-11-29 13:29:05.819876 (Thread-1): 13:29:05 | 5 of 5 SKIP relation dbt.test_model5................................. [SKIP]
2021-11-29 13:29:05.822140 (Thread-1): Finished running node model.my_new_project.test_model5
2021-11-29 13:29:05.824347 (MainThread): Acquiring new athena connection "master".
2021-11-29 13:29:05.826193 (MainThread): 13:29:05 | 
2021-11-29 13:29:05.830677 (MainThread): 13:29:05 | Finished running 5 view models in 6.74s.
2021-11-29 13:29:05.832483 (MainThread): Connection 'master' was properly closed.
2021-11-29 13:29:05.834584 (MainThread): Connection 'model.my_new_project.test_model2' was properly closed.
2021-11-29 13:29:05.850632 (MainThread): 
2021-11-29 13:29:05.851598 (MainThread): Completed with 2 errors and 0 warnings:
2021-11-29 13:29:05.852881 (MainThread): 
2021-11-29 13:29:05.854885 (MainThread): Runtime Error in model test_model1 (models/test_model1.sql)
2021-11-29 13:29:05.857317 (MainThread):   com.facebook.presto.v217.sql.analyzer.SemanticException: line 7:9: Column 'bldg_id' cannot be resolved
2021-11-29 13:29:05.859586 (MainThread): 
2021-11-29 13:29:05.862334 (MainThread): Runtime Error in model test_model2 (models/test_model2.sql)
2021-11-29 13:29:05.865990 (MainThread):   An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
2021-11-29 13:29:05.870076 (MainThread): 
Done. PASS=0 WARN=0 ERROR=2 SKIP=3 TOTAL=5
2021-11-29 13:29:05.873369 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1ac40a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa119afd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3819e80>]}
2021-11-29 13:29:05.876121 (MainThread): Flushing usage events
2021-11-29 13:29:54.168052 (MainThread): Running with dbt=0.21.0
2021-11-29 13:29:54.248987 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/vscode/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-29 13:29:54.255007 (MainThread): Tracking: tracking
2021-11-29 13:29:54.258180 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88293610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89b2fcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89b2fe20>]}
2021-11-29 13:29:54.267682 (MainThread): Partial parsing not enabled
2021-11-29 13:29:54.282958 (MainThread): Parsing macros/catalog.sql
2021-11-29 13:29:54.285612 (MainThread): Parsing macros/adapters.sql
2021-11-29 13:29:54.294020 (MainThread): Parsing macros/materializations/seed.sql
2021-11-29 13:29:54.297146 (MainThread): Parsing macros/materializations/snapshot.sql
2021-11-29 13:29:54.298314 (MainThread): Parsing macros/materializations/table.sql
2021-11-29 13:29:54.301465 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-29 13:29:54.314760 (MainThread): Parsing macros/materializations/view.sql
2021-11-29 13:29:54.318348 (MainThread): Parsing macros/core.sql
2021-11-29 13:29:54.322167 (MainThread): Parsing macros/materializations/test.sql
2021-11-29 13:29:54.326397 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-29 13:29:54.332049 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-29 13:29:54.335208 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-29 13:29:54.339684 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-29 13:29:54.343322 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-29 13:29:54.349344 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-29 13:29:54.362687 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-29 13:29:54.375351 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-29 13:29:54.380048 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-29 13:29:54.389475 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-29 13:29:54.406460 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-29 13:29:54.416134 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-29 13:29:54.418031 (MainThread): Parsing macros/etc/query.sql
2021-11-29 13:29:54.420054 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-29 13:29:54.422978 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-29 13:29:54.424647 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-29 13:29:54.427064 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-29 13:29:54.428484 (MainThread): Parsing macros/etc/datetime.sql
2021-11-29 13:29:54.434217 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-29 13:29:54.436452 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-29 13:29:54.438389 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-29 13:29:54.440532 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-29 13:29:54.442593 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-29 13:29:54.444247 (MainThread): Parsing macros/adapters/common.sql
2021-11-29 13:29:54.553300 (MainThread): Acquiring new athena connection "model.my_new_project.test_model1".
2021-11-29 13:29:54.560814 (MainThread): Acquiring new athena connection "model.my_new_project.test_model2".
2021-11-29 13:29:54.563223 (MainThread): Acquiring new athena connection "model.my_new_project.test_model3".
2021-11-29 13:29:54.566773 (MainThread): Acquiring new athena connection "model.my_new_project.test_model4".
2021-11-29 13:29:54.570729 (MainThread): Acquiring new athena connection "model.my_new_project.test_model5".
2021-11-29 13:29:54.597390 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-11-29 13:29:54.601412 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ed35d4b5-9c95-4322-ab80-f5c1f58736f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87c930a0>]}
2021-11-29 13:29:54.613695 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-11-29 13:29:54.615326 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ed35d4b5-9c95-4322-ab80-f5c1f58736f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87cf4ee0>]}
2021-11-29 13:29:54.616314 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 1 seed file, 0 sources, 0 exposures
2021-11-29 13:29:54.620667 (MainThread): 
2021-11-29 13:29:54.621370 (MainThread): Acquiring new athena connection "master".
2021-11-29 13:29:54.625219 (ThreadPoolExecutor-0_0): Acquiring new athena connection "list_awsdatacatalog".
2021-11-29 13:29:54.632438 (ThreadPoolExecutor-0_0): Using athena connection "list_awsdatacatalog".
2021-11-29 13:29:54.633433 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
  
2021-11-29 13:29:54.635529 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-29 13:29:54.666532 (ThreadPoolExecutor-0_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
2021-11-29 13:29:56.477275 (ThreadPoolExecutor-0_0): SQL status: OK -1 in 1.84 seconds
2021-11-29 13:29:56.486226 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: Close
2021-11-29 13:29:56.496866 (ThreadPoolExecutor-2_0): Acquiring new athena connection "list_awsdatacatalog_dbt".
2021-11-29 13:29:56.500326 (ThreadPoolExecutor-2_0): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 40758), raddr=('3.219.162.41', 443)>
2021-11-29 13:29:56.514466 (ThreadPoolExecutor-2_0): Using athena connection "list_awsdatacatalog_dbt".
2021-11-29 13:29:56.516157 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
2021-11-29 13:29:56.524813 (ThreadPoolExecutor-2_0): Opening a new connection, currently in state closed
2021-11-29 13:29:56.550456 (ThreadPoolExecutor-2_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
2021-11-29 13:29:59.578037 (ThreadPoolExecutor-2_0): SQL status: OK -1 in 3.05 seconds
2021-11-29 13:29:59.589521 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: Close
2021-11-29 13:29:59.597415 (MainThread): 13:29:59 | Concurrency: 1 threads (target='dev')
2021-11-29 13:29:59.600210 (MainThread): 13:29:59 | 
2021-11-29 13:29:59.612164 (Thread-1): Began running node model.my_new_project.test_model1
2021-11-29 13:29:59.614273 (Thread-1): 13:29:59 | 1 of 5 START view model dbt.test_model1.............................. [RUN]
2021-11-29 13:29:59.619380 (Thread-1): Acquiring new athena connection "model.my_new_project.test_model1".
2021-11-29 13:29:59.622811 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 40760), raddr=('3.219.162.41', 443)>
2021-11-29 13:29:59.629090 (Thread-1): Compiling model.my_new_project.test_model1
2021-11-29 13:29:59.633288 (Thread-1): Writing injected SQL for node "model.my_new_project.test_model1"
2021-11-29 13:29:59.645566 (Thread-1): finished collecting timing info
2021-11-29 13:29:59.660771 (Thread-1): Writing runtime SQL for node "model.my_new_project.test_model1"
2021-11-29 13:29:59.666079 (Thread-1): Using athena connection "model.my_new_project.test_model1".
2021-11-29 13:29:59.666979 (Thread-1): On model.my_new_project.test_model1: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    With sample_buildings as (
    SELECT 
        bldg_fid,
        city,
        state
    FROM "defaultdb"."buildings" 
    group by 1
)
/*where county='G5500690' */

Select 
    sum(out.electricity.clothes_dryer.energy_consumption),
    bldg_id
from "defaultdb"."resby_puma_northeast"


left join sample_buildings  using (bldg_id)

2021-11-29 13:29:59.668853 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 13:29:59.685526 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    With sample_buildings as (
    SELECT 
        bldg_fid,
        city,
        state
    FROM "defaultdb"."buildings" 
    group by 1
)
/*where county='G5500690' */

Select 
    sum(out.electricity.clothes_dryer.energy_consumption),
    bldg_id
from "defaultdb"."resby_puma_northeast"


left join sample_buildings  using (bldg_id)
2021-11-29 13:30:01.316025 (Thread-1): Error running SQL: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    With sample_buildings as (
    SELECT 
        bldg_fid,
        city,
        state
    FROM "defaultdb"."buildings" 
    group by 1
)
/*where county='G5500690' */

Select 
    sum(out.electricity.clothes_dryer.energy_consumption),
    bldg_id
from "defaultdb"."resby_puma_northeast"


left join sample_buildings  using (bldg_id)

2021-11-29 13:30:01.319765 (Thread-1): finished collecting timing info
2021-11-29 13:30:01.324463 (Thread-1): On model.my_new_project.test_model1: Close
2021-11-29 13:30:01.328412 (Thread-1): Runtime Error in model test_model1 (models/test_model1.sql)
  com.facebook.presto.v217.sql.analyzer.SemanticException: line 8:9: 'city' must be an aggregate expression or appear in GROUP BY clause
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 100, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 90, in execute
    raise OperationalError(query_execution.state_change_reason)
pyathena.error.OperationalError: com.facebook.presto.v217.sql.analyzer.SemanticException: line 8:9: 'city' must be an aggregate expression or appear in GROUP BY clause

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 66, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 103, in exception_handler
    raise RuntimeException(str(e)) from e
dbt.exceptions.RuntimeException: Runtime Error in model test_model1 (models/test_model1.sql)
  com.facebook.presto.v217.sql.analyzer.SemanticException: line 8:9: 'city' must be an aggregate expression or appear in GROUP BY clause
2021-11-29 13:30:01.336372 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed35d4b5-9c95-4322-ab80-f5c1f58736f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8721e8b0>]}
2021-11-29 13:30:01.339637 (Thread-1): 13:30:01 | 1 of 5 ERROR creating view model dbt.test_model1..................... [ERROR in 1.72s]
2021-11-29 13:30:01.342658 (Thread-1): Finished running node model.my_new_project.test_model1
2021-11-29 13:30:01.345691 (Thread-1): Began running node model.my_new_project.test_model2
2021-11-29 13:30:01.348374 (Thread-1): 13:30:01 | 2 of 5 START view model dbt.test_model2.............................. [RUN]
2021-11-29 13:30:01.351341 (Thread-1): Acquiring new athena connection "model.my_new_project.test_model2".
2021-11-29 13:30:01.353461 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 55234), raddr=('3.220.241.22', 443)>
2021-11-29 13:30:01.355755 (Thread-1): Compiling model.my_new_project.test_model2
2021-11-29 13:30:01.361591 (Thread-1): Writing injected SQL for node "model.my_new_project.test_model2"
2021-11-29 13:30:01.366089 (Thread-1): finished collecting timing info
2021-11-29 13:30:01.368705 (Thread-1): Writing runtime SQL for node "model.my_new_project.test_model2"
2021-11-29 13:30:01.372311 (Thread-1): Using athena connection "model.my_new_project.test_model2".
2021-11-29 13:30:01.373792 (Thread-1): On model.my_new_project.test_model2: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    /*
from somewhere - get bldg_id and zip code --> bldg_locations
*/

2021-11-29 13:30:01.377121 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 13:30:01.393988 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    /*
from somewhere - get bldg_id and zip code --> bldg_locations
*/
2021-11-29 13:30:01.672213 (Thread-1): Failed to execute query.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 307, in _execute
    query_id = retry_api_call(
  File "/usr/local/lib/python3.8/site-packages/pyathena/util.py", line 84, in retry_api_call
    return retry(func, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 404, in __call__
    do = self.iter(retry_state=retry_state)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 349, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 407, in __call__
    result = fn(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 276, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 586, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
2021-11-29 13:30:01.683201 (Thread-1): Error running SQL: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    /*
from somewhere - get bldg_id and zip code --> bldg_locations
*/

2021-11-29 13:30:01.689440 (Thread-1): finished collecting timing info
2021-11-29 13:30:01.694613 (Thread-1): On model.my_new_project.test_model2: Close
2021-11-29 13:30:01.701355 (Thread-1): Runtime Error in model test_model2 (models/test_model2.sql)
  An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 307, in _execute
    query_id = retry_api_call(
  File "/usr/local/lib/python3.8/site-packages/pyathena/util.py", line 84, in retry_api_call
    return retry(func, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 404, in __call__
    do = self.iter(retry_state=retry_state)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 349, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 407, in __call__
    result = fn(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 276, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 586, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 100, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 72, in execute
    query_id = self._execute(
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 315, in _execute
    raise DatabaseError(*e.args) from e
pyathena.error.DatabaseError: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 66, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 103, in exception_handler
    raise RuntimeException(str(e)) from e
dbt.exceptions.RuntimeException: Runtime Error in model test_model2 (models/test_model2.sql)
  An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
2021-11-29 13:30:01.708528 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed35d4b5-9c95-4322-ab80-f5c1f58736f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8558dfd0>]}
2021-11-29 13:30:01.713580 (Thread-1): 13:30:01 | 2 of 5 ERROR creating view model dbt.test_model2..................... [ERROR in 0.36s]
2021-11-29 13:30:01.717199 (Thread-1): Finished running node model.my_new_project.test_model2
2021-11-29 13:30:01.721342 (Thread-1): Began running node model.my_new_project.test_model3
2021-11-29 13:30:01.723402 (Thread-1): 13:30:01 | 3 of 5 SKIP relation dbt.test_model3................................. [SKIP]
2021-11-29 13:30:01.725885 (Thread-1): Finished running node model.my_new_project.test_model3
2021-11-29 13:30:01.728543 (Thread-1): Began running node model.my_new_project.test_model4
2021-11-29 13:30:01.731437 (Thread-1): 13:30:01 | 4 of 5 SKIP relation dbt.test_model4................................. [SKIP]
2021-11-29 13:30:01.734116 (Thread-1): Finished running node model.my_new_project.test_model4
2021-11-29 13:30:01.736882 (Thread-1): Began running node model.my_new_project.test_model5
2021-11-29 13:30:01.739721 (Thread-1): 13:30:01 | 5 of 5 SKIP relation dbt.test_model5................................. [SKIP]
2021-11-29 13:30:01.744892 (Thread-1): Finished running node model.my_new_project.test_model5
2021-11-29 13:30:01.748361 (MainThread): Acquiring new athena connection "master".
2021-11-29 13:30:01.749902 (MainThread): 13:30:01 | 
2021-11-29 13:30:01.751673 (MainThread): 13:30:01 | Finished running 5 view models in 7.13s.
2021-11-29 13:30:01.753691 (MainThread): Connection 'master' was properly closed.
2021-11-29 13:30:01.755626 (MainThread): Connection 'model.my_new_project.test_model2' was properly closed.
2021-11-29 13:30:01.772705 (MainThread): 
2021-11-29 13:30:01.774113 (MainThread): Completed with 2 errors and 0 warnings:
2021-11-29 13:30:01.777090 (MainThread): 
2021-11-29 13:30:01.779223 (MainThread): Runtime Error in model test_model1 (models/test_model1.sql)
2021-11-29 13:30:01.781337 (MainThread):   com.facebook.presto.v217.sql.analyzer.SemanticException: line 8:9: 'city' must be an aggregate expression or appear in GROUP BY clause
2021-11-29 13:30:01.783701 (MainThread): 
2021-11-29 13:30:01.785675 (MainThread): Runtime Error in model test_model2 (models/test_model2.sql)
2021-11-29 13:30:01.787033 (MainThread):   An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
2021-11-29 13:30:01.792257 (MainThread): 
Done. PASS=0 WARN=0 ERROR=2 SKIP=3 TOTAL=5
2021-11-29 13:30:01.794755 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89b4f910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87ccf2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89ad1e20>]}
2021-11-29 13:30:01.797755 (MainThread): Flushing usage events
2021-11-29 13:30:57.215414 (MainThread): Running with dbt=0.21.0
2021-11-29 13:30:57.281574 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/vscode/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-29 13:30:57.287823 (MainThread): Tracking: tracking
2021-11-29 13:30:57.290212 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafdb0910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1645160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1645d60>]}
2021-11-29 13:30:57.300449 (MainThread): Partial parsing not enabled
2021-11-29 13:30:57.315204 (MainThread): Parsing macros/catalog.sql
2021-11-29 13:30:57.318586 (MainThread): Parsing macros/adapters.sql
2021-11-29 13:30:57.327602 (MainThread): Parsing macros/materializations/seed.sql
2021-11-29 13:30:57.331411 (MainThread): Parsing macros/materializations/snapshot.sql
2021-11-29 13:30:57.332797 (MainThread): Parsing macros/materializations/table.sql
2021-11-29 13:30:57.335881 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-29 13:30:57.349264 (MainThread): Parsing macros/materializations/view.sql
2021-11-29 13:30:57.353085 (MainThread): Parsing macros/core.sql
2021-11-29 13:30:57.355836 (MainThread): Parsing macros/materializations/test.sql
2021-11-29 13:30:57.360147 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-29 13:30:57.365658 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-29 13:30:57.368783 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-29 13:30:57.373368 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-29 13:30:57.374829 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-29 13:30:57.381511 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-29 13:30:57.392776 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-29 13:30:57.406283 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-29 13:30:57.410846 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-29 13:30:57.418715 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-29 13:30:57.437348 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-29 13:30:57.446911 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-29 13:30:57.449134 (MainThread): Parsing macros/etc/query.sql
2021-11-29 13:30:57.450670 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-29 13:30:57.453228 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-29 13:30:57.454907 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-29 13:30:57.456272 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-29 13:30:57.458635 (MainThread): Parsing macros/etc/datetime.sql
2021-11-29 13:30:57.463824 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-29 13:30:57.465431 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-29 13:30:57.468004 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-29 13:30:57.469139 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-29 13:30:57.471292 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-29 13:30:57.474240 (MainThread): Parsing macros/adapters/common.sql
2021-11-29 13:30:57.579270 (MainThread): Acquiring new athena connection "model.my_new_project.test_model1".
2021-11-29 13:30:57.586972 (MainThread): 1699: statically parsed test_model2.sql
2021-11-29 13:30:57.587891 (MainThread): Acquiring new athena connection "model.my_new_project.test_model2".
2021-11-29 13:30:57.591185 (MainThread): Sending event: {'category': 'dbt', 'action': 'experimental_parser', 'label': 'c94f132a-6eee-47af-8a90-db63986c9b80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf7f8760>]}
2021-11-29 13:30:57.592629 (MainThread): Acquiring new athena connection "model.my_new_project.test_model3".
2021-11-29 13:30:57.597229 (MainThread): Acquiring new athena connection "model.my_new_project.test_model4".
2021-11-29 13:30:57.599824 (MainThread): Acquiring new athena connection "model.my_new_project.test_model5".
2021-11-29 13:30:57.622979 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-11-29 13:30:57.627330 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c94f132a-6eee-47af-8a90-db63986c9b80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf1a3f10>]}
2021-11-29 13:30:57.639337 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-11-29 13:30:57.641215 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c94f132a-6eee-47af-8a90-db63986c9b80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf1a3e80>]}
2021-11-29 13:30:57.642178 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 1 seed file, 0 sources, 0 exposures
2021-11-29 13:30:57.645177 (MainThread): 
2021-11-29 13:30:57.646212 (MainThread): Acquiring new athena connection "master".
2021-11-29 13:30:57.648944 (ThreadPoolExecutor-0_0): Acquiring new athena connection "list_awsdatacatalog".
2021-11-29 13:30:57.655806 (ThreadPoolExecutor-0_0): Using athena connection "list_awsdatacatalog".
2021-11-29 13:30:57.656436 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
  
2021-11-29 13:30:57.658168 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-29 13:30:57.679354 (ThreadPoolExecutor-0_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
2021-11-29 13:30:59.513018 (ThreadPoolExecutor-0_0): SQL status: OK -1 in 1.85 seconds
2021-11-29 13:30:59.526664 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: Close
2021-11-29 13:30:59.534968 (ThreadPoolExecutor-2_0): Acquiring new athena connection "list_awsdatacatalog_dbt".
2021-11-29 13:30:59.538907 (ThreadPoolExecutor-2_0): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 55242), raddr=('3.220.241.22', 443)>
2021-11-29 13:30:59.552960 (ThreadPoolExecutor-2_0): Using athena connection "list_awsdatacatalog_dbt".
2021-11-29 13:30:59.555231 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
2021-11-29 13:30:59.559441 (ThreadPoolExecutor-2_0): Opening a new connection, currently in state closed
2021-11-29 13:30:59.589017 (ThreadPoolExecutor-2_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
2021-11-29 13:31:03.548997 (ThreadPoolExecutor-2_0): SQL status: OK -1 in 3.99 seconds
2021-11-29 13:31:03.557218 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: Close
2021-11-29 13:31:03.563557 (MainThread): 13:31:03 | Concurrency: 1 threads (target='dev')
2021-11-29 13:31:03.569150 (MainThread): 13:31:03 | 
2021-11-29 13:31:03.582629 (Thread-1): Began running node model.my_new_project.test_model1
2021-11-29 13:31:03.585657 (Thread-1): 13:31:03 | 1 of 5 START view model dbt.test_model1.............................. [RUN]
2021-11-29 13:31:03.591398 (Thread-1): Acquiring new athena connection "model.my_new_project.test_model1".
2021-11-29 13:31:03.596973 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 55244), raddr=('3.220.241.22', 443)>
2021-11-29 13:31:03.601064 (Thread-1): Compiling model.my_new_project.test_model1
2021-11-29 13:31:03.605318 (Thread-1): Writing injected SQL for node "model.my_new_project.test_model1"
2021-11-29 13:31:03.615542 (Thread-1): finished collecting timing info
2021-11-29 13:31:03.629937 (Thread-1): Writing runtime SQL for node "model.my_new_project.test_model1"
2021-11-29 13:31:03.635226 (Thread-1): Using athena connection "model.my_new_project.test_model1".
2021-11-29 13:31:03.636391 (Thread-1): On model.my_new_project.test_model1: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    With sample_buildings as (
    SELECT 
        bldg_fid,
/*        city,*/
        state
    FROM "defaultdb"."buildings" 
    group by 1
)
/*where county='G5500690' */

Select 
    sum(out.electricity.clothes_dryer.energy_consumption),
    bldg_id
from "defaultdb"."resby_puma_northeast"


left join sample_buildings  using (bldg_id)

2021-11-29 13:31:03.638266 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 13:31:03.655427 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    With sample_buildings as (
    SELECT 
        bldg_fid,
/*        city,*/
        state
    FROM "defaultdb"."buildings" 
    group by 1
)
/*where county='G5500690' */

Select 
    sum(out.electricity.clothes_dryer.energy_consumption),
    bldg_id
from "defaultdb"."resby_puma_northeast"


left join sample_buildings  using (bldg_id)
2021-11-29 13:31:05.139435 (Thread-1): Error running SQL: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    With sample_buildings as (
    SELECT 
        bldg_fid,
/*        city,*/
        state
    FROM "defaultdb"."buildings" 
    group by 1
)
/*where county='G5500690' */

Select 
    sum(out.electricity.clothes_dryer.energy_consumption),
    bldg_id
from "defaultdb"."resby_puma_northeast"


left join sample_buildings  using (bldg_id)

2021-11-29 13:31:05.140655 (Thread-1): finished collecting timing info
2021-11-29 13:31:05.143035 (Thread-1): On model.my_new_project.test_model1: Close
2021-11-29 13:31:05.145453 (Thread-1): Runtime Error in model test_model1 (models/test_model1.sql)
  com.facebook.presto.v217.sql.analyzer.SemanticException: line 9:9: 'state' must be an aggregate expression or appear in GROUP BY clause
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 100, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 90, in execute
    raise OperationalError(query_execution.state_change_reason)
pyathena.error.OperationalError: com.facebook.presto.v217.sql.analyzer.SemanticException: line 9:9: 'state' must be an aggregate expression or appear in GROUP BY clause

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 66, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 103, in exception_handler
    raise RuntimeException(str(e)) from e
dbt.exceptions.RuntimeException: Runtime Error in model test_model1 (models/test_model1.sql)
  com.facebook.presto.v217.sql.analyzer.SemanticException: line 9:9: 'state' must be an aggregate expression or appear in GROUP BY clause
2021-11-29 13:31:05.149091 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c94f132a-6eee-47af-8a90-db63986c9b80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae72b7c0>]}
2021-11-29 13:31:05.150458 (Thread-1): 13:31:05 | 1 of 5 ERROR creating view model dbt.test_model1..................... [ERROR in 1.56s]
2021-11-29 13:31:05.152067 (Thread-1): Finished running node model.my_new_project.test_model1
2021-11-29 13:31:05.153663 (Thread-1): Began running node model.my_new_project.test_model2
2021-11-29 13:31:05.155596 (Thread-1): 13:31:05 | 2 of 5 START view model dbt.test_model2.............................. [RUN]
2021-11-29 13:31:05.159158 (Thread-1): Acquiring new athena connection "model.my_new_project.test_model2".
2021-11-29 13:31:05.159896 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 55246), raddr=('3.220.241.22', 443)>
2021-11-29 13:31:05.161542 (Thread-1): Compiling model.my_new_project.test_model2
2021-11-29 13:31:05.179101 (Thread-1): Writing injected SQL for node "model.my_new_project.test_model2"
2021-11-29 13:31:05.189395 (Thread-1): finished collecting timing info
2021-11-29 13:31:05.192847 (Thread-1): Writing runtime SQL for node "model.my_new_project.test_model2"
2021-11-29 13:31:05.196824 (Thread-1): Using athena connection "model.my_new_project.test_model2".
2021-11-29 13:31:05.197499 (Thread-1): On model.my_new_project.test_model2: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    /*
from somewhere - get bldg_id and zip code --> bldg_locations
*/

2021-11-29 13:31:05.199929 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 13:31:05.216401 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    /*
from somewhere - get bldg_id and zip code --> bldg_locations
*/
2021-11-29 13:31:05.470683 (Thread-1): Failed to execute query.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 307, in _execute
    query_id = retry_api_call(
  File "/usr/local/lib/python3.8/site-packages/pyathena/util.py", line 84, in retry_api_call
    return retry(func, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 404, in __call__
    do = self.iter(retry_state=retry_state)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 349, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 407, in __call__
    result = fn(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 276, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 586, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
2021-11-29 13:31:05.473795 (Thread-1): Error running SQL: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    /*
from somewhere - get bldg_id and zip code --> bldg_locations
*/

2021-11-29 13:31:05.479315 (Thread-1): finished collecting timing info
2021-11-29 13:31:05.483074 (Thread-1): On model.my_new_project.test_model2: Close
2021-11-29 13:31:05.486076 (Thread-1): Runtime Error in model test_model2 (models/test_model2.sql)
  An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 307, in _execute
    query_id = retry_api_call(
  File "/usr/local/lib/python3.8/site-packages/pyathena/util.py", line 84, in retry_api_call
    return retry(func, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 404, in __call__
    do = self.iter(retry_state=retry_state)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 349, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 407, in __call__
    result = fn(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 276, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 586, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 100, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 72, in execute
    query_id = self._execute(
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 315, in _execute
    raise DatabaseError(*e.args) from e
pyathena.error.DatabaseError: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 66, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 103, in exception_handler
    raise RuntimeException(str(e)) from e
dbt.exceptions.RuntimeException: Runtime Error in model test_model2 (models/test_model2.sql)
  An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
2021-11-29 13:31:05.490181 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c94f132a-6eee-47af-8a90-db63986c9b80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaca33ca0>]}
2021-11-29 13:31:05.492459 (Thread-1): 13:31:05 | 2 of 5 ERROR creating view model dbt.test_model2..................... [ERROR in 0.33s]
2021-11-29 13:31:05.496025 (Thread-1): Finished running node model.my_new_project.test_model2
2021-11-29 13:31:05.499165 (Thread-1): Began running node model.my_new_project.test_model3
2021-11-29 13:31:05.501124 (Thread-1): 13:31:05 | 3 of 5 SKIP relation dbt.test_model3................................. [SKIP]
2021-11-29 13:31:05.502954 (Thread-1): Finished running node model.my_new_project.test_model3
2021-11-29 13:31:05.506419 (Thread-1): Began running node model.my_new_project.test_model4
2021-11-29 13:31:05.507118 (Thread-1): 13:31:05 | 4 of 5 SKIP relation dbt.test_model4................................. [SKIP]
2021-11-29 13:31:05.508950 (Thread-1): Finished running node model.my_new_project.test_model4
2021-11-29 13:31:05.511885 (Thread-1): Began running node model.my_new_project.test_model5
2021-11-29 13:31:05.514200 (Thread-1): 13:31:05 | 5 of 5 SKIP relation dbt.test_model5................................. [SKIP]
2021-11-29 13:31:05.515564 (Thread-1): Finished running node model.my_new_project.test_model5
2021-11-29 13:31:05.519922 (MainThread): Acquiring new athena connection "master".
2021-11-29 13:31:05.520636 (MainThread): 13:31:05 | 
2021-11-29 13:31:05.523140 (MainThread): 13:31:05 | Finished running 5 view models in 7.87s.
2021-11-29 13:31:05.526174 (MainThread): Connection 'master' was properly closed.
2021-11-29 13:31:05.528421 (MainThread): Connection 'model.my_new_project.test_model2' was properly closed.
2021-11-29 13:31:05.544477 (MainThread): 
2021-11-29 13:31:05.545530 (MainThread): Completed with 2 errors and 0 warnings:
2021-11-29 13:31:05.546997 (MainThread): 
2021-11-29 13:31:05.548514 (MainThread): Runtime Error in model test_model1 (models/test_model1.sql)
2021-11-29 13:31:05.550828 (MainThread):   com.facebook.presto.v217.sql.analyzer.SemanticException: line 9:9: 'state' must be an aggregate expression or appear in GROUP BY clause
2021-11-29 13:31:05.552954 (MainThread): 
2021-11-29 13:31:05.555205 (MainThread): Runtime Error in model test_model2 (models/test_model2.sql)
2021-11-29 13:31:05.559864 (MainThread):   An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
2021-11-29 13:31:05.561870 (MainThread): 
Done. PASS=0 WARN=0 ERROR=2 SKIP=3 TOTAL=5
2021-11-29 13:31:05.563630 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1e6c850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf155a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb15e6df0>]}
2021-11-29 13:31:05.565340 (MainThread): Flushing usage events
2021-11-29 13:31:37.488749 (MainThread): Running with dbt=0.21.0
2021-11-29 13:31:37.557254 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/vscode/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-29 13:31:37.562093 (MainThread): Tracking: tracking
2021-11-29 13:31:37.564776 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5189610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6a26c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6a26d90>]}
2021-11-29 13:31:37.573694 (MainThread): Partial parsing not enabled
2021-11-29 13:31:37.586591 (MainThread): Parsing macros/catalog.sql
2021-11-29 13:31:37.589137 (MainThread): Parsing macros/adapters.sql
2021-11-29 13:31:37.597796 (MainThread): Parsing macros/materializations/seed.sql
2021-11-29 13:31:37.600998 (MainThread): Parsing macros/materializations/snapshot.sql
2021-11-29 13:31:37.602020 (MainThread): Parsing macros/materializations/table.sql
2021-11-29 13:31:37.604928 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-29 13:31:37.617235 (MainThread): Parsing macros/materializations/view.sql
2021-11-29 13:31:37.621223 (MainThread): Parsing macros/core.sql
2021-11-29 13:31:37.623739 (MainThread): Parsing macros/materializations/test.sql
2021-11-29 13:31:37.628695 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-29 13:31:37.634740 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-29 13:31:37.637759 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-29 13:31:37.642327 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-29 13:31:37.644186 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-29 13:31:37.651773 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-29 13:31:37.663391 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-29 13:31:37.676053 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-29 13:31:37.680610 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-29 13:31:37.688344 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-29 13:31:37.705077 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-29 13:31:37.714386 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-29 13:31:37.716768 (MainThread): Parsing macros/etc/query.sql
2021-11-29 13:31:37.718562 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-29 13:31:37.720996 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-29 13:31:37.722618 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-29 13:31:37.724750 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-29 13:31:37.726080 (MainThread): Parsing macros/etc/datetime.sql
2021-11-29 13:31:37.731535 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-29 13:31:37.734061 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-29 13:31:37.735886 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-29 13:31:37.737701 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-29 13:31:37.739365 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-29 13:31:37.742170 (MainThread): Parsing macros/adapters/common.sql
2021-11-29 13:31:37.851208 (MainThread): Acquiring new athena connection "model.my_new_project.test_model1".
2021-11-29 13:31:37.858869 (MainThread): Acquiring new athena connection "model.my_new_project.test_model2".
2021-11-29 13:31:37.862232 (MainThread): Acquiring new athena connection "model.my_new_project.test_model3".
2021-11-29 13:31:37.865146 (MainThread): Acquiring new athena connection "model.my_new_project.test_model4".
2021-11-29 13:31:37.867959 (MainThread): Acquiring new athena connection "model.my_new_project.test_model5".
2021-11-29 13:31:37.894147 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-11-29 13:31:37.898532 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c93e6545-8faf-4dd5-9c2e-5f34dc411d2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4b8f310>]}
2021-11-29 13:31:37.912297 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-11-29 13:31:37.913792 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c93e6545-8faf-4dd5-9c2e-5f34dc411d2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4b8fbe0>]}
2021-11-29 13:31:37.914886 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 1 seed file, 0 sources, 0 exposures
2021-11-29 13:31:37.917144 (MainThread): 
2021-11-29 13:31:37.918130 (MainThread): Acquiring new athena connection "master".
2021-11-29 13:31:37.920611 (ThreadPoolExecutor-0_0): Acquiring new athena connection "list_awsdatacatalog".
2021-11-29 13:31:37.927847 (ThreadPoolExecutor-0_0): Using athena connection "list_awsdatacatalog".
2021-11-29 13:31:37.928876 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
  
2021-11-29 13:31:37.930505 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-29 13:31:37.950485 (ThreadPoolExecutor-0_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
2021-11-29 13:31:39.839838 (ThreadPoolExecutor-0_0): SQL status: OK -1 in 1.91 seconds
2021-11-29 13:31:39.850824 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: Close
2021-11-29 13:31:39.858940 (ThreadPoolExecutor-2_0): Acquiring new athena connection "list_awsdatacatalog_dbt".
2021-11-29 13:31:39.863741 (ThreadPoolExecutor-2_0): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 50666), raddr=('3.223.130.62', 443)>
2021-11-29 13:31:39.878756 (ThreadPoolExecutor-2_0): Using athena connection "list_awsdatacatalog_dbt".
2021-11-29 13:31:39.880318 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
2021-11-29 13:31:39.883162 (ThreadPoolExecutor-2_0): Opening a new connection, currently in state closed
2021-11-29 13:31:39.910540 (ThreadPoolExecutor-2_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
2021-11-29 13:31:42.783962 (ThreadPoolExecutor-2_0): SQL status: OK -1 in 2.90 seconds
2021-11-29 13:31:42.791334 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: Close
2021-11-29 13:31:42.799041 (MainThread): 13:31:42 | Concurrency: 1 threads (target='dev')
2021-11-29 13:31:42.802940 (MainThread): 13:31:42 | 
2021-11-29 13:31:42.815235 (Thread-1): Began running node model.my_new_project.test_model1
2021-11-29 13:31:42.817873 (Thread-1): 13:31:42 | 1 of 5 START view model dbt.test_model1.............................. [RUN]
2021-11-29 13:31:42.824171 (Thread-1): Acquiring new athena connection "model.my_new_project.test_model1".
2021-11-29 13:31:42.828971 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 50668), raddr=('3.223.130.62', 443)>
2021-11-29 13:31:42.834178 (Thread-1): Compiling model.my_new_project.test_model1
2021-11-29 13:31:42.839701 (Thread-1): Writing injected SQL for node "model.my_new_project.test_model1"
2021-11-29 13:31:42.849308 (Thread-1): finished collecting timing info
2021-11-29 13:31:42.864179 (Thread-1): Writing runtime SQL for node "model.my_new_project.test_model1"
2021-11-29 13:31:42.868951 (Thread-1): Using athena connection "model.my_new_project.test_model1".
2021-11-29 13:31:42.869926 (Thread-1): On model.my_new_project.test_model1: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    With sample_buildings as (
    SELECT 
        bldg_fid/*,
        city,
        state*/
    FROM "defaultdb"."buildings" 
    group by 1
)
/*where county='G5500690' */

Select 
    sum(out.electricity.clothes_dryer.energy_consumption),
    bldg_id
from "defaultdb"."resby_puma_northeast"


left join sample_buildings  using (bldg_id)

2021-11-29 13:31:42.872179 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 13:31:42.889938 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    With sample_buildings as (
    SELECT 
        bldg_fid/*,
        city,
        state*/
    FROM "defaultdb"."buildings" 
    group by 1
)
/*where county='G5500690' */

Select 
    sum(out.electricity.clothes_dryer.energy_consumption),
    bldg_id
from "defaultdb"."resby_puma_northeast"


left join sample_buildings  using (bldg_id)
2021-11-29 13:31:44.395869 (Thread-1): Error running SQL: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    With sample_buildings as (
    SELECT 
        bldg_fid/*,
        city,
        state*/
    FROM "defaultdb"."buildings" 
    group by 1
)
/*where county='G5500690' */

Select 
    sum(out.electricity.clothes_dryer.energy_consumption),
    bldg_id
from "defaultdb"."resby_puma_northeast"


left join sample_buildings  using (bldg_id)

2021-11-29 13:31:44.397173 (Thread-1): finished collecting timing info
2021-11-29 13:31:44.400190 (Thread-1): On model.my_new_project.test_model1: Close
2021-11-29 13:31:44.402410 (Thread-1): Runtime Error in model test_model1 (models/test_model1.sql)
  com.facebook.presto.v217.sql.analyzer.SemanticException: line 21:36: Column 'bldg_id' is missing from right side of join
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 100, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 90, in execute
    raise OperationalError(query_execution.state_change_reason)
pyathena.error.OperationalError: com.facebook.presto.v217.sql.analyzer.SemanticException: line 21:36: Column 'bldg_id' is missing from right side of join

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 66, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 103, in exception_handler
    raise RuntimeException(str(e)) from e
dbt.exceptions.RuntimeException: Runtime Error in model test_model1 (models/test_model1.sql)
  com.facebook.presto.v217.sql.analyzer.SemanticException: line 21:36: Column 'bldg_id' is missing from right side of join
2021-11-29 13:31:44.405992 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c93e6545-8faf-4dd5-9c2e-5f34dc411d2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4114820>]}
2021-11-29 13:31:44.408307 (Thread-1): 13:31:44 | 1 of 5 ERROR creating view model dbt.test_model1..................... [ERROR in 1.58s]
2021-11-29 13:31:44.410075 (Thread-1): Finished running node model.my_new_project.test_model1
2021-11-29 13:31:44.412420 (Thread-1): Began running node model.my_new_project.test_model2
2021-11-29 13:31:44.415161 (Thread-1): 13:31:44 | 2 of 5 START view model dbt.test_model2.............................. [RUN]
2021-11-29 13:31:44.417611 (Thread-1): Acquiring new athena connection "model.my_new_project.test_model2".
2021-11-29 13:31:44.419013 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 50670), raddr=('3.223.130.62', 443)>
2021-11-29 13:31:44.420748 (Thread-1): Compiling model.my_new_project.test_model2
2021-11-29 13:31:44.425292 (Thread-1): Writing injected SQL for node "model.my_new_project.test_model2"
2021-11-29 13:31:44.432279 (Thread-1): finished collecting timing info
2021-11-29 13:31:44.435256 (Thread-1): Writing runtime SQL for node "model.my_new_project.test_model2"
2021-11-29 13:31:44.441002 (Thread-1): Using athena connection "model.my_new_project.test_model2".
2021-11-29 13:31:44.442893 (Thread-1): On model.my_new_project.test_model2: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    /*
from somewhere - get bldg_id and zip code --> bldg_locations
*/

2021-11-29 13:31:44.446145 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 13:31:44.474090 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    /*
from somewhere - get bldg_id and zip code --> bldg_locations
*/
2021-11-29 13:31:44.710659 (Thread-1): Failed to execute query.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 307, in _execute
    query_id = retry_api_call(
  File "/usr/local/lib/python3.8/site-packages/pyathena/util.py", line 84, in retry_api_call
    return retry(func, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 404, in __call__
    do = self.iter(retry_state=retry_state)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 349, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 407, in __call__
    result = fn(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 276, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 586, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
2021-11-29 13:31:44.716007 (Thread-1): Error running SQL: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    /*
from somewhere - get bldg_id and zip code --> bldg_locations
*/

2021-11-29 13:31:44.720628 (Thread-1): finished collecting timing info
2021-11-29 13:31:44.724615 (Thread-1): On model.my_new_project.test_model2: Close
2021-11-29 13:31:44.728877 (Thread-1): Runtime Error in model test_model2 (models/test_model2.sql)
  An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 307, in _execute
    query_id = retry_api_call(
  File "/usr/local/lib/python3.8/site-packages/pyathena/util.py", line 84, in retry_api_call
    return retry(func, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 404, in __call__
    do = self.iter(retry_state=retry_state)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 349, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 407, in __call__
    result = fn(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 276, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 586, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 100, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 72, in execute
    query_id = self._execute(
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 315, in _execute
    raise DatabaseError(*e.args) from e
pyathena.error.DatabaseError: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 66, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 103, in exception_handler
    raise RuntimeException(str(e)) from e
dbt.exceptions.RuntimeException: Runtime Error in model test_model2 (models/test_model2.sql)
  An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
2021-11-29 13:31:44.734860 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c93e6545-8faf-4dd5-9c2e-5f34dc411d2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e40e100>]}
2021-11-29 13:31:44.738063 (Thread-1): 13:31:44 | 2 of 5 ERROR creating view model dbt.test_model2..................... [ERROR in 0.32s]
2021-11-29 13:31:44.740821 (Thread-1): Finished running node model.my_new_project.test_model2
2021-11-29 13:31:44.744117 (Thread-1): Began running node model.my_new_project.test_model3
2021-11-29 13:31:44.746895 (Thread-1): 13:31:44 | 3 of 5 SKIP relation dbt.test_model3................................. [SKIP]
2021-11-29 13:31:44.749738 (Thread-1): Finished running node model.my_new_project.test_model3
2021-11-29 13:31:44.752226 (Thread-1): Began running node model.my_new_project.test_model4
2021-11-29 13:31:44.754130 (Thread-1): 13:31:44 | 4 of 5 SKIP relation dbt.test_model4................................. [SKIP]
2021-11-29 13:31:44.757218 (Thread-1): Finished running node model.my_new_project.test_model4
2021-11-29 13:31:44.759918 (Thread-1): Began running node model.my_new_project.test_model5
2021-11-29 13:31:44.761623 (Thread-1): 13:31:44 | 5 of 5 SKIP relation dbt.test_model5................................. [SKIP]
2021-11-29 13:31:44.764102 (Thread-1): Finished running node model.my_new_project.test_model5
2021-11-29 13:31:44.766383 (MainThread): Acquiring new athena connection "master".
2021-11-29 13:31:44.768056 (MainThread): 13:31:44 | 
2021-11-29 13:31:44.769305 (MainThread): 13:31:44 | Finished running 5 view models in 6.85s.
2021-11-29 13:31:44.770938 (MainThread): Connection 'master' was properly closed.
2021-11-29 13:31:44.772577 (MainThread): Connection 'model.my_new_project.test_model2' was properly closed.
2021-11-29 13:31:44.787643 (MainThread): 
2021-11-29 13:31:44.788666 (MainThread): Completed with 2 errors and 0 warnings:
2021-11-29 13:31:44.790665 (MainThread): 
2021-11-29 13:31:44.794071 (MainThread): Runtime Error in model test_model1 (models/test_model1.sql)
2021-11-29 13:31:44.796347 (MainThread):   com.facebook.presto.v217.sql.analyzer.SemanticException: line 21:36: Column 'bldg_id' is missing from right side of join
2021-11-29 13:31:44.798661 (MainThread): 
2021-11-29 13:31:44.800973 (MainThread): Runtime Error in model test_model2 (models/test_model2.sql)
2021-11-29 13:31:44.803609 (MainThread):   An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
2021-11-29 13:31:44.806280 (MainThread): 
Done. PASS=0 WARN=0 ERROR=2 SKIP=3 TOTAL=5
2021-11-29 13:31:44.808401 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4bc7a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4b34fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa69c6df0>]}
2021-11-29 13:31:44.811991 (MainThread): Flushing usage events
2021-11-29 13:32:12.249011 (MainThread): Running with dbt=0.21.0
2021-11-29 13:32:12.321081 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/vscode/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-29 13:32:12.328030 (MainThread): Tracking: tracking
2021-11-29 13:32:12.331444 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8643e910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87cf3c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87cf3d60>]}
2021-11-29 13:32:12.340259 (MainThread): Partial parsing not enabled
2021-11-29 13:32:12.357295 (MainThread): Parsing macros/catalog.sql
2021-11-29 13:32:12.360893 (MainThread): Parsing macros/adapters.sql
2021-11-29 13:32:12.369604 (MainThread): Parsing macros/materializations/seed.sql
2021-11-29 13:32:12.372876 (MainThread): Parsing macros/materializations/snapshot.sql
2021-11-29 13:32:12.374036 (MainThread): Parsing macros/materializations/table.sql
2021-11-29 13:32:12.377363 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-29 13:32:12.390813 (MainThread): Parsing macros/materializations/view.sql
2021-11-29 13:32:12.394357 (MainThread): Parsing macros/core.sql
2021-11-29 13:32:12.396937 (MainThread): Parsing macros/materializations/test.sql
2021-11-29 13:32:12.401178 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-29 13:32:12.406876 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-29 13:32:12.410142 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-29 13:32:12.414350 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-29 13:32:12.416160 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-29 13:32:12.421990 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-29 13:32:12.432868 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-29 13:32:12.444676 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-29 13:32:12.449233 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-29 13:32:12.457374 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-29 13:32:12.474931 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-29 13:32:12.483894 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-29 13:32:12.485372 (MainThread): Parsing macros/etc/query.sql
2021-11-29 13:32:12.487093 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-29 13:32:12.489842 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-29 13:32:12.492737 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-29 13:32:12.494223 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-29 13:32:12.495834 (MainThread): Parsing macros/etc/datetime.sql
2021-11-29 13:32:12.501769 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-29 13:32:12.503157 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-29 13:32:12.505296 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-29 13:32:12.506686 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-29 13:32:12.509572 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-29 13:32:12.511164 (MainThread): Parsing macros/adapters/common.sql
2021-11-29 13:32:12.631130 (MainThread): Acquiring new athena connection "model.my_new_project.test_model1".
2021-11-29 13:32:12.639256 (MainThread): 1699: statically parsed test_model2.sql
2021-11-29 13:32:12.640649 (MainThread): Acquiring new athena connection "model.my_new_project.test_model2".
2021-11-29 13:32:12.643281 (MainThread): Sending event: {'category': 'dbt', 'action': 'experimental_parser', 'label': '73c3155d-6114-4599-a5d3-aa16d2f2fdcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85eaf760>]}
2021-11-29 13:32:12.645706 (MainThread): Acquiring new athena connection "model.my_new_project.test_model3".
2021-11-29 13:32:12.649842 (MainThread): Acquiring new athena connection "model.my_new_project.test_model4".
2021-11-29 13:32:12.652442 (MainThread): Acquiring new athena connection "model.my_new_project.test_model5".
2021-11-29 13:32:12.675596 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-11-29 13:32:12.679560 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '73c3155d-6114-4599-a5d3-aa16d2f2fdcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85659c40>]}
2021-11-29 13:32:12.692605 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-11-29 13:32:12.694651 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '73c3155d-6114-4599-a5d3-aa16d2f2fdcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85e82580>]}
2021-11-29 13:32:12.695904 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 1 seed file, 0 sources, 0 exposures
2021-11-29 13:32:12.698335 (MainThread): 
2021-11-29 13:32:12.699271 (MainThread): Acquiring new athena connection "master".
2021-11-29 13:32:12.702260 (ThreadPoolExecutor-0_0): Acquiring new athena connection "list_awsdatacatalog".
2021-11-29 13:32:12.709714 (ThreadPoolExecutor-0_0): Using athena connection "list_awsdatacatalog".
2021-11-29 13:32:12.710841 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
  
2021-11-29 13:32:12.712638 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-29 13:32:12.736313 (ThreadPoolExecutor-0_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
2021-11-29 13:32:14.490508 (ThreadPoolExecutor-0_0): SQL status: OK -1 in 1.78 seconds
2021-11-29 13:32:14.498382 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: Close
2021-11-29 13:32:14.505641 (ThreadPoolExecutor-2_0): Acquiring new athena connection "list_awsdatacatalog_dbt".
2021-11-29 13:32:14.509041 (ThreadPoolExecutor-2_0): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 50676), raddr=('3.223.130.62', 443)>
2021-11-29 13:32:14.523047 (ThreadPoolExecutor-2_0): Using athena connection "list_awsdatacatalog_dbt".
2021-11-29 13:32:14.524709 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
2021-11-29 13:32:14.529836 (ThreadPoolExecutor-2_0): Opening a new connection, currently in state closed
2021-11-29 13:32:14.555729 (ThreadPoolExecutor-2_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
2021-11-29 13:32:18.558820 (ThreadPoolExecutor-2_0): SQL status: OK -1 in 4.03 seconds
2021-11-29 13:32:18.567893 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: Close
2021-11-29 13:32:18.575355 (MainThread): 13:32:18 | Concurrency: 1 threads (target='dev')
2021-11-29 13:32:18.577134 (MainThread): 13:32:18 | 
2021-11-29 13:32:18.586335 (Thread-1): Began running node model.my_new_project.test_model1
2021-11-29 13:32:18.587972 (Thread-1): 13:32:18 | 1 of 5 START view model dbt.test_model1.............................. [RUN]
2021-11-29 13:32:18.591653 (Thread-1): Acquiring new athena connection "model.my_new_project.test_model1".
2021-11-29 13:32:18.597007 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 50678), raddr=('3.223.130.62', 443)>
2021-11-29 13:32:18.601173 (Thread-1): Compiling model.my_new_project.test_model1
2021-11-29 13:32:18.605782 (Thread-1): Writing injected SQL for node "model.my_new_project.test_model1"
2021-11-29 13:32:18.615762 (Thread-1): finished collecting timing info
2021-11-29 13:32:18.629272 (Thread-1): Writing runtime SQL for node "model.my_new_project.test_model1"
2021-11-29 13:32:18.633840 (Thread-1): Using athena connection "model.my_new_project.test_model1".
2021-11-29 13:32:18.634704 (Thread-1): On model.my_new_project.test_model1: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    With sample_buildings as (
    SELECT 
        bldg_fid/*,
        city,
        state*/
    FROM "defaultdb"."buildings" 
    group by 1
)
/*where county='G5500690' */

Select 
    sum(out.electricity.clothes_dryer.energy_consumption),
    bldg_id
from "defaultdb"."resby_puma_northeast"


left join sample_buildings  using (bldg_fid)

2021-11-29 13:32:18.636209 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 13:32:18.651689 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    With sample_buildings as (
    SELECT 
        bldg_fid/*,
        city,
        state*/
    FROM "defaultdb"."buildings" 
    group by 1
)
/*where county='G5500690' */

Select 
    sum(out.electricity.clothes_dryer.energy_consumption),
    bldg_id
from "defaultdb"."resby_puma_northeast"


left join sample_buildings  using (bldg_fid)
2021-11-29 13:32:20.153845 (Thread-1): Error running SQL: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    With sample_buildings as (
    SELECT 
        bldg_fid/*,
        city,
        state*/
    FROM "defaultdb"."buildings" 
    group by 1
)
/*where county='G5500690' */

Select 
    sum(out.electricity.clothes_dryer.energy_consumption),
    bldg_id
from "defaultdb"."resby_puma_northeast"


left join sample_buildings  using (bldg_fid)

2021-11-29 13:32:20.162602 (Thread-1): finished collecting timing info
2021-11-29 13:32:20.167139 (Thread-1): On model.my_new_project.test_model1: Close
2021-11-29 13:32:20.172619 (Thread-1): Runtime Error in model test_model1 (models/test_model1.sql)
  com.facebook.presto.v217.sql.analyzer.SemanticException: line 21:36: Column 'bldg_fid' is missing from left side of join
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 100, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 90, in execute
    raise OperationalError(query_execution.state_change_reason)
pyathena.error.OperationalError: com.facebook.presto.v217.sql.analyzer.SemanticException: line 21:36: Column 'bldg_fid' is missing from left side of join

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 66, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 103, in exception_handler
    raise RuntimeException(str(e)) from e
dbt.exceptions.RuntimeException: Runtime Error in model test_model1 (models/test_model1.sql)
  com.facebook.presto.v217.sql.analyzer.SemanticException: line 21:36: Column 'bldg_fid' is missing from left side of join
2021-11-29 13:32:20.181899 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73c3155d-6114-4599-a5d3-aa16d2f2fdcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84be27c0>]}
2021-11-29 13:32:20.186866 (Thread-1): 13:32:20 | 1 of 5 ERROR creating view model dbt.test_model1..................... [ERROR in 1.59s]
2021-11-29 13:32:20.191003 (Thread-1): Finished running node model.my_new_project.test_model1
2021-11-29 13:32:20.196189 (Thread-1): Began running node model.my_new_project.test_model2
2021-11-29 13:32:20.200590 (Thread-1): 13:32:20 | 2 of 5 START view model dbt.test_model2.............................. [RUN]
2021-11-29 13:32:20.203596 (Thread-1): Acquiring new athena connection "model.my_new_project.test_model2".
2021-11-29 13:32:20.207766 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 50680), raddr=('3.223.130.62', 443)>
2021-11-29 13:32:20.211087 (Thread-1): Compiling model.my_new_project.test_model2
2021-11-29 13:32:20.216832 (Thread-1): Writing injected SQL for node "model.my_new_project.test_model2"
2021-11-29 13:32:20.225838 (Thread-1): finished collecting timing info
2021-11-29 13:32:20.230220 (Thread-1): Writing runtime SQL for node "model.my_new_project.test_model2"
2021-11-29 13:32:20.234236 (Thread-1): Using athena connection "model.my_new_project.test_model2".
2021-11-29 13:32:20.235244 (Thread-1): On model.my_new_project.test_model2: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    /*
from somewhere - get bldg_id and zip code --> bldg_locations
*/

2021-11-29 13:32:20.236753 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 13:32:20.255339 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    /*
from somewhere - get bldg_id and zip code --> bldg_locations
*/
2021-11-29 13:32:20.512271 (Thread-1): Failed to execute query.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 307, in _execute
    query_id = retry_api_call(
  File "/usr/local/lib/python3.8/site-packages/pyathena/util.py", line 84, in retry_api_call
    return retry(func, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 404, in __call__
    do = self.iter(retry_state=retry_state)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 349, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 407, in __call__
    result = fn(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 276, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 586, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
2021-11-29 13:32:20.519904 (Thread-1): Error running SQL: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    /*
from somewhere - get bldg_id and zip code --> bldg_locations
*/

2021-11-29 13:32:20.525368 (Thread-1): finished collecting timing info
2021-11-29 13:32:20.530191 (Thread-1): On model.my_new_project.test_model2: Close
2021-11-29 13:32:20.534781 (Thread-1): Runtime Error in model test_model2 (models/test_model2.sql)
  An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 307, in _execute
    query_id = retry_api_call(
  File "/usr/local/lib/python3.8/site-packages/pyathena/util.py", line 84, in retry_api_call
    return retry(func, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 404, in __call__
    do = self.iter(retry_state=retry_state)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 349, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 407, in __call__
    result = fn(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 276, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 586, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 100, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 72, in execute
    query_id = self._execute(
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 315, in _execute
    raise DatabaseError(*e.args) from e
pyathena.error.DatabaseError: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 66, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 103, in exception_handler
    raise RuntimeException(str(e)) from e
dbt.exceptions.RuntimeException: Runtime Error in model test_model2 (models/test_model2.sql)
  An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
2021-11-29 13:32:20.541171 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73c3155d-6114-4599-a5d3-aa16d2f2fdcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6eed0130>]}
2021-11-29 13:32:20.544926 (Thread-1): 13:32:20 | 2 of 5 ERROR creating view model dbt.test_model2..................... [ERROR in 0.34s]
2021-11-29 13:32:20.548455 (Thread-1): Finished running node model.my_new_project.test_model2
2021-11-29 13:32:20.551809 (Thread-1): Began running node model.my_new_project.test_model3
2021-11-29 13:32:20.554846 (Thread-1): 13:32:20 | 3 of 5 SKIP relation dbt.test_model3................................. [SKIP]
2021-11-29 13:32:20.557093 (Thread-1): Finished running node model.my_new_project.test_model3
2021-11-29 13:32:20.560362 (Thread-1): Began running node model.my_new_project.test_model4
2021-11-29 13:32:20.562869 (Thread-1): 13:32:20 | 4 of 5 SKIP relation dbt.test_model4................................. [SKIP]
2021-11-29 13:32:20.565010 (Thread-1): Finished running node model.my_new_project.test_model4
2021-11-29 13:32:20.567528 (Thread-1): Began running node model.my_new_project.test_model5
2021-11-29 13:32:20.569177 (Thread-1): 13:32:20 | 5 of 5 SKIP relation dbt.test_model5................................. [SKIP]
2021-11-29 13:32:20.570768 (Thread-1): Finished running node model.my_new_project.test_model5
2021-11-29 13:32:20.572861 (MainThread): Acquiring new athena connection "master".
2021-11-29 13:32:20.575790 (MainThread): 13:32:20 | 
2021-11-29 13:32:20.578621 (MainThread): 13:32:20 | Finished running 5 view models in 7.88s.
2021-11-29 13:32:20.580875 (MainThread): Connection 'master' was properly closed.
2021-11-29 13:32:20.583318 (MainThread): Connection 'model.my_new_project.test_model2' was properly closed.
2021-11-29 13:32:20.598894 (MainThread): 
2021-11-29 13:32:20.600114 (MainThread): Completed with 2 errors and 0 warnings:
2021-11-29 13:32:20.602182 (MainThread): 
2021-11-29 13:32:20.603739 (MainThread): Runtime Error in model test_model1 (models/test_model1.sql)
2021-11-29 13:32:20.605914 (MainThread):   com.facebook.presto.v217.sql.analyzer.SemanticException: line 21:36: Column 'bldg_fid' is missing from left side of join
2021-11-29 13:32:20.608506 (MainThread): 
2021-11-29 13:32:20.611194 (MainThread): Runtime Error in model test_model2 (models/test_model2.sql)
2021-11-29 13:32:20.613063 (MainThread):   An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
2021-11-29 13:32:20.614379 (MainThread): 
Done. PASS=0 WARN=0 ERROR=2 SKIP=3 TOTAL=5
2021-11-29 13:32:20.616751 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8560ca60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87c95df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87d148e0>]}
2021-11-29 13:32:20.619552 (MainThread): Flushing usage events
2021-11-29 13:33:09.642364 (MainThread): Running with dbt=0.21.0
2021-11-29 13:33:09.711844 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/vscode/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-29 13:33:09.719203 (MainThread): Tracking: tracking
2021-11-29 13:33:09.721650 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa00825e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa191ec70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa191ee80>]}
2021-11-29 13:33:09.730147 (MainThread): Partial parsing not enabled
2021-11-29 13:33:09.745402 (MainThread): Parsing macros/catalog.sql
2021-11-29 13:33:09.748208 (MainThread): Parsing macros/adapters.sql
2021-11-29 13:33:09.756936 (MainThread): Parsing macros/materializations/seed.sql
2021-11-29 13:33:09.759835 (MainThread): Parsing macros/materializations/snapshot.sql
2021-11-29 13:33:09.761421 (MainThread): Parsing macros/materializations/table.sql
2021-11-29 13:33:09.764388 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-29 13:33:09.777182 (MainThread): Parsing macros/materializations/view.sql
2021-11-29 13:33:09.780597 (MainThread): Parsing macros/core.sql
2021-11-29 13:33:09.783764 (MainThread): Parsing macros/materializations/test.sql
2021-11-29 13:33:09.787961 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-29 13:33:09.793564 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-29 13:33:09.796980 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-29 13:33:09.801114 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-29 13:33:09.803092 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-29 13:33:09.808761 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-29 13:33:09.819283 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-29 13:33:09.831143 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-29 13:33:09.835869 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-29 13:33:09.843754 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-29 13:33:09.861629 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-29 13:33:09.870585 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-29 13:33:09.872108 (MainThread): Parsing macros/etc/query.sql
2021-11-29 13:33:09.873417 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-29 13:33:09.876021 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-29 13:33:09.877638 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-29 13:33:09.879197 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-29 13:33:09.881242 (MainThread): Parsing macros/etc/datetime.sql
2021-11-29 13:33:09.886523 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-29 13:33:09.888761 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-29 13:33:09.890495 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-29 13:33:09.892112 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-29 13:33:09.893506 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-29 13:33:09.895278 (MainThread): Parsing macros/adapters/common.sql
2021-11-29 13:33:10.000911 (MainThread): Acquiring new athena connection "model.my_new_project.test_model1".
2021-11-29 13:33:10.010084 (MainThread): Acquiring new athena connection "model.my_new_project.test_model2".
2021-11-29 13:33:10.013635 (MainThread): Acquiring new athena connection "model.my_new_project.test_model3".
2021-11-29 13:33:10.016903 (MainThread): Acquiring new athena connection "model.my_new_project.test_model4".
2021-11-29 13:33:10.019815 (MainThread): Acquiring new athena connection "model.my_new_project.test_model5".
2021-11-29 13:33:10.043375 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-11-29 13:33:10.047387 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '45f3c13f-9ee5-4f17-8891-d0f5bae8d690', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fa86a60>]}
2021-11-29 13:33:10.060277 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-11-29 13:33:10.061837 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '45f3c13f-9ee5-4f17-8891-d0f5bae8d690', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fa86a90>]}
2021-11-29 13:33:10.062805 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 1 seed file, 0 sources, 0 exposures
2021-11-29 13:33:10.064936 (MainThread): 
2021-11-29 13:33:10.066508 (MainThread): Acquiring new athena connection "master".
2021-11-29 13:33:10.069085 (ThreadPoolExecutor-0_0): Acquiring new athena connection "list_awsdatacatalog".
2021-11-29 13:33:10.077123 (ThreadPoolExecutor-0_0): Using athena connection "list_awsdatacatalog".
2021-11-29 13:33:10.078156 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
  
2021-11-29 13:33:10.080260 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-29 13:33:10.100052 (ThreadPoolExecutor-0_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
2021-11-29 13:33:11.942178 (ThreadPoolExecutor-0_0): SQL status: OK -1 in 1.86 seconds
2021-11-29 13:33:11.944479 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: Close
2021-11-29 13:33:11.949487 (ThreadPoolExecutor-2_0): Acquiring new athena connection "list_awsdatacatalog_dbt".
2021-11-29 13:33:11.951933 (ThreadPoolExecutor-2_0): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 54380), raddr=('52.55.74.167', 443)>
2021-11-29 13:33:11.962856 (ThreadPoolExecutor-2_0): Using athena connection "list_awsdatacatalog_dbt".
2021-11-29 13:33:11.964892 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
2021-11-29 13:33:11.967751 (ThreadPoolExecutor-2_0): Opening a new connection, currently in state closed
2021-11-29 13:33:12.004841 (ThreadPoolExecutor-2_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
2021-11-29 13:33:14.965705 (ThreadPoolExecutor-2_0): SQL status: OK -1 in 3.00 seconds
2021-11-29 13:33:14.970154 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: Close
2021-11-29 13:33:14.974069 (MainThread): 13:33:14 | Concurrency: 1 threads (target='dev')
2021-11-29 13:33:14.977339 (MainThread): 13:33:14 | 
2021-11-29 13:33:14.983367 (Thread-1): Began running node model.my_new_project.test_model1
2021-11-29 13:33:14.985123 (Thread-1): 13:33:14 | 1 of 5 START view model dbt.test_model1.............................. [RUN]
2021-11-29 13:33:14.987415 (Thread-1): Acquiring new athena connection "model.my_new_project.test_model1".
2021-11-29 13:33:14.991409 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 54382), raddr=('52.55.74.167', 443)>
2021-11-29 13:33:14.997278 (Thread-1): Compiling model.my_new_project.test_model1
2021-11-29 13:33:15.001152 (Thread-1): Writing injected SQL for node "model.my_new_project.test_model1"
2021-11-29 13:33:15.005792 (Thread-1): finished collecting timing info
2021-11-29 13:33:15.019385 (Thread-1): Writing runtime SQL for node "model.my_new_project.test_model1"
2021-11-29 13:33:15.024749 (Thread-1): Using athena connection "model.my_new_project.test_model1".
2021-11-29 13:33:15.026023 (Thread-1): On model.my_new_project.test_model1: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    With sample_buildings as (
    SELECT 
        bldg_fid/*,
        city,
        state*/
    FROM "defaultdb"."buildings" 
    group by 1
)
/*where county='G5500690' */

Select 
    sum(out.electricity.clothes_dryer.energy_consumption),
    bldg_id
from "defaultdb"."resby_puma_northeast"


left join sample_buildings using (sample_buildings)

2021-11-29 13:33:15.027767 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 13:33:15.043838 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    With sample_buildings as (
    SELECT 
        bldg_fid/*,
        city,
        state*/
    FROM "defaultdb"."buildings" 
    group by 1
)
/*where county='G5500690' */

Select 
    sum(out.electricity.clothes_dryer.energy_consumption),
    bldg_id
from "defaultdb"."resby_puma_northeast"


left join sample_buildings using (sample_buildings)
2021-11-29 13:33:16.567440 (Thread-1): Error running SQL: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    With sample_buildings as (
    SELECT 
        bldg_fid/*,
        city,
        state*/
    FROM "defaultdb"."buildings" 
    group by 1
)
/*where county='G5500690' */

Select 
    sum(out.electricity.clothes_dryer.energy_consumption),
    bldg_id
from "defaultdb"."resby_puma_northeast"


left join sample_buildings using (sample_buildings)

2021-11-29 13:33:16.572324 (Thread-1): finished collecting timing info
2021-11-29 13:33:16.579883 (Thread-1): On model.my_new_project.test_model1: Close
2021-11-29 13:33:16.589221 (Thread-1): Runtime Error in model test_model1 (models/test_model1.sql)
  com.facebook.presto.v217.sql.analyzer.SemanticException: line 21:35: Column 'sample_buildings' is missing from left side of join
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 100, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 90, in execute
    raise OperationalError(query_execution.state_change_reason)
pyathena.error.OperationalError: com.facebook.presto.v217.sql.analyzer.SemanticException: line 21:35: Column 'sample_buildings' is missing from left side of join

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 66, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 103, in exception_handler
    raise RuntimeException(str(e)) from e
dbt.exceptions.RuntimeException: Runtime Error in model test_model1 (models/test_model1.sql)
  com.facebook.presto.v217.sql.analyzer.SemanticException: line 21:35: Column 'sample_buildings' is missing from left side of join
2021-11-29 13:33:16.597922 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45f3c13f-9ee5-4f17-8891-d0f5bae8d690', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f00d940>]}
2021-11-29 13:33:16.601948 (Thread-1): 13:33:16 | 1 of 5 ERROR creating view model dbt.test_model1..................... [ERROR in 1.61s]
2021-11-29 13:33:16.605429 (Thread-1): Finished running node model.my_new_project.test_model1
2021-11-29 13:33:16.609442 (Thread-1): Began running node model.my_new_project.test_model2
2021-11-29 13:33:16.613440 (Thread-1): 13:33:16 | 2 of 5 START view model dbt.test_model2.............................. [RUN]
2021-11-29 13:33:16.618552 (Thread-1): Acquiring new athena connection "model.my_new_project.test_model2".
2021-11-29 13:33:16.621459 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 54384), raddr=('52.55.74.167', 443)>
2021-11-29 13:33:16.625397 (Thread-1): Compiling model.my_new_project.test_model2
2021-11-29 13:33:16.630083 (Thread-1): Writing injected SQL for node "model.my_new_project.test_model2"
2021-11-29 13:33:16.636997 (Thread-1): finished collecting timing info
2021-11-29 13:33:16.640922 (Thread-1): Writing runtime SQL for node "model.my_new_project.test_model2"
2021-11-29 13:33:16.645419 (Thread-1): Using athena connection "model.my_new_project.test_model2".
2021-11-29 13:33:16.646494 (Thread-1): On model.my_new_project.test_model2: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    /*
from somewhere - get bldg_id and zip code --> bldg_locations
*/

2021-11-29 13:33:16.648098 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 13:33:16.665284 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    /*
from somewhere - get bldg_id and zip code --> bldg_locations
*/
2021-11-29 13:33:16.925713 (Thread-1): Failed to execute query.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 307, in _execute
    query_id = retry_api_call(
  File "/usr/local/lib/python3.8/site-packages/pyathena/util.py", line 84, in retry_api_call
    return retry(func, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 404, in __call__
    do = self.iter(retry_state=retry_state)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 349, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 407, in __call__
    result = fn(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 276, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 586, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
2021-11-29 13:33:16.929336 (Thread-1): Error running SQL: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    /*
from somewhere - get bldg_id and zip code --> bldg_locations
*/

2021-11-29 13:33:16.934390 (Thread-1): finished collecting timing info
2021-11-29 13:33:16.938494 (Thread-1): On model.my_new_project.test_model2: Close
2021-11-29 13:33:16.941969 (Thread-1): Runtime Error in model test_model2 (models/test_model2.sql)
  An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 307, in _execute
    query_id = retry_api_call(
  File "/usr/local/lib/python3.8/site-packages/pyathena/util.py", line 84, in retry_api_call
    return retry(func, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 404, in __call__
    do = self.iter(retry_state=retry_state)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 349, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 407, in __call__
    result = fn(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 276, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 586, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 100, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 72, in execute
    query_id = self._execute(
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 315, in _execute
    raise DatabaseError(*e.args) from e
pyathena.error.DatabaseError: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 66, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 103, in exception_handler
    raise RuntimeException(str(e)) from e
dbt.exceptions.RuntimeException: Runtime Error in model test_model2 (models/test_model2.sql)
  An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
2021-11-29 13:33:16.946310 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45f3c13f-9ee5-4f17-8891-d0f5bae8d690', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d37b340>]}
2021-11-29 13:33:16.949542 (Thread-1): 13:33:16 | 2 of 5 ERROR creating view model dbt.test_model2..................... [ERROR in 0.33s]
2021-11-29 13:33:16.952089 (Thread-1): Finished running node model.my_new_project.test_model2
2021-11-29 13:33:16.956527 (Thread-1): Began running node model.my_new_project.test_model3
2021-11-29 13:33:16.957749 (Thread-1): 13:33:16 | 3 of 5 SKIP relation dbt.test_model3................................. [SKIP]
2021-11-29 13:33:16.962288 (Thread-1): Finished running node model.my_new_project.test_model3
2021-11-29 13:33:16.965016 (Thread-1): Began running node model.my_new_project.test_model4
2021-11-29 13:33:16.965974 (Thread-1): 13:33:16 | 4 of 5 SKIP relation dbt.test_model4................................. [SKIP]
2021-11-29 13:33:16.968032 (Thread-1): Finished running node model.my_new_project.test_model4
2021-11-29 13:33:16.971338 (Thread-1): Began running node model.my_new_project.test_model5
2021-11-29 13:33:16.972445 (Thread-1): 13:33:16 | 5 of 5 SKIP relation dbt.test_model5................................. [SKIP]
2021-11-29 13:33:16.973815 (Thread-1): Finished running node model.my_new_project.test_model5
2021-11-29 13:33:16.978535 (MainThread): Acquiring new athena connection "master".
2021-11-29 13:33:16.979515 (MainThread): 13:33:16 | 
2021-11-29 13:33:16.981242 (MainThread): 13:33:16 | Finished running 5 view models in 6.91s.
2021-11-29 13:33:16.983088 (MainThread): Connection 'master' was properly closed.
2021-11-29 13:33:16.985871 (MainThread): Connection 'model.my_new_project.test_model2' was properly closed.
2021-11-29 13:33:17.000869 (MainThread): 
2021-11-29 13:33:17.002534 (MainThread): Completed with 2 errors and 0 warnings:
2021-11-29 13:33:17.004224 (MainThread): 
2021-11-29 13:33:17.007169 (MainThread): Runtime Error in model test_model1 (models/test_model1.sql)
2021-11-29 13:33:17.009637 (MainThread):   com.facebook.presto.v217.sql.analyzer.SemanticException: line 21:35: Column 'sample_buildings' is missing from left side of join
2021-11-29 13:33:17.011820 (MainThread): 
2021-11-29 13:33:17.015641 (MainThread): Runtime Error in model test_model2 (models/test_model2.sql)
2021-11-29 13:33:17.017425 (MainThread):   An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
2021-11-29 13:33:17.019133 (MainThread): 
Done. PASS=0 WARN=0 ERROR=2 SKIP=3 TOTAL=5
2021-11-29 13:33:17.020903 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa193d8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fa41f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fa9bb20>]}
2021-11-29 13:33:17.023134 (MainThread): Flushing usage events
2021-11-29 13:33:41.844877 (MainThread): Running with dbt=0.21.0
2021-11-29 13:33:41.911832 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/vscode/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-29 13:33:41.917397 (MainThread): Tracking: tracking
2021-11-29 13:33:41.920363 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96758910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9800fc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9800fd60>]}
2021-11-29 13:33:41.929479 (MainThread): Partial parsing not enabled
2021-11-29 13:33:41.942608 (MainThread): Parsing macros/catalog.sql
2021-11-29 13:33:41.945291 (MainThread): Parsing macros/adapters.sql
2021-11-29 13:33:41.955334 (MainThread): Parsing macros/materializations/seed.sql
2021-11-29 13:33:41.958472 (MainThread): Parsing macros/materializations/snapshot.sql
2021-11-29 13:33:41.959446 (MainThread): Parsing macros/materializations/table.sql
2021-11-29 13:33:41.962349 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-29 13:33:41.975724 (MainThread): Parsing macros/materializations/view.sql
2021-11-29 13:33:41.979431 (MainThread): Parsing macros/core.sql
2021-11-29 13:33:41.982482 (MainThread): Parsing macros/materializations/test.sql
2021-11-29 13:33:41.987318 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-29 13:33:41.993244 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-29 13:33:41.996489 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-29 13:33:42.001188 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-29 13:33:42.002780 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-29 13:33:42.009348 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-29 13:33:42.020460 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-29 13:33:42.032676 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-29 13:33:42.037295 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-29 13:33:42.045037 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-29 13:33:42.061892 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-29 13:33:42.072020 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-29 13:33:42.074508 (MainThread): Parsing macros/etc/query.sql
2021-11-29 13:33:42.076408 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-29 13:33:42.078914 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-29 13:33:42.081966 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-29 13:33:42.083402 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-29 13:33:42.085414 (MainThread): Parsing macros/etc/datetime.sql
2021-11-29 13:33:42.091439 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-29 13:33:42.092938 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-29 13:33:42.095617 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-29 13:33:42.096961 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-29 13:33:42.098955 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-29 13:33:42.101296 (MainThread): Parsing macros/adapters/common.sql
2021-11-29 13:33:42.206029 (MainThread): Acquiring new athena connection "model.my_new_project.test_model1".
2021-11-29 13:33:42.214113 (MainThread): Acquiring new athena connection "model.my_new_project.test_model2".
2021-11-29 13:33:42.216136 (MainThread): Acquiring new athena connection "model.my_new_project.test_model3".
2021-11-29 13:33:42.219153 (MainThread): Acquiring new athena connection "model.my_new_project.test_model4".
2021-11-29 13:33:42.221889 (MainThread): Acquiring new athena connection "model.my_new_project.test_model5".
2021-11-29 13:33:42.244370 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-11-29 13:33:42.248447 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '04bff479-41de-4b27-b140-15611e3a7b09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9611f760>]}
2021-11-29 13:33:42.259475 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-11-29 13:33:42.261194 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '04bff479-41de-4b27-b140-15611e3a7b09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9611fa30>]}
2021-11-29 13:33:42.262475 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 1 seed file, 0 sources, 0 exposures
2021-11-29 13:33:42.265039 (MainThread): 
2021-11-29 13:33:42.266432 (MainThread): Acquiring new athena connection "master".
2021-11-29 13:33:42.268497 (ThreadPoolExecutor-0_0): Acquiring new athena connection "list_awsdatacatalog".
2021-11-29 13:33:42.275289 (ThreadPoolExecutor-0_0): Using athena connection "list_awsdatacatalog".
2021-11-29 13:33:42.276523 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
  
2021-11-29 13:33:42.282198 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-29 13:33:42.302382 (ThreadPoolExecutor-0_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
2021-11-29 13:33:44.064156 (ThreadPoolExecutor-0_0): SQL status: OK -1 in 1.78 seconds
2021-11-29 13:33:44.075550 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: Close
2021-11-29 13:33:44.082555 (ThreadPoolExecutor-2_0): Acquiring new athena connection "list_awsdatacatalog_dbt".
2021-11-29 13:33:44.085491 (ThreadPoolExecutor-2_0): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 54392), raddr=('52.55.74.167', 443)>
2021-11-29 13:33:44.098467 (ThreadPoolExecutor-2_0): Using athena connection "list_awsdatacatalog_dbt".
2021-11-29 13:33:44.100120 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
2021-11-29 13:33:44.105915 (ThreadPoolExecutor-2_0): Opening a new connection, currently in state closed
2021-11-29 13:33:44.131409 (ThreadPoolExecutor-2_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
2021-11-29 13:33:47.302537 (ThreadPoolExecutor-2_0): SQL status: OK -1 in 3.20 seconds
2021-11-29 13:33:47.311316 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: Close
2021-11-29 13:33:47.317356 (MainThread): 13:33:47 | Concurrency: 1 threads (target='dev')
2021-11-29 13:33:47.320992 (MainThread): 13:33:47 | 
2021-11-29 13:33:47.328564 (Thread-1): Began running node model.my_new_project.test_model1
2021-11-29 13:33:47.330403 (Thread-1): 13:33:47 | 1 of 5 START view model dbt.test_model1.............................. [RUN]
2021-11-29 13:33:47.333778 (Thread-1): Acquiring new athena connection "model.my_new_project.test_model1".
2021-11-29 13:33:47.336934 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 54394), raddr=('52.55.74.167', 443)>
2021-11-29 13:33:47.340733 (Thread-1): Compiling model.my_new_project.test_model1
2021-11-29 13:33:47.346353 (Thread-1): Writing injected SQL for node "model.my_new_project.test_model1"
2021-11-29 13:33:47.352297 (Thread-1): finished collecting timing info
2021-11-29 13:33:47.367796 (Thread-1): Writing runtime SQL for node "model.my_new_project.test_model1"
2021-11-29 13:33:47.371904 (Thread-1): Using athena connection "model.my_new_project.test_model1".
2021-11-29 13:33:47.373530 (Thread-1): On model.my_new_project.test_model1: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    With sample_buildings as (
    SELECT 
        bldg_fid/*,
        city,
        state*/
    FROM "defaultdb"."buildings" 
    group by 1
)
/*where county='G5500690' */

Select 
    sum(out.electricity.clothes_dryer.energy_consumption),
    bldg_id
from "defaultdb"."resby_puma_northeast"


left join sample_buildings using (bldg_fid)

2021-11-29 13:33:47.376049 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 13:33:47.392872 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    With sample_buildings as (
    SELECT 
        bldg_fid/*,
        city,
        state*/
    FROM "defaultdb"."buildings" 
    group by 1
)
/*where county='G5500690' */

Select 
    sum(out.electricity.clothes_dryer.energy_consumption),
    bldg_id
from "defaultdb"."resby_puma_northeast"


left join sample_buildings using (bldg_fid)
2021-11-29 13:33:48.907422 (Thread-1): Error running SQL: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    With sample_buildings as (
    SELECT 
        bldg_fid/*,
        city,
        state*/
    FROM "defaultdb"."buildings" 
    group by 1
)
/*where county='G5500690' */

Select 
    sum(out.electricity.clothes_dryer.energy_consumption),
    bldg_id
from "defaultdb"."resby_puma_northeast"


left join sample_buildings using (bldg_fid)

2021-11-29 13:33:48.911034 (Thread-1): finished collecting timing info
2021-11-29 13:33:48.918856 (Thread-1): On model.my_new_project.test_model1: Close
2021-11-29 13:33:48.924073 (Thread-1): Runtime Error in model test_model1 (models/test_model1.sql)
  com.facebook.presto.v217.sql.analyzer.SemanticException: line 21:35: Column 'bldg_fid' is missing from left side of join
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 100, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 90, in execute
    raise OperationalError(query_execution.state_change_reason)
pyathena.error.OperationalError: com.facebook.presto.v217.sql.analyzer.SemanticException: line 21:35: Column 'bldg_fid' is missing from left side of join

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 66, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 103, in exception_handler
    raise RuntimeException(str(e)) from e
dbt.exceptions.RuntimeException: Runtime Error in model test_model1 (models/test_model1.sql)
  com.facebook.presto.v217.sql.analyzer.SemanticException: line 21:35: Column 'bldg_fid' is missing from left side of join
2021-11-29 13:33:48.933092 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04bff479-41de-4b27-b140-15611e3a7b09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff956ff7c0>]}
2021-11-29 13:33:48.937092 (Thread-1): 13:33:48 | 1 of 5 ERROR creating view model dbt.test_model1..................... [ERROR in 1.60s]
2021-11-29 13:33:48.940030 (Thread-1): Finished running node model.my_new_project.test_model1
2021-11-29 13:33:48.943257 (Thread-1): Began running node model.my_new_project.test_model2
2021-11-29 13:33:48.946030 (Thread-1): 13:33:48 | 2 of 5 START view model dbt.test_model2.............................. [RUN]
2021-11-29 13:33:48.949246 (Thread-1): Acquiring new athena connection "model.my_new_project.test_model2".
2021-11-29 13:33:48.954280 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 54396), raddr=('52.55.74.167', 443)>
2021-11-29 13:33:48.958290 (Thread-1): Compiling model.my_new_project.test_model2
2021-11-29 13:33:48.962745 (Thread-1): Writing injected SQL for node "model.my_new_project.test_model2"
2021-11-29 13:33:48.968996 (Thread-1): finished collecting timing info
2021-11-29 13:33:48.973373 (Thread-1): Writing runtime SQL for node "model.my_new_project.test_model2"
2021-11-29 13:33:48.978277 (Thread-1): Using athena connection "model.my_new_project.test_model2".
2021-11-29 13:33:48.979296 (Thread-1): On model.my_new_project.test_model2: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    /*
from somewhere - get bldg_id and zip code --> bldg_locations
*/

2021-11-29 13:33:48.980991 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 13:33:48.998046 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    /*
from somewhere - get bldg_id and zip code --> bldg_locations
*/
2021-11-29 13:33:49.248493 (Thread-1): Failed to execute query.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 307, in _execute
    query_id = retry_api_call(
  File "/usr/local/lib/python3.8/site-packages/pyathena/util.py", line 84, in retry_api_call
    return retry(func, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 404, in __call__
    do = self.iter(retry_state=retry_state)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 349, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 407, in __call__
    result = fn(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 276, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 586, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
2021-11-29 13:33:49.254366 (Thread-1): Error running SQL: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    /*
from somewhere - get bldg_id and zip code --> bldg_locations
*/

2021-11-29 13:33:49.259870 (Thread-1): finished collecting timing info
2021-11-29 13:33:49.264958 (Thread-1): On model.my_new_project.test_model2: Close
2021-11-29 13:33:49.269533 (Thread-1): Runtime Error in model test_model2 (models/test_model2.sql)
  An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 307, in _execute
    query_id = retry_api_call(
  File "/usr/local/lib/python3.8/site-packages/pyathena/util.py", line 84, in retry_api_call
    return retry(func, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 404, in __call__
    do = self.iter(retry_state=retry_state)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 349, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 407, in __call__
    result = fn(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 276, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 586, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 100, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 72, in execute
    query_id = self._execute(
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 315, in _execute
    raise DatabaseError(*e.args) from e
pyathena.error.DatabaseError: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 66, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 103, in exception_handler
    raise RuntimeException(str(e)) from e
dbt.exceptions.RuntimeException: Runtime Error in model test_model2 (models/test_model2.sql)
  An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
2021-11-29 13:33:49.273497 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04bff479-41de-4b27-b140-15611e3a7b09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9420a790>]}
2021-11-29 13:33:49.277192 (Thread-1): 13:33:49 | 2 of 5 ERROR creating view model dbt.test_model2..................... [ERROR in 0.32s]
2021-11-29 13:33:49.279127 (Thread-1): Finished running node model.my_new_project.test_model2
2021-11-29 13:33:49.282791 (Thread-1): Began running node model.my_new_project.test_model3
2021-11-29 13:33:49.285265 (Thread-1): 13:33:49 | 3 of 5 SKIP relation dbt.test_model3................................. [SKIP]
2021-11-29 13:33:49.287535 (Thread-1): Finished running node model.my_new_project.test_model3
2021-11-29 13:33:49.291723 (Thread-1): Began running node model.my_new_project.test_model4
2021-11-29 13:33:49.293991 (Thread-1): 13:33:49 | 4 of 5 SKIP relation dbt.test_model4................................. [SKIP]
2021-11-29 13:33:49.295785 (Thread-1): Finished running node model.my_new_project.test_model4
2021-11-29 13:33:49.298188 (Thread-1): Began running node model.my_new_project.test_model5
2021-11-29 13:33:49.299966 (Thread-1): 13:33:49 | 5 of 5 SKIP relation dbt.test_model5................................. [SKIP]
2021-11-29 13:33:49.301885 (Thread-1): Finished running node model.my_new_project.test_model5
2021-11-29 13:33:49.305024 (MainThread): Acquiring new athena connection "master".
2021-11-29 13:33:49.305883 (MainThread): 13:33:49 | 
2021-11-29 13:33:49.307536 (MainThread): 13:33:49 | Finished running 5 view models in 7.04s.
2021-11-29 13:33:49.309263 (MainThread): Connection 'master' was properly closed.
2021-11-29 13:33:49.310850 (MainThread): Connection 'model.my_new_project.test_model2' was properly closed.
2021-11-29 13:33:49.325974 (MainThread): 
2021-11-29 13:33:49.326798 (MainThread): Completed with 2 errors and 0 warnings:
2021-11-29 13:33:49.328891 (MainThread): 
2021-11-29 13:33:49.331317 (MainThread): Runtime Error in model test_model1 (models/test_model1.sql)
2021-11-29 13:33:49.333483 (MainThread):   com.facebook.presto.v217.sql.analyzer.SemanticException: line 21:35: Column 'bldg_fid' is missing from left side of join
2021-11-29 13:33:49.335142 (MainThread): 
2021-11-29 13:33:49.336893 (MainThread): Runtime Error in model test_model2 (models/test_model2.sql)
2021-11-29 13:33:49.338595 (MainThread):   An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
2021-11-29 13:33:49.342096 (MainThread): 
Done. PASS=0 WARN=0 ERROR=2 SKIP=3 TOTAL=5
2021-11-29 13:33:49.344563 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9802f160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94dfed30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97faedf0>]}
2021-11-29 13:33:49.346293 (MainThread): Flushing usage events
2021-11-29 14:05:13.943551 (MainThread): Running with dbt=0.21.0
2021-11-29 14:05:14.031602 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/vscode/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-29 14:05:14.039642 (MainThread): Tracking: tracking
2021-11-29 14:05:14.044602 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f02d580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff808c9cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff808c9e50>]}
2021-11-29 14:05:14.060038 (MainThread): Partial parsing not enabled
2021-11-29 14:05:14.081925 (MainThread): Parsing macros/catalog.sql
2021-11-29 14:05:14.084673 (MainThread): Parsing macros/adapters.sql
2021-11-29 14:05:14.094157 (MainThread): Parsing macros/materializations/seed.sql
2021-11-29 14:05:14.099119 (MainThread): Parsing macros/materializations/snapshot.sql
2021-11-29 14:05:14.100726 (MainThread): Parsing macros/materializations/table.sql
2021-11-29 14:05:14.105010 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-29 14:05:14.120481 (MainThread): Parsing macros/materializations/view.sql
2021-11-29 14:05:14.125768 (MainThread): Parsing macros/core.sql
2021-11-29 14:05:14.129324 (MainThread): Parsing macros/materializations/test.sql
2021-11-29 14:05:14.133763 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-29 14:05:14.140219 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-29 14:05:14.145532 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-29 14:05:14.150635 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-29 14:05:14.152393 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-29 14:05:14.158526 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-29 14:05:14.170555 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-29 14:05:14.185102 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-29 14:05:14.190828 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-29 14:05:14.200052 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-29 14:05:14.218319 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-29 14:05:14.228830 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-29 14:05:14.231079 (MainThread): Parsing macros/etc/query.sql
2021-11-29 14:05:14.234223 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-29 14:05:14.236957 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-29 14:05:14.239583 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-29 14:05:14.242002 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-29 14:05:14.248093 (MainThread): Parsing macros/etc/datetime.sql
2021-11-29 14:05:14.253807 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-29 14:05:14.257196 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-29 14:05:14.259334 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-29 14:05:14.261323 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-29 14:05:14.263314 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-29 14:05:14.265836 (MainThread): Parsing macros/adapters/common.sql
2021-11-29 14:05:14.386130 (MainThread): Acquiring new athena connection "model.my_new_project.test_model1".
2021-11-29 14:05:14.395639 (MainThread): Acquiring new athena connection "model.my_new_project.test_model2".
2021-11-29 14:05:14.399451 (MainThread): Acquiring new athena connection "model.my_new_project.test_model3".
2021-11-29 14:05:14.404189 (MainThread): Acquiring new athena connection "model.my_new_project.test_model4".
2021-11-29 14:05:14.408454 (MainThread): Acquiring new athena connection "model.my_new_project.test_model5".
2021-11-29 14:05:14.438544 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-11-29 14:05:14.443687 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b68b709d-a5a5-404f-9881-7de1a2dd1170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ea32df0>]}
2021-11-29 14:05:14.464861 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-11-29 14:05:14.466958 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b68b709d-a5a5-404f-9881-7de1a2dd1170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ea32a60>]}
2021-11-29 14:05:14.468724 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 1 seed file, 0 sources, 0 exposures
2021-11-29 14:05:14.472615 (MainThread): 
2021-11-29 14:05:14.473753 (MainThread): Acquiring new athena connection "master".
2021-11-29 14:05:14.476922 (ThreadPoolExecutor-0_0): Acquiring new athena connection "list_awsdatacatalog".
2021-11-29 14:05:14.488759 (ThreadPoolExecutor-0_0): Using athena connection "list_awsdatacatalog".
2021-11-29 14:05:14.489684 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
  
2021-11-29 14:05:14.492026 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-29 14:05:14.528991 (ThreadPoolExecutor-0_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
2021-11-29 14:05:16.416433 (ThreadPoolExecutor-0_0): SQL status: OK -1 in 1.92 seconds
2021-11-29 14:05:16.421397 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: Close
2021-11-29 14:05:16.424736 (ThreadPoolExecutor-2_0): Acquiring new athena connection "list_awsdatacatalog_dbt".
2021-11-29 14:05:16.425788 (ThreadPoolExecutor-2_0): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 33396), raddr=('3.226.93.250', 443)>
2021-11-29 14:05:16.432878 (ThreadPoolExecutor-2_0): Using athena connection "list_awsdatacatalog_dbt".
2021-11-29 14:05:16.434050 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
2021-11-29 14:05:16.436216 (ThreadPoolExecutor-2_0): Opening a new connection, currently in state closed
2021-11-29 14:05:16.458463 (ThreadPoolExecutor-2_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
2021-11-29 14:05:20.442601 (ThreadPoolExecutor-2_0): SQL status: OK -1 in 4.01 seconds
2021-11-29 14:05:20.448421 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: Close
2021-11-29 14:05:20.451354 (MainThread): 14:05:20 | Concurrency: 1 threads (target='dev')
2021-11-29 14:05:20.452698 (MainThread): 14:05:20 | 
2021-11-29 14:05:20.460681 (Thread-1): Began running node model.my_new_project.test_model1
2021-11-29 14:05:20.461890 (Thread-1): 14:05:20 | 1 of 5 START view model dbt.test_model1.............................. [RUN]
2021-11-29 14:05:20.466074 (Thread-1): Acquiring new athena connection "model.my_new_project.test_model1".
2021-11-29 14:05:20.471445 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 33398), raddr=('3.226.93.250', 443)>
2021-11-29 14:05:20.473751 (Thread-1): Compiling model.my_new_project.test_model1
2021-11-29 14:05:20.478806 (Thread-1): Writing injected SQL for node "model.my_new_project.test_model1"
2021-11-29 14:05:20.488750 (Thread-1): finished collecting timing info
2021-11-29 14:05:20.503691 (Thread-1): Writing runtime SQL for node "model.my_new_project.test_model1"
2021-11-29 14:05:20.512448 (Thread-1): Using athena connection "model.my_new_project.test_model1".
2021-11-29 14:05:20.513465 (Thread-1): On model.my_new_project.test_model1: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    With sample_buildings as (
    SELECT 
        bldg_fid/*,
        city,
        state*/
    FROM "defaultdb"."buildings" 
    /*group by 1*/
)
/*where county='G5500690' */

Select 
    sum(out.electricity.clothes_dryer.energy_consumption),
    bldg_id
from "defaultdb"."resby_puma_northeast"


left join sample_buildings using (bldg_fid)

2021-11-29 14:05:20.514957 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 14:05:20.533446 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    With sample_buildings as (
    SELECT 
        bldg_fid/*,
        city,
        state*/
    FROM "defaultdb"."buildings" 
    /*group by 1*/
)
/*where county='G5500690' */

Select 
    sum(out.electricity.clothes_dryer.energy_consumption),
    bldg_id
from "defaultdb"."resby_puma_northeast"


left join sample_buildings using (bldg_fid)
2021-11-29 14:05:22.038062 (Thread-1): Error running SQL: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    With sample_buildings as (
    SELECT 
        bldg_fid/*,
        city,
        state*/
    FROM "defaultdb"."buildings" 
    /*group by 1*/
)
/*where county='G5500690' */

Select 
    sum(out.electricity.clothes_dryer.energy_consumption),
    bldg_id
from "defaultdb"."resby_puma_northeast"


left join sample_buildings using (bldg_fid)

2021-11-29 14:05:22.042567 (Thread-1): finished collecting timing info
2021-11-29 14:05:22.050589 (Thread-1): On model.my_new_project.test_model1: Close
2021-11-29 14:05:22.057592 (Thread-1): Runtime Error in model test_model1 (models/test_model1.sql)
  com.facebook.presto.v217.sql.analyzer.SemanticException: line 21:35: Column 'bldg_fid' is missing from left side of join
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 100, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 90, in execute
    raise OperationalError(query_execution.state_change_reason)
pyathena.error.OperationalError: com.facebook.presto.v217.sql.analyzer.SemanticException: line 21:35: Column 'bldg_fid' is missing from left side of join

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 66, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 103, in exception_handler
    raise RuntimeException(str(e)) from e
dbt.exceptions.RuntimeException: Runtime Error in model test_model1 (models/test_model1.sql)
  com.facebook.presto.v217.sql.analyzer.SemanticException: line 21:35: Column 'bldg_fid' is missing from left side of join
2021-11-29 14:05:22.065049 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b68b709d-a5a5-404f-9881-7de1a2dd1170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7dfba910>]}
2021-11-29 14:05:22.071534 (Thread-1): 14:05:22 | 1 of 5 ERROR creating view model dbt.test_model1..................... [ERROR in 1.60s]
2021-11-29 14:05:22.074858 (Thread-1): Finished running node model.my_new_project.test_model1
2021-11-29 14:05:22.079660 (Thread-1): Began running node model.my_new_project.test_model2
2021-11-29 14:05:22.082006 (Thread-1): 14:05:22 | 2 of 5 START view model dbt.test_model2.............................. [RUN]
2021-11-29 14:05:22.083611 (Thread-1): Acquiring new athena connection "model.my_new_project.test_model2".
2021-11-29 14:05:22.086601 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 33400), raddr=('3.226.93.250', 443)>
2021-11-29 14:05:22.088753 (Thread-1): Compiling model.my_new_project.test_model2
2021-11-29 14:05:22.095911 (Thread-1): Writing injected SQL for node "model.my_new_project.test_model2"
2021-11-29 14:05:22.103229 (Thread-1): finished collecting timing info
2021-11-29 14:05:22.106784 (Thread-1): Writing runtime SQL for node "model.my_new_project.test_model2"
2021-11-29 14:05:22.113687 (Thread-1): Using athena connection "model.my_new_project.test_model2".
2021-11-29 14:05:22.114672 (Thread-1): On model.my_new_project.test_model2: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    /*
from somewhere - get bldg_id and zip code --> bldg_locations
*/

2021-11-29 14:05:22.116744 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 14:05:22.138448 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    /*
from somewhere - get bldg_id and zip code --> bldg_locations
*/
2021-11-29 14:05:22.367074 (Thread-1): Failed to execute query.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 307, in _execute
    query_id = retry_api_call(
  File "/usr/local/lib/python3.8/site-packages/pyathena/util.py", line 84, in retry_api_call
    return retry(func, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 404, in __call__
    do = self.iter(retry_state=retry_state)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 349, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 407, in __call__
    result = fn(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 276, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 586, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
2021-11-29 14:05:22.368808 (Thread-1): Error running SQL: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    /*
from somewhere - get bldg_id and zip code --> bldg_locations
*/

2021-11-29 14:05:22.371886 (Thread-1): finished collecting timing info
2021-11-29 14:05:22.373657 (Thread-1): On model.my_new_project.test_model2: Close
2021-11-29 14:05:22.377681 (Thread-1): Runtime Error in model test_model2 (models/test_model2.sql)
  An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 307, in _execute
    query_id = retry_api_call(
  File "/usr/local/lib/python3.8/site-packages/pyathena/util.py", line 84, in retry_api_call
    return retry(func, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 404, in __call__
    do = self.iter(retry_state=retry_state)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 349, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 407, in __call__
    result = fn(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 276, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 586, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 100, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 72, in execute
    query_id = self._execute(
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 315, in _execute
    raise DatabaseError(*e.args) from e
pyathena.error.DatabaseError: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 66, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 103, in exception_handler
    raise RuntimeException(str(e)) from e
dbt.exceptions.RuntimeException: Runtime Error in model test_model2 (models/test_model2.sql)
  An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
2021-11-29 14:05:22.380857 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b68b709d-a5a5-404f-9881-7de1a2dd1170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c327fa0>]}
2021-11-29 14:05:22.382708 (Thread-1): 14:05:22 | 2 of 5 ERROR creating view model dbt.test_model2..................... [ERROR in 0.30s]
2021-11-29 14:05:22.384528 (Thread-1): Finished running node model.my_new_project.test_model2
2021-11-29 14:05:22.387112 (Thread-1): Began running node model.my_new_project.test_model3
2021-11-29 14:05:22.388793 (Thread-1): 14:05:22 | 3 of 5 SKIP relation dbt.test_model3................................. [SKIP]
2021-11-29 14:05:22.392030 (Thread-1): Finished running node model.my_new_project.test_model3
2021-11-29 14:05:22.396118 (Thread-1): Began running node model.my_new_project.test_model4
2021-11-29 14:05:22.401421 (Thread-1): 14:05:22 | 4 of 5 SKIP relation dbt.test_model4................................. [SKIP]
2021-11-29 14:05:22.404472 (Thread-1): Finished running node model.my_new_project.test_model4
2021-11-29 14:05:22.408922 (Thread-1): Began running node model.my_new_project.test_model5
2021-11-29 14:05:22.411538 (Thread-1): 14:05:22 | 5 of 5 SKIP relation dbt.test_model5................................. [SKIP]
2021-11-29 14:05:22.414672 (Thread-1): Finished running node model.my_new_project.test_model5
2021-11-29 14:05:22.422209 (MainThread): Acquiring new athena connection "master".
2021-11-29 14:05:22.426123 (MainThread): 14:05:22 | 
2021-11-29 14:05:22.434701 (MainThread): 14:05:22 | Finished running 5 view models in 7.95s.
2021-11-29 14:05:22.439571 (MainThread): Connection 'master' was properly closed.
2021-11-29 14:05:22.446599 (MainThread): Connection 'model.my_new_project.test_model2' was properly closed.
2021-11-29 14:05:22.472658 (MainThread): 
2021-11-29 14:05:22.477735 (MainThread): Completed with 2 errors and 0 warnings:
2021-11-29 14:05:22.480982 (MainThread): 
2021-11-29 14:05:22.484520 (MainThread): Runtime Error in model test_model1 (models/test_model1.sql)
2021-11-29 14:05:22.488175 (MainThread):   com.facebook.presto.v217.sql.analyzer.SemanticException: line 21:35: Column 'bldg_fid' is missing from left side of join
2021-11-29 14:05:22.490947 (MainThread): 
2021-11-29 14:05:22.500054 (MainThread): Runtime Error in model test_model2 (models/test_model2.sql)
2021-11-29 14:05:22.503034 (MainThread):   An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
2021-11-29 14:05:22.505166 (MainThread): 
Done. PASS=0 WARN=0 ERROR=2 SKIP=3 TOTAL=5
2021-11-29 14:05:22.507083 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff808e9520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ea47af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e9edfd0>]}
2021-11-29 14:05:22.512996 (MainThread): Flushing usage events
2021-11-29 14:07:55.272316 (MainThread): Running with dbt=0.21.0
2021-11-29 14:07:55.362848 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/vscode/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-29 14:07:55.369587 (MainThread): Tracking: tracking
2021-11-29 14:07:55.374251 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80e0e5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff826aa2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff826aadc0>]}
2021-11-29 14:07:55.386803 (MainThread): Partial parsing not enabled
2021-11-29 14:07:55.410641 (MainThread): Parsing macros/catalog.sql
2021-11-29 14:07:55.413833 (MainThread): Parsing macros/adapters.sql
2021-11-29 14:07:55.423417 (MainThread): Parsing macros/materializations/seed.sql
2021-11-29 14:07:55.426891 (MainThread): Parsing macros/materializations/snapshot.sql
2021-11-29 14:07:55.427958 (MainThread): Parsing macros/materializations/table.sql
2021-11-29 14:07:55.431034 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-29 14:07:55.446416 (MainThread): Parsing macros/materializations/view.sql
2021-11-29 14:07:55.450606 (MainThread): Parsing macros/core.sql
2021-11-29 14:07:55.453410 (MainThread): Parsing macros/materializations/test.sql
2021-11-29 14:07:55.458166 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-29 14:07:55.465405 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-29 14:07:55.471019 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-29 14:07:55.477337 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-29 14:07:55.479911 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-29 14:07:55.486097 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-29 14:07:55.497772 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-29 14:07:55.512671 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-29 14:07:55.517758 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-29 14:07:55.528085 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-29 14:07:55.547849 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-29 14:07:55.557943 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-29 14:07:55.560831 (MainThread): Parsing macros/etc/query.sql
2021-11-29 14:07:55.563213 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-29 14:07:55.566829 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-29 14:07:55.568776 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-29 14:07:55.572613 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-29 14:07:55.576372 (MainThread): Parsing macros/etc/datetime.sql
2021-11-29 14:07:55.586062 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-29 14:07:55.588930 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-29 14:07:55.591964 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-29 14:07:55.596015 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-29 14:07:55.600141 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-29 14:07:55.603815 (MainThread): Parsing macros/adapters/common.sql
2021-11-29 14:07:55.725552 (MainThread): Acquiring new athena connection "model.my_new_project.test_model1".
2021-11-29 14:07:55.735845 (MainThread): Acquiring new athena connection "model.my_new_project.test_model2".
2021-11-29 14:07:55.739887 (MainThread): Acquiring new athena connection "model.my_new_project.test_model3".
2021-11-29 14:07:55.745432 (MainThread): Acquiring new athena connection "model.my_new_project.test_model4".
2021-11-29 14:07:55.748446 (MainThread): Acquiring new athena connection "model.my_new_project.test_model5".
2021-11-29 14:07:55.779246 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-11-29 14:07:55.783306 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5507f5e1-3027-4456-b202-6d98814acb84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff808395e0>]}
2021-11-29 14:07:55.803566 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-11-29 14:07:55.806113 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5507f5e1-3027-4456-b202-6d98814acb84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80854bb0>]}
2021-11-29 14:07:55.809012 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 1 seed file, 0 sources, 0 exposures
2021-11-29 14:07:55.813352 (MainThread): 
2021-11-29 14:07:55.814307 (MainThread): Acquiring new athena connection "master".
2021-11-29 14:07:55.817147 (ThreadPoolExecutor-0_0): Acquiring new athena connection "list_awsdatacatalog".
2021-11-29 14:07:55.824608 (ThreadPoolExecutor-0_0): Using athena connection "list_awsdatacatalog".
2021-11-29 14:07:55.825687 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
  
2021-11-29 14:07:55.827264 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-29 14:07:55.864918 (ThreadPoolExecutor-0_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
2021-11-29 14:07:57.669044 (ThreadPoolExecutor-0_0): SQL status: OK -1 in 1.84 seconds
2021-11-29 14:07:57.681084 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: Close
2021-11-29 14:07:57.684621 (ThreadPoolExecutor-2_0): Acquiring new athena connection "list_awsdatacatalog_dbt".
2021-11-29 14:07:57.688720 (ThreadPoolExecutor-2_0): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 53632), raddr=('23.22.122.26', 443)>
2021-11-29 14:07:57.696392 (ThreadPoolExecutor-2_0): Using athena connection "list_awsdatacatalog_dbt".
2021-11-29 14:07:57.697636 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
2021-11-29 14:07:57.700097 (ThreadPoolExecutor-2_0): Opening a new connection, currently in state closed
2021-11-29 14:07:57.722929 (ThreadPoolExecutor-2_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
2021-11-29 14:08:00.595185 (ThreadPoolExecutor-2_0): SQL status: OK -1 in 2.90 seconds
2021-11-29 14:08:00.602131 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: Close
2021-11-29 14:08:00.610792 (MainThread): 14:08:00 | Concurrency: 1 threads (target='dev')
2021-11-29 14:08:00.612608 (MainThread): 14:08:00 | 
2021-11-29 14:08:00.618234 (Thread-1): Began running node model.my_new_project.test_model1
2021-11-29 14:08:00.619251 (Thread-1): 14:08:00 | 1 of 5 START view model dbt.test_model1.............................. [RUN]
2021-11-29 14:08:00.621447 (Thread-1): Acquiring new athena connection "model.my_new_project.test_model1".
2021-11-29 14:08:00.623056 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 53634), raddr=('23.22.122.26', 443)>
2021-11-29 14:08:00.625548 (Thread-1): Compiling model.my_new_project.test_model1
2021-11-29 14:08:00.628192 (Thread-1): Writing injected SQL for node "model.my_new_project.test_model1"
2021-11-29 14:08:00.634889 (Thread-1): finished collecting timing info
2021-11-29 14:08:00.651192 (Thread-1): Writing runtime SQL for node "model.my_new_project.test_model1"
2021-11-29 14:08:00.657753 (Thread-1): Using athena connection "model.my_new_project.test_model1".
2021-11-29 14:08:00.662808 (Thread-1): On model.my_new_project.test_model1: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    With sample_buildings as (
    SELECT 
        bldg_fid/*,
        city,
        state*/
    FROM "defaultdb"."buildings" 
    /*group by 1*/
)
/*where county='G5500690' */

Select 
    sum(out.electricity.clothes_dryer.energy_consumption),
    bldg_id as "bldg_fid"
from "defaultdb"."resby_puma_northeast"


left join sample_buildings using (bldg_fid)

2021-11-29 14:08:00.666764 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 14:08:00.687077 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    With sample_buildings as (
    SELECT 
        bldg_fid/*,
        city,
        state*/
    FROM "defaultdb"."buildings" 
    /*group by 1*/
)
/*where county='G5500690' */

Select 
    sum(out.electricity.clothes_dryer.energy_consumption),
    bldg_id as "bldg_fid"
from "defaultdb"."resby_puma_northeast"


left join sample_buildings using (bldg_fid)
2021-11-29 14:08:02.166976 (Thread-1): Error running SQL: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    With sample_buildings as (
    SELECT 
        bldg_fid/*,
        city,
        state*/
    FROM "defaultdb"."buildings" 
    /*group by 1*/
)
/*where county='G5500690' */

Select 
    sum(out.electricity.clothes_dryer.energy_consumption),
    bldg_id as "bldg_fid"
from "defaultdb"."resby_puma_northeast"


left join sample_buildings using (bldg_fid)

2021-11-29 14:08:02.172969 (Thread-1): finished collecting timing info
2021-11-29 14:08:02.180063 (Thread-1): On model.my_new_project.test_model1: Close
2021-11-29 14:08:02.189896 (Thread-1): Runtime Error in model test_model1 (models/test_model1.sql)
  com.facebook.presto.v217.sql.analyzer.SemanticException: line 21:35: Column 'bldg_fid' is missing from left side of join
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 100, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 90, in execute
    raise OperationalError(query_execution.state_change_reason)
pyathena.error.OperationalError: com.facebook.presto.v217.sql.analyzer.SemanticException: line 21:35: Column 'bldg_fid' is missing from left side of join

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 66, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 103, in exception_handler
    raise RuntimeException(str(e)) from e
dbt.exceptions.RuntimeException: Runtime Error in model test_model1 (models/test_model1.sql)
  com.facebook.presto.v217.sql.analyzer.SemanticException: line 21:35: Column 'bldg_fid' is missing from left side of join
2021-11-29 14:08:02.196781 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5507f5e1-3027-4456-b202-6d98814acb84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fd9b850>]}
2021-11-29 14:08:02.199828 (Thread-1): 14:08:02 | 1 of 5 ERROR creating view model dbt.test_model1..................... [ERROR in 1.58s]
2021-11-29 14:08:02.202237 (Thread-1): Finished running node model.my_new_project.test_model1
2021-11-29 14:08:02.205892 (Thread-1): Began running node model.my_new_project.test_model2
2021-11-29 14:08:02.209927 (Thread-1): 14:08:02 | 2 of 5 START view model dbt.test_model2.............................. [RUN]
2021-11-29 14:08:02.213327 (Thread-1): Acquiring new athena connection "model.my_new_project.test_model2".
2021-11-29 14:08:02.215785 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 53636), raddr=('23.22.122.26', 443)>
2021-11-29 14:08:02.219339 (Thread-1): Compiling model.my_new_project.test_model2
2021-11-29 14:08:02.222358 (Thread-1): Writing injected SQL for node "model.my_new_project.test_model2"
2021-11-29 14:08:02.230773 (Thread-1): finished collecting timing info
2021-11-29 14:08:02.234980 (Thread-1): Writing runtime SQL for node "model.my_new_project.test_model2"
2021-11-29 14:08:02.239981 (Thread-1): Using athena connection "model.my_new_project.test_model2".
2021-11-29 14:08:02.243130 (Thread-1): On model.my_new_project.test_model2: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    /*
from somewhere - get bldg_id and zip code --> bldg_locations
*/

2021-11-29 14:08:02.247106 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 14:08:02.267497 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    /*
from somewhere - get bldg_id and zip code --> bldg_locations
*/
2021-11-29 14:08:02.504194 (Thread-1): Failed to execute query.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 307, in _execute
    query_id = retry_api_call(
  File "/usr/local/lib/python3.8/site-packages/pyathena/util.py", line 84, in retry_api_call
    return retry(func, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 404, in __call__
    do = self.iter(retry_state=retry_state)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 349, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 407, in __call__
    result = fn(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 276, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 586, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
2021-11-29 14:08:02.508356 (Thread-1): Error running SQL: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    /*
from somewhere - get bldg_id and zip code --> bldg_locations
*/

2021-11-29 14:08:02.512628 (Thread-1): finished collecting timing info
2021-11-29 14:08:02.516259 (Thread-1): On model.my_new_project.test_model2: Close
2021-11-29 14:08:02.519764 (Thread-1): Runtime Error in model test_model2 (models/test_model2.sql)
  An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 307, in _execute
    query_id = retry_api_call(
  File "/usr/local/lib/python3.8/site-packages/pyathena/util.py", line 84, in retry_api_call
    return retry(func, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 404, in __call__
    do = self.iter(retry_state=retry_state)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 349, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 407, in __call__
    result = fn(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 276, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 586, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 100, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 72, in execute
    query_id = self._execute(
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 315, in _execute
    raise DatabaseError(*e.args) from e
pyathena.error.DatabaseError: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 66, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 103, in exception_handler
    raise RuntimeException(str(e)) from e
dbt.exceptions.RuntimeException: Runtime Error in model test_model2 (models/test_model2.sql)
  An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
2021-11-29 14:08:02.523960 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5507f5e1-3027-4456-b202-6d98814acb84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e0a5ee0>]}
2021-11-29 14:08:02.527036 (Thread-1): 14:08:02 | 2 of 5 ERROR creating view model dbt.test_model2..................... [ERROR in 0.31s]
2021-11-29 14:08:02.530948 (Thread-1): Finished running node model.my_new_project.test_model2
2021-11-29 14:08:02.535934 (Thread-1): Began running node model.my_new_project.test_model3
2021-11-29 14:08:02.538768 (Thread-1): 14:08:02 | 3 of 5 SKIP relation dbt.test_model3................................. [SKIP]
2021-11-29 14:08:02.547417 (Thread-1): Finished running node model.my_new_project.test_model3
2021-11-29 14:08:02.552599 (Thread-1): Began running node model.my_new_project.test_model4
2021-11-29 14:08:02.555315 (Thread-1): 14:08:02 | 4 of 5 SKIP relation dbt.test_model4................................. [SKIP]
2021-11-29 14:08:02.559856 (Thread-1): Finished running node model.my_new_project.test_model4
2021-11-29 14:08:02.567786 (Thread-1): Began running node model.my_new_project.test_model5
2021-11-29 14:08:02.570872 (Thread-1): 14:08:02 | 5 of 5 SKIP relation dbt.test_model5................................. [SKIP]
2021-11-29 14:08:02.573268 (Thread-1): Finished running node model.my_new_project.test_model5
2021-11-29 14:08:02.581199 (MainThread): Acquiring new athena connection "master".
2021-11-29 14:08:02.585378 (MainThread): 14:08:02 | 
2021-11-29 14:08:02.586792 (MainThread): 14:08:02 | Finished running 5 view models in 6.77s.
2021-11-29 14:08:02.589001 (MainThread): Connection 'master' was properly closed.
2021-11-29 14:08:02.591257 (MainThread): Connection 'model.my_new_project.test_model2' was properly closed.
2021-11-29 14:08:02.620997 (MainThread): 
2021-11-29 14:08:02.621949 (MainThread): Completed with 2 errors and 0 warnings:
2021-11-29 14:08:02.627756 (MainThread): 
2021-11-29 14:08:02.631193 (MainThread): Runtime Error in model test_model1 (models/test_model1.sql)
2021-11-29 14:08:02.635681 (MainThread):   com.facebook.presto.v217.sql.analyzer.SemanticException: line 21:35: Column 'bldg_fid' is missing from left side of join
2021-11-29 14:08:02.640354 (MainThread): 
2021-11-29 14:08:02.648557 (MainThread): Runtime Error in model test_model2 (models/test_model2.sql)
2021-11-29 14:08:02.652163 (MainThread):   An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
2021-11-29 14:08:02.654273 (MainThread): 
Done. PASS=0 WARN=0 ERROR=2 SKIP=3 TOTAL=5
2021-11-29 14:08:02.656655 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff826ca280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff809055e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8264ae20>]}
2021-11-29 14:08:02.663279 (MainThread): Flushing usage events
2021-11-29 14:10:12.723143 (MainThread): Running with dbt=0.21.0
2021-11-29 14:10:12.826989 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/vscode/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-29 14:10:12.833189 (MainThread): Tracking: tracking
2021-11-29 14:10:12.835884 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff847f2610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8608ec70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8608ee20>]}
2021-11-29 14:10:12.848855 (MainThread): Partial parsing not enabled
2021-11-29 14:10:12.872598 (MainThread): Parsing macros/catalog.sql
2021-11-29 14:10:12.877366 (MainThread): Parsing macros/adapters.sql
2021-11-29 14:10:12.887094 (MainThread): Parsing macros/materializations/seed.sql
2021-11-29 14:10:12.890090 (MainThread): Parsing macros/materializations/snapshot.sql
2021-11-29 14:10:12.892073 (MainThread): Parsing macros/materializations/table.sql
2021-11-29 14:10:12.897183 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-29 14:10:12.910731 (MainThread): Parsing macros/materializations/view.sql
2021-11-29 14:10:12.915539 (MainThread): Parsing macros/core.sql
2021-11-29 14:10:12.918465 (MainThread): Parsing macros/materializations/test.sql
2021-11-29 14:10:12.924759 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-29 14:10:12.931699 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-29 14:10:12.936431 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-29 14:10:12.942459 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-29 14:10:12.946061 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-29 14:10:12.952948 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-29 14:10:12.964925 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-29 14:10:12.978444 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-29 14:10:12.983963 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-29 14:10:12.995075 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-29 14:10:13.014552 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-29 14:10:13.025397 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-29 14:10:13.028582 (MainThread): Parsing macros/etc/query.sql
2021-11-29 14:10:13.031814 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-29 14:10:13.034597 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-29 14:10:13.037053 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-29 14:10:13.038849 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-29 14:10:13.043651 (MainThread): Parsing macros/etc/datetime.sql
2021-11-29 14:10:13.049836 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-29 14:10:13.051734 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-29 14:10:13.055509 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-29 14:10:13.058672 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-29 14:10:13.061114 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-29 14:10:13.066643 (MainThread): Parsing macros/adapters/common.sql
2021-11-29 14:10:13.183665 (MainThread): Acquiring new athena connection "model.my_new_project.test_model1".
2021-11-29 14:10:13.193605 (MainThread): Acquiring new athena connection "model.my_new_project.test_model2".
2021-11-29 14:10:13.196906 (MainThread): Acquiring new athena connection "model.my_new_project.test_model3".
2021-11-29 14:10:13.202631 (MainThread): Acquiring new athena connection "model.my_new_project.test_model4".
2021-11-29 14:10:13.207729 (MainThread): Acquiring new athena connection "model.my_new_project.test_model5".
2021-11-29 14:10:13.240661 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-11-29 14:10:13.247577 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '783f3443-c46a-4476-a3ee-39f3450e1726', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff841f20d0>]}
2021-11-29 14:10:13.265177 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-11-29 14:10:13.269556 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '783f3443-c46a-4476-a3ee-39f3450e1726', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84253d30>]}
2021-11-29 14:10:13.273492 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 1 seed file, 0 sources, 0 exposures
2021-11-29 14:10:13.282703 (MainThread): 
2021-11-29 14:10:13.285841 (MainThread): Acquiring new athena connection "master".
2021-11-29 14:10:13.288666 (ThreadPoolExecutor-0_0): Acquiring new athena connection "list_awsdatacatalog".
2021-11-29 14:10:13.299603 (ThreadPoolExecutor-0_0): Using athena connection "list_awsdatacatalog".
2021-11-29 14:10:13.301348 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
  
2021-11-29 14:10:13.303075 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-29 14:10:13.338467 (ThreadPoolExecutor-0_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
2021-11-29 14:10:15.228883 (ThreadPoolExecutor-0_0): SQL status: OK -1 in 1.93 seconds
2021-11-29 14:10:15.232001 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: Close
2021-11-29 14:10:15.235452 (ThreadPoolExecutor-2_0): Acquiring new athena connection "list_awsdatacatalog_dbt".
2021-11-29 14:10:15.238461 (ThreadPoolExecutor-2_0): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 34484), raddr=('52.3.131.174', 443)>
2021-11-29 14:10:15.246565 (ThreadPoolExecutor-2_0): Using athena connection "list_awsdatacatalog_dbt".
2021-11-29 14:10:15.248070 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
2021-11-29 14:10:15.250794 (ThreadPoolExecutor-2_0): Opening a new connection, currently in state closed
2021-11-29 14:10:15.271545 (ThreadPoolExecutor-2_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
2021-11-29 14:10:18.197612 (ThreadPoolExecutor-2_0): SQL status: OK -1 in 2.95 seconds
2021-11-29 14:10:18.201550 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: Close
2021-11-29 14:10:18.205061 (MainThread): 14:10:18 | Concurrency: 1 threads (target='dev')
2021-11-29 14:10:18.208322 (MainThread): 14:10:18 | 
2021-11-29 14:10:18.216035 (Thread-1): Began running node model.my_new_project.test_model1
2021-11-29 14:10:18.217354 (Thread-1): 14:10:18 | 1 of 5 START view model dbt.test_model1.............................. [RUN]
2021-11-29 14:10:18.220068 (Thread-1): Acquiring new athena connection "model.my_new_project.test_model1".
2021-11-29 14:10:18.222177 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 34486), raddr=('52.3.131.174', 443)>
2021-11-29 14:10:18.229163 (Thread-1): Compiling model.my_new_project.test_model1
2021-11-29 14:10:18.232535 (Thread-1): Writing injected SQL for node "model.my_new_project.test_model1"
2021-11-29 14:10:18.241067 (Thread-1): finished collecting timing info
2021-11-29 14:10:18.259971 (Thread-1): Writing runtime SQL for node "model.my_new_project.test_model1"
2021-11-29 14:10:18.272695 (Thread-1): Using athena connection "model.my_new_project.test_model1".
2021-11-29 14:10:18.275093 (Thread-1): On model.my_new_project.test_model1: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    With sample_buildings as (
    SELECT 
        bldg_fid/*,
        city,
        state*/
    FROM "defaultdb"."buildings" 
    /*group by 1*/
)
/*where county='G5500690' */

Select 
    sum(out.electricity.clothes_dryer.energy_consumption),
    bldg_id
from "defaultdb"."resby_puma_northeast"


left join sample_buildings on "defaultdb"."resby_puma_northeast".bldg_id="defaultdb"."buildings".bldg_fid

2021-11-29 14:10:18.279586 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 14:10:18.300510 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    With sample_buildings as (
    SELECT 
        bldg_fid/*,
        city,
        state*/
    FROM "defaultdb"."buildings" 
    /*group by 1*/
)
/*where county='G5500690' */

Select 
    sum(out.electricity.clothes_dryer.energy_consumption),
    bldg_id
from "defaultdb"."resby_puma_northeast"


left join sample_buildings on "defaultdb"."resby_puma_northeast".bldg_id="defaultdb"."buildings".bldg_fid
2021-11-29 14:10:19.799521 (Thread-1): Error running SQL: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    With sample_buildings as (
    SELECT 
        bldg_fid/*,
        city,
        state*/
    FROM "defaultdb"."buildings" 
    /*group by 1*/
)
/*where county='G5500690' */

Select 
    sum(out.electricity.clothes_dryer.energy_consumption),
    bldg_id
from "defaultdb"."resby_puma_northeast"


left join sample_buildings on "defaultdb"."resby_puma_northeast".bldg_id="defaultdb"."buildings".bldg_fid

2021-11-29 14:10:19.802421 (Thread-1): finished collecting timing info
2021-11-29 14:10:19.806578 (Thread-1): On model.my_new_project.test_model1: Close
2021-11-29 14:10:19.811973 (Thread-1): Runtime Error in model test_model1 (models/test_model1.sql)
  com.facebook.presto.v217.sql.analyzer.SemanticException: line 21:74: Column 'defaultdb.buildings.bldg_fid' cannot be resolved
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 100, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 90, in execute
    raise OperationalError(query_execution.state_change_reason)
pyathena.error.OperationalError: com.facebook.presto.v217.sql.analyzer.SemanticException: line 21:74: Column 'defaultdb.buildings.bldg_fid' cannot be resolved

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 66, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 103, in exception_handler
    raise RuntimeException(str(e)) from e
dbt.exceptions.RuntimeException: Runtime Error in model test_model1 (models/test_model1.sql)
  com.facebook.presto.v217.sql.analyzer.SemanticException: line 21:74: Column 'defaultdb.buildings.bldg_fid' cannot be resolved
2021-11-29 14:10:19.818589 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '783f3443-c46a-4476-a3ee-39f3450e1726', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8377d8b0>]}
2021-11-29 14:10:19.821841 (Thread-1): 14:10:19 | 1 of 5 ERROR creating view model dbt.test_model1..................... [ERROR in 1.60s]
2021-11-29 14:10:19.824773 (Thread-1): Finished running node model.my_new_project.test_model1
2021-11-29 14:10:19.828480 (Thread-1): Began running node model.my_new_project.test_model2
2021-11-29 14:10:19.830948 (Thread-1): 14:10:19 | 2 of 5 START view model dbt.test_model2.............................. [RUN]
2021-11-29 14:10:19.834490 (Thread-1): Acquiring new athena connection "model.my_new_project.test_model2".
2021-11-29 14:10:19.837847 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 34488), raddr=('52.3.131.174', 443)>
2021-11-29 14:10:19.842077 (Thread-1): Compiling model.my_new_project.test_model2
2021-11-29 14:10:19.848431 (Thread-1): Writing injected SQL for node "model.my_new_project.test_model2"
2021-11-29 14:10:19.855370 (Thread-1): finished collecting timing info
2021-11-29 14:10:19.864120 (Thread-1): Writing runtime SQL for node "model.my_new_project.test_model2"
2021-11-29 14:10:19.867951 (Thread-1): Using athena connection "model.my_new_project.test_model2".
2021-11-29 14:10:19.869152 (Thread-1): On model.my_new_project.test_model2: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    /*
from somewhere - get bldg_id and zip code --> bldg_locations
*/

2021-11-29 14:10:19.871172 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 14:10:19.898530 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    /*
from somewhere - get bldg_id and zip code --> bldg_locations
*/
2021-11-29 14:10:20.154011 (Thread-1): Failed to execute query.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 307, in _execute
    query_id = retry_api_call(
  File "/usr/local/lib/python3.8/site-packages/pyathena/util.py", line 84, in retry_api_call
    return retry(func, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 404, in __call__
    do = self.iter(retry_state=retry_state)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 349, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 407, in __call__
    result = fn(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 276, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 586, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
2021-11-29 14:10:20.157652 (Thread-1): Error running SQL: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    /*
from somewhere - get bldg_id and zip code --> bldg_locations
*/

2021-11-29 14:10:20.160944 (Thread-1): finished collecting timing info
2021-11-29 14:10:20.163913 (Thread-1): On model.my_new_project.test_model2: Close
2021-11-29 14:10:20.165865 (Thread-1): Runtime Error in model test_model2 (models/test_model2.sql)
  An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 307, in _execute
    query_id = retry_api_call(
  File "/usr/local/lib/python3.8/site-packages/pyathena/util.py", line 84, in retry_api_call
    return retry(func, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 404, in __call__
    do = self.iter(retry_state=retry_state)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 349, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 407, in __call__
    result = fn(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 276, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 586, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 100, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 72, in execute
    query_id = self._execute(
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 315, in _execute
    raise DatabaseError(*e.args) from e
pyathena.error.DatabaseError: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 66, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 103, in exception_handler
    raise RuntimeException(str(e)) from e
dbt.exceptions.RuntimeException: Runtime Error in model test_model2 (models/test_model2.sql)
  An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
2021-11-29 14:10:20.170761 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '783f3443-c46a-4476-a3ee-39f3450e1726', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81aecfd0>]}
2021-11-29 14:10:20.173778 (Thread-1): 14:10:20 | 2 of 5 ERROR creating view model dbt.test_model2..................... [ERROR in 0.34s]
2021-11-29 14:10:20.178353 (Thread-1): Finished running node model.my_new_project.test_model2
2021-11-29 14:10:20.181941 (Thread-1): Began running node model.my_new_project.test_model3
2021-11-29 14:10:20.183871 (Thread-1): 14:10:20 | 3 of 5 SKIP relation dbt.test_model3................................. [SKIP]
2021-11-29 14:10:20.185466 (Thread-1): Finished running node model.my_new_project.test_model3
2021-11-29 14:10:20.190847 (Thread-1): Began running node model.my_new_project.test_model4
2021-11-29 14:10:20.196033 (Thread-1): 14:10:20 | 4 of 5 SKIP relation dbt.test_model4................................. [SKIP]
2021-11-29 14:10:20.200573 (Thread-1): Finished running node model.my_new_project.test_model4
2021-11-29 14:10:20.203705 (Thread-1): Began running node model.my_new_project.test_model5
2021-11-29 14:10:20.205551 (Thread-1): 14:10:20 | 5 of 5 SKIP relation dbt.test_model5................................. [SKIP]
2021-11-29 14:10:20.214411 (Thread-1): Finished running node model.my_new_project.test_model5
2021-11-29 14:10:20.222772 (MainThread): Acquiring new athena connection "master".
2021-11-29 14:10:20.230239 (MainThread): 14:10:20 | 
2021-11-29 14:10:20.233055 (MainThread): 14:10:20 | Finished running 5 view models in 6.94s.
2021-11-29 14:10:20.237365 (MainThread): Connection 'master' was properly closed.
2021-11-29 14:10:20.239955 (MainThread): Connection 'model.my_new_project.test_model2' was properly closed.
2021-11-29 14:10:20.265751 (MainThread): 
2021-11-29 14:10:20.267904 (MainThread): Completed with 2 errors and 0 warnings:
2021-11-29 14:10:20.272391 (MainThread): 
2021-11-29 14:10:20.280695 (MainThread): Runtime Error in model test_model1 (models/test_model1.sql)
2021-11-29 14:10:20.287817 (MainThread):   com.facebook.presto.v217.sql.analyzer.SemanticException: line 21:74: Column 'defaultdb.buildings.bldg_fid' cannot be resolved
2021-11-29 14:10:20.297321 (MainThread): 
2021-11-29 14:10:20.301449 (MainThread): Runtime Error in model test_model2 (models/test_model2.sql)
2021-11-29 14:10:20.307042 (MainThread):   An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
2021-11-29 14:10:20.317340 (MainThread): 
Done. PASS=0 WARN=0 ERROR=2 SKIP=3 TOTAL=5
2021-11-29 14:10:20.322528 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8427a2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff841b3fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff842e0d60>]}
2021-11-29 14:10:20.329079 (MainThread): Flushing usage events
2021-11-29 14:23:13.963579 (MainThread): Running with dbt=0.21.0
2021-11-29 14:23:14.050619 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/vscode/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-29 14:23:14.057739 (MainThread): Tracking: tracking
2021-11-29 14:23:14.060527 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff963dc580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97c78250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97c78e50>]}
2021-11-29 14:23:14.072866 (MainThread): Partial parsing not enabled
2021-11-29 14:23:14.093647 (MainThread): Parsing macros/catalog.sql
2021-11-29 14:23:14.097365 (MainThread): Parsing macros/adapters.sql
2021-11-29 14:23:14.108036 (MainThread): Parsing macros/materializations/seed.sql
2021-11-29 14:23:14.112203 (MainThread): Parsing macros/materializations/snapshot.sql
2021-11-29 14:23:14.114647 (MainThread): Parsing macros/materializations/table.sql
2021-11-29 14:23:14.117733 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-29 14:23:14.130433 (MainThread): Parsing macros/materializations/view.sql
2021-11-29 14:23:14.134702 (MainThread): Parsing macros/core.sql
2021-11-29 14:23:14.137892 (MainThread): Parsing macros/materializations/test.sql
2021-11-29 14:23:14.143160 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-29 14:23:14.149751 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-29 14:23:14.153287 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-29 14:23:14.158439 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-29 14:23:14.160912 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-29 14:23:14.169233 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-29 14:23:14.181732 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-29 14:23:14.195150 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-29 14:23:14.200077 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-29 14:23:14.210175 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-29 14:23:14.228000 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-29 14:23:14.239432 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-29 14:23:14.243551 (MainThread): Parsing macros/etc/query.sql
2021-11-29 14:23:14.244809 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-29 14:23:14.247755 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-29 14:23:14.249447 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-29 14:23:14.250973 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-29 14:23:14.255703 (MainThread): Parsing macros/etc/datetime.sql
2021-11-29 14:23:14.262088 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-29 14:23:14.263786 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-29 14:23:14.266532 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-29 14:23:14.268036 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-29 14:23:14.270215 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-29 14:23:14.274424 (MainThread): Parsing macros/adapters/common.sql
2021-11-29 14:23:14.391021 (MainThread): Acquiring new athena connection "model.my_new_project.test_model1".
2021-11-29 14:23:14.399439 (MainThread): Acquiring new athena connection "model.my_new_project.test_model2".
2021-11-29 14:23:14.401991 (MainThread): Acquiring new athena connection "model.my_new_project.test_model3".
2021-11-29 14:23:14.405549 (MainThread): Acquiring new athena connection "model.my_new_project.test_model4".
2021-11-29 14:23:14.410810 (MainThread): 1699: statically parsed test_model5.sql
2021-11-29 14:23:14.411678 (MainThread): Acquiring new athena connection "model.my_new_project.test_model5".
2021-11-29 14:23:14.415071 (MainThread): Sending event: {'category': 'dbt', 'action': 'experimental_parser', 'label': 'ee3ecdf6-e683-461a-89a2-be79c8a8e578', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95e42280>]}
2021-11-29 14:23:14.447151 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-11-29 14:23:14.450827 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ee3ecdf6-e683-461a-89a2-be79c8a8e578', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95de2c40>]}
2021-11-29 14:23:14.465183 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-11-29 14:23:14.466932 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ee3ecdf6-e683-461a-89a2-be79c8a8e578', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95de2520>]}
2021-11-29 14:23:14.468064 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 1 seed file, 0 sources, 0 exposures
2021-11-29 14:23:14.471604 (MainThread): 
2021-11-29 14:23:14.476228 (MainThread): Acquiring new athena connection "master".
2021-11-29 14:23:14.480298 (ThreadPoolExecutor-0_0): Acquiring new athena connection "list_awsdatacatalog".
2021-11-29 14:23:14.488763 (ThreadPoolExecutor-0_0): Using athena connection "list_awsdatacatalog".
2021-11-29 14:23:14.491815 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
  
2021-11-29 14:23:14.495231 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-29 14:23:14.525384 (ThreadPoolExecutor-0_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
2021-11-29 14:23:16.317919 (ThreadPoolExecutor-0_0): SQL status: OK -1 in 1.82 seconds
2021-11-29 14:23:16.328472 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: Close
2021-11-29 14:23:16.335159 (ThreadPoolExecutor-2_0): Acquiring new athena connection "list_awsdatacatalog_dbt".
2021-11-29 14:23:16.340623 (ThreadPoolExecutor-2_0): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 50754), raddr=('3.223.130.62', 443)>
2021-11-29 14:23:16.347233 (ThreadPoolExecutor-2_0): Using athena connection "list_awsdatacatalog_dbt".
2021-11-29 14:23:16.348220 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
2021-11-29 14:23:16.350523 (ThreadPoolExecutor-2_0): Opening a new connection, currently in state closed
2021-11-29 14:23:16.374503 (ThreadPoolExecutor-2_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
2021-11-29 14:23:19.230009 (ThreadPoolExecutor-2_0): SQL status: OK -1 in 2.88 seconds
2021-11-29 14:23:19.240157 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: Close
2021-11-29 14:23:19.245067 (MainThread): 14:23:19 | Concurrency: 1 threads (target='dev')
2021-11-29 14:23:19.247868 (MainThread): 14:23:19 | 
2021-11-29 14:23:19.256256 (Thread-1): Began running node model.my_new_project.test_model1
2021-11-29 14:23:19.257846 (Thread-1): 14:23:19 | 1 of 5 START view model dbt.test_model1.............................. [RUN]
2021-11-29 14:23:19.260301 (Thread-1): Acquiring new athena connection "model.my_new_project.test_model1".
2021-11-29 14:23:19.265491 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 50756), raddr=('3.223.130.62', 443)>
2021-11-29 14:23:19.269553 (Thread-1): Compiling model.my_new_project.test_model1
2021-11-29 14:23:19.276569 (Thread-1): Writing injected SQL for node "model.my_new_project.test_model1"
2021-11-29 14:23:19.282648 (Thread-1): finished collecting timing info
2021-11-29 14:23:19.299819 (Thread-1): Writing runtime SQL for node "model.my_new_project.test_model1"
2021-11-29 14:23:19.308817 (Thread-1): Using athena connection "model.my_new_project.test_model1".
2021-11-29 14:23:19.310088 (Thread-1): On model.my_new_project.test_model1: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    SELECT * FROM "defaultdb"."resby_puma_northeast" puma
inner join "defaultdb"."buildings" buildings
on puma.bldg_id=buildings.bldg_fid

limit 10;

2021-11-29 14:23:19.312157 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 14:23:19.329852 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    SELECT * FROM "defaultdb"."resby_puma_northeast" puma
inner join "defaultdb"."buildings" buildings
on puma.bldg_id=buildings.bldg_fid

limit 10;
2021-11-29 14:23:21.065332 (Thread-1): SQL status: OK -1 in 1.75 seconds
2021-11-29 14:23:21.069638 (Thread-1): Using athena connection "model.my_new_project.test_model1".
2021-11-29 14:23:21.070765 (Thread-1): On model.my_new_project.test_model1: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
alter table dbt.test_model1 set tblproperties ('classification' = 'view')
2021-11-29 14:23:21.074723 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
alter table dbt.test_model1 set tblproperties ('classification' = 'view')
2021-11-29 14:23:22.592385 (Thread-1): SQL status: OK -1 in 1.52 seconds
2021-11-29 14:23:22.609978 (Thread-1): finished collecting timing info
2021-11-29 14:23:22.612645 (Thread-1): On model.my_new_project.test_model1: Close
2021-11-29 14:23:22.617589 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee3ecdf6-e683-461a-89a2-be79c8a8e578', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9408e5e0>]}
2021-11-29 14:23:22.621108 (Thread-1): 14:23:22 | 1 of 5 OK created view model dbt.test_model1......................... [OK -1 in 3.36s]
2021-11-29 14:23:22.625215 (Thread-1): Finished running node model.my_new_project.test_model1
2021-11-29 14:23:22.627671 (Thread-1): Began running node model.my_new_project.test_model2
2021-11-29 14:23:22.630511 (Thread-1): 14:23:22 | 2 of 5 START view model dbt.test_model2.............................. [RUN]
2021-11-29 14:23:22.632959 (Thread-1): Acquiring new athena connection "model.my_new_project.test_model2".
2021-11-29 14:23:22.634979 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 50758), raddr=('3.223.130.62', 443)>
2021-11-29 14:23:22.637954 (Thread-1): Compiling model.my_new_project.test_model2
2021-11-29 14:23:22.641735 (Thread-1): Writing injected SQL for node "model.my_new_project.test_model2"
2021-11-29 14:23:22.649699 (Thread-1): finished collecting timing info
2021-11-29 14:23:22.654249 (Thread-1): Writing runtime SQL for node "model.my_new_project.test_model2"
2021-11-29 14:23:22.663604 (Thread-1): Using athena connection "model.my_new_project.test_model2".
2021-11-29 14:23:22.666465 (Thread-1): On model.my_new_project.test_model2: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    /*
from somewhere - get bldg_id and zip code --> bldg_locations
*/

2021-11-29 14:23:22.677402 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 14:23:22.701643 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    /*
from somewhere - get bldg_id and zip code --> bldg_locations
*/
2021-11-29 14:23:22.955950 (Thread-1): Failed to execute query.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 307, in _execute
    query_id = retry_api_call(
  File "/usr/local/lib/python3.8/site-packages/pyathena/util.py", line 84, in retry_api_call
    return retry(func, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 404, in __call__
    do = self.iter(retry_state=retry_state)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 349, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 407, in __call__
    result = fn(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 276, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 586, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
2021-11-29 14:23:22.958585 (Thread-1): Error running SQL: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    /*
from somewhere - get bldg_id and zip code --> bldg_locations
*/

2021-11-29 14:23:22.962542 (Thread-1): finished collecting timing info
2021-11-29 14:23:22.965078 (Thread-1): On model.my_new_project.test_model2: Close
2021-11-29 14:23:22.967066 (Thread-1): Runtime Error in model test_model2 (models/test_model2.sql)
  An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 307, in _execute
    query_id = retry_api_call(
  File "/usr/local/lib/python3.8/site-packages/pyathena/util.py", line 84, in retry_api_call
    return retry(func, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 404, in __call__
    do = self.iter(retry_state=retry_state)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 349, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 407, in __call__
    result = fn(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 276, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 586, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 100, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 72, in execute
    query_id = self._execute(
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 315, in _execute
    raise DatabaseError(*e.args) from e
pyathena.error.DatabaseError: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 66, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 103, in exception_handler
    raise RuntimeException(str(e)) from e
dbt.exceptions.RuntimeException: Runtime Error in model test_model2 (models/test_model2.sql)
  An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
2021-11-29 14:23:22.971218 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee3ecdf6-e683-461a-89a2-be79c8a8e578', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff940c9100>]}
2021-11-29 14:23:22.974843 (Thread-1): 14:23:22 | 2 of 5 ERROR creating view model dbt.test_model2..................... [ERROR in 0.34s]
2021-11-29 14:23:22.977103 (Thread-1): Finished running node model.my_new_project.test_model2
2021-11-29 14:23:22.980534 (Thread-1): Began running node model.my_new_project.test_model3
2021-11-29 14:23:22.982266 (Thread-1): 14:23:22 | 3 of 5 SKIP relation dbt.test_model3................................. [SKIP]
2021-11-29 14:23:22.984454 (Thread-1): Finished running node model.my_new_project.test_model3
2021-11-29 14:23:22.990992 (Thread-1): Began running node model.my_new_project.test_model4
2021-11-29 14:23:22.992890 (Thread-1): 14:23:22 | 4 of 5 SKIP relation dbt.test_model4................................. [SKIP]
2021-11-29 14:23:22.995887 (Thread-1): Finished running node model.my_new_project.test_model4
2021-11-29 14:23:23.000528 (Thread-1): Began running node model.my_new_project.test_model5
2021-11-29 14:23:23.003022 (Thread-1): 14:23:23 | 5 of 5 SKIP relation dbt.test_model5................................. [SKIP]
2021-11-29 14:23:23.011123 (Thread-1): Finished running node model.my_new_project.test_model5
2021-11-29 14:23:23.014548 (MainThread): Acquiring new athena connection "master".
2021-11-29 14:23:23.017676 (MainThread): 14:23:23 | 
2021-11-29 14:23:23.019442 (MainThread): 14:23:23 | Finished running 5 view models in 8.54s.
2021-11-29 14:23:23.025128 (MainThread): Connection 'master' was properly closed.
2021-11-29 14:23:23.028661 (MainThread): Connection 'model.my_new_project.test_model2' was properly closed.
2021-11-29 14:23:23.046401 (MainThread): 
2021-11-29 14:23:23.047449 (MainThread): Completed with 1 error and 0 warnings:
2021-11-29 14:23:23.049883 (MainThread): 
2021-11-29 14:23:23.053614 (MainThread): Runtime Error in model test_model2 (models/test_model2.sql)
2021-11-29 14:23:23.062518 (MainThread):   An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
2021-11-29 14:23:23.065997 (MainThread): 
Done. PASS=1 WARN=0 ERROR=1 SKIP=3 TOTAL=5
2021-11-29 14:23:23.070521 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97c98520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95df7af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95599fd0>]}
2021-11-29 14:23:23.078789 (MainThread): Flushing usage events
2021-11-29 17:24:09.139667 (MainThread): Running with dbt=0.21.0
2021-11-29 17:24:09.221927 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/vscode/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-29 17:24:09.229354 (MainThread): Tracking: tracking
2021-11-29 17:24:09.231401 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9c92520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab52fbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab52fd90>]}
2021-11-29 17:24:09.242044 (MainThread): Partial parsing not enabled
2021-11-29 17:24:09.261786 (MainThread): Parsing macros/catalog.sql
2021-11-29 17:24:09.265287 (MainThread): Parsing macros/adapters.sql
2021-11-29 17:24:09.274724 (MainThread): Parsing macros/materializations/seed.sql
2021-11-29 17:24:09.277913 (MainThread): Parsing macros/materializations/snapshot.sql
2021-11-29 17:24:09.279053 (MainThread): Parsing macros/materializations/table.sql
2021-11-29 17:24:09.281823 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-29 17:24:09.294370 (MainThread): Parsing macros/materializations/view.sql
2021-11-29 17:24:09.297619 (MainThread): Parsing macros/core.sql
2021-11-29 17:24:09.300815 (MainThread): Parsing macros/materializations/test.sql
2021-11-29 17:24:09.305036 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-29 17:24:09.310641 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-29 17:24:09.313863 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-29 17:24:09.318404 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-29 17:24:09.321093 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-29 17:24:09.327392 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-29 17:24:09.338329 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-29 17:24:09.350006 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-29 17:24:09.354652 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-29 17:24:09.362352 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-29 17:24:09.378851 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-29 17:24:09.388398 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-29 17:24:09.389907 (MainThread): Parsing macros/etc/query.sql
2021-11-29 17:24:09.391025 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-29 17:24:09.395041 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-29 17:24:09.396828 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-29 17:24:09.398294 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-29 17:24:09.399888 (MainThread): Parsing macros/etc/datetime.sql
2021-11-29 17:24:09.405459 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-29 17:24:09.407852 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-29 17:24:09.410218 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-29 17:24:09.411707 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-29 17:24:09.413069 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-29 17:24:09.414720 (MainThread): Parsing macros/adapters/common.sql
2021-11-29 17:24:09.520260 (MainThread): Acquiring new athena connection "model.my_new_project.test_model1".
2021-11-29 17:24:09.529169 (MainThread): Acquiring new athena connection "model.my_new_project.test_model2".
2021-11-29 17:24:09.532185 (MainThread): Acquiring new athena connection "model.my_new_project.test_model3".
2021-11-29 17:24:09.535915 (MainThread): Acquiring new athena connection "model.my_new_project.test_model4".
2021-11-29 17:24:09.538644 (MainThread): Acquiring new athena connection "model.my_new_project.test_model5".
2021-11-29 17:24:09.575991 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-11-29 17:24:09.581397 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '353ffa4f-55b4-49fb-a5b4-6b56d5bb032d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9697490>]}
2021-11-29 17:24:09.594360 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-11-29 17:24:09.595909 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '353ffa4f-55b4-49fb-a5b4-6b56d5bb032d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa96977f0>]}
2021-11-29 17:24:09.597352 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 1 seed file, 0 sources, 0 exposures
2021-11-29 17:24:09.599497 (MainThread): 
2021-11-29 17:24:09.600891 (MainThread): Acquiring new athena connection "master".
2021-11-29 17:24:09.602880 (ThreadPoolExecutor-0_0): Acquiring new athena connection "list_awsdatacatalog".
2021-11-29 17:24:09.611987 (ThreadPoolExecutor-0_0): Using athena connection "list_awsdatacatalog".
2021-11-29 17:24:09.612721 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
  
2021-11-29 17:24:09.614768 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-29 17:24:09.648946 (ThreadPoolExecutor-0_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
2021-11-29 17:24:11.597751 (ThreadPoolExecutor-0_0): SQL status: OK -1 in 1.98 seconds
2021-11-29 17:24:11.609747 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: Close
2021-11-29 17:24:11.617524 (ThreadPoolExecutor-2_0): Acquiring new athena connection "list_awsdatacatalog_dbt".
2021-11-29 17:24:11.624500 (ThreadPoolExecutor-2_0): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 57872), raddr=('3.218.163.85', 443)>
2021-11-29 17:24:11.642157 (ThreadPoolExecutor-2_0): Using athena connection "list_awsdatacatalog_dbt".
2021-11-29 17:24:11.643903 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
2021-11-29 17:24:11.647786 (ThreadPoolExecutor-2_0): Opening a new connection, currently in state closed
2021-11-29 17:24:11.677760 (ThreadPoolExecutor-2_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
2021-11-29 17:24:15.665531 (ThreadPoolExecutor-2_0): SQL status: OK -1 in 4.02 seconds
2021-11-29 17:24:15.676229 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: Close
2021-11-29 17:24:15.684701 (MainThread): 17:24:15 | Concurrency: 1 threads (target='dev')
2021-11-29 17:24:15.687481 (MainThread): 17:24:15 | 
2021-11-29 17:24:15.699775 (Thread-1): Began running node model.my_new_project.test_model1
2021-11-29 17:24:15.702025 (Thread-1): 17:24:15 | 1 of 5 START view model dbt.test_model1.............................. [RUN]
2021-11-29 17:24:15.709322 (Thread-1): Acquiring new athena connection "model.my_new_project.test_model1".
2021-11-29 17:24:15.715527 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 57874), raddr=('3.218.163.85', 443)>
2021-11-29 17:24:15.719649 (Thread-1): Compiling model.my_new_project.test_model1
2021-11-29 17:24:15.724605 (Thread-1): Writing injected SQL for node "model.my_new_project.test_model1"
2021-11-29 17:24:15.736360 (Thread-1): finished collecting timing info
2021-11-29 17:24:15.751158 (Thread-1): Writing runtime SQL for node "model.my_new_project.test_model1"
2021-11-29 17:24:15.758101 (Thread-1): Using athena connection "model.my_new_project.test_model1".
2021-11-29 17:24:15.758645 (Thread-1): On model.my_new_project.test_model1: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    /*
SELECT * FROM "defaultdb"."resby_puma_northeast" puma
inner join "defaultdb"."buildings" buildings
on puma.bldg_id=buildings.bldg_fid

limit 10;
*/

select * from "defaultdb"."buildings" where state = "ME"
Limit 100;

2021-11-29 17:24:15.761924 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 17:24:15.941758 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    /*
SELECT * FROM "defaultdb"."resby_puma_northeast" puma
inner join "defaultdb"."buildings" buildings
on puma.bldg_id=buildings.bldg_fid

limit 10;
*/

select * from "defaultdb"."buildings" where state = "ME"
Limit 100;
2021-11-29 17:24:17.469961 (Thread-1): Error running SQL: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    /*
SELECT * FROM "defaultdb"."resby_puma_northeast" puma
inner join "defaultdb"."buildings" buildings
on puma.bldg_id=buildings.bldg_fid

limit 10;
*/

select * from "defaultdb"."buildings" where state = "ME"
Limit 100;

2021-11-29 17:24:17.472492 (Thread-1): finished collecting timing info
2021-11-29 17:24:17.475764 (Thread-1): On model.my_new_project.test_model1: Close
2021-11-29 17:24:17.478988 (Thread-1): Runtime Error in model test_model1 (models/test_model1.sql)
  com.facebook.presto.v217.sql.analyzer.SemanticException: line 13:53: Column 'me' cannot be resolved
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 100, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 90, in execute
    raise OperationalError(query_execution.state_change_reason)
pyathena.error.OperationalError: com.facebook.presto.v217.sql.analyzer.SemanticException: line 13:53: Column 'me' cannot be resolved

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 66, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 103, in exception_handler
    raise RuntimeException(str(e)) from e
dbt.exceptions.RuntimeException: Runtime Error in model test_model1 (models/test_model1.sql)
  com.facebook.presto.v217.sql.analyzer.SemanticException: line 13:53: Column 'me' cannot be resolved
2021-11-29 17:24:17.483133 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '353ffa4f-55b4-49fb-a5b4-6b56d5bb032d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8c1d820>]}
2021-11-29 17:24:17.485784 (Thread-1): 17:24:17 | 1 of 5 ERROR creating view model dbt.test_model1..................... [ERROR in 1.77s]
2021-11-29 17:24:17.488626 (Thread-1): Finished running node model.my_new_project.test_model1
2021-11-29 17:24:17.490854 (Thread-1): Began running node model.my_new_project.test_model2
2021-11-29 17:24:17.492972 (Thread-1): 17:24:17 | 2 of 5 START view model dbt.test_model2.............................. [RUN]
2021-11-29 17:24:17.495187 (Thread-1): Acquiring new athena connection "model.my_new_project.test_model2".
2021-11-29 17:24:17.496785 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 57876), raddr=('3.218.163.85', 443)>
2021-11-29 17:24:17.498615 (Thread-1): Compiling model.my_new_project.test_model2
2021-11-29 17:24:17.501270 (Thread-1): Writing injected SQL for node "model.my_new_project.test_model2"
2021-11-29 17:24:17.506727 (Thread-1): finished collecting timing info
2021-11-29 17:24:17.509166 (Thread-1): Writing runtime SQL for node "model.my_new_project.test_model2"
2021-11-29 17:24:17.513933 (Thread-1): Using athena connection "model.my_new_project.test_model2".
2021-11-29 17:24:17.514973 (Thread-1): On model.my_new_project.test_model2: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    /*
from somewhere - get bldg_id and zip code --> bldg_locations
*/

2021-11-29 17:24:17.516692 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 17:24:17.532627 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    /*
from somewhere - get bldg_id and zip code --> bldg_locations
*/
2021-11-29 17:24:17.791965 (Thread-1): Failed to execute query.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 307, in _execute
    query_id = retry_api_call(
  File "/usr/local/lib/python3.8/site-packages/pyathena/util.py", line 84, in retry_api_call
    return retry(func, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 404, in __call__
    do = self.iter(retry_state=retry_state)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 349, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 407, in __call__
    result = fn(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 276, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 586, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
2021-11-29 17:24:17.793406 (Thread-1): Error running SQL: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    /*
from somewhere - get bldg_id and zip code --> bldg_locations
*/

2021-11-29 17:24:17.795542 (Thread-1): finished collecting timing info
2021-11-29 17:24:17.796948 (Thread-1): On model.my_new_project.test_model2: Close
2021-11-29 17:24:17.799046 (Thread-1): Runtime Error in model test_model2 (models/test_model2.sql)
  An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 307, in _execute
    query_id = retry_api_call(
  File "/usr/local/lib/python3.8/site-packages/pyathena/util.py", line 84, in retry_api_call
    return retry(func, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 404, in __call__
    do = self.iter(retry_state=retry_state)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 349, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 407, in __call__
    result = fn(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 276, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 586, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 100, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 72, in execute
    query_id = self._execute(
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 315, in _execute
    raise DatabaseError(*e.args) from e
pyathena.error.DatabaseError: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 66, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 103, in exception_handler
    raise RuntimeException(str(e)) from e
dbt.exceptions.RuntimeException: Runtime Error in model test_model2 (models/test_model2.sql)
  An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
2021-11-29 17:24:17.802091 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '353ffa4f-55b4-49fb-a5b4-6b56d5bb032d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2f0f790>]}
2021-11-29 17:24:17.803789 (Thread-1): 17:24:17 | 2 of 5 ERROR creating view model dbt.test_model2..................... [ERROR in 0.31s]
2021-11-29 17:24:17.805550 (Thread-1): Finished running node model.my_new_project.test_model2
2021-11-29 17:24:17.807943 (Thread-1): Began running node model.my_new_project.test_model3
2021-11-29 17:24:17.809586 (Thread-1): 17:24:17 | 3 of 5 SKIP relation dbt.test_model3................................. [SKIP]
2021-11-29 17:24:17.811290 (Thread-1): Finished running node model.my_new_project.test_model3
2021-11-29 17:24:17.813269 (Thread-1): Began running node model.my_new_project.test_model4
2021-11-29 17:24:17.814619 (Thread-1): 17:24:17 | 4 of 5 SKIP relation dbt.test_model4................................. [SKIP]
2021-11-29 17:24:17.816118 (Thread-1): Finished running node model.my_new_project.test_model4
2021-11-29 17:24:17.818498 (Thread-1): Began running node model.my_new_project.test_model5
2021-11-29 17:24:17.820217 (Thread-1): 17:24:17 | 5 of 5 SKIP relation dbt.test_model5................................. [SKIP]
2021-11-29 17:24:17.822136 (Thread-1): Finished running node model.my_new_project.test_model5
2021-11-29 17:24:17.824990 (MainThread): Acquiring new athena connection "master".
2021-11-29 17:24:17.826882 (MainThread): 17:24:17 | 
2021-11-29 17:24:17.829119 (MainThread): 17:24:17 | Finished running 5 view models in 8.23s.
2021-11-29 17:24:17.831115 (MainThread): Connection 'master' was properly closed.
2021-11-29 17:24:17.832868 (MainThread): Connection 'model.my_new_project.test_model2' was properly closed.
2021-11-29 17:24:17.848785 (MainThread): 
2021-11-29 17:24:17.850312 (MainThread): Completed with 2 errors and 0 warnings:
2021-11-29 17:24:17.853606 (MainThread): 
2021-11-29 17:24:17.855712 (MainThread): Runtime Error in model test_model1 (models/test_model1.sql)
2021-11-29 17:24:17.857845 (MainThread):   com.facebook.presto.v217.sql.analyzer.SemanticException: line 13:53: Column 'me' cannot be resolved
2021-11-29 17:24:17.860379 (MainThread): 
2021-11-29 17:24:17.862321 (MainThread): Runtime Error in model test_model2 (models/test_model2.sql)
2021-11-29 17:24:17.864346 (MainThread):   An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
2021-11-29 17:24:17.867101 (MainThread): 
Done. PASS=0 WARN=0 ERROR=2 SKIP=3 TOTAL=5
2021-11-29 17:24:17.870785 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa96f3fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa963efa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab4cedf0>]}
2021-11-29 17:24:17.873196 (MainThread): Flushing usage events
2021-11-29 17:27:23.490173 (MainThread): Running with dbt=0.21.0
2021-11-29 17:27:23.570631 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/vscode/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-29 17:27:23.576287 (MainThread): Tracking: tracking
2021-11-29 17:27:23.579106 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95c76580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97512d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97512e50>]}
2021-11-29 17:27:23.588864 (MainThread): Partial parsing not enabled
2021-11-29 17:27:23.606475 (MainThread): Parsing macros/catalog.sql
2021-11-29 17:27:23.610151 (MainThread): Parsing macros/adapters.sql
2021-11-29 17:27:23.619994 (MainThread): Parsing macros/materializations/seed.sql
2021-11-29 17:27:23.623757 (MainThread): Parsing macros/materializations/snapshot.sql
2021-11-29 17:27:23.625246 (MainThread): Parsing macros/materializations/table.sql
2021-11-29 17:27:23.628351 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-29 17:27:23.641739 (MainThread): Parsing macros/materializations/view.sql
2021-11-29 17:27:23.645117 (MainThread): Parsing macros/core.sql
2021-11-29 17:27:23.647840 (MainThread): Parsing macros/materializations/test.sql
2021-11-29 17:27:23.651958 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-29 17:27:23.657394 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-29 17:27:23.661231 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-29 17:27:23.666330 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-29 17:27:23.668115 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-29 17:27:23.673913 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-29 17:27:23.685219 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-29 17:27:23.698525 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-29 17:27:23.703250 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-29 17:27:23.711951 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-29 17:27:23.728628 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-29 17:27:23.738321 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-29 17:27:23.739821 (MainThread): Parsing macros/etc/query.sql
2021-11-29 17:27:23.741908 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-29 17:27:23.744599 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-29 17:27:23.746284 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-29 17:27:23.747927 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-29 17:27:23.749417 (MainThread): Parsing macros/etc/datetime.sql
2021-11-29 17:27:23.755626 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-29 17:27:23.757271 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-29 17:27:23.759244 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-29 17:27:23.760805 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-29 17:27:23.762938 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-29 17:27:23.765405 (MainThread): Parsing macros/adapters/common.sql
2021-11-29 17:27:23.870326 (MainThread): Acquiring new athena connection "model.my_new_project.test_model1".
2021-11-29 17:27:23.877970 (MainThread): Acquiring new athena connection "model.my_new_project.test_model2".
2021-11-29 17:27:23.880919 (MainThread): Acquiring new athena connection "model.my_new_project.test_model3".
2021-11-29 17:27:23.884015 (MainThread): Acquiring new athena connection "model.my_new_project.test_model4".
2021-11-29 17:27:23.887768 (MainThread): Acquiring new athena connection "model.my_new_project.test_model5".
2021-11-29 17:27:23.913450 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-11-29 17:27:23.917248 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2977e588-2717-4143-9d66-a88e7f52156a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9567bdf0>]}
2021-11-29 17:27:23.929121 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-11-29 17:27:23.930701 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2977e588-2717-4143-9d66-a88e7f52156a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9567b640>]}
2021-11-29 17:27:23.931457 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 1 seed file, 0 sources, 0 exposures
2021-11-29 17:27:23.933867 (MainThread): 
2021-11-29 17:27:23.935723 (MainThread): Acquiring new athena connection "master".
2021-11-29 17:27:23.939563 (ThreadPoolExecutor-0_0): Acquiring new athena connection "list_awsdatacatalog".
2021-11-29 17:27:23.947646 (ThreadPoolExecutor-0_0): Using athena connection "list_awsdatacatalog".
2021-11-29 17:27:23.948543 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
  
2021-11-29 17:27:23.950668 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-29 17:27:23.977036 (ThreadPoolExecutor-0_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
2021-11-29 17:27:25.788978 (ThreadPoolExecutor-0_0): SQL status: OK -1 in 1.84 seconds
2021-11-29 17:27:25.793440 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: Close
2021-11-29 17:27:25.797822 (ThreadPoolExecutor-2_0): Acquiring new athena connection "list_awsdatacatalog_dbt".
2021-11-29 17:27:25.807757 (ThreadPoolExecutor-2_0): Using athena connection "list_awsdatacatalog_dbt".
2021-11-29 17:27:25.809410 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
2021-11-29 17:27:25.814497 (ThreadPoolExecutor-2_0): Opening a new connection, currently in state init
2021-11-29 17:27:25.837987 (ThreadPoolExecutor-2_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
2021-11-29 17:27:29.759834 (ThreadPoolExecutor-2_0): SQL status: OK -1 in 3.95 seconds
2021-11-29 17:27:29.771807 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: Close
2021-11-29 17:27:29.777632 (MainThread): 17:27:29 | Concurrency: 1 threads (target='dev')
2021-11-29 17:27:29.780940 (MainThread): 17:27:29 | 
2021-11-29 17:27:29.792296 (Thread-1): Began running node model.my_new_project.test_model1
2021-11-29 17:27:29.794392 (Thread-1): 17:27:29 | 1 of 5 START view model dbt.test_model1.............................. [RUN]
2021-11-29 17:27:29.802062 (Thread-1): Acquiring new athena connection "model.my_new_project.test_model1".
2021-11-29 17:27:29.812538 (Thread-1): unclosed <ssl.SSLSocket fd=6, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 50306), raddr=('54.160.162.173', 443)>
2021-11-29 17:27:29.816400 (Thread-1): Compiling model.my_new_project.test_model1
2021-11-29 17:27:29.824368 (Thread-1): Writing injected SQL for node "model.my_new_project.test_model1"
2021-11-29 17:27:29.830886 (Thread-1): finished collecting timing info
2021-11-29 17:27:29.845931 (Thread-1): Writing runtime SQL for node "model.my_new_project.test_model1"
2021-11-29 17:27:29.850781 (Thread-1): Using athena connection "model.my_new_project.test_model1".
2021-11-29 17:27:29.853129 (Thread-1): On model.my_new_project.test_model1: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    /*
SELECT * FROM "defaultdb"."resby_puma_northeast" puma
inner join "defaultdb"."buildings" buildings
on puma.bldg_id=buildings.bldg_fid

limit 10;
*/

select * from "defaultdb"."buildings" where state in ("ME","NH","VT","MA","CT","RI")
Limit 100;

2021-11-29 17:27:29.854566 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 17:27:29.871335 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    /*
SELECT * FROM "defaultdb"."resby_puma_northeast" puma
inner join "defaultdb"."buildings" buildings
on puma.bldg_id=buildings.bldg_fid

limit 10;
*/

select * from "defaultdb"."buildings" where state in ("ME","NH","VT","MA","CT","RI")
Limit 100;
2021-11-29 17:27:31.356587 (Thread-1): Error running SQL: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    /*
SELECT * FROM "defaultdb"."resby_puma_northeast" puma
inner join "defaultdb"."buildings" buildings
on puma.bldg_id=buildings.bldg_fid

limit 10;
*/

select * from "defaultdb"."buildings" where state in ("ME","NH","VT","MA","CT","RI")
Limit 100;

2021-11-29 17:27:31.360061 (Thread-1): finished collecting timing info
2021-11-29 17:27:31.366803 (Thread-1): On model.my_new_project.test_model1: Close
2021-11-29 17:27:31.373685 (Thread-1): Runtime Error in model test_model1 (models/test_model1.sql)
  com.facebook.presto.v217.sql.analyzer.SemanticException: line 13:55: Column 'me' cannot be resolved
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 100, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 90, in execute
    raise OperationalError(query_execution.state_change_reason)
pyathena.error.OperationalError: com.facebook.presto.v217.sql.analyzer.SemanticException: line 13:55: Column 'me' cannot be resolved

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 66, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 103, in exception_handler
    raise RuntimeException(str(e)) from e
dbt.exceptions.RuntimeException: Runtime Error in model test_model1 (models/test_model1.sql)
  com.facebook.presto.v217.sql.analyzer.SemanticException: line 13:55: Column 'me' cannot be resolved
2021-11-29 17:27:31.382718 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2977e588-2717-4143-9d66-a88e7f52156a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94106f10>]}
2021-11-29 17:27:31.386629 (Thread-1): 17:27:31 | 1 of 5 ERROR creating view model dbt.test_model1..................... [ERROR in 1.58s]
2021-11-29 17:27:31.389836 (Thread-1): Finished running node model.my_new_project.test_model1
2021-11-29 17:27:31.393823 (Thread-1): Began running node model.my_new_project.test_model2
2021-11-29 17:27:31.397487 (Thread-1): 17:27:31 | 2 of 5 START view model dbt.test_model2.............................. [RUN]
2021-11-29 17:27:31.400032 (Thread-1): Acquiring new athena connection "model.my_new_project.test_model2".
2021-11-29 17:27:31.402601 (Thread-1): unclosed <ssl.SSLSocket fd=6, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 50308), raddr=('54.160.162.173', 443)>
2021-11-29 17:27:31.406328 (Thread-1): Compiling model.my_new_project.test_model2
2021-11-29 17:27:31.410506 (Thread-1): Writing injected SQL for node "model.my_new_project.test_model2"
2021-11-29 17:27:31.420992 (Thread-1): finished collecting timing info
2021-11-29 17:27:31.425612 (Thread-1): Writing runtime SQL for node "model.my_new_project.test_model2"
2021-11-29 17:27:31.429342 (Thread-1): Using athena connection "model.my_new_project.test_model2".
2021-11-29 17:27:31.430392 (Thread-1): On model.my_new_project.test_model2: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    /*
from somewhere - get bldg_id and zip code --> bldg_locations
*/

2021-11-29 17:27:31.432017 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 17:27:31.449840 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    /*
from somewhere - get bldg_id and zip code --> bldg_locations
*/
2021-11-29 17:27:31.710341 (Thread-1): Failed to execute query.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 307, in _execute
    query_id = retry_api_call(
  File "/usr/local/lib/python3.8/site-packages/pyathena/util.py", line 84, in retry_api_call
    return retry(func, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 404, in __call__
    do = self.iter(retry_state=retry_state)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 349, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 407, in __call__
    result = fn(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 276, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 586, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
2021-11-29 17:27:31.717983 (Thread-1): Error running SQL: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    /*
from somewhere - get bldg_id and zip code --> bldg_locations
*/

2021-11-29 17:27:31.723540 (Thread-1): finished collecting timing info
2021-11-29 17:27:31.728570 (Thread-1): On model.my_new_project.test_model2: Close
2021-11-29 17:27:31.732648 (Thread-1): Runtime Error in model test_model2 (models/test_model2.sql)
  An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 307, in _execute
    query_id = retry_api_call(
  File "/usr/local/lib/python3.8/site-packages/pyathena/util.py", line 84, in retry_api_call
    return retry(func, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 404, in __call__
    do = self.iter(retry_state=retry_state)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 349, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 407, in __call__
    result = fn(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 276, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 586, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 100, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 72, in execute
    query_id = self._execute(
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 315, in _execute
    raise DatabaseError(*e.args) from e
pyathena.error.DatabaseError: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 66, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 103, in exception_handler
    raise RuntimeException(str(e)) from e
dbt.exceptions.RuntimeException: Runtime Error in model test_model2 (models/test_model2.sql)
  An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
2021-11-29 17:27:31.739142 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2977e588-2717-4143-9d66-a88e7f52156a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e605e20>]}
2021-11-29 17:27:31.745016 (Thread-1): 17:27:31 | 2 of 5 ERROR creating view model dbt.test_model2..................... [ERROR in 0.34s]
2021-11-29 17:27:31.747771 (Thread-1): Finished running node model.my_new_project.test_model2
2021-11-29 17:27:31.752040 (Thread-1): Began running node model.my_new_project.test_model3
2021-11-29 17:27:31.754784 (Thread-1): 17:27:31 | 3 of 5 SKIP relation dbt.test_model3................................. [SKIP]
2021-11-29 17:27:31.757513 (Thread-1): Finished running node model.my_new_project.test_model3
2021-11-29 17:27:31.760359 (Thread-1): Began running node model.my_new_project.test_model4
2021-11-29 17:27:31.762353 (Thread-1): 17:27:31 | 4 of 5 SKIP relation dbt.test_model4................................. [SKIP]
2021-11-29 17:27:31.764249 (Thread-1): Finished running node model.my_new_project.test_model4
2021-11-29 17:27:31.766398 (Thread-1): Began running node model.my_new_project.test_model5
2021-11-29 17:27:31.768061 (Thread-1): 17:27:31 | 5 of 5 SKIP relation dbt.test_model5................................. [SKIP]
2021-11-29 17:27:31.770876 (Thread-1): Finished running node model.my_new_project.test_model5
2021-11-29 17:27:31.775410 (MainThread): Acquiring new athena connection "master".
2021-11-29 17:27:31.777706 (MainThread): 17:27:31 | 
2021-11-29 17:27:31.779640 (MainThread): 17:27:31 | Finished running 5 view models in 7.84s.
2021-11-29 17:27:31.781038 (MainThread): Connection 'master' was properly closed.
2021-11-29 17:27:31.783349 (MainThread): Connection 'list_awsdatacatalog' was properly closed.
2021-11-29 17:27:31.785743 (MainThread): Connection 'model.my_new_project.test_model2' was properly closed.
2021-11-29 17:27:31.788243 (MainThread): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 50304), raddr=('54.160.162.173', 443)>
2021-11-29 17:27:31.803031 (MainThread): 
2021-11-29 17:27:31.804815 (MainThread): Completed with 2 errors and 0 warnings:
2021-11-29 17:27:31.806296 (MainThread): 
2021-11-29 17:27:31.807947 (MainThread): Runtime Error in model test_model1 (models/test_model1.sql)
2021-11-29 17:27:31.809552 (MainThread):   com.facebook.presto.v217.sql.analyzer.SemanticException: line 13:55: Column 'me' cannot be resolved
2021-11-29 17:27:31.811410 (MainThread): 
2021-11-29 17:27:31.812826 (MainThread): Runtime Error in model test_model2 (models/test_model2.sql)
2021-11-29 17:27:31.814418 (MainThread):   An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
2021-11-29 17:27:31.816882 (MainThread): 
Done. PASS=0 WARN=0 ERROR=2 SKIP=3 TOTAL=5
2021-11-29 17:27:31.820648 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97532520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff974b7e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94c01880>]}
2021-11-29 17:27:31.823085 (MainThread): Flushing usage events
2021-11-29 17:35:30.612190 (MainThread): Running with dbt=0.21.0
2021-11-29 17:35:30.694103 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/vscode/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-29 17:35:30.698808 (MainThread): Tracking: tracking
2021-11-29 17:35:30.701680 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb53cd610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6c69c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6c69e20>]}
2021-11-29 17:35:30.709913 (MainThread): Partial parsing not enabled
2021-11-29 17:35:30.725870 (MainThread): Parsing macros/catalog.sql
2021-11-29 17:35:30.728480 (MainThread): Parsing macros/adapters.sql
2021-11-29 17:35:30.736948 (MainThread): Parsing macros/materializations/seed.sql
2021-11-29 17:35:30.739848 (MainThread): Parsing macros/materializations/snapshot.sql
2021-11-29 17:35:30.741095 (MainThread): Parsing macros/materializations/table.sql
2021-11-29 17:35:30.744078 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-29 17:35:30.756472 (MainThread): Parsing macros/materializations/view.sql
2021-11-29 17:35:30.759980 (MainThread): Parsing macros/core.sql
2021-11-29 17:35:30.763003 (MainThread): Parsing macros/materializations/test.sql
2021-11-29 17:35:30.768007 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-29 17:35:30.774361 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-29 17:35:30.777829 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-29 17:35:30.782199 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-29 17:35:30.783936 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-29 17:35:30.791546 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-29 17:35:30.802719 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-29 17:35:30.815234 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-29 17:35:30.819877 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-29 17:35:30.827592 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-29 17:35:30.845301 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-29 17:35:30.855042 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-29 17:35:30.856463 (MainThread): Parsing macros/etc/query.sql
2021-11-29 17:35:30.858984 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-29 17:35:30.861762 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-29 17:35:30.863880 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-29 17:35:30.866061 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-29 17:35:30.867578 (MainThread): Parsing macros/etc/datetime.sql
2021-11-29 17:35:30.873252 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-29 17:35:30.874642 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-29 17:35:30.876827 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-29 17:35:30.878693 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-29 17:35:30.880102 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-29 17:35:30.881664 (MainThread): Parsing macros/adapters/common.sql
2021-11-29 17:35:30.992057 (MainThread): Acquiring new athena connection "model.my_new_project.test_model1".
2021-11-29 17:35:31.000134 (MainThread): Acquiring new athena connection "model.my_new_project.test_model2".
2021-11-29 17:35:31.002320 (MainThread): Acquiring new athena connection "model.my_new_project.test_model3".
2021-11-29 17:35:31.005417 (MainThread): Acquiring new athena connection "model.my_new_project.test_model4".
2021-11-29 17:35:31.008656 (MainThread): Acquiring new athena connection "model.my_new_project.test_model5".
2021-11-29 17:35:31.038104 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-11-29 17:35:31.045734 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '882e5fc7-247c-4c94-b15b-92f4baf6093d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4df6460>]}
2021-11-29 17:35:31.071017 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-11-29 17:35:31.074785 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '882e5fc7-247c-4c94-b15b-92f4baf6093d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4e2d370>]}
2021-11-29 17:35:31.076041 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 1 seed file, 0 sources, 0 exposures
2021-11-29 17:35:31.083644 (MainThread): 
2021-11-29 17:35:31.086388 (MainThread): Acquiring new athena connection "master".
2021-11-29 17:35:31.092255 (ThreadPoolExecutor-0_0): Acquiring new athena connection "list_awsdatacatalog".
2021-11-29 17:35:31.100488 (ThreadPoolExecutor-0_0): Using athena connection "list_awsdatacatalog".
2021-11-29 17:35:31.102001 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
  
2021-11-29 17:35:31.104946 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-29 17:35:31.137056 (ThreadPoolExecutor-0_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
2021-11-29 17:35:33.043945 (ThreadPoolExecutor-0_0): SQL status: OK -1 in 1.94 seconds
2021-11-29 17:35:33.049907 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: Close
2021-11-29 17:35:33.055052 (ThreadPoolExecutor-2_0): Acquiring new athena connection "list_awsdatacatalog_dbt".
2021-11-29 17:35:33.056595 (ThreadPoolExecutor-2_0): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 44292), raddr=('35.173.63.72', 443)>
2021-11-29 17:35:33.067193 (ThreadPoolExecutor-2_0): Using athena connection "list_awsdatacatalog_dbt".
2021-11-29 17:35:33.068285 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
2021-11-29 17:35:33.071128 (ThreadPoolExecutor-2_0): Opening a new connection, currently in state closed
2021-11-29 17:35:33.091975 (ThreadPoolExecutor-2_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
2021-11-29 17:35:35.946476 (ThreadPoolExecutor-2_0): SQL status: OK -1 in 2.88 seconds
2021-11-29 17:35:35.951356 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: Close
2021-11-29 17:35:35.956676 (MainThread): 17:35:35 | Concurrency: 1 threads (target='dev')
2021-11-29 17:35:35.959728 (MainThread): 17:35:35 | 
2021-11-29 17:35:35.965841 (Thread-1): Began running node model.my_new_project.test_model1
2021-11-29 17:35:35.968018 (Thread-1): 17:35:35 | 1 of 5 START view model dbt.test_model1.............................. [RUN]
2021-11-29 17:35:35.971163 (Thread-1): Acquiring new athena connection "model.my_new_project.test_model1".
2021-11-29 17:35:35.974748 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 44294), raddr=('35.173.63.72', 443)>
2021-11-29 17:35:35.977231 (Thread-1): Compiling model.my_new_project.test_model1
2021-11-29 17:35:35.982370 (Thread-1): Writing injected SQL for node "model.my_new_project.test_model1"
2021-11-29 17:35:35.989502 (Thread-1): finished collecting timing info
2021-11-29 17:35:36.002523 (Thread-1): Writing runtime SQL for node "model.my_new_project.test_model1"
2021-11-29 17:35:36.008042 (Thread-1): Using athena connection "model.my_new_project.test_model1".
2021-11-29 17:35:36.008909 (Thread-1): On model.my_new_project.test_model1: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    /*
SELECT * FROM "defaultdb"."resby_puma_northeast" puma
inner join "defaultdb"."buildings" buildings
on puma.bldg_id=buildings.bldg_fid

limit 10;
*/

select * from "defaultdb"."buildings" where "defaultdb"."buildings".state in "ME"
/*Order by state*/
Limit 100;

2021-11-29 17:35:36.010500 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 17:35:36.025761 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    /*
SELECT * FROM "defaultdb"."resby_puma_northeast" puma
inner join "defaultdb"."buildings" buildings
on puma.bldg_id=buildings.bldg_fid

limit 10;
*/

select * from "defaultdb"."buildings" where "defaultdb"."buildings".state in "ME"
/*Order by state*/
Limit 100;
2021-11-29 17:35:36.273843 (Thread-1): Failed to execute query.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 307, in _execute
    query_id = retry_api_call(
  File "/usr/local/lib/python3.8/site-packages/pyathena/util.py", line 84, in retry_api_call
    return retry(func, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 404, in __call__
    do = self.iter(retry_state=retry_state)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 349, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 407, in __call__
    result = fn(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 276, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 586, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 13:75: mismatched input 'in'. Expecting: 'AND', 'EXCEPT', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OFFSET', 'OR', 'ORDER', 'UNION', <EOF>
2021-11-29 17:35:36.279800 (Thread-1): Error running SQL: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    /*
SELECT * FROM "defaultdb"."resby_puma_northeast" puma
inner join "defaultdb"."buildings" buildings
on puma.bldg_id=buildings.bldg_fid

limit 10;
*/

select * from "defaultdb"."buildings" where "defaultdb"."buildings".state in "ME"
/*Order by state*/
Limit 100;

2021-11-29 17:35:36.284812 (Thread-1): finished collecting timing info
2021-11-29 17:35:36.288749 (Thread-1): On model.my_new_project.test_model1: Close
2021-11-29 17:35:36.292713 (Thread-1): Runtime Error in model test_model1 (models/test_model1.sql)
  An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 13:75: mismatched input 'in'. Expecting: 'AND', 'EXCEPT', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OFFSET', 'OR', 'ORDER', 'UNION', <EOF>
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 307, in _execute
    query_id = retry_api_call(
  File "/usr/local/lib/python3.8/site-packages/pyathena/util.py", line 84, in retry_api_call
    return retry(func, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 404, in __call__
    do = self.iter(retry_state=retry_state)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 349, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 407, in __call__
    result = fn(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 276, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 586, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 13:75: mismatched input 'in'. Expecting: 'AND', 'EXCEPT', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OFFSET', 'OR', 'ORDER', 'UNION', <EOF>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 100, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 72, in execute
    query_id = self._execute(
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 315, in _execute
    raise DatabaseError(*e.args) from e
pyathena.error.DatabaseError: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 13:75: mismatched input 'in'. Expecting: 'AND', 'EXCEPT', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OFFSET', 'OR', 'ORDER', 'UNION', <EOF>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 66, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 103, in exception_handler
    raise RuntimeException(str(e)) from e
dbt.exceptions.RuntimeException: Runtime Error in model test_model1 (models/test_model1.sql)
  An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 13:75: mismatched input 'in'. Expecting: 'AND', 'EXCEPT', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OFFSET', 'OR', 'ORDER', 'UNION', <EOF>
2021-11-29 17:35:36.297884 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '882e5fc7-247c-4c94-b15b-92f4baf6093d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb40892e0>]}
2021-11-29 17:35:36.301015 (Thread-1): 17:35:36 | 1 of 5 ERROR creating view model dbt.test_model1..................... [ERROR in 0.33s]
2021-11-29 17:35:36.303454 (Thread-1): Finished running node model.my_new_project.test_model1
2021-11-29 17:35:36.306434 (Thread-1): Began running node model.my_new_project.test_model2
2021-11-29 17:35:36.308715 (Thread-1): 17:35:36 | 2 of 5 START view model dbt.test_model2.............................. [RUN]
2021-11-29 17:35:36.312275 (Thread-1): Acquiring new athena connection "model.my_new_project.test_model2".
2021-11-29 17:35:36.315856 (Thread-1): Compiling model.my_new_project.test_model2
2021-11-29 17:35:36.319478 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 44296), raddr=('35.173.63.72', 443)>
2021-11-29 17:35:36.321102 (Thread-1): Writing injected SQL for node "model.my_new_project.test_model2"
2021-11-29 17:35:36.326802 (Thread-1): finished collecting timing info
2021-11-29 17:35:36.329255 (Thread-1): Writing runtime SQL for node "model.my_new_project.test_model2"
2021-11-29 17:35:36.333732 (Thread-1): Using athena connection "model.my_new_project.test_model2".
2021-11-29 17:35:36.334715 (Thread-1): On model.my_new_project.test_model2: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    /*
from somewhere - get bldg_id and zip code --> bldg_locations
*/

2021-11-29 17:35:36.335951 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 17:35:36.352592 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    /*
from somewhere - get bldg_id and zip code --> bldg_locations
*/
2021-11-29 17:35:36.590258 (Thread-1): Failed to execute query.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 307, in _execute
    query_id = retry_api_call(
  File "/usr/local/lib/python3.8/site-packages/pyathena/util.py", line 84, in retry_api_call
    return retry(func, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 404, in __call__
    do = self.iter(retry_state=retry_state)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 349, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 407, in __call__
    result = fn(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 276, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 586, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
2021-11-29 17:35:36.592760 (Thread-1): Error running SQL: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    /*
from somewhere - get bldg_id and zip code --> bldg_locations
*/

2021-11-29 17:35:36.598704 (Thread-1): finished collecting timing info
2021-11-29 17:35:36.601945 (Thread-1): On model.my_new_project.test_model2: Close
2021-11-29 17:35:36.605337 (Thread-1): Runtime Error in model test_model2 (models/test_model2.sql)
  An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 307, in _execute
    query_id = retry_api_call(
  File "/usr/local/lib/python3.8/site-packages/pyathena/util.py", line 84, in retry_api_call
    return retry(func, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 404, in __call__
    do = self.iter(retry_state=retry_state)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 349, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 407, in __call__
    result = fn(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 276, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 586, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 100, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 72, in execute
    query_id = self._execute(
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 315, in _execute
    raise DatabaseError(*e.args) from e
pyathena.error.DatabaseError: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 66, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 103, in exception_handler
    raise RuntimeException(str(e)) from e
dbt.exceptions.RuntimeException: Runtime Error in model test_model2 (models/test_model2.sql)
  An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
2021-11-29 17:35:36.610833 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '882e5fc7-247c-4c94-b15b-92f4baf6093d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae6b0d90>]}
2021-11-29 17:35:36.613902 (Thread-1): 17:35:36 | 2 of 5 ERROR creating view model dbt.test_model2..................... [ERROR in 0.30s]
2021-11-29 17:35:36.617019 (Thread-1): Finished running node model.my_new_project.test_model2
2021-11-29 17:35:36.621050 (Thread-1): Began running node model.my_new_project.test_model3
2021-11-29 17:35:36.623455 (Thread-1): 17:35:36 | 3 of 5 SKIP relation dbt.test_model3................................. [SKIP]
2021-11-29 17:35:36.626711 (Thread-1): Finished running node model.my_new_project.test_model3
2021-11-29 17:35:36.630181 (Thread-1): Began running node model.my_new_project.test_model4
2021-11-29 17:35:36.632859 (Thread-1): 17:35:36 | 4 of 5 SKIP relation dbt.test_model4................................. [SKIP]
2021-11-29 17:35:36.635075 (Thread-1): Finished running node model.my_new_project.test_model4
2021-11-29 17:35:36.638275 (Thread-1): Began running node model.my_new_project.test_model5
2021-11-29 17:35:36.640746 (Thread-1): 17:35:36 | 5 of 5 SKIP relation dbt.test_model5................................. [SKIP]
2021-11-29 17:35:36.642925 (Thread-1): Finished running node model.my_new_project.test_model5
2021-11-29 17:35:36.646007 (MainThread): Acquiring new athena connection "master".
2021-11-29 17:35:36.649878 (MainThread): 17:35:36 | 
2021-11-29 17:35:36.651800 (MainThread): 17:35:36 | Finished running 5 view models in 5.56s.
2021-11-29 17:35:36.653594 (MainThread): Connection 'master' was properly closed.
2021-11-29 17:35:36.655657 (MainThread): Connection 'model.my_new_project.test_model2' was properly closed.
2021-11-29 17:35:36.672453 (MainThread): 
2021-11-29 17:35:36.673903 (MainThread): Completed with 2 errors and 0 warnings:
2021-11-29 17:35:36.675743 (MainThread): 
2021-11-29 17:35:36.677412 (MainThread): Runtime Error in model test_model1 (models/test_model1.sql)
2021-11-29 17:35:36.680766 (MainThread):   An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 13:75: mismatched input 'in'. Expecting: 'AND', 'EXCEPT', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OFFSET', 'OR', 'ORDER', 'UNION', <EOF>
2021-11-29 17:35:36.683274 (MainThread): 
2021-11-29 17:35:36.685111 (MainThread): Runtime Error in model test_model2 (models/test_model2.sql)
2021-11-29 17:35:36.688050 (MainThread):   An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
2021-11-29 17:35:36.690443 (MainThread): 
Done. PASS=0 WARN=0 ERROR=2 SKIP=3 TOTAL=5
2021-11-29 17:35:36.692237 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6c881f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4ebbd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4d8efd0>]}
2021-11-29 17:35:36.694172 (MainThread): Flushing usage events
2021-11-29 17:41:39.201616 (MainThread): Running with dbt=0.21.0
2021-11-29 17:41:39.313524 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/vscode/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-29 17:41:39.320098 (MainThread): Tracking: tracking
2021-11-29 17:41:39.323455 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c8d4880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e171b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e171dc0>]}
2021-11-29 17:41:39.334904 (MainThread): Partial parsing not enabled
2021-11-29 17:41:39.351037 (MainThread): Parsing macros/catalog.sql
2021-11-29 17:41:39.353645 (MainThread): Parsing macros/adapters.sql
2021-11-29 17:41:39.363387 (MainThread): Parsing macros/materializations/seed.sql
2021-11-29 17:41:39.366370 (MainThread): Parsing macros/materializations/snapshot.sql
2021-11-29 17:41:39.367324 (MainThread): Parsing macros/materializations/table.sql
2021-11-29 17:41:39.371100 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-29 17:41:39.384504 (MainThread): Parsing macros/materializations/view.sql
2021-11-29 17:41:39.388952 (MainThread): Parsing macros/core.sql
2021-11-29 17:41:39.391621 (MainThread): Parsing macros/materializations/test.sql
2021-11-29 17:41:39.396678 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-29 17:41:39.402130 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-29 17:41:39.405358 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-29 17:41:39.409985 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-29 17:41:39.412612 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-29 17:41:39.419549 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-29 17:41:39.430290 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-29 17:41:39.442902 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-29 17:41:39.447417 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-29 17:41:39.455449 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-29 17:41:39.472619 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-29 17:41:39.481614 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-29 17:41:39.483320 (MainThread): Parsing macros/etc/query.sql
2021-11-29 17:41:39.484942 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-29 17:41:39.488585 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-29 17:41:39.490693 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-29 17:41:39.492120 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-29 17:41:39.494800 (MainThread): Parsing macros/etc/datetime.sql
2021-11-29 17:41:39.500607 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-29 17:41:39.501981 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-29 17:41:39.504399 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-29 17:41:39.506435 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-29 17:41:39.508598 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-29 17:41:39.510776 (MainThread): Parsing macros/adapters/common.sql
2021-11-29 17:41:39.623111 (MainThread): Acquiring new athena connection "model.my_new_project.test_model1".
2021-11-29 17:41:39.632734 (MainThread): Acquiring new athena connection "model.my_new_project.test_model2".
2021-11-29 17:41:39.635755 (MainThread): Acquiring new athena connection "model.my_new_project.test_model3".
2021-11-29 17:41:39.638590 (MainThread): Acquiring new athena connection "model.my_new_project.test_model4".
2021-11-29 17:41:39.642517 (MainThread): Acquiring new athena connection "model.my_new_project.test_model5".
2021-11-29 17:41:39.666610 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-11-29 17:41:39.670494 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7ea25b47-bff6-4afa-a56d-c530775dc881', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c2d8130>]}
2021-11-29 17:41:39.682578 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-11-29 17:41:39.685805 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7ea25b47-bff6-4afa-a56d-c530775dc881', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c31ed00>]}
2021-11-29 17:41:39.686673 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 1 seed file, 0 sources, 0 exposures
2021-11-29 17:41:39.689027 (MainThread): 
2021-11-29 17:41:39.689885 (MainThread): Acquiring new athena connection "master".
2021-11-29 17:41:39.692313 (ThreadPoolExecutor-0_0): Acquiring new athena connection "list_awsdatacatalog".
2021-11-29 17:41:39.704491 (ThreadPoolExecutor-0_0): Using athena connection "list_awsdatacatalog".
2021-11-29 17:41:39.705440 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
  
2021-11-29 17:41:39.707458 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-29 17:41:39.734262 (ThreadPoolExecutor-0_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
2021-11-29 17:41:41.654081 (ThreadPoolExecutor-0_0): SQL status: OK -1 in 1.95 seconds
2021-11-29 17:41:41.661349 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: Close
2021-11-29 17:41:41.671864 (ThreadPoolExecutor-2_0): Acquiring new athena connection "list_awsdatacatalog_dbt".
2021-11-29 17:41:41.685756 (ThreadPoolExecutor-2_0): Using athena connection "list_awsdatacatalog_dbt".
2021-11-29 17:41:41.687480 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
2021-11-29 17:41:41.692673 (ThreadPoolExecutor-2_0): Opening a new connection, currently in state init
2021-11-29 17:41:41.722784 (ThreadPoolExecutor-2_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
2021-11-29 17:41:45.722075 (ThreadPoolExecutor-2_0): SQL status: OK -1 in 4.03 seconds
2021-11-29 17:41:45.733828 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: Close
2021-11-29 17:41:45.741617 (MainThread): 17:41:45 | Concurrency: 1 threads (target='dev')
2021-11-29 17:41:45.746347 (MainThread): 17:41:45 | 
2021-11-29 17:41:45.759466 (Thread-1): Began running node model.my_new_project.test_model1
2021-11-29 17:41:45.761502 (Thread-1): 17:41:45 | 1 of 5 START view model dbt.test_model1.............................. [RUN]
2021-11-29 17:41:45.766295 (Thread-1): Acquiring new athena connection "model.my_new_project.test_model1".
2021-11-29 17:41:45.770889 (Thread-1): unclosed <ssl.SSLSocket fd=6, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 44308), raddr=('35.173.63.72', 443)>
2021-11-29 17:41:45.775777 (Thread-1): Compiling model.my_new_project.test_model1
2021-11-29 17:41:45.784508 (Thread-1): Writing injected SQL for node "model.my_new_project.test_model1"
2021-11-29 17:41:45.795080 (Thread-1): finished collecting timing info
2021-11-29 17:41:45.810570 (Thread-1): Writing runtime SQL for node "model.my_new_project.test_model1"
2021-11-29 17:41:45.816393 (Thread-1): Using athena connection "model.my_new_project.test_model1".
2021-11-29 17:41:45.817309 (Thread-1): On model.my_new_project.test_model1: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    /*
SELECT * FROM "defaultdb"."resby_puma_northeast" puma
inner join "defaultdb"."buildings" buildings
on puma.bldg_id=buildings.bldg_fid

limit 10;
*/



/* In plain english: select all from the "buildings" table where the state value is in the Region_Table state column.  */


/* select * from dbt.Region_Table */


select * from "defaultdb"."buildings" where "defaultdb"."buildings".state in 'ME'
/*Order by state*/
Limit 100;

2021-11-29 17:41:45.818881 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 17:41:45.836411 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    /*
SELECT * FROM "defaultdb"."resby_puma_northeast" puma
inner join "defaultdb"."buildings" buildings
on puma.bldg_id=buildings.bldg_fid

limit 10;
*/



/* In plain english: select all from the "buildings" table where the state value is in the Region_Table state column.  */


/* select * from dbt.Region_Table */


select * from "defaultdb"."buildings" where "defaultdb"."buildings".state in 'ME'
/*Order by state*/
Limit 100;
2021-11-29 17:41:46.090940 (Thread-1): Failed to execute query.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 307, in _execute
    query_id = retry_api_call(
  File "/usr/local/lib/python3.8/site-packages/pyathena/util.py", line 84, in retry_api_call
    return retry(func, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 404, in __call__
    do = self.iter(retry_state=retry_state)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 349, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 407, in __call__
    result = fn(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 276, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 586, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 21:75: mismatched input 'in'. Expecting: 'AND', 'EXCEPT', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OFFSET', 'OR', 'ORDER', 'UNION', <EOF>
2021-11-29 17:41:46.093142 (Thread-1): Error running SQL: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    /*
SELECT * FROM "defaultdb"."resby_puma_northeast" puma
inner join "defaultdb"."buildings" buildings
on puma.bldg_id=buildings.bldg_fid

limit 10;
*/



/* In plain english: select all from the "buildings" table where the state value is in the Region_Table state column.  */


/* select * from dbt.Region_Table */


select * from "defaultdb"."buildings" where "defaultdb"."buildings".state in 'ME'
/*Order by state*/
Limit 100;

2021-11-29 17:41:46.095128 (Thread-1): finished collecting timing info
2021-11-29 17:41:46.096554 (Thread-1): On model.my_new_project.test_model1: Close
2021-11-29 17:41:46.098753 (Thread-1): Runtime Error in model test_model1 (models/test_model1.sql)
  An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 21:75: mismatched input 'in'. Expecting: 'AND', 'EXCEPT', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OFFSET', 'OR', 'ORDER', 'UNION', <EOF>
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 307, in _execute
    query_id = retry_api_call(
  File "/usr/local/lib/python3.8/site-packages/pyathena/util.py", line 84, in retry_api_call
    return retry(func, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 404, in __call__
    do = self.iter(retry_state=retry_state)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 349, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 407, in __call__
    result = fn(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 276, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 586, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 21:75: mismatched input 'in'. Expecting: 'AND', 'EXCEPT', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OFFSET', 'OR', 'ORDER', 'UNION', <EOF>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 100, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 72, in execute
    query_id = self._execute(
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 315, in _execute
    raise DatabaseError(*e.args) from e
pyathena.error.DatabaseError: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 21:75: mismatched input 'in'. Expecting: 'AND', 'EXCEPT', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OFFSET', 'OR', 'ORDER', 'UNION', <EOF>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 66, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 103, in exception_handler
    raise RuntimeException(str(e)) from e
dbt.exceptions.RuntimeException: Runtime Error in model test_model1 (models/test_model1.sql)
  An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 21:75: mismatched input 'in'. Expecting: 'AND', 'EXCEPT', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OFFSET', 'OR', 'ORDER', 'UNION', <EOF>
2021-11-29 17:41:46.102074 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ea25b47-bff6-4afa-a56d-c530775dc881', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99d37cd0>]}
2021-11-29 17:41:46.103563 (Thread-1): 17:41:46 | 1 of 5 ERROR creating view model dbt.test_model1..................... [ERROR in 0.34s]
2021-11-29 17:41:46.105216 (Thread-1): Finished running node model.my_new_project.test_model1
2021-11-29 17:41:46.111392 (Thread-1): Began running node model.my_new_project.test_model2
2021-11-29 17:41:46.113277 (Thread-1): 17:41:46 | 2 of 5 START view model dbt.test_model2.............................. [RUN]
2021-11-29 17:41:46.114915 (Thread-1): Acquiring new athena connection "model.my_new_project.test_model2".
2021-11-29 17:41:46.118367 (Thread-1): Compiling model.my_new_project.test_model2
2021-11-29 17:41:46.120884 (Thread-1): Writing injected SQL for node "model.my_new_project.test_model2"
2021-11-29 17:41:46.126502 (Thread-1): finished collecting timing info
2021-11-29 17:41:46.128431 (Thread-1): Writing runtime SQL for node "model.my_new_project.test_model2"
2021-11-29 17:41:46.133819 (Thread-1): Using athena connection "model.my_new_project.test_model2".
2021-11-29 17:41:46.134901 (Thread-1): On model.my_new_project.test_model2: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    /*
from somewhere - get bldg_id and zip code --> bldg_locations
*/

2021-11-29 17:41:46.136620 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 17:41:46.146388 (Thread-1): unclosed <ssl.SSLSocket fd=6, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 44310), raddr=('35.173.63.72', 443)>
2021-11-29 17:41:46.156323 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    /*
from somewhere - get bldg_id and zip code --> bldg_locations
*/
2021-11-29 17:41:46.401781 (Thread-1): Failed to execute query.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 307, in _execute
    query_id = retry_api_call(
  File "/usr/local/lib/python3.8/site-packages/pyathena/util.py", line 84, in retry_api_call
    return retry(func, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 404, in __call__
    do = self.iter(retry_state=retry_state)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 349, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 407, in __call__
    result = fn(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 276, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 586, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
2021-11-29 17:41:46.404909 (Thread-1): Error running SQL: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    /*
from somewhere - get bldg_id and zip code --> bldg_locations
*/

2021-11-29 17:41:46.408308 (Thread-1): finished collecting timing info
2021-11-29 17:41:46.412146 (Thread-1): On model.my_new_project.test_model2: Close
2021-11-29 17:41:46.414864 (Thread-1): Runtime Error in model test_model2 (models/test_model2.sql)
  An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 307, in _execute
    query_id = retry_api_call(
  File "/usr/local/lib/python3.8/site-packages/pyathena/util.py", line 84, in retry_api_call
    return retry(func, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 404, in __call__
    do = self.iter(retry_state=retry_state)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 349, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 407, in __call__
    result = fn(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 276, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 586, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 100, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 72, in execute
    query_id = self._execute(
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 315, in _execute
    raise DatabaseError(*e.args) from e
pyathena.error.DatabaseError: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 66, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 103, in exception_handler
    raise RuntimeException(str(e)) from e
dbt.exceptions.RuntimeException: Runtime Error in model test_model2 (models/test_model2.sql)
  An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
2021-11-29 17:41:46.418052 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ea25b47-bff6-4afa-a56d-c530775dc881', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99a70220>]}
2021-11-29 17:41:46.420188 (Thread-1): 17:41:46 | 2 of 5 ERROR creating view model dbt.test_model2..................... [ERROR in 0.30s]
2021-11-29 17:41:46.422209 (Thread-1): Finished running node model.my_new_project.test_model2
2021-11-29 17:41:46.425593 (Thread-1): Began running node model.my_new_project.test_model3
2021-11-29 17:41:46.426703 (Thread-1): 17:41:46 | 3 of 5 SKIP relation dbt.test_model3................................. [SKIP]
2021-11-29 17:41:46.428572 (Thread-1): Finished running node model.my_new_project.test_model3
2021-11-29 17:41:46.432089 (Thread-1): Began running node model.my_new_project.test_model4
2021-11-29 17:41:46.434279 (Thread-1): 17:41:46 | 4 of 5 SKIP relation dbt.test_model4................................. [SKIP]
2021-11-29 17:41:46.435875 (Thread-1): Finished running node model.my_new_project.test_model4
2021-11-29 17:41:46.437992 (Thread-1): Began running node model.my_new_project.test_model5
2021-11-29 17:41:46.440415 (Thread-1): 17:41:46 | 5 of 5 SKIP relation dbt.test_model5................................. [SKIP]
2021-11-29 17:41:46.442333 (Thread-1): Finished running node model.my_new_project.test_model5
2021-11-29 17:41:46.446836 (MainThread): Acquiring new athena connection "master".
2021-11-29 17:41:46.449578 (MainThread): 17:41:46 | 
2021-11-29 17:41:46.451842 (MainThread): 17:41:46 | Finished running 5 view models in 6.76s.
2021-11-29 17:41:46.453344 (MainThread): Connection 'master' was properly closed.
2021-11-29 17:41:46.455295 (MainThread): Connection 'list_awsdatacatalog' was properly closed.
2021-11-29 17:41:46.458190 (MainThread): Connection 'model.my_new_project.test_model2' was properly closed.
2021-11-29 17:41:46.460231 (MainThread): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 44306), raddr=('35.173.63.72', 443)>
2021-11-29 17:41:46.463607 (MainThread): unclosed <ssl.SSLSocket fd=6, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 44312), raddr=('35.173.63.72', 443)>
2021-11-29 17:41:46.483164 (MainThread): 
2021-11-29 17:41:46.485035 (MainThread): Completed with 2 errors and 0 warnings:
2021-11-29 17:41:46.488309 (MainThread): 
2021-11-29 17:41:46.490055 (MainThread): Runtime Error in model test_model1 (models/test_model1.sql)
2021-11-29 17:41:46.492317 (MainThread):   An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 21:75: mismatched input 'in'. Expecting: 'AND', 'EXCEPT', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OFFSET', 'OR', 'ORDER', 'UNION', <EOF>
2021-11-29 17:41:46.494389 (MainThread): 
2021-11-29 17:41:46.498167 (MainThread): Runtime Error in model test_model2 (models/test_model2.sql)
2021-11-29 17:41:46.500288 (MainThread):   An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
2021-11-29 17:41:46.503112 (MainThread): 
Done. PASS=0 WARN=0 ERROR=2 SKIP=3 TOTAL=5
2021-11-29 17:41:46.505332 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c358940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9af72c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9af72460>]}
2021-11-29 17:41:46.507181 (MainThread): Flushing usage events
2021-11-29 17:44:17.623784 (MainThread): Running with dbt=0.21.0
2021-11-29 17:44:17.709848 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/vscode/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-29 17:44:17.715183 (MainThread): Tracking: tracking
2021-11-29 17:44:17.717499 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cce1880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e57c3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e57ce80>]}
2021-11-29 17:44:17.730084 (MainThread): Partial parsing not enabled
2021-11-29 17:44:17.745575 (MainThread): Parsing macros/catalog.sql
2021-11-29 17:44:17.748206 (MainThread): Parsing macros/adapters.sql
2021-11-29 17:44:17.756942 (MainThread): Parsing macros/materializations/seed.sql
2021-11-29 17:44:17.760631 (MainThread): Parsing macros/materializations/snapshot.sql
2021-11-29 17:44:17.761566 (MainThread): Parsing macros/materializations/table.sql
2021-11-29 17:44:17.764833 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-29 17:44:17.777229 (MainThread): Parsing macros/materializations/view.sql
2021-11-29 17:44:17.780528 (MainThread): Parsing macros/core.sql
2021-11-29 17:44:17.783084 (MainThread): Parsing macros/materializations/test.sql
2021-11-29 17:44:17.787349 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-29 17:44:17.793718 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-29 17:44:17.797399 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-29 17:44:17.801616 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-29 17:44:17.803265 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-29 17:44:17.809308 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-29 17:44:17.821145 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-29 17:44:17.834125 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-29 17:44:17.839420 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-29 17:44:17.847312 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-29 17:44:17.863956 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-29 17:44:17.874306 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-29 17:44:17.876655 (MainThread): Parsing macros/etc/query.sql
2021-11-29 17:44:17.878187 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-29 17:44:17.880323 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-29 17:44:17.881867 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-29 17:44:17.883370 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-29 17:44:17.884949 (MainThread): Parsing macros/etc/datetime.sql
2021-11-29 17:44:17.890473 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-29 17:44:17.891975 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-29 17:44:17.893708 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-29 17:44:17.894795 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-29 17:44:17.896767 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-29 17:44:17.898620 (MainThread): Parsing macros/adapters/common.sql
2021-11-29 17:44:18.003854 (MainThread): Acquiring new athena connection "model.my_new_project.test_model1".
2021-11-29 17:44:18.012036 (MainThread): Acquiring new athena connection "model.my_new_project.test_model2".
2021-11-29 17:44:18.014374 (MainThread): Acquiring new athena connection "model.my_new_project.test_model3".
2021-11-29 17:44:18.017479 (MainThread): Acquiring new athena connection "model.my_new_project.test_model4".
2021-11-29 17:44:18.020212 (MainThread): Acquiring new athena connection "model.my_new_project.test_model5".
2021-11-29 17:44:18.049773 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-11-29 17:44:18.053793 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1f8e8ad9-9b6b-48ae-9893-c4a7a91b59df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c6e85b0>]}
2021-11-29 17:44:18.072275 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-11-29 17:44:18.075521 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1f8e8ad9-9b6b-48ae-9893-c4a7a91b59df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c6e8a60>]}
2021-11-29 17:44:18.077177 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 1 seed file, 0 sources, 0 exposures
2021-11-29 17:44:18.080637 (MainThread): 
2021-11-29 17:44:18.084501 (MainThread): Acquiring new athena connection "master".
2021-11-29 17:44:18.093334 (ThreadPoolExecutor-0_0): Acquiring new athena connection "list_awsdatacatalog".
2021-11-29 17:44:18.104611 (ThreadPoolExecutor-0_0): Using athena connection "list_awsdatacatalog".
2021-11-29 17:44:18.105957 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
  
2021-11-29 17:44:18.108491 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-29 17:44:18.145158 (ThreadPoolExecutor-0_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
2021-11-29 17:44:19.925402 (ThreadPoolExecutor-0_0): SQL status: OK -1 in 1.82 seconds
2021-11-29 17:44:19.935351 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: Close
2021-11-29 17:44:19.943217 (ThreadPoolExecutor-2_0): Acquiring new athena connection "list_awsdatacatalog_dbt".
2021-11-29 17:44:19.950288 (ThreadPoolExecutor-2_0): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 57926), raddr=('3.218.163.85', 443)>
2021-11-29 17:44:19.964825 (ThreadPoolExecutor-2_0): Using athena connection "list_awsdatacatalog_dbt".
2021-11-29 17:44:19.966382 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
2021-11-29 17:44:19.970930 (ThreadPoolExecutor-2_0): Opening a new connection, currently in state closed
2021-11-29 17:44:19.996752 (ThreadPoolExecutor-2_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
2021-11-29 17:44:22.852011 (ThreadPoolExecutor-2_0): SQL status: OK -1 in 2.88 seconds
2021-11-29 17:44:22.864738 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: Close
2021-11-29 17:44:22.870596 (MainThread): 17:44:22 | Concurrency: 1 threads (target='dev')
2021-11-29 17:44:22.875686 (MainThread): 17:44:22 | 
2021-11-29 17:44:22.889177 (Thread-1): Began running node model.my_new_project.test_model1
2021-11-29 17:44:22.891164 (Thread-1): 17:44:22 | 1 of 5 START view model dbt.test_model1.............................. [RUN]
2021-11-29 17:44:22.897387 (Thread-1): Acquiring new athena connection "model.my_new_project.test_model1".
2021-11-29 17:44:22.902844 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 57928), raddr=('3.218.163.85', 443)>
2021-11-29 17:44:22.906718 (Thread-1): Compiling model.my_new_project.test_model1
2021-11-29 17:44:22.914327 (Thread-1): Writing injected SQL for node "model.my_new_project.test_model1"
2021-11-29 17:44:22.923414 (Thread-1): finished collecting timing info
2021-11-29 17:44:22.938285 (Thread-1): Writing runtime SQL for node "model.my_new_project.test_model1"
2021-11-29 17:44:22.943399 (Thread-1): Using athena connection "model.my_new_project.test_model1".
2021-11-29 17:44:22.944369 (Thread-1): On model.my_new_project.test_model1: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    /*
SELECT * FROM "defaultdb"."resby_puma_northeast" puma
inner join "defaultdb"."buildings" buildings
on puma.bldg_id=buildings.bldg_fid

limit 10;
*/

/* select * from dbt.Region_Table */

/* In plain english: select all from the "buildings" table where the state value is in the Region_Table state column.  */

SELECT * FROM "defaultdb"."buildings" buildings
inner join dbt.Region_Table region
on buildings.state=region.state
limit 10;

2021-11-29 17:44:22.946813 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 17:44:22.963233 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    /*
SELECT * FROM "defaultdb"."resby_puma_northeast" puma
inner join "defaultdb"."buildings" buildings
on puma.bldg_id=buildings.bldg_fid

limit 10;
*/

/* select * from dbt.Region_Table */

/* In plain english: select all from the "buildings" table where the state value is in the Region_Table state column.  */

SELECT * FROM "defaultdb"."buildings" buildings
inner join dbt.Region_Table region
on buildings.state=region.state
limit 10;
2021-11-29 17:44:24.430735 (Thread-1): Error running SQL: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    /*
SELECT * FROM "defaultdb"."resby_puma_northeast" puma
inner join "defaultdb"."buildings" buildings
on puma.bldg_id=buildings.bldg_fid

limit 10;
*/

/* select * from dbt.Region_Table */

/* In plain english: select all from the "buildings" table where the state value is in the Region_Table state column.  */

SELECT * FROM "defaultdb"."buildings" buildings
inner join dbt.Region_Table region
on buildings.state=region.state
limit 10;

2021-11-29 17:44:24.436470 (Thread-1): finished collecting timing info
2021-11-29 17:44:24.443005 (Thread-1): On model.my_new_project.test_model1: Close
2021-11-29 17:44:24.450128 (Thread-1): Runtime Error in model test_model1 (models/test_model1.sql)
  com.facebook.presto.v217.sql.analyzer.SemanticException: line 2:1: Column name 'city' specified more than once
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 100, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 90, in execute
    raise OperationalError(query_execution.state_change_reason)
pyathena.error.OperationalError: com.facebook.presto.v217.sql.analyzer.SemanticException: line 2:1: Column name 'city' specified more than once

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 66, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 103, in exception_handler
    raise RuntimeException(str(e)) from e
dbt.exceptions.RuntimeException: Runtime Error in model test_model1 (models/test_model1.sql)
  com.facebook.presto.v217.sql.analyzer.SemanticException: line 2:1: Column name 'city' specified more than once
2021-11-29 17:44:24.461169 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f8e8ad9-9b6b-48ae-9893-c4a7a91b59df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c6dd3d0>]}
2021-11-29 17:44:24.464724 (Thread-1): 17:44:24 | 1 of 5 ERROR creating view model dbt.test_model1..................... [ERROR in 1.56s]
2021-11-29 17:44:24.469750 (Thread-1): Finished running node model.my_new_project.test_model1
2021-11-29 17:44:24.473307 (Thread-1): Began running node model.my_new_project.test_model2
2021-11-29 17:44:24.476359 (Thread-1): 17:44:24 | 2 of 5 START view model dbt.test_model2.............................. [RUN]
2021-11-29 17:44:24.480450 (Thread-1): Acquiring new athena connection "model.my_new_project.test_model2".
2021-11-29 17:44:24.485639 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 57930), raddr=('3.218.163.85', 443)>
2021-11-29 17:44:24.489082 (Thread-1): Compiling model.my_new_project.test_model2
2021-11-29 17:44:24.492369 (Thread-1): Writing injected SQL for node "model.my_new_project.test_model2"
2021-11-29 17:44:24.502338 (Thread-1): finished collecting timing info
2021-11-29 17:44:24.505231 (Thread-1): Writing runtime SQL for node "model.my_new_project.test_model2"
2021-11-29 17:44:24.511186 (Thread-1): Using athena connection "model.my_new_project.test_model2".
2021-11-29 17:44:24.512840 (Thread-1): On model.my_new_project.test_model2: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    /*
from somewhere - get bldg_id and zip code --> bldg_locations
*/

2021-11-29 17:44:24.514358 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 17:44:24.536754 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    /*
from somewhere - get bldg_id and zip code --> bldg_locations
*/
2021-11-29 17:44:24.778934 (Thread-1): Failed to execute query.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 307, in _execute
    query_id = retry_api_call(
  File "/usr/local/lib/python3.8/site-packages/pyathena/util.py", line 84, in retry_api_call
    return retry(func, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 404, in __call__
    do = self.iter(retry_state=retry_state)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 349, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 407, in __call__
    result = fn(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 276, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 586, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
2021-11-29 17:44:24.781014 (Thread-1): Error running SQL: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    /*
from somewhere - get bldg_id and zip code --> bldg_locations
*/

2021-11-29 17:44:24.784229 (Thread-1): finished collecting timing info
2021-11-29 17:44:24.786163 (Thread-1): On model.my_new_project.test_model2: Close
2021-11-29 17:44:24.788833 (Thread-1): Runtime Error in model test_model2 (models/test_model2.sql)
  An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 307, in _execute
    query_id = retry_api_call(
  File "/usr/local/lib/python3.8/site-packages/pyathena/util.py", line 84, in retry_api_call
    return retry(func, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 404, in __call__
    do = self.iter(retry_state=retry_state)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 349, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 407, in __call__
    result = fn(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 276, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 586, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 100, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 72, in execute
    query_id = self._execute(
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 315, in _execute
    raise DatabaseError(*e.args) from e
pyathena.error.DatabaseError: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 66, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 103, in exception_handler
    raise RuntimeException(str(e)) from e
dbt.exceptions.RuntimeException: Runtime Error in model test_model2 (models/test_model2.sql)
  An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
2021-11-29 17:44:24.791357 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f8e8ad9-9b6b-48ae-9893-c4a7a91b59df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b1c64f0>]}
2021-11-29 17:44:24.793308 (Thread-1): 17:44:24 | 2 of 5 ERROR creating view model dbt.test_model2..................... [ERROR in 0.31s]
2021-11-29 17:44:24.795046 (Thread-1): Finished running node model.my_new_project.test_model2
2021-11-29 17:44:24.797358 (Thread-1): Began running node model.my_new_project.test_model3
2021-11-29 17:44:24.799093 (Thread-1): 17:44:24 | 3 of 5 SKIP relation dbt.test_model3................................. [SKIP]
2021-11-29 17:44:24.800678 (Thread-1): Finished running node model.my_new_project.test_model3
2021-11-29 17:44:24.802828 (Thread-1): Began running node model.my_new_project.test_model4
2021-11-29 17:44:24.805017 (Thread-1): 17:44:24 | 4 of 5 SKIP relation dbt.test_model4................................. [SKIP]
2021-11-29 17:44:24.807135 (Thread-1): Finished running node model.my_new_project.test_model4
2021-11-29 17:44:24.809230 (Thread-1): Began running node model.my_new_project.test_model5
2021-11-29 17:44:24.811253 (Thread-1): 17:44:24 | 5 of 5 SKIP relation dbt.test_model5................................. [SKIP]
2021-11-29 17:44:24.813044 (Thread-1): Finished running node model.my_new_project.test_model5
2021-11-29 17:44:24.815995 (MainThread): Acquiring new athena connection "master".
2021-11-29 17:44:24.817385 (MainThread): 17:44:24 | 
2021-11-29 17:44:24.818750 (MainThread): 17:44:24 | Finished running 5 view models in 6.73s.
2021-11-29 17:44:24.820808 (MainThread): Connection 'master' was properly closed.
2021-11-29 17:44:24.822324 (MainThread): Connection 'model.my_new_project.test_model2' was properly closed.
2021-11-29 17:44:24.836968 (MainThread): 
2021-11-29 17:44:24.837777 (MainThread): Completed with 2 errors and 0 warnings:
2021-11-29 17:44:24.839251 (MainThread): 
2021-11-29 17:44:24.841500 (MainThread): Runtime Error in model test_model1 (models/test_model1.sql)
2021-11-29 17:44:24.843359 (MainThread):   com.facebook.presto.v217.sql.analyzer.SemanticException: line 2:1: Column name 'city' specified more than once
2021-11-29 17:44:24.845098 (MainThread): 
2021-11-29 17:44:24.849421 (MainThread): Runtime Error in model test_model2 (models/test_model2.sql)
2021-11-29 17:44:24.851250 (MainThread):   An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
2021-11-29 17:44:24.853299 (MainThread): 
Done. PASS=0 WARN=0 ERROR=2 SKIP=3 TOTAL=5
2021-11-29 17:44:24.855937 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c6fdb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e523ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e59b8e0>]}
2021-11-29 17:44:24.857981 (MainThread): Flushing usage events
2021-11-29 17:48:11.363826 (MainThread): Running with dbt=0.21.0
2021-11-29 17:48:11.445182 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/vscode/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-29 17:48:11.451219 (MainThread): Tracking: tracking
2021-11-29 17:48:11.453341 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86f465e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff887e2c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff887e2e80>]}
2021-11-29 17:48:11.461507 (MainThread): Partial parsing not enabled
2021-11-29 17:48:11.482813 (MainThread): Parsing macros/catalog.sql
2021-11-29 17:48:11.487489 (MainThread): Parsing macros/adapters.sql
2021-11-29 17:48:11.497070 (MainThread): Parsing macros/materializations/seed.sql
2021-11-29 17:48:11.499995 (MainThread): Parsing macros/materializations/snapshot.sql
2021-11-29 17:48:11.501103 (MainThread): Parsing macros/materializations/table.sql
2021-11-29 17:48:11.504360 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-29 17:48:11.516961 (MainThread): Parsing macros/materializations/view.sql
2021-11-29 17:48:11.520677 (MainThread): Parsing macros/core.sql
2021-11-29 17:48:11.523216 (MainThread): Parsing macros/materializations/test.sql
2021-11-29 17:48:11.527306 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-29 17:48:11.533644 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-29 17:48:11.537645 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-29 17:48:11.542002 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-29 17:48:11.543629 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-29 17:48:11.550045 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-29 17:48:11.561674 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-29 17:48:11.574204 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-29 17:48:11.578452 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-29 17:48:11.586888 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-29 17:48:11.603319 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-29 17:48:11.613416 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-29 17:48:11.615931 (MainThread): Parsing macros/etc/query.sql
2021-11-29 17:48:11.618378 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-29 17:48:11.620323 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-29 17:48:11.621846 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-29 17:48:11.623337 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-29 17:48:11.626143 (MainThread): Parsing macros/etc/datetime.sql
2021-11-29 17:48:11.631505 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-29 17:48:11.632995 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-29 17:48:11.634942 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-29 17:48:11.636136 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-29 17:48:11.638026 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-29 17:48:11.639813 (MainThread): Parsing macros/adapters/common.sql
2021-11-29 17:48:11.746806 (MainThread): 1699: statically parsed test_model1.sql
2021-11-29 17:48:11.747761 (MainThread): Acquiring new athena connection "model.my_new_project.test_model1".
2021-11-29 17:48:11.756375 (MainThread): Sending event: {'category': 'dbt', 'action': 'experimental_parser', 'label': '20017a52-91be-4515-a013-1adefc90f455', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8697a610>]}
2021-11-29 17:48:11.757899 (MainThread): Acquiring new athena connection "model.my_new_project.test_model2".
2021-11-29 17:48:11.761056 (MainThread): Acquiring new athena connection "model.my_new_project.test_model3".
2021-11-29 17:48:11.764403 (MainThread): Acquiring new athena connection "model.my_new_project.test_model4".
2021-11-29 17:48:11.767283 (MainThread): Acquiring new athena connection "model.my_new_project.test_model5".
2021-11-29 17:48:11.790319 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-11-29 17:48:11.794453 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '20017a52-91be-4515-a013-1adefc90f455', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86361910>]}
2021-11-29 17:48:11.806809 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-11-29 17:48:11.808467 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '20017a52-91be-4515-a013-1adefc90f455', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86361790>]}
2021-11-29 17:48:11.809291 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 2 seed files, 0 sources, 0 exposures
2021-11-29 17:48:11.811995 (MainThread): 
2021-11-29 17:48:11.815667 (MainThread): Acquiring new athena connection "master".
2021-11-29 17:48:11.818398 (ThreadPoolExecutor-0_0): Acquiring new athena connection "list_awsdatacatalog".
2021-11-29 17:48:11.825448 (ThreadPoolExecutor-0_0): Using athena connection "list_awsdatacatalog".
2021-11-29 17:48:11.826282 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
  
2021-11-29 17:48:11.828434 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-29 17:48:11.861834 (ThreadPoolExecutor-0_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
2021-11-29 17:48:13.688935 (ThreadPoolExecutor-0_0): SQL status: OK -1 in 1.86 seconds
2021-11-29 17:48:13.698935 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: Close
2021-11-29 17:48:13.715022 (ThreadPoolExecutor-2_0): Acquiring new athena connection "list_awsdatacatalog_dbt".
2021-11-29 17:48:13.717786 (ThreadPoolExecutor-2_0): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 53144), raddr=('50.17.123.190', 443)>
2021-11-29 17:48:13.730950 (ThreadPoolExecutor-2_0): Using athena connection "list_awsdatacatalog_dbt".
2021-11-29 17:48:13.732530 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
2021-11-29 17:48:13.735817 (ThreadPoolExecutor-2_0): Opening a new connection, currently in state closed
2021-11-29 17:48:13.761205 (ThreadPoolExecutor-2_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
2021-11-29 17:48:16.615603 (ThreadPoolExecutor-2_0): SQL status: OK -1 in 2.88 seconds
2021-11-29 17:48:16.625627 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: Close
2021-11-29 17:48:16.633269 (MainThread): 17:48:16 | Concurrency: 1 threads (target='dev')
2021-11-29 17:48:16.637244 (MainThread): 17:48:16 | 
2021-11-29 17:48:16.650254 (Thread-1): Began running node model.my_new_project.test_model1
2021-11-29 17:48:16.652100 (Thread-1): 17:48:16 | 1 of 5 START view model dbt.test_model1.............................. [RUN]
2021-11-29 17:48:16.657178 (Thread-1): Acquiring new athena connection "model.my_new_project.test_model1".
2021-11-29 17:48:16.664402 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 53146), raddr=('50.17.123.190', 443)>
2021-11-29 17:48:16.669828 (Thread-1): Compiling model.my_new_project.test_model1
2021-11-29 17:48:16.673502 (Thread-1): Writing injected SQL for node "model.my_new_project.test_model1"
2021-11-29 17:48:16.680894 (Thread-1): finished collecting timing info
2021-11-29 17:48:16.697106 (Thread-1): Writing runtime SQL for node "model.my_new_project.test_model1"
2021-11-29 17:48:16.702054 (Thread-1): Using athena connection "model.my_new_project.test_model1".
2021-11-29 17:48:16.703027 (Thread-1): On model.my_new_project.test_model1: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    /*
SELECT * FROM "defaultdb"."resby_puma_northeast" puma
inner join "defaultdb"."buildings" buildings
on puma.bldg_id=buildings.bldg_fid

limit 10;
*/

/* select * from dbt.Region_Table */

/* In plain english: select all from the "buildings" table where the state value is in the Region_Table state column.  */

SELECT * FROM "defaultdb"."buildings" buildings
inner join dbt.Region_Table region
on buildings.state=region.state
limit 10;

2021-11-29 17:48:16.704618 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 17:48:16.720634 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    /*
SELECT * FROM "defaultdb"."resby_puma_northeast" puma
inner join "defaultdb"."buildings" buildings
on puma.bldg_id=buildings.bldg_fid

limit 10;
*/

/* select * from dbt.Region_Table */

/* In plain english: select all from the "buildings" table where the state value is in the Region_Table state column.  */

SELECT * FROM "defaultdb"."buildings" buildings
inner join dbt.Region_Table region
on buildings.state=region.state
limit 10;
2021-11-29 17:48:18.188612 (Thread-1): Error running SQL: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    /*
SELECT * FROM "defaultdb"."resby_puma_northeast" puma
inner join "defaultdb"."buildings" buildings
on puma.bldg_id=buildings.bldg_fid

limit 10;
*/

/* select * from dbt.Region_Table */

/* In plain english: select all from the "buildings" table where the state value is in the Region_Table state column.  */

SELECT * FROM "defaultdb"."buildings" buildings
inner join dbt.Region_Table region
on buildings.state=region.state
limit 10;

2021-11-29 17:48:18.189983 (Thread-1): finished collecting timing info
2021-11-29 17:48:18.192528 (Thread-1): On model.my_new_project.test_model1: Close
2021-11-29 17:48:18.194480 (Thread-1): Runtime Error in model test_model1 (models/test_model1.sql)
  com.facebook.presto.v217.sql.analyzer.SemanticException: line 2:1: Column name 'city' specified more than once
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 100, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 90, in execute
    raise OperationalError(query_execution.state_change_reason)
pyathena.error.OperationalError: com.facebook.presto.v217.sql.analyzer.SemanticException: line 2:1: Column name 'city' specified more than once

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 66, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 103, in exception_handler
    raise RuntimeException(str(e)) from e
dbt.exceptions.RuntimeException: Runtime Error in model test_model1 (models/test_model1.sql)
  com.facebook.presto.v217.sql.analyzer.SemanticException: line 2:1: Column name 'city' specified more than once
2021-11-29 17:48:18.198689 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20017a52-91be-4515-a013-1adefc90f455', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff858ccca0>]}
2021-11-29 17:48:18.200684 (Thread-1): 17:48:18 | 1 of 5 ERROR creating view model dbt.test_model1..................... [ERROR in 1.54s]
2021-11-29 17:48:18.202656 (Thread-1): Finished running node model.my_new_project.test_model1
2021-11-29 17:48:18.205703 (Thread-1): Began running node model.my_new_project.test_model2
2021-11-29 17:48:18.207985 (Thread-1): 17:48:18 | 2 of 5 START view model dbt.test_model2.............................. [RUN]
2021-11-29 17:48:18.210333 (Thread-1): Acquiring new athena connection "model.my_new_project.test_model2".
2021-11-29 17:48:18.213180 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 53148), raddr=('50.17.123.190', 443)>
2021-11-29 17:48:18.214912 (Thread-1): Compiling model.my_new_project.test_model2
2021-11-29 17:48:18.219078 (Thread-1): Writing injected SQL for node "model.my_new_project.test_model2"
2021-11-29 17:48:18.228346 (Thread-1): finished collecting timing info
2021-11-29 17:48:18.233302 (Thread-1): Writing runtime SQL for node "model.my_new_project.test_model2"
2021-11-29 17:48:18.237298 (Thread-1): Using athena connection "model.my_new_project.test_model2".
2021-11-29 17:48:18.238275 (Thread-1): On model.my_new_project.test_model2: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    /*
from somewhere - get bldg_id and zip code --> bldg_locations
*/

2021-11-29 17:48:18.240025 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 17:48:18.259796 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    /*
from somewhere - get bldg_id and zip code --> bldg_locations
*/
2021-11-29 17:48:18.501999 (Thread-1): Failed to execute query.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 307, in _execute
    query_id = retry_api_call(
  File "/usr/local/lib/python3.8/site-packages/pyathena/util.py", line 84, in retry_api_call
    return retry(func, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 404, in __call__
    do = self.iter(retry_state=retry_state)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 349, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 407, in __call__
    result = fn(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 276, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 586, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
2021-11-29 17:48:18.503990 (Thread-1): Error running SQL: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    /*
from somewhere - get bldg_id and zip code --> bldg_locations
*/

2021-11-29 17:48:18.506861 (Thread-1): finished collecting timing info
2021-11-29 17:48:18.509315 (Thread-1): On model.my_new_project.test_model2: Close
2021-11-29 17:48:18.511033 (Thread-1): Runtime Error in model test_model2 (models/test_model2.sql)
  An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 307, in _execute
    query_id = retry_api_call(
  File "/usr/local/lib/python3.8/site-packages/pyathena/util.py", line 84, in retry_api_call
    return retry(func, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 404, in __call__
    do = self.iter(retry_state=retry_state)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 349, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 407, in __call__
    result = fn(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 276, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 586, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 100, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 72, in execute
    query_id = self._execute(
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 315, in _execute
    raise DatabaseError(*e.args) from e
pyathena.error.DatabaseError: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 66, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 103, in exception_handler
    raise RuntimeException(str(e)) from e
dbt.exceptions.RuntimeException: Runtime Error in model test_model2 (models/test_model2.sql)
  An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
2021-11-29 17:48:18.514225 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20017a52-91be-4515-a013-1adefc90f455', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84e2be50>]}
2021-11-29 17:48:18.515718 (Thread-1): 17:48:18 | 2 of 5 ERROR creating view model dbt.test_model2..................... [ERROR in 0.30s]
2021-11-29 17:48:18.517084 (Thread-1): Finished running node model.my_new_project.test_model2
2021-11-29 17:48:18.523805 (Thread-1): Began running node model.my_new_project.test_model3
2021-11-29 17:48:18.525961 (Thread-1): 17:48:18 | 3 of 5 SKIP relation dbt.test_model3................................. [SKIP]
2021-11-29 17:48:18.527749 (Thread-1): Finished running node model.my_new_project.test_model3
2021-11-29 17:48:18.529615 (Thread-1): Began running node model.my_new_project.test_model4
2021-11-29 17:48:18.530963 (Thread-1): 17:48:18 | 4 of 5 SKIP relation dbt.test_model4................................. [SKIP]
2021-11-29 17:48:18.532166 (Thread-1): Finished running node model.my_new_project.test_model4
2021-11-29 17:48:18.533916 (Thread-1): Began running node model.my_new_project.test_model5
2021-11-29 17:48:18.536735 (Thread-1): 17:48:18 | 5 of 5 SKIP relation dbt.test_model5................................. [SKIP]
2021-11-29 17:48:18.538114 (Thread-1): Finished running node model.my_new_project.test_model5
2021-11-29 17:48:18.540497 (MainThread): Acquiring new athena connection "master".
2021-11-29 17:48:18.543103 (MainThread): 17:48:18 | 
2021-11-29 17:48:18.546322 (MainThread): 17:48:18 | Finished running 5 view models in 6.73s.
2021-11-29 17:48:18.549249 (MainThread): Connection 'master' was properly closed.
2021-11-29 17:48:18.551219 (MainThread): Connection 'model.my_new_project.test_model2' was properly closed.
2021-11-29 17:48:18.567240 (MainThread): 
2021-11-29 17:48:18.568635 (MainThread): Completed with 2 errors and 0 warnings:
2021-11-29 17:48:18.570383 (MainThread): 
2021-11-29 17:48:18.572443 (MainThread): Runtime Error in model test_model1 (models/test_model1.sql)
2021-11-29 17:48:18.574871 (MainThread):   com.facebook.presto.v217.sql.analyzer.SemanticException: line 2:1: Column name 'city' specified more than once
2021-11-29 17:48:18.575943 (MainThread): 
2021-11-29 17:48:18.577894 (MainThread): Runtime Error in model test_model2 (models/test_model2.sql)
2021-11-29 17:48:18.582167 (MainThread):   An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
2021-11-29 17:48:18.584466 (MainThread): 
Done. PASS=0 WARN=0 ERROR=2 SKIP=3 TOTAL=5
2021-11-29 17:48:18.585473 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff862ffc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88805910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88805880>]}
2021-11-29 17:48:18.586534 (MainThread): Flushing usage events
2021-11-29 17:49:00.341490 (MainThread): Running with dbt=0.21.0
2021-11-29 17:49:00.409674 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/vscode/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-29 17:49:00.415341 (MainThread): Tracking: tracking
2021-11-29 17:49:00.418521 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6b74400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8415be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8415d60>]}
2021-11-29 17:49:00.427833 (MainThread): Partial parsing not enabled
2021-11-29 17:49:00.446317 (MainThread): Parsing macros/catalog.sql
2021-11-29 17:49:00.450021 (MainThread): Parsing macros/adapters.sql
2021-11-29 17:49:00.458352 (MainThread): Parsing macros/materializations/seed.sql
2021-11-29 17:49:00.461452 (MainThread): Parsing macros/materializations/snapshot.sql
2021-11-29 17:49:00.462428 (MainThread): Parsing macros/materializations/table.sql
2021-11-29 17:49:00.466660 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-29 17:49:00.480360 (MainThread): Parsing macros/materializations/view.sql
2021-11-29 17:49:00.484202 (MainThread): Parsing macros/core.sql
2021-11-29 17:49:00.486695 (MainThread): Parsing macros/materializations/test.sql
2021-11-29 17:49:00.490841 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-29 17:49:00.496882 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-29 17:49:00.501212 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-29 17:49:00.506177 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-29 17:49:00.508384 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-29 17:49:00.514319 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-29 17:49:00.525640 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-29 17:49:00.538188 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-29 17:49:00.542701 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-29 17:49:00.551263 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-29 17:49:00.567706 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-29 17:49:00.577176 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-29 17:49:00.579024 (MainThread): Parsing macros/etc/query.sql
2021-11-29 17:49:00.581074 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-29 17:49:00.583781 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-29 17:49:00.585446 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-29 17:49:00.586825 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-29 17:49:00.589157 (MainThread): Parsing macros/etc/datetime.sql
2021-11-29 17:49:00.596017 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-29 17:49:00.598069 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-29 17:49:00.600528 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-29 17:49:00.601901 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-29 17:49:00.603739 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-29 17:49:00.605849 (MainThread): Parsing macros/adapters/common.sql
2021-11-29 17:49:00.712219 (MainThread): Acquiring new athena connection "model.my_new_project.test_model1".
2021-11-29 17:49:00.721568 (MainThread): Acquiring new athena connection "model.my_new_project.test_model2".
2021-11-29 17:49:00.724189 (MainThread): Acquiring new athena connection "model.my_new_project.test_model3".
2021-11-29 17:49:00.727588 (MainThread): Acquiring new athena connection "model.my_new_project.test_model4".
2021-11-29 17:49:00.731484 (MainThread): Acquiring new athena connection "model.my_new_project.test_model5".
2021-11-29 17:49:00.760245 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-11-29 17:49:00.765015 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7d9096f0-13cb-48a2-a2cf-58301dee7b27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb65966d0>]}
2021-11-29 17:49:00.779077 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-11-29 17:49:00.805639 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7d9096f0-13cb-48a2-a2cf-58301dee7b27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6596730>]}
2021-11-29 17:49:00.807507 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 2 seed files, 0 sources, 0 exposures
2021-11-29 17:49:00.814621 (MainThread): 
2021-11-29 17:49:00.819308 (MainThread): Acquiring new athena connection "master".
2021-11-29 17:49:00.823383 (ThreadPoolExecutor-0_0): Acquiring new athena connection "list_awsdatacatalog".
2021-11-29 17:49:00.834150 (ThreadPoolExecutor-0_0): Using athena connection "list_awsdatacatalog".
2021-11-29 17:49:00.835594 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
  
2021-11-29 17:49:00.837476 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-29 17:49:00.858988 (ThreadPoolExecutor-0_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
2021-11-29 17:49:02.612904 (ThreadPoolExecutor-0_0): SQL status: OK -1 in 1.78 seconds
2021-11-29 17:49:02.622671 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: Close
2021-11-29 17:49:02.631053 (ThreadPoolExecutor-2_0): Acquiring new athena connection "list_awsdatacatalog_dbt".
2021-11-29 17:49:02.634418 (ThreadPoolExecutor-2_0): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 53156), raddr=('50.17.123.190', 443)>
2021-11-29 17:49:02.651959 (ThreadPoolExecutor-2_0): Using athena connection "list_awsdatacatalog_dbt".
2021-11-29 17:49:02.653675 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
2021-11-29 17:49:02.661167 (ThreadPoolExecutor-2_0): Opening a new connection, currently in state closed
2021-11-29 17:49:02.695456 (ThreadPoolExecutor-2_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
2021-11-29 17:49:06.996289 (ThreadPoolExecutor-2_0): SQL status: OK -1 in 4.34 seconds
2021-11-29 17:49:07.002145 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: Close
2021-11-29 17:49:07.006353 (MainThread): 17:49:07 | Concurrency: 1 threads (target='dev')
2021-11-29 17:49:07.010581 (MainThread): 17:49:07 | 
2021-11-29 17:49:07.018994 (Thread-1): Began running node model.my_new_project.test_model1
2021-11-29 17:49:07.020296 (Thread-1): 17:49:07 | 1 of 5 START view model dbt.test_model1.............................. [RUN]
2021-11-29 17:49:07.023433 (Thread-1): Acquiring new athena connection "model.my_new_project.test_model1".
2021-11-29 17:49:07.025882 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 53158), raddr=('50.17.123.190', 443)>
2021-11-29 17:49:07.028855 (Thread-1): Compiling model.my_new_project.test_model1
2021-11-29 17:49:07.036196 (Thread-1): Writing injected SQL for node "model.my_new_project.test_model1"
2021-11-29 17:49:07.040720 (Thread-1): finished collecting timing info
2021-11-29 17:49:07.054065 (Thread-1): Writing runtime SQL for node "model.my_new_project.test_model1"
2021-11-29 17:49:07.058206 (Thread-1): Using athena connection "model.my_new_project.test_model1".
2021-11-29 17:49:07.059134 (Thread-1): On model.my_new_project.test_model1: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    /*
SELECT * FROM "defaultdb"."resby_puma_northeast" puma
inner join "defaultdb"."buildings" buildings
on puma.bldg_id=buildings.bldg_fid

limit 10;
*/

/* select * from dbt.Region_Table */

/* In plain english: select all from the "buildings" table where the state value is in the Region_Table state column.  */

SELECT * FROM "defaultdb"."buildings" buildings
inner join dbt.Region_Table region
on buildings.state=region.state
limit 10;

2021-11-29 17:49:07.060707 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 17:49:07.077996 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    /*
SELECT * FROM "defaultdb"."resby_puma_northeast" puma
inner join "defaultdb"."buildings" buildings
on puma.bldg_id=buildings.bldg_fid

limit 10;
*/

/* select * from dbt.Region_Table */

/* In plain english: select all from the "buildings" table where the state value is in the Region_Table state column.  */

SELECT * FROM "defaultdb"."buildings" buildings
inner join dbt.Region_Table region
on buildings.state=region.state
limit 10;
2021-11-29 17:49:08.549470 (Thread-1): Error running SQL: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    /*
SELECT * FROM "defaultdb"."resby_puma_northeast" puma
inner join "defaultdb"."buildings" buildings
on puma.bldg_id=buildings.bldg_fid

limit 10;
*/

/* select * from dbt.Region_Table */

/* In plain english: select all from the "buildings" table where the state value is in the Region_Table state column.  */

SELECT * FROM "defaultdb"."buildings" buildings
inner join dbt.Region_Table region
on buildings.state=region.state
limit 10;

2021-11-29 17:49:08.554668 (Thread-1): finished collecting timing info
2021-11-29 17:49:08.562897 (Thread-1): On model.my_new_project.test_model1: Close
2021-11-29 17:49:08.568093 (Thread-1): Runtime Error in model test_model1 (models/test_model1.sql)
  com.facebook.presto.v217.sql.analyzer.SemanticException: line 2:1: Column name 'city' specified more than once
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 100, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 90, in execute
    raise OperationalError(query_execution.state_change_reason)
pyathena.error.OperationalError: com.facebook.presto.v217.sql.analyzer.SemanticException: line 2:1: Column name 'city' specified more than once

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 66, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 103, in exception_handler
    raise RuntimeException(str(e)) from e
dbt.exceptions.RuntimeException: Runtime Error in model test_model1 (models/test_model1.sql)
  com.facebook.presto.v217.sql.analyzer.SemanticException: line 2:1: Column name 'city' specified more than once
2021-11-29 17:49:08.579513 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d9096f0-13cb-48a2-a2cf-58301dee7b27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb65b0130>]}
2021-11-29 17:49:08.583527 (Thread-1): 17:49:08 | 1 of 5 ERROR creating view model dbt.test_model1..................... [ERROR in 1.56s]
2021-11-29 17:49:08.587290 (Thread-1): Finished running node model.my_new_project.test_model1
2021-11-29 17:49:08.591019 (Thread-1): Began running node model.my_new_project.test_model2
2021-11-29 17:49:08.593781 (Thread-1): 17:49:08 | 2 of 5 START view model dbt.test_model2.............................. [RUN]
2021-11-29 17:49:08.597279 (Thread-1): Acquiring new athena connection "model.my_new_project.test_model2".
2021-11-29 17:49:08.600295 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 53160), raddr=('50.17.123.190', 443)>
2021-11-29 17:49:08.604157 (Thread-1): Compiling model.my_new_project.test_model2
2021-11-29 17:49:08.608995 (Thread-1): Writing injected SQL for node "model.my_new_project.test_model2"
2021-11-29 17:49:08.617292 (Thread-1): finished collecting timing info
2021-11-29 17:49:08.621052 (Thread-1): Writing runtime SQL for node "model.my_new_project.test_model2"
2021-11-29 17:49:08.631728 (Thread-1): Using athena connection "model.my_new_project.test_model2".
2021-11-29 17:49:08.633301 (Thread-1): On model.my_new_project.test_model2: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    /*
from somewhere - get bldg_id and zip code --> bldg_locations
*/

2021-11-29 17:49:08.634794 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 17:49:08.652350 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    /*
from somewhere - get bldg_id and zip code --> bldg_locations
*/
2021-11-29 17:49:08.906236 (Thread-1): Failed to execute query.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 307, in _execute
    query_id = retry_api_call(
  File "/usr/local/lib/python3.8/site-packages/pyathena/util.py", line 84, in retry_api_call
    return retry(func, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 404, in __call__
    do = self.iter(retry_state=retry_state)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 349, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 407, in __call__
    result = fn(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 276, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 586, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
2021-11-29 17:49:08.909578 (Thread-1): Error running SQL: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    /*
from somewhere - get bldg_id and zip code --> bldg_locations
*/

2021-11-29 17:49:08.911276 (Thread-1): finished collecting timing info
2021-11-29 17:49:08.913234 (Thread-1): On model.my_new_project.test_model2: Close
2021-11-29 17:49:08.914761 (Thread-1): Runtime Error in model test_model2 (models/test_model2.sql)
  An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 307, in _execute
    query_id = retry_api_call(
  File "/usr/local/lib/python3.8/site-packages/pyathena/util.py", line 84, in retry_api_call
    return retry(func, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 404, in __call__
    do = self.iter(retry_state=retry_state)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 349, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 407, in __call__
    result = fn(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 276, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 586, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 100, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 72, in execute
    query_id = self._execute(
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 315, in _execute
    raise DatabaseError(*e.args) from e
pyathena.error.DatabaseError: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 66, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 103, in exception_handler
    raise RuntimeException(str(e)) from e
dbt.exceptions.RuntimeException: Runtime Error in model test_model2 (models/test_model2.sql)
  An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
2021-11-29 17:49:08.917210 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d9096f0-13cb-48a2-a2cf-58301dee7b27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb50676a0>]}
2021-11-29 17:49:08.918677 (Thread-1): 17:49:08 | 2 of 5 ERROR creating view model dbt.test_model2..................... [ERROR in 0.32s]
2021-11-29 17:49:08.920383 (Thread-1): Finished running node model.my_new_project.test_model2
2021-11-29 17:49:08.922634 (Thread-1): Began running node model.my_new_project.test_model3
2021-11-29 17:49:08.924063 (Thread-1): 17:49:08 | 3 of 5 SKIP relation dbt.test_model3................................. [SKIP]
2021-11-29 17:49:08.925227 (Thread-1): Finished running node model.my_new_project.test_model3
2021-11-29 17:49:08.927184 (Thread-1): Began running node model.my_new_project.test_model4
2021-11-29 17:49:08.928903 (Thread-1): 17:49:08 | 4 of 5 SKIP relation dbt.test_model4................................. [SKIP]
2021-11-29 17:49:08.930867 (Thread-1): Finished running node model.my_new_project.test_model4
2021-11-29 17:49:08.934573 (Thread-1): Began running node model.my_new_project.test_model5
2021-11-29 17:49:08.937251 (Thread-1): 17:49:08 | 5 of 5 SKIP relation dbt.test_model5................................. [SKIP]
2021-11-29 17:49:08.938467 (Thread-1): Finished running node model.my_new_project.test_model5
2021-11-29 17:49:08.941374 (MainThread): Acquiring new athena connection "master".
2021-11-29 17:49:08.942911 (MainThread): 17:49:08 | 
2021-11-29 17:49:08.946471 (MainThread): 17:49:08 | Finished running 5 view models in 8.12s.
2021-11-29 17:49:08.949254 (MainThread): Connection 'master' was properly closed.
2021-11-29 17:49:08.950268 (MainThread): Connection 'model.my_new_project.test_model2' was properly closed.
2021-11-29 17:49:08.965204 (MainThread): 
2021-11-29 17:49:08.966696 (MainThread): Completed with 2 errors and 0 warnings:
2021-11-29 17:49:08.970383 (MainThread): 
2021-11-29 17:49:08.972350 (MainThread): Runtime Error in model test_model1 (models/test_model1.sql)
2021-11-29 17:49:08.974236 (MainThread):   com.facebook.presto.v217.sql.analyzer.SemanticException: line 2:1: Column name 'city' specified more than once
2021-11-29 17:49:08.976109 (MainThread): 
2021-11-29 17:49:08.979532 (MainThread): Runtime Error in model test_model2 (models/test_model2.sql)
2021-11-29 17:49:08.982484 (MainThread):   An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 7:3: mismatched input '<EOF>'. Expecting: <query>
2021-11-29 17:49:08.984804 (MainThread): 
Done. PASS=0 WARN=0 ERROR=2 SKIP=3 TOTAL=5
2021-11-29 17:49:08.986744 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6530b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8430880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb84308b0>]}
2021-11-29 17:49:08.988516 (MainThread): Flushing usage events
2021-11-29 17:51:50.716775 (MainThread): Running with dbt=0.21.0
2021-11-29 17:51:50.801153 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/vscode/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-29 17:51:50.809680 (MainThread): Tracking: tracking
2021-11-29 17:51:50.812208 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff951ec610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96a88be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96a88e20>]}
2021-11-29 17:51:50.823718 (MainThread): Partial parsing not enabled
2021-11-29 17:51:50.838828 (MainThread): Parsing macros/catalog.sql
2021-11-29 17:51:50.841296 (MainThread): Parsing macros/adapters.sql
2021-11-29 17:51:50.849844 (MainThread): Parsing macros/materializations/seed.sql
2021-11-29 17:51:50.852658 (MainThread): Parsing macros/materializations/snapshot.sql
2021-11-29 17:51:50.853784 (MainThread): Parsing macros/materializations/table.sql
2021-11-29 17:51:50.856631 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-29 17:51:50.869203 (MainThread): Parsing macros/materializations/view.sql
2021-11-29 17:51:50.872690 (MainThread): Parsing macros/core.sql
2021-11-29 17:51:50.875738 (MainThread): Parsing macros/materializations/test.sql
2021-11-29 17:51:50.880119 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-29 17:51:50.885764 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-29 17:51:50.889647 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-29 17:51:50.894244 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-29 17:51:50.895785 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-29 17:51:50.901784 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-29 17:51:50.912422 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-29 17:51:50.924816 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-29 17:51:50.930024 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-29 17:51:50.938894 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-29 17:51:50.955516 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-29 17:51:50.964293 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-29 17:51:50.965780 (MainThread): Parsing macros/etc/query.sql
2021-11-29 17:51:50.967212 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-29 17:51:50.969870 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-29 17:51:50.971448 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-29 17:51:50.972964 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-29 17:51:50.974930 (MainThread): Parsing macros/etc/datetime.sql
2021-11-29 17:51:50.982515 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-29 17:51:50.983910 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-29 17:51:50.986117 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-29 17:51:50.987822 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-29 17:51:50.990057 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-29 17:51:50.991662 (MainThread): Parsing macros/adapters/common.sql
2021-11-29 17:51:51.098407 (MainThread): Acquiring new athena connection "model.my_new_project.test_model1".
2021-11-29 17:51:51.106580 (MainThread): Acquiring new athena connection "model.my_new_project.test_model2".
2021-11-29 17:51:51.110278 (MainThread): Acquiring new athena connection "model.my_new_project.test_model3".
2021-11-29 17:51:51.113991 (MainThread): Acquiring new athena connection "model.my_new_project.test_model4".
2021-11-29 17:51:51.117743 (MainThread): Acquiring new athena connection "model.my_new_project.test_model5".
2021-11-29 17:51:51.144446 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-11-29 17:51:51.148218 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3843eefa-4c82-4248-851c-d748083582bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94c0a160>]}
2021-11-29 17:51:51.167635 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-11-29 17:51:51.169805 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3843eefa-4c82-4248-851c-d748083582bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94c0a6d0>]}
2021-11-29 17:51:51.171736 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 2 seed files, 0 sources, 0 exposures
2021-11-29 17:51:51.174836 (MainThread): 
2021-11-29 17:51:51.176604 (MainThread): Acquiring new athena connection "master".
2021-11-29 17:51:51.179317 (ThreadPoolExecutor-0_0): Acquiring new athena connection "list_awsdatacatalog".
2021-11-29 17:51:51.186057 (ThreadPoolExecutor-0_0): Using athena connection "list_awsdatacatalog".
2021-11-29 17:51:51.186833 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
  
2021-11-29 17:51:51.188692 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-29 17:51:51.217428 (ThreadPoolExecutor-0_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
2021-11-29 17:51:53.050149 (ThreadPoolExecutor-0_0): SQL status: OK -1 in 1.86 seconds
2021-11-29 17:51:53.058216 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: Close
2021-11-29 17:51:53.075579 (ThreadPoolExecutor-2_0): Acquiring new athena connection "list_awsdatacatalog_dbt".
2021-11-29 17:51:53.078669 (ThreadPoolExecutor-2_0): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 49794), raddr=('52.20.155.128', 443)>
2021-11-29 17:51:53.093128 (ThreadPoolExecutor-2_0): Using athena connection "list_awsdatacatalog_dbt".
2021-11-29 17:51:53.094780 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
2021-11-29 17:51:53.098149 (ThreadPoolExecutor-2_0): Opening a new connection, currently in state closed
2021-11-29 17:51:53.127361 (ThreadPoolExecutor-2_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
2021-11-29 17:51:56.095859 (ThreadPoolExecutor-2_0): SQL status: OK -1 in 3.00 seconds
2021-11-29 17:51:56.104300 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: Close
2021-11-29 17:51:56.110896 (MainThread): 17:51:56 | Concurrency: 1 threads (target='dev')
2021-11-29 17:51:56.117746 (MainThread): 17:51:56 | 
2021-11-29 17:51:56.128714 (Thread-1): Began running node model.my_new_project.test_model1
2021-11-29 17:51:56.130761 (Thread-1): 17:51:56 | 1 of 5 START view model dbt.test_model1.............................. [RUN]
2021-11-29 17:51:56.136066 (Thread-1): Acquiring new athena connection "model.my_new_project.test_model1".
2021-11-29 17:51:56.142083 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 49796), raddr=('52.20.155.128', 443)>
2021-11-29 17:51:56.149725 (Thread-1): Compiling model.my_new_project.test_model1
2021-11-29 17:51:56.158564 (Thread-1): Writing injected SQL for node "model.my_new_project.test_model1"
2021-11-29 17:51:56.169132 (Thread-1): finished collecting timing info
2021-11-29 17:51:56.184734 (Thread-1): Writing runtime SQL for node "model.my_new_project.test_model1"
2021-11-29 17:51:56.192401 (Thread-1): Using athena connection "model.my_new_project.test_model1".
2021-11-29 17:51:56.193729 (Thread-1): On model.my_new_project.test_model1: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    /*
SELECT * FROM "defaultdb"."resby_puma_northeast" puma
inner join "defaultdb"."buildings" buildings
on puma.bldg_id=buildings.bldg_fid

limit 10;
*/

/* select * from dbt.Region_Table */

/* In plain english: select all from the "buildings" table where the state value is in the Region_Table state column.  */

SELECT * FROM "defaultdb"."buildings" buildings
inner join dbt.Region_Table region
on buildings.state=region.state
limit 10;

2021-11-29 17:51:56.195554 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 17:51:56.211997 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    /*
SELECT * FROM "defaultdb"."resby_puma_northeast" puma
inner join "defaultdb"."buildings" buildings
on puma.bldg_id=buildings.bldg_fid

limit 10;
*/

/* select * from dbt.Region_Table */

/* In plain english: select all from the "buildings" table where the state value is in the Region_Table state column.  */

SELECT * FROM "defaultdb"."buildings" buildings
inner join dbt.Region_Table region
on buildings.state=region.state
limit 10;
2021-11-29 17:51:57.678476 (Thread-1): Error running SQL: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    /*
SELECT * FROM "defaultdb"."resby_puma_northeast" puma
inner join "defaultdb"."buildings" buildings
on puma.bldg_id=buildings.bldg_fid

limit 10;
*/

/* select * from dbt.Region_Table */

/* In plain english: select all from the "buildings" table where the state value is in the Region_Table state column.  */

SELECT * FROM "defaultdb"."buildings" buildings
inner join dbt.Region_Table region
on buildings.state=region.state
limit 10;

2021-11-29 17:51:57.679654 (Thread-1): finished collecting timing info
2021-11-29 17:51:57.681579 (Thread-1): On model.my_new_project.test_model1: Close
2021-11-29 17:51:57.684262 (Thread-1): Runtime Error in model test_model1 (models/test_model1.sql)
  com.facebook.presto.v217.sql.analyzer.SemanticException: line 2:1: Column name 'city' specified more than once
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 100, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 90, in execute
    raise OperationalError(query_execution.state_change_reason)
pyathena.error.OperationalError: com.facebook.presto.v217.sql.analyzer.SemanticException: line 2:1: Column name 'city' specified more than once

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 66, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 103, in exception_handler
    raise RuntimeException(str(e)) from e
dbt.exceptions.RuntimeException: Runtime Error in model test_model1 (models/test_model1.sql)
  com.facebook.presto.v217.sql.analyzer.SemanticException: line 2:1: Column name 'city' specified more than once
2021-11-29 17:51:57.691256 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3843eefa-4c82-4248-851c-d748083582bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94b5c4c0>]}
2021-11-29 17:51:57.692758 (Thread-1): 17:51:57 | 1 of 5 ERROR creating view model dbt.test_model1..................... [ERROR in 1.56s]
2021-11-29 17:51:57.694666 (Thread-1): Finished running node model.my_new_project.test_model1
2021-11-29 17:51:57.696373 (Thread-1): Began running node model.my_new_project.test_model2
2021-11-29 17:51:57.698074 (Thread-1): 17:51:57 | 2 of 5 START view model dbt.test_model2.............................. [RUN]
2021-11-29 17:51:57.699804 (Thread-1): Acquiring new athena connection "model.my_new_project.test_model2".
2021-11-29 17:51:57.701512 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 49798), raddr=('52.20.155.128', 443)>
2021-11-29 17:51:57.703614 (Thread-1): Compiling model.my_new_project.test_model2
2021-11-29 17:51:57.706208 (Thread-1): Writing injected SQL for node "model.my_new_project.test_model2"
2021-11-29 17:51:57.711077 (Thread-1): finished collecting timing info
2021-11-29 17:51:57.713536 (Thread-1): Writing runtime SQL for node "model.my_new_project.test_model2"
2021-11-29 17:51:57.716526 (Thread-1): Using athena connection "model.my_new_project.test_model2".
2021-11-29 17:51:57.717012 (Thread-1): On model.my_new_project.test_model2: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    SELECT * FROM "defaultdb"."buildings" buildings
inner join dbt.Random_Small_Towns region
on buildings.state=region.state
limit 10;

2021-11-29 17:51:57.718115 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 17:51:57.737432 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    SELECT * FROM "defaultdb"."buildings" buildings
inner join dbt.Random_Small_Towns region
on buildings.state=region.state
limit 10;
2021-11-29 17:51:59.228164 (Thread-1): Error running SQL: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    SELECT * FROM "defaultdb"."buildings" buildings
inner join dbt.Random_Small_Towns region
on buildings.state=region.state
limit 10;

2021-11-29 17:51:59.232824 (Thread-1): finished collecting timing info
2021-11-29 17:51:59.238680 (Thread-1): On model.my_new_project.test_model2: Close
2021-11-29 17:51:59.243785 (Thread-1): Runtime Error in model test_model2 (models/test_model2.sql)
  com.facebook.presto.v217.sql.analyzer.SemanticException: line 6:12: Table 459120389451.dbt.random_small_towns does not exist
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 100, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 90, in execute
    raise OperationalError(query_execution.state_change_reason)
pyathena.error.OperationalError: com.facebook.presto.v217.sql.analyzer.SemanticException: line 6:12: Table 459120389451.dbt.random_small_towns does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 66, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 103, in exception_handler
    raise RuntimeException(str(e)) from e
dbt.exceptions.RuntimeException: Runtime Error in model test_model2 (models/test_model2.sql)
  com.facebook.presto.v217.sql.analyzer.SemanticException: line 6:12: Table 459120389451.dbt.random_small_towns does not exist
2021-11-29 17:51:59.252706 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3843eefa-4c82-4248-851c-d748083582bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f6fbee0>]}
2021-11-29 17:51:59.262015 (Thread-1): 17:51:59 | 2 of 5 ERROR creating view model dbt.test_model2..................... [ERROR in 1.55s]
2021-11-29 17:51:59.266812 (Thread-1): Finished running node model.my_new_project.test_model2
2021-11-29 17:51:59.271563 (Thread-1): Began running node model.my_new_project.test_model3
2021-11-29 17:51:59.274445 (Thread-1): 17:51:59 | 3 of 5 SKIP relation dbt.test_model3................................. [SKIP]
2021-11-29 17:51:59.277552 (Thread-1): Finished running node model.my_new_project.test_model3
2021-11-29 17:51:59.280709 (Thread-1): Began running node model.my_new_project.test_model4
2021-11-29 17:51:59.283533 (Thread-1): 17:51:59 | 4 of 5 SKIP relation dbt.test_model4................................. [SKIP]
2021-11-29 17:51:59.287214 (Thread-1): Finished running node model.my_new_project.test_model4
2021-11-29 17:51:59.292687 (Thread-1): Began running node model.my_new_project.test_model5
2021-11-29 17:51:59.294994 (Thread-1): 17:51:59 | 5 of 5 SKIP relation dbt.test_model5................................. [SKIP]
2021-11-29 17:51:59.296985 (Thread-1): Finished running node model.my_new_project.test_model5
2021-11-29 17:51:59.299786 (MainThread): Acquiring new athena connection "master".
2021-11-29 17:51:59.301880 (MainThread): 17:51:59 | 
2021-11-29 17:51:59.305848 (MainThread): 17:51:59 | Finished running 5 view models in 8.13s.
2021-11-29 17:51:59.308836 (MainThread): Connection 'master' was properly closed.
2021-11-29 17:51:59.310870 (MainThread): Connection 'model.my_new_project.test_model2' was properly closed.
2021-11-29 17:51:59.313038 (MainThread): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 49800), raddr=('52.20.155.128', 443)>
2021-11-29 17:51:59.327617 (MainThread): 
2021-11-29 17:51:59.328551 (MainThread): Completed with 2 errors and 0 warnings:
2021-11-29 17:51:59.330536 (MainThread): 
2021-11-29 17:51:59.332192 (MainThread): Runtime Error in model test_model1 (models/test_model1.sql)
2021-11-29 17:51:59.334257 (MainThread):   com.facebook.presto.v217.sql.analyzer.SemanticException: line 2:1: Column name 'city' specified more than once
2021-11-29 17:51:59.336195 (MainThread): 
2021-11-29 17:51:59.340803 (MainThread): Runtime Error in model test_model2 (models/test_model2.sql)
2021-11-29 17:51:59.344267 (MainThread):   com.facebook.presto.v217.sql.analyzer.SemanticException: line 6:12: Table 459120389451.dbt.random_small_towns does not exist
2021-11-29 17:51:59.346301 (MainThread): 
Done. PASS=0 WARN=0 ERROR=2 SKIP=3 TOTAL=5
2021-11-29 17:51:59.348669 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94ba7be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96aa9970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96aa94f0>]}
2021-11-29 17:51:59.350702 (MainThread): Flushing usage events
2021-11-29 17:52:32.673243 (MainThread): Running with dbt=0.21.0
2021-11-29 17:52:32.740389 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/vscode/.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', select=None, selector_name=None, show=False, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='seed', write_json=True)
2021-11-29 17:52:32.745922 (MainThread): Tracking: tracking
2021-11-29 17:52:32.748458 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6621610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7ebd1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7ebde20>]}
2021-11-29 17:52:32.759498 (MainThread): Partial parsing not enabled
2021-11-29 17:52:32.777046 (MainThread): Parsing macros/catalog.sql
2021-11-29 17:52:32.780573 (MainThread): Parsing macros/adapters.sql
2021-11-29 17:52:32.788945 (MainThread): Parsing macros/materializations/seed.sql
2021-11-29 17:52:32.792940 (MainThread): Parsing macros/materializations/snapshot.sql
2021-11-29 17:52:32.794156 (MainThread): Parsing macros/materializations/table.sql
2021-11-29 17:52:32.797270 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-29 17:52:32.811402 (MainThread): Parsing macros/materializations/view.sql
2021-11-29 17:52:32.817336 (MainThread): Parsing macros/core.sql
2021-11-29 17:52:32.820530 (MainThread): Parsing macros/materializations/test.sql
2021-11-29 17:52:32.825664 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-29 17:52:32.831774 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-29 17:52:32.836258 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-29 17:52:32.858861 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-29 17:52:32.860703 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-29 17:52:32.867397 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-29 17:52:32.878903 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-29 17:52:32.891922 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-29 17:52:32.896842 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-29 17:52:32.905286 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-29 17:52:32.922773 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-29 17:52:32.932445 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-29 17:52:32.934436 (MainThread): Parsing macros/etc/query.sql
2021-11-29 17:52:32.937687 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-29 17:52:32.940193 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-29 17:52:32.942507 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-29 17:52:32.944058 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-29 17:52:32.945716 (MainThread): Parsing macros/etc/datetime.sql
2021-11-29 17:52:32.950966 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-29 17:52:32.952685 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-29 17:52:32.955543 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-29 17:52:32.957678 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-29 17:52:32.959598 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-29 17:52:32.961383 (MainThread): Parsing macros/adapters/common.sql
2021-11-29 17:52:33.072496 (MainThread): Acquiring new athena connection "model.my_new_project.test_model1".
2021-11-29 17:52:33.082768 (MainThread): 1699: statically parsed test_model2.sql
2021-11-29 17:52:33.083608 (MainThread): Acquiring new athena connection "model.my_new_project.test_model2".
2021-11-29 17:52:33.087423 (MainThread): Sending event: {'category': 'dbt', 'action': 'experimental_parser', 'label': '66723efd-b418-40d5-bcce-fa46940ff65a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa607e910>]}
2021-11-29 17:52:33.088795 (MainThread): Acquiring new athena connection "model.my_new_project.test_model3".
2021-11-29 17:52:33.093550 (MainThread): Acquiring new athena connection "model.my_new_project.test_model4".
2021-11-29 17:52:33.097514 (MainThread): Acquiring new athena connection "model.my_new_project.test_model5".
2021-11-29 17:52:33.122657 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-11-29 17:52:33.127427 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '66723efd-b418-40d5-bcce-fa46940ff65a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa582cc10>]}
2021-11-29 17:52:33.139871 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-11-29 17:52:33.141839 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '66723efd-b418-40d5-bcce-fa46940ff65a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa582cac0>]}
2021-11-29 17:52:33.143993 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 2 seed files, 0 sources, 0 exposures
2021-11-29 17:52:33.146333 (MainThread): 
2021-11-29 17:52:33.148715 (MainThread): Acquiring new athena connection "master".
2021-11-29 17:52:33.151425 (ThreadPoolExecutor-0_0): Acquiring new athena connection "list_awsdatacatalog".
2021-11-29 17:52:33.161734 (ThreadPoolExecutor-0_0): Using athena connection "list_awsdatacatalog".
2021-11-29 17:52:33.162776 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
  
2021-11-29 17:52:33.164391 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-29 17:52:33.184590 (ThreadPoolExecutor-0_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
2021-11-29 17:52:34.940182 (ThreadPoolExecutor-0_0): SQL status: OK -1 in 1.78 seconds
2021-11-29 17:52:34.948972 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: Close
2021-11-29 17:52:34.955771 (ThreadPoolExecutor-2_0): Acquiring new athena connection "list_awsdatacatalog_dbt".
2021-11-29 17:52:34.959054 (ThreadPoolExecutor-2_0): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 49804), raddr=('52.20.155.128', 443)>
2021-11-29 17:52:34.973558 (ThreadPoolExecutor-2_0): Using athena connection "list_awsdatacatalog_dbt".
2021-11-29 17:52:34.975010 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
2021-11-29 17:52:34.978853 (ThreadPoolExecutor-2_0): Opening a new connection, currently in state closed
2021-11-29 17:52:35.007224 (ThreadPoolExecutor-2_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
2021-11-29 17:52:37.953456 (ThreadPoolExecutor-2_0): SQL status: OK -1 in 2.97 seconds
2021-11-29 17:52:37.956298 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: Close
2021-11-29 17:52:37.959401 (MainThread): 17:52:37 | Concurrency: 1 threads (target='dev')
2021-11-29 17:52:37.962227 (MainThread): 17:52:37 | 
2021-11-29 17:52:37.967256 (Thread-1): Began running node seed.my_new_project.Random_Small_Towns
2021-11-29 17:52:37.968638 (Thread-1): 17:52:37 | 1 of 2 START seed file dbt.Random_Small_Towns........................ [RUN]
2021-11-29 17:52:37.971320 (Thread-1): Acquiring new athena connection "seed.my_new_project.Random_Small_Towns".
2021-11-29 17:52:37.973552 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 49806), raddr=('52.20.155.128', 443)>
2021-11-29 17:52:37.975834 (Thread-1): finished collecting timing info
2021-11-29 17:52:37.999268 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-11-29 17:52:38.000828 (Thread-1): * Deprecation Warning: The quote_columns parameter was not set for seeds, so the
default value of False was chosen. The default will change to True in a future
release.

For more information, see:
https://docs.getdbt.com/v0.15/docs/seeds#section-specify-column-quoting
2021-11-29 17:52:38.003247 (Thread-1): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '66723efd-b418-40d5-bcce-fa46940ff65a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa42b11f0>]}
2021-11-29 17:52:38.005760 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-11-29 17:52:38.007982 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-11-29 17:52:38.011264 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-11-29 17:52:38.013640 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-11-29 17:52:38.015456 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 17:52:38.031176 (Thread-1): Using athena connection "seed.my_new_project.Random_Small_Towns".
2021-11-29 17:52:38.032321 (Thread-1): On seed.my_new_project.Random_Small_Towns: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "seed.my_new_project.Random_Small_Towns"} */

    create external table dbt.Random_Small_Towns (Zip integer, City string, County string, State string, Region string)
    stored as parquet
    location 's3://justin-dbt-testing/Targettables/b32b4749-1c38-4df1-9ca0-a3abc4b63c1a/'
    tblproperties ('classification'='parquet')
  
2021-11-29 17:52:38.034881 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "seed.my_new_project.Random_Small_Towns"} */

    create external table dbt.Random_Small_Towns (Zip integer, City string, County string, State string, Region string)
    stored as parquet
    location 's3://justin-dbt-testing/Targettables/b32b4749-1c38-4df1-9ca0-a3abc4b63c1a/'
    tblproperties ('classification'='parquet')
2021-11-29 17:52:39.745789 (Thread-1): SQL status: OK -1 in 1.71 seconds
2021-11-29 17:52:39.767658 (Thread-1): Using athena connection "seed.my_new_project.Random_Small_Towns".
2021-11-29 17:52:39.768674 (Thread-1): On seed.my_new_project.Random_Small_Towns: 
          insert into dbt.Random_Small_Towns (Zip, City, County, State, Region) values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s)
      ...
2021-11-29 17:52:39.773450 (Thread-1): insert into dbt.Random_Small_Towns (Zip, City, County, State, Region) values
          (4101,'Portland','Cumberland','ME','Northeast'),(4027,'Lebanon','York','ME','Northeast'),(4430,'Millinocket','Penobscot','ME','Northeast'),(33514,'Center Hill','Sumter','FL','Southeast'),(33935,'Muce','Glades','FL','Southeast'),(33040,'Key West','Monroe','FL','Southeast'),(54751,'Menomonie','Dunn','WI','Midwest'),(54011,'El Paso','Pierce','WI','Midwest'),(55043,'Lakeland','Washington','MN','Midwest'),(86321,'Bagdad','Yavapai','AZ','Southwest'),(85937,'Snowflake','Navajo','AZ','Southwest'),(85539,'Miami','Gila','AZ','Southwest'),(98851,'Soap Lake','Grant','WA','Northwest'),(99022,'Medical Lake','Spokane','WA','Northwest'),(99148,'Loon Lake','Stevens','WA','Northwest'),(99723,'Utqiagvik','North Slope','AK','Alaska'),(99762,'Nome','Unorganized','AK','Alaska'),(99686,'Valdez','Chugach','AK','Alaska'),(96777,'Phala','Hawaii','HI','Hawaii'),(96761,'Kapalua','Maui','HI','Hawaii'),(96769,'Puuwai','Kauai','HI','Hawaii')
2021-11-29 17:52:42.415882 (Thread-1): SQL status: OK -1 in 2.64 seconds
2021-11-29 17:52:42.433588 (Thread-1): Writing runtime SQL for node "seed.my_new_project.Random_Small_Towns"
2021-11-29 17:52:42.467044 (Thread-1): finished collecting timing info
2021-11-29 17:52:42.468394 (Thread-1): On seed.my_new_project.Random_Small_Towns: Close
2021-11-29 17:52:42.471041 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66723efd-b418-40d5-bcce-fa46940ff65a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4361760>]}
2021-11-29 17:52:42.473539 (Thread-1): 17:52:42 | 1 of 2 OK loaded seed file dbt.Random_Small_Towns.................... [INSERT 21 in 4.50s]
2021-11-29 17:52:42.475816 (Thread-1): Finished running node seed.my_new_project.Random_Small_Towns
2021-11-29 17:52:42.478886 (Thread-1): Began running node seed.my_new_project.Region_Table
2021-11-29 17:52:42.481694 (Thread-1): 17:52:42 | 2 of 2 START seed file dbt.Region_Table.............................. [RUN]
2021-11-29 17:52:42.484215 (Thread-1): Acquiring new athena connection "seed.my_new_project.Region_Table".
2021-11-29 17:52:42.486687 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 49808), raddr=('52.20.155.128', 443)>
2021-11-29 17:52:42.488763 (Thread-1): finished collecting timing info
2021-11-29 17:52:42.492387 (Thread-1): finished collecting timing info
2021-11-29 17:52:42.494551 (Thread-1): Compilation Error in seed Region_Table (data/Region_Table.csv)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete dbt.region_table, or rename it to be less ambiguous.
  Searched for: dbt.Region_Table
  Found: dbt.region_table
  
  > in macro materialization_seed_default (macros/materializations/seed/seed.sql)
  > called by seed Region_Table (data/Region_Table.csv)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 39, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 734, in get_relation
    matches = self._make_match(relations_list, database, schema,
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 723, in _make_match
    if relation.matches(**search):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/relation.py", line 99, in matches
    dbt.exceptions.approximate_relation_match(target, self)
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 741, in approximate_relation_match
    raise_compiler_error(
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 444, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in seed Region_Table (data/Region_Table.csv)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete dbt.region_table, or rename it to be less ambiguous.
  Searched for: dbt.Region_Table
  Found: dbt.region_table
  
  > in macro materialization_seed_default (macros/materializations/seed/seed.sql)
  > called by seed Region_Table (data/Region_Table.csv)
2021-11-29 17:52:42.498694 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66723efd-b418-40d5-bcce-fa46940ff65a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4de61c0>]}
2021-11-29 17:52:42.501665 (Thread-1): 17:52:42 | 2 of 2 ERROR loading seed file dbt.Region_Table...................... [ERROR in 0.01s]
2021-11-29 17:52:42.503433 (Thread-1): Finished running node seed.my_new_project.Region_Table
2021-11-29 17:52:42.507095 (MainThread): Acquiring new athena connection "master".
2021-11-29 17:52:42.508166 (MainThread): 17:52:42 | 
2021-11-29 17:52:42.509885 (MainThread): 17:52:42 | Finished running 2 seeds in 9.36s.
2021-11-29 17:52:42.512272 (MainThread): Connection 'master' was properly closed.
2021-11-29 17:52:42.514080 (MainThread): Connection 'seed.my_new_project.Region_Table' was properly closed.
2021-11-29 17:52:42.529314 (MainThread): 
2021-11-29 17:52:42.530249 (MainThread): Completed with 1 error and 0 warnings:
2021-11-29 17:52:42.533243 (MainThread): 
2021-11-29 17:52:42.535463 (MainThread): Compilation Error in seed Region_Table (data/Region_Table.csv)
2021-11-29 17:52:42.538297 (MainThread):   When searching for a relation, dbt found an approximate match. Instead of guessing 
2021-11-29 17:52:42.540737 (MainThread):   which relation to use, dbt will move on. Please delete dbt.region_table, or rename it to be less ambiguous.
2021-11-29 17:52:42.543131 (MainThread):   Searched for: dbt.Region_Table
2021-11-29 17:52:42.547323 (MainThread):   Found: dbt.region_table
2021-11-29 17:52:42.550005 (MainThread):   
2021-11-29 17:52:42.554331 (MainThread):   > in macro materialization_seed_default (macros/materializations/seed/seed.sql)
2021-11-29 17:52:42.556560 (MainThread):   > called by seed Region_Table (data/Region_Table.csv)
2021-11-29 17:52:42.558411 (MainThread): 
Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
2021-11-29 17:52:42.561427 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa583aaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7edd4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7eddb80>]}
2021-11-29 17:52:42.564067 (MainThread): Flushing usage events
2021-11-29 17:53:51.765899 (MainThread): Running with dbt=0.21.0
2021-11-29 17:53:51.836607 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/vscode/.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', select=None, selector_name=None, show=False, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='seed', write_json=True)
2021-11-29 17:53:51.841513 (MainThread): Tracking: tracking
2021-11-29 17:53:51.846388 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0622610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1ec32e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1ec3df0>]}
2021-11-29 17:53:51.856657 (MainThread): Partial parsing not enabled
2021-11-29 17:53:51.875658 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1edeac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa01108e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0110100>]}
2021-11-29 17:53:51.876465 (MainThread): Flushing usage events
2021-11-29 17:53:52.137937 (MainThread): Encountered an error:
2021-11-29 17:53:52.139337 (MainThread): Compilation Error
  The schema file at models/Jaffle/dbt_project.yml is invalid because the version is not an integer. Please consult the documentation for more information on schema.yml syntax:
  
  https://docs.getdbt.com/docs/schemayml-files
2021-11-29 17:53:52.147176 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 433, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 149, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 87, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 74, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 182, in get_full_manifest
    manifest = loader.load()
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 210, in load
    read_files(project, self.manifest.files, project_parser_files, saved_files)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/read_files.py", line 151, in read_files
    project_files['SchemaParser'] = read_files_for_parser(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/read_files.py", line 106, in read_files_for_parser
    source_files = get_source_files(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/read_files.py", line 97, in get_source_files
    file = load_source_file(fp, parse_file_type, project.project_name, saved_files)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/read_files.py", line 39, in load_source_file
    validate_yaml(source_file.path.original_file_path, dfy)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/read_files.py", line 50, in validate_yaml
    check_format_version(file_path, dct)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/schemas.py", line 541, in check_format_version
    raise_invalid_schema_yml_version(
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 904, in raise_invalid_schema_yml_version
    raise_compiler_error(
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 444, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error
  The schema file at models/Jaffle/dbt_project.yml is invalid because the version is not an integer. Please consult the documentation for more information on schema.yml syntax:
  
  https://docs.getdbt.com/docs/schemayml-files

2021-11-29 17:57:10.423904 (MainThread): Running with dbt=0.21.0
2021-11-29 17:57:10.495877 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/vscode/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-29 17:57:10.504219 (MainThread): Tracking: tracking
2021-11-29 17:57:10.507248 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d2a2520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8eb3ec10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8eb3ee20>]}
2021-11-29 17:57:10.516202 (MainThread): Partial parsing not enabled
2021-11-29 17:57:10.533604 (MainThread): Parsing macros/catalog.sql
2021-11-29 17:57:10.536060 (MainThread): Parsing macros/adapters.sql
2021-11-29 17:57:10.544697 (MainThread): Parsing macros/materializations/seed.sql
2021-11-29 17:57:10.548207 (MainThread): Parsing macros/materializations/snapshot.sql
2021-11-29 17:57:10.549315 (MainThread): Parsing macros/materializations/table.sql
2021-11-29 17:57:10.553094 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-29 17:57:10.566025 (MainThread): Parsing macros/materializations/view.sql
2021-11-29 17:57:10.569596 (MainThread): Parsing macros/core.sql
2021-11-29 17:57:10.572470 (MainThread): Parsing macros/materializations/test.sql
2021-11-29 17:57:10.577443 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-29 17:57:10.583465 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-29 17:57:10.586726 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-29 17:57:10.591104 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-29 17:57:10.593524 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-29 17:57:10.599399 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-29 17:57:10.610140 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-29 17:57:10.624776 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-29 17:57:10.629415 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-29 17:57:10.637088 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-29 17:57:10.653536 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-29 17:57:10.663167 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-29 17:57:10.666260 (MainThread): Parsing macros/etc/query.sql
2021-11-29 17:57:10.667420 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-29 17:57:10.670172 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-29 17:57:10.671604 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-29 17:57:10.674393 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-29 17:57:10.676000 (MainThread): Parsing macros/etc/datetime.sql
2021-11-29 17:57:10.682282 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-29 17:57:10.683812 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-29 17:57:10.686218 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-29 17:57:10.690556 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-29 17:57:10.694063 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-29 17:57:10.697619 (MainThread): Parsing macros/adapters/common.sql
2021-11-29 17:57:10.806476 (MainThread): Acquiring new athena connection "model.my_new_project.test_model1".
2021-11-29 17:57:10.814601 (MainThread): Acquiring new athena connection "model.my_new_project.test_model2".
2021-11-29 17:57:10.817382 (MainThread): Acquiring new athena connection "model.my_new_project.test_model3".
2021-11-29 17:57:10.820558 (MainThread): Acquiring new athena connection "model.my_new_project.test_model4".
2021-11-29 17:57:10.823554 (MainThread): Acquiring new athena connection "model.my_new_project.test_model5".
2021-11-29 17:57:10.848958 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-11-29 17:57:10.854410 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '774e3654-489e-48b6-9514-359c95d63b77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ccc0760>]}
2021-11-29 17:57:10.866807 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-11-29 17:57:10.871432 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '774e3654-489e-48b6-9514-359c95d63b77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ccc0070>]}
2021-11-29 17:57:10.872776 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 2 seed files, 0 sources, 0 exposures
2021-11-29 17:57:10.875583 (MainThread): 
2021-11-29 17:57:10.876439 (MainThread): Acquiring new athena connection "master".
2021-11-29 17:57:10.878685 (ThreadPoolExecutor-0_0): Acquiring new athena connection "list_awsdatacatalog".
2021-11-29 17:57:10.885337 (ThreadPoolExecutor-0_0): Using athena connection "list_awsdatacatalog".
2021-11-29 17:57:10.886133 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
  
2021-11-29 17:57:10.887885 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-29 17:57:10.913074 (ThreadPoolExecutor-0_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
2021-11-29 17:57:12.756408 (ThreadPoolExecutor-0_0): SQL status: OK -1 in 1.87 seconds
2021-11-29 17:57:12.770727 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: Close
2021-11-29 17:57:12.777302 (ThreadPoolExecutor-2_0): Acquiring new athena connection "list_awsdatacatalog_dbt".
2021-11-29 17:57:12.781049 (ThreadPoolExecutor-2_0): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 44720), raddr=('54.156.232.244', 443)>
2021-11-29 17:57:12.797350 (ThreadPoolExecutor-2_0): Using athena connection "list_awsdatacatalog_dbt".
2021-11-29 17:57:12.799001 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
2021-11-29 17:57:12.804443 (ThreadPoolExecutor-2_0): Opening a new connection, currently in state closed
2021-11-29 17:57:12.832762 (ThreadPoolExecutor-2_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
2021-11-29 17:57:16.768540 (ThreadPoolExecutor-2_0): SQL status: OK -1 in 3.96 seconds
2021-11-29 17:57:16.774568 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: Close
2021-11-29 17:57:16.780175 (MainThread): 17:57:16 | Concurrency: 1 threads (target='dev')
2021-11-29 17:57:16.785174 (MainThread): 17:57:16 | 
2021-11-29 17:57:16.795981 (Thread-1): Began running node model.my_new_project.test_model1
2021-11-29 17:57:16.797612 (Thread-1): 17:57:16 | 1 of 5 START view model dbt.test_model1.............................. [RUN]
2021-11-29 17:57:16.803305 (Thread-1): Acquiring new athena connection "model.my_new_project.test_model1".
2021-11-29 17:57:16.809163 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 44722), raddr=('54.156.232.244', 443)>
2021-11-29 17:57:16.813317 (Thread-1): Compiling model.my_new_project.test_model1
2021-11-29 17:57:16.818049 (Thread-1): Writing injected SQL for node "model.my_new_project.test_model1"
2021-11-29 17:57:16.828839 (Thread-1): finished collecting timing info
2021-11-29 17:57:16.842386 (Thread-1): Writing runtime SQL for node "model.my_new_project.test_model1"
2021-11-29 17:57:16.847043 (Thread-1): Using athena connection "model.my_new_project.test_model1".
2021-11-29 17:57:16.847980 (Thread-1): On model.my_new_project.test_model1: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    /*
SELECT * FROM "defaultdb"."resby_puma_northeast" puma
inner join "defaultdb"."buildings" buildings
on puma.bldg_id=buildings.bldg_fid

limit 10;
*/

/* select * from dbt.Region_Table */

/* In plain english: select all from the "buildings" table where the state value is in the Region_Table state column.  */

SELECT * FROM "defaultdb"."buildings" buildings
inner join dbt.Region_Table region
on buildings.state=region.state
limit 10;

2021-11-29 17:57:16.849387 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 17:57:16.865417 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    /*
SELECT * FROM "defaultdb"."resby_puma_northeast" puma
inner join "defaultdb"."buildings" buildings
on puma.bldg_id=buildings.bldg_fid

limit 10;
*/

/* select * from dbt.Region_Table */

/* In plain english: select all from the "buildings" table where the state value is in the Region_Table state column.  */

SELECT * FROM "defaultdb"."buildings" buildings
inner join dbt.Region_Table region
on buildings.state=region.state
limit 10;
2021-11-29 17:57:18.332360 (Thread-1): Error running SQL: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    /*
SELECT * FROM "defaultdb"."resby_puma_northeast" puma
inner join "defaultdb"."buildings" buildings
on puma.bldg_id=buildings.bldg_fid

limit 10;
*/

/* select * from dbt.Region_Table */

/* In plain english: select all from the "buildings" table where the state value is in the Region_Table state column.  */

SELECT * FROM "defaultdb"."buildings" buildings
inner join dbt.Region_Table region
on buildings.state=region.state
limit 10;

2021-11-29 17:57:18.338319 (Thread-1): finished collecting timing info
2021-11-29 17:57:18.344314 (Thread-1): On model.my_new_project.test_model1: Close
2021-11-29 17:57:18.352556 (Thread-1): Runtime Error in model test_model1 (models/test_model1.sql)
  com.facebook.presto.v217.sql.analyzer.SemanticException: line 2:1: Column name 'city' specified more than once
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 100, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 90, in execute
    raise OperationalError(query_execution.state_change_reason)
pyathena.error.OperationalError: com.facebook.presto.v217.sql.analyzer.SemanticException: line 2:1: Column name 'city' specified more than once

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 66, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 103, in exception_handler
    raise RuntimeException(str(e)) from e
dbt.exceptions.RuntimeException: Runtime Error in model test_model1 (models/test_model1.sql)
  com.facebook.presto.v217.sql.analyzer.SemanticException: line 2:1: Column name 'city' specified more than once
2021-11-29 17:57:18.364467 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '774e3654-489e-48b6-9514-359c95d63b77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cc124f0>]}
2021-11-29 17:57:18.375067 (Thread-1): 17:57:18 | 1 of 5 ERROR creating view model dbt.test_model1..................... [ERROR in 1.56s]
2021-11-29 17:57:18.378804 (Thread-1): Finished running node model.my_new_project.test_model1
2021-11-29 17:57:18.382954 (Thread-1): Began running node model.my_new_project.test_model2
2021-11-29 17:57:18.386150 (Thread-1): 17:57:18 | 2 of 5 START view model dbt.test_model2.............................. [RUN]
2021-11-29 17:57:18.388591 (Thread-1): Acquiring new athena connection "model.my_new_project.test_model2".
2021-11-29 17:57:18.391418 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 44724), raddr=('54.156.232.244', 443)>
2021-11-29 17:57:18.393894 (Thread-1): Compiling model.my_new_project.test_model2
2021-11-29 17:57:18.398006 (Thread-1): Writing injected SQL for node "model.my_new_project.test_model2"
2021-11-29 17:57:18.403865 (Thread-1): finished collecting timing info
2021-11-29 17:57:18.406907 (Thread-1): Writing runtime SQL for node "model.my_new_project.test_model2"
2021-11-29 17:57:18.412197 (Thread-1): Using athena connection "model.my_new_project.test_model2".
2021-11-29 17:57:18.413400 (Thread-1): On model.my_new_project.test_model2: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    SELECT * FROM "defaultdb"."buildings" buildings
inner join dbt.Random_Small_Towns region
on buildings.state=region.state
limit 10;

2021-11-29 17:57:18.415758 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 17:57:18.434449 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    SELECT * FROM "defaultdb"."buildings" buildings
inner join dbt.Random_Small_Towns region
on buildings.state=region.state
limit 10;
2021-11-29 17:57:19.912195 (Thread-1): Error running SQL: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    SELECT * FROM "defaultdb"."buildings" buildings
inner join dbt.Random_Small_Towns region
on buildings.state=region.state
limit 10;

2021-11-29 17:57:19.913913 (Thread-1): finished collecting timing info
2021-11-29 17:57:19.917282 (Thread-1): On model.my_new_project.test_model2: Close
2021-11-29 17:57:19.920137 (Thread-1): Runtime Error in model test_model2 (models/test_model2.sql)
  com.facebook.presto.v217.sql.analyzer.SemanticException: line 2:1: Column name 'city' specified more than once
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 100, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 90, in execute
    raise OperationalError(query_execution.state_change_reason)
pyathena.error.OperationalError: com.facebook.presto.v217.sql.analyzer.SemanticException: line 2:1: Column name 'city' specified more than once

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 66, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 103, in exception_handler
    raise RuntimeException(str(e)) from e
dbt.exceptions.RuntimeException: Runtime Error in model test_model2 (models/test_model2.sql)
  com.facebook.presto.v217.sql.analyzer.SemanticException: line 2:1: Column name 'city' specified more than once
2021-11-29 17:57:19.924325 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '774e3654-489e-48b6-9514-359c95d63b77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87740c40>]}
2021-11-29 17:57:19.926710 (Thread-1): 17:57:19 | 2 of 5 ERROR creating view model dbt.test_model2..................... [ERROR in 1.54s]
2021-11-29 17:57:19.928950 (Thread-1): Finished running node model.my_new_project.test_model2
2021-11-29 17:57:19.933185 (Thread-1): Began running node model.my_new_project.test_model3
2021-11-29 17:57:19.935071 (Thread-1): 17:57:19 | 3 of 5 SKIP relation dbt.test_model3................................. [SKIP]
2021-11-29 17:57:19.937220 (Thread-1): Finished running node model.my_new_project.test_model3
2021-11-29 17:57:19.939876 (Thread-1): Began running node model.my_new_project.test_model4
2021-11-29 17:57:19.940848 (Thread-1): 17:57:19 | 4 of 5 SKIP relation dbt.test_model4................................. [SKIP]
2021-11-29 17:57:19.942474 (Thread-1): Finished running node model.my_new_project.test_model4
2021-11-29 17:57:19.945817 (Thread-1): Began running node model.my_new_project.test_model5
2021-11-29 17:57:19.946739 (Thread-1): 17:57:19 | 5 of 5 SKIP relation dbt.test_model5................................. [SKIP]
2021-11-29 17:57:19.948243 (Thread-1): Finished running node model.my_new_project.test_model5
2021-11-29 17:57:19.950700 (MainThread): Acquiring new athena connection "master".
2021-11-29 17:57:19.951603 (MainThread): 17:57:19 | 
2021-11-29 17:57:19.953477 (MainThread): 17:57:19 | Finished running 5 view models in 9.08s.
2021-11-29 17:57:19.955454 (MainThread): Connection 'master' was properly closed.
2021-11-29 17:57:19.957060 (MainThread): Connection 'model.my_new_project.test_model2' was properly closed.
2021-11-29 17:57:19.958393 (MainThread): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 44726), raddr=('54.156.232.244', 443)>
2021-11-29 17:57:19.972835 (MainThread): 
2021-11-29 17:57:19.974174 (MainThread): Completed with 2 errors and 0 warnings:
2021-11-29 17:57:19.975948 (MainThread): 
2021-11-29 17:57:19.977323 (MainThread): Runtime Error in model test_model1 (models/test_model1.sql)
2021-11-29 17:57:19.978984 (MainThread):   com.facebook.presto.v217.sql.analyzer.SemanticException: line 2:1: Column name 'city' specified more than once
2021-11-29 17:57:19.981211 (MainThread): 
2021-11-29 17:57:19.983170 (MainThread): Runtime Error in model test_model2 (models/test_model2.sql)
2021-11-29 17:57:19.986554 (MainThread):   com.facebook.presto.v217.sql.analyzer.SemanticException: line 2:1: Column name 'city' specified more than once
2021-11-29 17:57:19.989281 (MainThread): 
Done. PASS=0 WARN=0 ERROR=2 SKIP=3 TOTAL=5
2021-11-29 17:57:19.991051 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cc5dc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8eb5e910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8eb5e880>]}
2021-11-29 17:57:19.992886 (MainThread): Flushing usage events
2021-11-29 17:58:24.515410 (MainThread): Running with dbt=0.21.0
2021-11-29 17:58:24.590221 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/vscode/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-29 17:58:24.595507 (MainThread): Tracking: tracking
2021-11-29 17:58:24.597580 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a9f6610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c291b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c291e20>]}
2021-11-29 17:58:24.608441 (MainThread): Partial parsing not enabled
2021-11-29 17:58:24.624713 (MainThread): Parsing macros/catalog.sql
2021-11-29 17:58:24.628005 (MainThread): Parsing macros/adapters.sql
2021-11-29 17:58:24.636830 (MainThread): Parsing macros/materializations/seed.sql
2021-11-29 17:58:24.639867 (MainThread): Parsing macros/materializations/snapshot.sql
2021-11-29 17:58:24.641156 (MainThread): Parsing macros/materializations/table.sql
2021-11-29 17:58:24.644522 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-29 17:58:24.657872 (MainThread): Parsing macros/materializations/view.sql
2021-11-29 17:58:24.661941 (MainThread): Parsing macros/core.sql
2021-11-29 17:58:24.664461 (MainThread): Parsing macros/materializations/test.sql
2021-11-29 17:58:24.669252 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-29 17:58:24.674902 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-29 17:58:24.678081 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-29 17:58:24.682380 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-29 17:58:24.683805 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-29 17:58:24.691075 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-29 17:58:24.702210 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-29 17:58:24.715029 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-29 17:58:24.719522 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-29 17:58:24.727162 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-29 17:58:24.744551 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-29 17:58:24.754088 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-29 17:58:24.755863 (MainThread): Parsing macros/etc/query.sql
2021-11-29 17:58:24.757550 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-29 17:58:24.760743 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-29 17:58:24.762651 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-29 17:58:24.764357 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-29 17:58:24.766599 (MainThread): Parsing macros/etc/datetime.sql
2021-11-29 17:58:24.773186 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-29 17:58:24.775119 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-29 17:58:24.777621 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-29 17:58:24.779157 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-29 17:58:24.781496 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-29 17:58:24.783242 (MainThread): Parsing macros/adapters/common.sql
2021-11-29 17:58:24.892032 (MainThread): Acquiring new athena connection "model.my_new_project.test_model1".
2021-11-29 17:58:24.900119 (MainThread): Acquiring new athena connection "model.my_new_project.test_model2".
2021-11-29 17:58:24.902905 (MainThread): Acquiring new athena connection "model.my_new_project.test_model3".
2021-11-29 17:58:24.905688 (MainThread): Acquiring new athena connection "model.my_new_project.test_model4".
2021-11-29 17:58:24.908708 (MainThread): Acquiring new athena connection "model.my_new_project.test_model5".
2021-11-29 17:58:24.934045 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-11-29 17:58:24.938657 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a941177e-5222-46fe-9fd2-d9b2bb3776c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a3a9b20>]}
2021-11-29 17:58:24.952382 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-11-29 17:58:24.954442 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a941177e-5222-46fe-9fd2-d9b2bb3776c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a3a9e20>]}
2021-11-29 17:58:24.955277 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 3 seed files, 0 sources, 0 exposures
2021-11-29 17:58:24.958018 (MainThread): 
2021-11-29 17:58:24.958950 (MainThread): Acquiring new athena connection "master".
2021-11-29 17:58:24.961421 (ThreadPoolExecutor-0_0): Acquiring new athena connection "list_awsdatacatalog".
2021-11-29 17:58:24.968232 (ThreadPoolExecutor-0_0): Using athena connection "list_awsdatacatalog".
2021-11-29 17:58:24.969017 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
  
2021-11-29 17:58:24.970912 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-29 17:58:24.991975 (ThreadPoolExecutor-0_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
2021-11-29 17:58:26.731133 (ThreadPoolExecutor-0_0): SQL status: OK -1 in 1.76 seconds
2021-11-29 17:58:26.741339 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: Close
2021-11-29 17:58:26.749174 (ThreadPoolExecutor-2_0): Acquiring new athena connection "list_awsdatacatalog_dbt".
2021-11-29 17:58:26.751509 (ThreadPoolExecutor-2_0): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 44732), raddr=('54.156.232.244', 443)>
2021-11-29 17:58:26.765153 (ThreadPoolExecutor-2_0): Using athena connection "list_awsdatacatalog_dbt".
2021-11-29 17:58:26.766533 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
2021-11-29 17:58:26.773385 (ThreadPoolExecutor-2_0): Opening a new connection, currently in state closed
2021-11-29 17:58:26.798353 (ThreadPoolExecutor-2_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
2021-11-29 17:58:30.753919 (ThreadPoolExecutor-2_0): SQL status: OK -1 in 3.98 seconds
2021-11-29 17:58:30.760411 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: Close
2021-11-29 17:58:30.766242 (MainThread): 17:58:30 | Concurrency: 1 threads (target='dev')
2021-11-29 17:58:30.771399 (MainThread): 17:58:30 | 
2021-11-29 17:58:30.779444 (Thread-1): Began running node model.my_new_project.test_model1
2021-11-29 17:58:30.781209 (Thread-1): 17:58:30 | 1 of 5 START view model dbt.test_model1.............................. [RUN]
2021-11-29 17:58:30.784715 (Thread-1): Acquiring new athena connection "model.my_new_project.test_model1".
2021-11-29 17:58:30.788311 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 44734), raddr=('54.156.232.244', 443)>
2021-11-29 17:58:30.791704 (Thread-1): Compiling model.my_new_project.test_model1
2021-11-29 17:58:30.796378 (Thread-1): Writing injected SQL for node "model.my_new_project.test_model1"
2021-11-29 17:58:30.802729 (Thread-1): finished collecting timing info
2021-11-29 17:58:30.818214 (Thread-1): Writing runtime SQL for node "model.my_new_project.test_model1"
2021-11-29 17:58:30.823487 (Thread-1): Using athena connection "model.my_new_project.test_model1".
2021-11-29 17:58:30.824707 (Thread-1): On model.my_new_project.test_model1: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    /*
SELECT * FROM "defaultdb"."resby_puma_northeast" puma
inner join "defaultdb"."buildings" buildings
on puma.bldg_id=buildings.bldg_fid

limit 10;
*/

/* select * from dbt.Region_Table */

/* In plain english: select all from the "buildings" table where the state value is in the Region_Table state column.  */

SELECT * FROM "defaultdb"."buildings" buildings
inner join dbt.Region_Table1 region
on buildings.state=region.state
limit 10;

2021-11-29 17:58:30.826078 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 17:58:30.841707 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    /*
SELECT * FROM "defaultdb"."resby_puma_northeast" puma
inner join "defaultdb"."buildings" buildings
on puma.bldg_id=buildings.bldg_fid

limit 10;
*/

/* select * from dbt.Region_Table */

/* In plain english: select all from the "buildings" table where the state value is in the Region_Table state column.  */

SELECT * FROM "defaultdb"."buildings" buildings
inner join dbt.Region_Table1 region
on buildings.state=region.state
limit 10;
2021-11-29 17:58:32.362487 (Thread-1): Error running SQL: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    /*
SELECT * FROM "defaultdb"."resby_puma_northeast" puma
inner join "defaultdb"."buildings" buildings
on puma.bldg_id=buildings.bldg_fid

limit 10;
*/

/* select * from dbt.Region_Table */

/* In plain english: select all from the "buildings" table where the state value is in the Region_Table state column.  */

SELECT * FROM "defaultdb"."buildings" buildings
inner join dbt.Region_Table1 region
on buildings.state=region.state
limit 10;

2021-11-29 17:58:32.367283 (Thread-1): finished collecting timing info
2021-11-29 17:58:32.372592 (Thread-1): On model.my_new_project.test_model1: Close
2021-11-29 17:58:32.379568 (Thread-1): Runtime Error in model test_model1 (models/test_model1.sql)
  com.facebook.presto.v217.sql.analyzer.SemanticException: line 18:12: Table 459120389451.dbt.region_table1 does not exist
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 100, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 90, in execute
    raise OperationalError(query_execution.state_change_reason)
pyathena.error.OperationalError: com.facebook.presto.v217.sql.analyzer.SemanticException: line 18:12: Table 459120389451.dbt.region_table1 does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 66, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 103, in exception_handler
    raise RuntimeException(str(e)) from e
dbt.exceptions.RuntimeException: Runtime Error in model test_model1 (models/test_model1.sql)
  com.facebook.presto.v217.sql.analyzer.SemanticException: line 18:12: Table 459120389451.dbt.region_table1 does not exist
2021-11-29 17:58:32.390252 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a941177e-5222-46fe-9fd2-d9b2bb3776c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a433d60>]}
2021-11-29 17:58:32.394842 (Thread-1): 17:58:32 | 1 of 5 ERROR creating view model dbt.test_model1..................... [ERROR in 1.61s]
2021-11-29 17:58:32.398486 (Thread-1): Finished running node model.my_new_project.test_model1
2021-11-29 17:58:32.402321 (Thread-1): Began running node model.my_new_project.test_model2
2021-11-29 17:58:32.405555 (Thread-1): 17:58:32 | 2 of 5 START view model dbt.test_model2.............................. [RUN]
2021-11-29 17:58:32.408615 (Thread-1): Acquiring new athena connection "model.my_new_project.test_model2".
2021-11-29 17:58:32.411570 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 34180), raddr=('3.222.16.146', 443)>
2021-11-29 17:58:32.414339 (Thread-1): Compiling model.my_new_project.test_model2
2021-11-29 17:58:32.418125 (Thread-1): Writing injected SQL for node "model.my_new_project.test_model2"
2021-11-29 17:58:32.425232 (Thread-1): finished collecting timing info
2021-11-29 17:58:32.428158 (Thread-1): Writing runtime SQL for node "model.my_new_project.test_model2"
2021-11-29 17:58:32.432295 (Thread-1): Using athena connection "model.my_new_project.test_model2".
2021-11-29 17:58:32.433402 (Thread-1): On model.my_new_project.test_model2: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    SELECT * FROM "defaultdb"."buildings" buildings
inner join dbt.Random_Small_Towns region
on buildings.state=region.state
limit 10;

2021-11-29 17:58:32.434867 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 17:58:32.451540 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    SELECT * FROM "defaultdb"."buildings" buildings
inner join dbt.Random_Small_Towns region
on buildings.state=region.state
limit 10;
2021-11-29 17:58:33.921967 (Thread-1): Error running SQL: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    SELECT * FROM "defaultdb"."buildings" buildings
inner join dbt.Random_Small_Towns region
on buildings.state=region.state
limit 10;

2021-11-29 17:58:33.928264 (Thread-1): finished collecting timing info
2021-11-29 17:58:33.935722 (Thread-1): On model.my_new_project.test_model2: Close
2021-11-29 17:58:33.941655 (Thread-1): Runtime Error in model test_model2 (models/test_model2.sql)
  com.facebook.presto.v217.sql.analyzer.SemanticException: line 2:1: Column name 'city' specified more than once
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 100, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 90, in execute
    raise OperationalError(query_execution.state_change_reason)
pyathena.error.OperationalError: com.facebook.presto.v217.sql.analyzer.SemanticException: line 2:1: Column name 'city' specified more than once

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 66, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 103, in exception_handler
    raise RuntimeException(str(e)) from e
dbt.exceptions.RuntimeException: Runtime Error in model test_model2 (models/test_model2.sql)
  com.facebook.presto.v217.sql.analyzer.SemanticException: line 2:1: Column name 'city' specified more than once
2021-11-29 17:58:33.952030 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a941177e-5222-46fe-9fd2-d9b2bb3776c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89982a90>]}
2021-11-29 17:58:33.957672 (Thread-1): 17:58:33 | 2 of 5 ERROR creating view model dbt.test_model2..................... [ERROR in 1.54s]
2021-11-29 17:58:33.961139 (Thread-1): Finished running node model.my_new_project.test_model2
2021-11-29 17:58:33.966498 (Thread-1): Began running node model.my_new_project.test_model3
2021-11-29 17:58:33.970011 (Thread-1): 17:58:33 | 3 of 5 SKIP relation dbt.test_model3................................. [SKIP]
2021-11-29 17:58:33.973256 (Thread-1): Finished running node model.my_new_project.test_model3
2021-11-29 17:58:33.976509 (Thread-1): Began running node model.my_new_project.test_model4
2021-11-29 17:58:33.979420 (Thread-1): 17:58:33 | 4 of 5 SKIP relation dbt.test_model4................................. [SKIP]
2021-11-29 17:58:33.982582 (Thread-1): Finished running node model.my_new_project.test_model4
2021-11-29 17:58:33.986744 (Thread-1): Began running node model.my_new_project.test_model5
2021-11-29 17:58:33.990881 (Thread-1): 17:58:33 | 5 of 5 SKIP relation dbt.test_model5................................. [SKIP]
2021-11-29 17:58:33.993355 (Thread-1): Finished running node model.my_new_project.test_model5
2021-11-29 17:58:33.996879 (MainThread): Acquiring new athena connection "master".
2021-11-29 17:58:33.998605 (MainThread): 17:58:33 | 
2021-11-29 17:58:34.003159 (MainThread): 17:58:34 | Finished running 5 view models in 9.04s.
2021-11-29 17:58:34.005710 (MainThread): Connection 'master' was properly closed.
2021-11-29 17:58:34.007918 (MainThread): Connection 'model.my_new_project.test_model2' was properly closed.
2021-11-29 17:58:34.010232 (MainThread): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 34182), raddr=('3.222.16.146', 443)>
2021-11-29 17:58:34.025369 (MainThread): 
2021-11-29 17:58:34.026206 (MainThread): Completed with 2 errors and 0 warnings:
2021-11-29 17:58:34.028583 (MainThread): 
2021-11-29 17:58:34.031278 (MainThread): Runtime Error in model test_model1 (models/test_model1.sql)
2021-11-29 17:58:34.033153 (MainThread):   com.facebook.presto.v217.sql.analyzer.SemanticException: line 18:12: Table 459120389451.dbt.region_table1 does not exist
2021-11-29 17:58:34.036125 (MainThread): 
2021-11-29 17:58:34.038234 (MainThread): Runtime Error in model test_model2 (models/test_model2.sql)
2021-11-29 17:58:34.039891 (MainThread):   com.facebook.presto.v217.sql.analyzer.SemanticException: line 2:1: Column name 'city' specified more than once
2021-11-29 17:58:34.041456 (MainThread): 
Done. PASS=0 WARN=0 ERROR=2 SKIP=3 TOTAL=5
2021-11-29 17:58:34.043561 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c2b1a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c2b12b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c233e80>]}
2021-11-29 17:58:34.045476 (MainThread): Flushing usage events
2021-11-29 17:58:41.505644 (MainThread): Running with dbt=0.21.0
2021-11-29 17:58:41.572631 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/vscode/.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', select=None, selector_name=None, show=False, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='seed', write_json=True)
2021-11-29 17:58:41.577324 (MainThread): Tracking: tracking
2021-11-29 17:58:41.580824 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b8728e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d113ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d113e20>]}
2021-11-29 17:58:41.590094 (MainThread): Partial parsing not enabled
2021-11-29 17:58:41.606326 (MainThread): Parsing macros/catalog.sql
2021-11-29 17:58:41.608853 (MainThread): Parsing macros/adapters.sql
2021-11-29 17:58:41.617627 (MainThread): Parsing macros/materializations/seed.sql
2021-11-29 17:58:41.620764 (MainThread): Parsing macros/materializations/snapshot.sql
2021-11-29 17:58:41.621841 (MainThread): Parsing macros/materializations/table.sql
2021-11-29 17:58:41.625153 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-29 17:58:41.638501 (MainThread): Parsing macros/materializations/view.sql
2021-11-29 17:58:41.642128 (MainThread): Parsing macros/core.sql
2021-11-29 17:58:41.644638 (MainThread): Parsing macros/materializations/test.sql
2021-11-29 17:58:41.649018 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-29 17:58:41.654729 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-29 17:58:41.658014 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-29 17:58:41.662386 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-29 17:58:41.664065 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-29 17:58:41.670325 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-29 17:58:41.680798 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-29 17:58:41.693729 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-29 17:58:41.698511 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-29 17:58:41.706306 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-29 17:58:41.722410 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-29 17:58:41.731704 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-29 17:58:41.733186 (MainThread): Parsing macros/etc/query.sql
2021-11-29 17:58:41.734413 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-29 17:58:41.737859 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-29 17:58:41.739644 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-29 17:58:41.741071 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-29 17:58:41.743308 (MainThread): Parsing macros/etc/datetime.sql
2021-11-29 17:58:41.748702 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-29 17:58:41.750869 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-29 17:58:41.752731 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-29 17:58:41.754863 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-29 17:58:41.756888 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-29 17:58:41.758315 (MainThread): Parsing macros/adapters/common.sql
2021-11-29 17:58:41.864718 (MainThread): Acquiring new athena connection "model.my_new_project.test_model1".
2021-11-29 17:58:41.872716 (MainThread): Acquiring new athena connection "model.my_new_project.test_model2".
2021-11-29 17:58:41.875726 (MainThread): Acquiring new athena connection "model.my_new_project.test_model3".
2021-11-29 17:58:41.878652 (MainThread): Acquiring new athena connection "model.my_new_project.test_model4".
2021-11-29 17:58:41.881451 (MainThread): Acquiring new athena connection "model.my_new_project.test_model5".
2021-11-29 17:58:41.906885 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-11-29 17:58:41.910752 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '114d959e-2a23-4872-a287-3d05e8b2f899', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b275850>]}
2021-11-29 17:58:41.922040 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-11-29 17:58:41.923455 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '114d959e-2a23-4872-a287-3d05e8b2f899', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b275e20>]}
2021-11-29 17:58:41.925223 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 3 seed files, 0 sources, 0 exposures
2021-11-29 17:58:41.927671 (MainThread): 
2021-11-29 17:58:41.928707 (MainThread): Acquiring new athena connection "master".
2021-11-29 17:58:41.930808 (ThreadPoolExecutor-0_0): Acquiring new athena connection "list_awsdatacatalog".
2021-11-29 17:58:41.938056 (ThreadPoolExecutor-0_0): Using athena connection "list_awsdatacatalog".
2021-11-29 17:58:41.938809 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
  
2021-11-29 17:58:41.940556 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-29 17:58:41.959407 (ThreadPoolExecutor-0_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
2021-11-29 17:58:43.724092 (ThreadPoolExecutor-0_0): SQL status: OK -1 in 1.78 seconds
2021-11-29 17:58:43.728671 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: Close
2021-11-29 17:58:43.731706 (ThreadPoolExecutor-2_0): Acquiring new athena connection "list_awsdatacatalog_dbt".
2021-11-29 17:58:43.734815 (ThreadPoolExecutor-2_0): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 34186), raddr=('3.222.16.146', 443)>
2021-11-29 17:58:43.742940 (ThreadPoolExecutor-2_0): Using athena connection "list_awsdatacatalog_dbt".
2021-11-29 17:58:43.744082 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
2021-11-29 17:58:43.747266 (ThreadPoolExecutor-2_0): Opening a new connection, currently in state closed
2021-11-29 17:58:43.766407 (ThreadPoolExecutor-2_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
2021-11-29 17:58:47.774100 (ThreadPoolExecutor-2_0): SQL status: OK -1 in 4.03 seconds
2021-11-29 17:58:47.779456 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: Close
2021-11-29 17:58:47.782741 (MainThread): 17:58:47 | Concurrency: 1 threads (target='dev')
2021-11-29 17:58:47.785434 (MainThread): 17:58:47 | 
2021-11-29 17:58:47.791720 (Thread-1): Began running node seed.my_new_project.Random_Small_Towns
2021-11-29 17:58:47.793030 (Thread-1): 17:58:47 | 1 of 3 START seed file dbt.Random_Small_Towns........................ [RUN]
2021-11-29 17:58:47.795621 (Thread-1): Acquiring new athena connection "seed.my_new_project.Random_Small_Towns".
2021-11-29 17:58:47.797888 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 34188), raddr=('3.222.16.146', 443)>
2021-11-29 17:58:47.801295 (Thread-1): finished collecting timing info
2021-11-29 17:58:47.814982 (Thread-1): finished collecting timing info
2021-11-29 17:58:47.816080 (Thread-1): Compilation Error in seed Random_Small_Towns (data/Random_Small_Towns.csv)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete dbt.random_small_towns, or rename it to be less ambiguous.
  Searched for: dbt.Random_Small_Towns
  Found: dbt.random_small_towns
  
  > in macro materialization_seed_default (macros/materializations/seed/seed.sql)
  > called by seed Random_Small_Towns (data/Random_Small_Towns.csv)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 39, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 734, in get_relation
    matches = self._make_match(relations_list, database, schema,
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 723, in _make_match
    if relation.matches(**search):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/relation.py", line 99, in matches
    dbt.exceptions.approximate_relation_match(target, self)
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 741, in approximate_relation_match
    raise_compiler_error(
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 444, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in seed Random_Small_Towns (data/Random_Small_Towns.csv)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete dbt.random_small_towns, or rename it to be less ambiguous.
  Searched for: dbt.Random_Small_Towns
  Found: dbt.random_small_towns
  
  > in macro materialization_seed_default (macros/materializations/seed/seed.sql)
  > called by seed Random_Small_Towns (data/Random_Small_Towns.csv)
2021-11-29 17:58:47.820061 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '114d959e-2a23-4872-a287-3d05e8b2f899', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b2d55b0>]}
2021-11-29 17:58:47.821939 (Thread-1): 17:58:47 | 1 of 3 ERROR loading seed file dbt.Random_Small_Towns................ [ERROR in 0.02s]
2021-11-29 17:58:47.823232 (Thread-1): Finished running node seed.my_new_project.Random_Small_Towns
2021-11-29 17:58:47.824620 (Thread-1): Began running node seed.my_new_project.Region_Table
2021-11-29 17:58:47.826304 (Thread-1): 17:58:47 | 2 of 3 START seed file dbt.Region_Table.............................. [RUN]
2021-11-29 17:58:47.827926 (Thread-1): Acquiring new athena connection "seed.my_new_project.Region_Table".
2021-11-29 17:58:47.829101 (Thread-1): finished collecting timing info
2021-11-29 17:58:47.833038 (Thread-1): finished collecting timing info
2021-11-29 17:58:47.835741 (Thread-1): Compilation Error in seed Region_Table (data/Region_Table.csv)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete dbt.region_table, or rename it to be less ambiguous.
  Searched for: dbt.Region_Table
  Found: dbt.region_table
  
  > in macro materialization_seed_default (macros/materializations/seed/seed.sql)
  > called by seed Region_Table (data/Region_Table.csv)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 39, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 734, in get_relation
    matches = self._make_match(relations_list, database, schema,
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 723, in _make_match
    if relation.matches(**search):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/relation.py", line 99, in matches
    dbt.exceptions.approximate_relation_match(target, self)
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 741, in approximate_relation_match
    raise_compiler_error(
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 444, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in seed Region_Table (data/Region_Table.csv)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete dbt.region_table, or rename it to be less ambiguous.
  Searched for: dbt.Region_Table
  Found: dbt.region_table
  
  > in macro materialization_seed_default (macros/materializations/seed/seed.sql)
  > called by seed Region_Table (data/Region_Table.csv)
2021-11-29 17:58:47.838059 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '114d959e-2a23-4872-a287-3d05e8b2f899', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a7fd970>]}
2021-11-29 17:58:47.839697 (Thread-1): 17:58:47 | 2 of 3 ERROR loading seed file dbt.Region_Table...................... [ERROR in 0.01s]
2021-11-29 17:58:47.841387 (Thread-1): Finished running node seed.my_new_project.Region_Table
2021-11-29 17:58:47.843911 (Thread-1): Began running node seed.my_new_project.Region_Table1
2021-11-29 17:58:47.845377 (Thread-1): 17:58:47 | 3 of 3 START seed file dbt.Region_Table1............................. [RUN]
2021-11-29 17:58:47.847709 (Thread-1): Acquiring new athena connection "seed.my_new_project.Region_Table1".
2021-11-29 17:58:47.850072 (Thread-1): finished collecting timing info
2021-11-29 17:58:47.861737 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-11-29 17:58:47.862745 (Thread-1): * Deprecation Warning: The quote_columns parameter was not set for seeds, so the
default value of False was chosen. The default will change to True in a future
release.

For more information, see:
https://docs.getdbt.com/v0.15/docs/seeds#section-specify-column-quoting
2021-11-29 17:58:47.864719 (Thread-1): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '114d959e-2a23-4872-a287-3d05e8b2f899', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89db5e50>]}
2021-11-29 17:58:47.865988 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-11-29 17:58:47.867331 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 17:58:47.885163 (Thread-1): Using athena connection "seed.my_new_project.Region_Table1".
2021-11-29 17:58:47.886431 (Thread-1): On seed.my_new_project.Region_Table1: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "seed.my_new_project.Region_Table1"} */

    create external table dbt.Region_Table1 (State string, Region string)
    stored as parquet
    location 's3://justin-dbt-testing/Targettables/c733ccbf-66fd-46ec-92ec-1830b481d3af/'
    tblproperties ('classification'='parquet')
  
2021-11-29 17:58:47.888123 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "seed.my_new_project.Region_Table1"} */

    create external table dbt.Region_Table1 (State string, Region string)
    stored as parquet
    location 's3://justin-dbt-testing/Targettables/c733ccbf-66fd-46ec-92ec-1830b481d3af/'
    tblproperties ('classification'='parquet')
2021-11-29 17:58:49.595981 (Thread-1): SQL status: OK -1 in 1.71 seconds
2021-11-29 17:58:49.628332 (Thread-1): Using athena connection "seed.my_new_project.Region_Table1".
2021-11-29 17:58:49.630007 (Thread-1): On seed.my_new_project.Region_Table1: 
          insert into dbt.Region_Table1 (State, Region) values
          (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s)
      ...
2021-11-29 17:58:49.633909 (Thread-1): insert into dbt.Region_Table1 (State, Region) values
          ('ME','Northeast'),('NH','Northeast'),('VT','Northeast'),('MA','Northeast'),('CT','Northeast'),('RI','Northeast')
2021-11-29 17:58:51.190195 (Thread-1): SQL status: OK -1 in 1.56 seconds
2021-11-29 17:58:51.207823 (Thread-1): Writing runtime SQL for node "seed.my_new_project.Region_Table1"
2021-11-29 17:58:51.236697 (Thread-1): finished collecting timing info
2021-11-29 17:58:51.238236 (Thread-1): On seed.my_new_project.Region_Table1: Close
2021-11-29 17:58:51.242365 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '114d959e-2a23-4872-a287-3d05e8b2f899', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89d3dbb0>]}
2021-11-29 17:58:51.245651 (Thread-1): 17:58:51 | 3 of 3 OK loaded seed file dbt.Region_Table1......................... [INSERT 6 in 3.39s]
2021-11-29 17:58:51.248684 (Thread-1): Finished running node seed.my_new_project.Region_Table1
2021-11-29 17:58:51.253689 (MainThread): Acquiring new athena connection "master".
2021-11-29 17:58:51.255254 (MainThread): 17:58:51 | 
2021-11-29 17:58:51.257814 (MainThread): 17:58:51 | Finished running 3 seeds in 9.33s.
2021-11-29 17:58:51.260570 (MainThread): Connection 'master' was properly closed.
2021-11-29 17:58:51.264849 (MainThread): Connection 'seed.my_new_project.Region_Table1' was properly closed.
2021-11-29 17:58:51.267198 (MainThread): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 34190), raddr=('3.222.16.146', 443)>
2021-11-29 17:58:51.282261 (MainThread): 
2021-11-29 17:58:51.283052 (MainThread): Completed with 2 errors and 0 warnings:
2021-11-29 17:58:51.285661 (MainThread): 
2021-11-29 17:58:51.287815 (MainThread): Compilation Error in seed Random_Small_Towns (data/Random_Small_Towns.csv)
2021-11-29 17:58:51.289673 (MainThread):   When searching for a relation, dbt found an approximate match. Instead of guessing 
2021-11-29 17:58:51.291389 (MainThread):   which relation to use, dbt will move on. Please delete dbt.random_small_towns, or rename it to be less ambiguous.
2021-11-29 17:58:51.293705 (MainThread):   Searched for: dbt.Random_Small_Towns
2021-11-29 17:58:51.295653 (MainThread):   Found: dbt.random_small_towns
2021-11-29 17:58:51.297719 (MainThread):   
2021-11-29 17:58:51.300997 (MainThread):   > in macro materialization_seed_default (macros/materializations/seed/seed.sql)
2021-11-29 17:58:51.303873 (MainThread):   > called by seed Random_Small_Towns (data/Random_Small_Towns.csv)
2021-11-29 17:58:51.306189 (MainThread): 
2021-11-29 17:58:51.307890 (MainThread): Compilation Error in seed Region_Table (data/Region_Table.csv)
2021-11-29 17:58:51.310388 (MainThread):   When searching for a relation, dbt found an approximate match. Instead of guessing 
2021-11-29 17:58:51.312708 (MainThread):   which relation to use, dbt will move on. Please delete dbt.region_table, or rename it to be less ambiguous.
2021-11-29 17:58:51.314321 (MainThread):   Searched for: dbt.Region_Table
2021-11-29 17:58:51.317232 (MainThread):   Found: dbt.region_table
2021-11-29 17:58:51.319665 (MainThread):   
2021-11-29 17:58:51.321459 (MainThread):   > in macro materialization_seed_default (macros/materializations/seed/seed.sql)
2021-11-29 17:58:51.323091 (MainThread):   > called by seed Region_Table (data/Region_Table.csv)
2021-11-29 17:58:51.325431 (MainThread): 
Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
2021-11-29 17:58:51.328113 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d0b4e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d12e4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d12e5e0>]}
2021-11-29 17:58:51.330640 (MainThread): Flushing usage events
2021-11-29 17:59:00.692421 (MainThread): Running with dbt=0.21.0
2021-11-29 17:59:00.759067 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/vscode/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-29 17:59:00.765193 (MainThread): Tracking: tracking
2021-11-29 17:59:00.767784 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb94998e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbad35460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbad35e20>]}
2021-11-29 17:59:00.778083 (MainThread): Partial parsing not enabled
2021-11-29 17:59:00.792779 (MainThread): Parsing macros/catalog.sql
2021-11-29 17:59:00.795373 (MainThread): Parsing macros/adapters.sql
2021-11-29 17:59:00.803896 (MainThread): Parsing macros/materializations/seed.sql
2021-11-29 17:59:00.806508 (MainThread): Parsing macros/materializations/snapshot.sql
2021-11-29 17:59:00.807444 (MainThread): Parsing macros/materializations/table.sql
2021-11-29 17:59:00.810911 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-29 17:59:00.824505 (MainThread): Parsing macros/materializations/view.sql
2021-11-29 17:59:00.828354 (MainThread): Parsing macros/core.sql
2021-11-29 17:59:00.831422 (MainThread): Parsing macros/materializations/test.sql
2021-11-29 17:59:00.835829 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-29 17:59:00.841422 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-29 17:59:00.844771 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-29 17:59:00.849035 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-29 17:59:00.851283 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-29 17:59:00.857383 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-29 17:59:00.868879 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-29 17:59:00.881419 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-29 17:59:00.886316 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-29 17:59:00.893629 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-29 17:59:00.910360 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-29 17:59:00.919990 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-29 17:59:00.921608 (MainThread): Parsing macros/etc/query.sql
2021-11-29 17:59:00.923615 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-29 17:59:00.926253 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-29 17:59:00.928698 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-29 17:59:00.930701 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-29 17:59:00.932266 (MainThread): Parsing macros/etc/datetime.sql
2021-11-29 17:59:00.937307 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-29 17:59:00.940545 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-29 17:59:00.942839 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-29 17:59:00.944455 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-29 17:59:00.946667 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-29 17:59:00.948881 (MainThread): Parsing macros/adapters/common.sql
2021-11-29 17:59:01.054876 (MainThread): Acquiring new athena connection "model.my_new_project.test_model1".
2021-11-29 17:59:01.062568 (MainThread): Acquiring new athena connection "model.my_new_project.test_model2".
2021-11-29 17:59:01.065353 (MainThread): Acquiring new athena connection "model.my_new_project.test_model3".
2021-11-29 17:59:01.068363 (MainThread): Acquiring new athena connection "model.my_new_project.test_model4".
2021-11-29 17:59:01.071319 (MainThread): Acquiring new athena connection "model.my_new_project.test_model5".
2021-11-29 17:59:01.095997 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-11-29 17:59:01.099781 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '34f52d7b-08f2-4d22-aa2f-38dafb099647', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8e4baf0>]}
2021-11-29 17:59:01.112020 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-11-29 17:59:01.113689 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '34f52d7b-08f2-4d22-aa2f-38dafb099647', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8e4bca0>]}
2021-11-29 17:59:01.114987 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 3 seed files, 0 sources, 0 exposures
2021-11-29 17:59:01.117422 (MainThread): 
2021-11-29 17:59:01.118657 (MainThread): Acquiring new athena connection "master".
2021-11-29 17:59:01.120768 (ThreadPoolExecutor-0_0): Acquiring new athena connection "list_awsdatacatalog".
2021-11-29 17:59:01.127419 (ThreadPoolExecutor-0_0): Using athena connection "list_awsdatacatalog".
2021-11-29 17:59:01.128298 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
  
2021-11-29 17:59:01.130049 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-29 17:59:01.155186 (ThreadPoolExecutor-0_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
2021-11-29 17:59:03.856940 (ThreadPoolExecutor-0_0): SQL status: OK -1 in 2.73 seconds
2021-11-29 17:59:03.863160 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: Close
2021-11-29 17:59:03.869109 (ThreadPoolExecutor-2_0): Acquiring new athena connection "list_awsdatacatalog_dbt".
2021-11-29 17:59:03.870950 (ThreadPoolExecutor-2_0): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 34194), raddr=('3.222.16.146', 443)>
2021-11-29 17:59:03.882911 (ThreadPoolExecutor-2_0): Using athena connection "list_awsdatacatalog_dbt".
2021-11-29 17:59:03.884297 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
2021-11-29 17:59:03.888443 (ThreadPoolExecutor-2_0): Opening a new connection, currently in state closed
2021-11-29 17:59:03.912785 (ThreadPoolExecutor-2_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
2021-11-29 17:59:07.554511 (ThreadPoolExecutor-2_0): SQL status: OK -1 in 3.67 seconds
2021-11-29 17:59:07.556013 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: Close
2021-11-29 17:59:07.558144 (MainThread): 17:59:07 | Concurrency: 1 threads (target='dev')
2021-11-29 17:59:07.559773 (MainThread): 17:59:07 | 
2021-11-29 17:59:07.564372 (Thread-1): Began running node model.my_new_project.test_model1
2021-11-29 17:59:07.565733 (Thread-1): 17:59:07 | 1 of 5 START view model dbt.test_model1.............................. [RUN]
2021-11-29 17:59:07.568456 (Thread-1): Acquiring new athena connection "model.my_new_project.test_model1".
2021-11-29 17:59:07.570863 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 34196), raddr=('3.222.16.146', 443)>
2021-11-29 17:59:07.572690 (Thread-1): Compiling model.my_new_project.test_model1
2021-11-29 17:59:07.575848 (Thread-1): Writing injected SQL for node "model.my_new_project.test_model1"
2021-11-29 17:59:07.579220 (Thread-1): finished collecting timing info
2021-11-29 17:59:07.590672 (Thread-1): Writing runtime SQL for node "model.my_new_project.test_model1"
2021-11-29 17:59:07.595367 (Thread-1): Using athena connection "model.my_new_project.test_model1".
2021-11-29 17:59:07.596755 (Thread-1): On model.my_new_project.test_model1: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    /*
SELECT * FROM "defaultdb"."resby_puma_northeast" puma
inner join "defaultdb"."buildings" buildings
on puma.bldg_id=buildings.bldg_fid

limit 10;
*/

/* select * from dbt.Region_Table */

/* In plain english: select all from the "buildings" table where the state value is in the Region_Table state column.  */

SELECT * FROM "defaultdb"."buildings" buildings
inner join dbt.Region_Table1 region
on buildings.state=region.state
limit 10;

2021-11-29 17:59:07.599640 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 17:59:07.615072 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    /*
SELECT * FROM "defaultdb"."resby_puma_northeast" puma
inner join "defaultdb"."buildings" buildings
on puma.bldg_id=buildings.bldg_fid

limit 10;
*/

/* select * from dbt.Region_Table */

/* In plain english: select all from the "buildings" table where the state value is in the Region_Table state column.  */

SELECT * FROM "defaultdb"."buildings" buildings
inner join dbt.Region_Table1 region
on buildings.state=region.state
limit 10;
2021-11-29 17:59:09.077047 (Thread-1): Error running SQL: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    /*
SELECT * FROM "defaultdb"."resby_puma_northeast" puma
inner join "defaultdb"."buildings" buildings
on puma.bldg_id=buildings.bldg_fid

limit 10;
*/

/* select * from dbt.Region_Table */

/* In plain english: select all from the "buildings" table where the state value is in the Region_Table state column.  */

SELECT * FROM "defaultdb"."buildings" buildings
inner join dbt.Region_Table1 region
on buildings.state=region.state
limit 10;

2021-11-29 17:59:09.081839 (Thread-1): finished collecting timing info
2021-11-29 17:59:09.089220 (Thread-1): On model.my_new_project.test_model1: Close
2021-11-29 17:59:09.098810 (Thread-1): Runtime Error in model test_model1 (models/test_model1.sql)
  com.facebook.presto.v217.sql.analyzer.SemanticException: line 2:1: Column name 'state' specified more than once
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 100, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 90, in execute
    raise OperationalError(query_execution.state_change_reason)
pyathena.error.OperationalError: com.facebook.presto.v217.sql.analyzer.SemanticException: line 2:1: Column name 'state' specified more than once

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 66, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 103, in exception_handler
    raise RuntimeException(str(e)) from e
dbt.exceptions.RuntimeException: Runtime Error in model test_model1 (models/test_model1.sql)
  com.facebook.presto.v217.sql.analyzer.SemanticException: line 2:1: Column name 'state' specified more than once
2021-11-29 17:59:09.108899 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34f52d7b-08f2-4d22-aa2f-38dafb099647', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8ed6d60>]}
2021-11-29 17:59:09.113887 (Thread-1): 17:59:09 | 1 of 5 ERROR creating view model dbt.test_model1..................... [ERROR in 1.54s]
2021-11-29 17:59:09.117177 (Thread-1): Finished running node model.my_new_project.test_model1
2021-11-29 17:59:09.120821 (Thread-1): Began running node model.my_new_project.test_model2
2021-11-29 17:59:09.125394 (Thread-1): 17:59:09 | 2 of 5 START view model dbt.test_model2.............................. [RUN]
2021-11-29 17:59:09.127895 (Thread-1): Acquiring new athena connection "model.my_new_project.test_model2".
2021-11-29 17:59:09.130757 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 34198), raddr=('3.222.16.146', 443)>
2021-11-29 17:59:09.135004 (Thread-1): Compiling model.my_new_project.test_model2
2021-11-29 17:59:09.141814 (Thread-1): Writing injected SQL for node "model.my_new_project.test_model2"
2021-11-29 17:59:09.148067 (Thread-1): finished collecting timing info
2021-11-29 17:59:09.151371 (Thread-1): Writing runtime SQL for node "model.my_new_project.test_model2"
2021-11-29 17:59:09.156074 (Thread-1): Using athena connection "model.my_new_project.test_model2".
2021-11-29 17:59:09.157072 (Thread-1): On model.my_new_project.test_model2: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    SELECT * FROM "defaultdb"."buildings" buildings
inner join dbt.Random_Small_Towns region
on buildings.state=region.state
limit 10;

2021-11-29 17:59:09.159731 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 17:59:09.176957 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    SELECT * FROM "defaultdb"."buildings" buildings
inner join dbt.Random_Small_Towns region
on buildings.state=region.state
limit 10;
2021-11-29 17:59:10.652851 (Thread-1): Error running SQL: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    SELECT * FROM "defaultdb"."buildings" buildings
inner join dbt.Random_Small_Towns region
on buildings.state=region.state
limit 10;

2021-11-29 17:59:10.659952 (Thread-1): finished collecting timing info
2021-11-29 17:59:10.666337 (Thread-1): On model.my_new_project.test_model2: Close
2021-11-29 17:59:10.672269 (Thread-1): Runtime Error in model test_model2 (models/test_model2.sql)
  com.facebook.presto.v217.sql.analyzer.SemanticException: line 2:1: Column name 'city' specified more than once
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 100, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 90, in execute
    raise OperationalError(query_execution.state_change_reason)
pyathena.error.OperationalError: com.facebook.presto.v217.sql.analyzer.SemanticException: line 2:1: Column name 'city' specified more than once

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 66, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 103, in exception_handler
    raise RuntimeException(str(e)) from e
dbt.exceptions.RuntimeException: Runtime Error in model test_model2 (models/test_model2.sql)
  com.facebook.presto.v217.sql.analyzer.SemanticException: line 2:1: Column name 'city' specified more than once
2021-11-29 17:59:10.682848 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34f52d7b-08f2-4d22-aa2f-38dafb099647', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8ed6f40>]}
2021-11-29 17:59:10.688353 (Thread-1): 17:59:10 | 2 of 5 ERROR creating view model dbt.test_model2..................... [ERROR in 1.56s]
2021-11-29 17:59:10.693254 (Thread-1): Finished running node model.my_new_project.test_model2
2021-11-29 17:59:10.698241 (Thread-1): Began running node model.my_new_project.test_model3
2021-11-29 17:59:10.700376 (Thread-1): 17:59:10 | 3 of 5 SKIP relation dbt.test_model3................................. [SKIP]
2021-11-29 17:59:10.703895 (Thread-1): Finished running node model.my_new_project.test_model3
2021-11-29 17:59:10.709279 (Thread-1): Began running node model.my_new_project.test_model4
2021-11-29 17:59:10.711311 (Thread-1): 17:59:10 | 4 of 5 SKIP relation dbt.test_model4................................. [SKIP]
2021-11-29 17:59:10.713682 (Thread-1): Finished running node model.my_new_project.test_model4
2021-11-29 17:59:10.717528 (Thread-1): Began running node model.my_new_project.test_model5
2021-11-29 17:59:10.720646 (Thread-1): 17:59:10 | 5 of 5 SKIP relation dbt.test_model5................................. [SKIP]
2021-11-29 17:59:10.723236 (Thread-1): Finished running node model.my_new_project.test_model5
2021-11-29 17:59:10.726910 (MainThread): Acquiring new athena connection "master".
2021-11-29 17:59:10.728179 (MainThread): 17:59:10 | 
2021-11-29 17:59:10.730185 (MainThread): 17:59:10 | Finished running 5 view models in 9.61s.
2021-11-29 17:59:10.732511 (MainThread): Connection 'master' was properly closed.
2021-11-29 17:59:10.735902 (MainThread): Connection 'model.my_new_project.test_model2' was properly closed.
2021-11-29 17:59:10.738029 (MainThread): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 34200), raddr=('3.222.16.146', 443)>
2021-11-29 17:59:10.753983 (MainThread): 
2021-11-29 17:59:10.754879 (MainThread): Completed with 2 errors and 0 warnings:
2021-11-29 17:59:10.756609 (MainThread): 
2021-11-29 17:59:10.758645 (MainThread): Runtime Error in model test_model1 (models/test_model1.sql)
2021-11-29 17:59:10.760389 (MainThread):   com.facebook.presto.v217.sql.analyzer.SemanticException: line 2:1: Column name 'state' specified more than once
2021-11-29 17:59:10.762274 (MainThread): 
2021-11-29 17:59:10.763746 (MainThread): Runtime Error in model test_model2 (models/test_model2.sql)
2021-11-29 17:59:10.765582 (MainThread):   com.facebook.presto.v217.sql.analyzer.SemanticException: line 2:1: Column name 'city' specified more than once
2021-11-29 17:59:10.768855 (MainThread): 
Done. PASS=0 WARN=0 ERROR=2 SKIP=3 TOTAL=5
2021-11-29 17:59:10.770663 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbad55910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbad552e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbacdae20>]}
2021-11-29 17:59:10.773364 (MainThread): Flushing usage events
2021-11-29 18:46:40.379436 (MainThread): Running with dbt=0.21.0
2021-11-29 18:46:40.455396 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/vscode/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-29 18:46:40.465197 (MainThread): Tracking: tracking
2021-11-29 18:46:40.468240 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb447d580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5d19d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5d19e50>]}
2021-11-29 18:46:40.477979 (MainThread): Partial parsing not enabled
2021-11-29 18:46:40.496369 (MainThread): Parsing macros/catalog.sql
2021-11-29 18:46:40.499888 (MainThread): Parsing macros/adapters.sql
2021-11-29 18:46:40.508724 (MainThread): Parsing macros/materializations/seed.sql
2021-11-29 18:46:40.511606 (MainThread): Parsing macros/materializations/snapshot.sql
2021-11-29 18:46:40.512600 (MainThread): Parsing macros/materializations/table.sql
2021-11-29 18:46:40.515484 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-29 18:46:40.527756 (MainThread): Parsing macros/materializations/view.sql
2021-11-29 18:46:40.531145 (MainThread): Parsing macros/core.sql
2021-11-29 18:46:40.533687 (MainThread): Parsing macros/materializations/test.sql
2021-11-29 18:46:40.537948 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-29 18:46:40.543614 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-29 18:46:40.546882 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-29 18:46:40.551268 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-29 18:46:40.553750 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-29 18:46:40.560397 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-29 18:46:40.572148 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-29 18:46:40.584668 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-29 18:46:40.589482 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-29 18:46:40.598064 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-29 18:46:40.615030 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-29 18:46:40.623884 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-29 18:46:40.625717 (MainThread): Parsing macros/etc/query.sql
2021-11-29 18:46:40.626975 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-29 18:46:40.629880 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-29 18:46:40.631520 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-29 18:46:40.633023 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-29 18:46:40.635211 (MainThread): Parsing macros/etc/datetime.sql
2021-11-29 18:46:40.640708 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-29 18:46:40.643009 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-29 18:46:40.645559 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-29 18:46:40.647619 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-29 18:46:40.649631 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-29 18:46:40.651669 (MainThread): Parsing macros/adapters/common.sql
2021-11-29 18:46:40.757538 (MainThread): Acquiring new athena connection "model.my_new_project.test_model1".
2021-11-29 18:46:40.765498 (MainThread): Acquiring new athena connection "model.my_new_project.test_model2".
2021-11-29 18:46:40.768076 (MainThread): Acquiring new athena connection "model.my_new_project.test_model3".
2021-11-29 18:46:40.771228 (MainThread): Acquiring new athena connection "model.my_new_project.test_model4".
2021-11-29 18:46:40.773949 (MainThread): Acquiring new athena connection "model.my_new_project.test_model5".
2021-11-29 18:46:40.801613 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-11-29 18:46:40.808411 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3a8c01a9-c904-4667-9d92-d582cb0e8dad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3e8d6a0>]}
2021-11-29 18:46:40.820072 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-11-29 18:46:40.821825 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3a8c01a9-c904-4667-9d92-d582cb0e8dad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3e8d100>]}
2021-11-29 18:46:40.822825 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 3 seed files, 0 sources, 0 exposures
2021-11-29 18:46:40.826372 (MainThread): 
2021-11-29 18:46:40.827396 (MainThread): Acquiring new athena connection "master".
2021-11-29 18:46:40.829554 (ThreadPoolExecutor-0_0): Acquiring new athena connection "list_awsdatacatalog".
2021-11-29 18:46:40.836135 (ThreadPoolExecutor-0_0): Using athena connection "list_awsdatacatalog".
2021-11-29 18:46:40.836999 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
  
2021-11-29 18:46:40.839278 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-29 18:46:40.866578 (ThreadPoolExecutor-0_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
2021-11-29 18:46:42.762036 (ThreadPoolExecutor-0_0): SQL status: OK -1 in 1.92 seconds
2021-11-29 18:46:42.772687 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: Close
2021-11-29 18:46:42.783692 (ThreadPoolExecutor-2_0): Acquiring new athena connection "list_awsdatacatalog_dbt".
2021-11-29 18:46:42.787662 (ThreadPoolExecutor-2_0): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 55670), raddr=('54.164.216.24', 443)>
2021-11-29 18:46:42.802265 (ThreadPoolExecutor-2_0): Using athena connection "list_awsdatacatalog_dbt".
2021-11-29 18:46:42.803791 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
2021-11-29 18:46:42.808378 (ThreadPoolExecutor-2_0): Opening a new connection, currently in state closed
2021-11-29 18:46:42.836258 (ThreadPoolExecutor-2_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
2021-11-29 18:46:46.894739 (ThreadPoolExecutor-2_0): SQL status: OK -1 in 4.09 seconds
2021-11-29 18:46:46.903478 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: Close
2021-11-29 18:46:46.908500 (MainThread): 18:46:46 | Concurrency: 1 threads (target='dev')
2021-11-29 18:46:46.914116 (MainThread): 18:46:46 | 
2021-11-29 18:46:46.925723 (Thread-1): Began running node model.my_new_project.test_model1
2021-11-29 18:46:46.928109 (Thread-1): 18:46:46 | 1 of 5 START view model dbt.test_model1.............................. [RUN]
2021-11-29 18:46:46.934863 (Thread-1): Acquiring new athena connection "model.my_new_project.test_model1".
2021-11-29 18:46:46.938017 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 55672), raddr=('54.164.216.24', 443)>
2021-11-29 18:46:46.942586 (Thread-1): Compiling model.my_new_project.test_model1
2021-11-29 18:46:46.948987 (Thread-1): Writing injected SQL for node "model.my_new_project.test_model1"
2021-11-29 18:46:46.954708 (Thread-1): finished collecting timing info
2021-11-29 18:46:46.970614 (Thread-1): Writing runtime SQL for node "model.my_new_project.test_model1"
2021-11-29 18:46:46.976116 (Thread-1): Using athena connection "model.my_new_project.test_model1".
2021-11-29 18:46:46.977048 (Thread-1): On model.my_new_project.test_model1: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    /*
SELECT * FROM "defaultdb"."resby_puma_northeast" puma
inner join "defaultdb"."buildings" buildings
on puma.bldg_id=buildings.bldg_fid

limit 10;
*/

/* select * from dbt.Region_Table */

/* In plain english: select all from the "buildings" table where the state value is in the Region_Table state column.  */

SELECT * FROM "defaultdb"."buildings" buildings
left join dbt.Region_Table1 region
on buildings.state=region.state
limit 10;

2021-11-29 18:46:46.978614 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 18:46:46.995412 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    /*
SELECT * FROM "defaultdb"."resby_puma_northeast" puma
inner join "defaultdb"."buildings" buildings
on puma.bldg_id=buildings.bldg_fid

limit 10;
*/

/* select * from dbt.Region_Table */

/* In plain english: select all from the "buildings" table where the state value is in the Region_Table state column.  */

SELECT * FROM "defaultdb"."buildings" buildings
left join dbt.Region_Table1 region
on buildings.state=region.state
limit 10;
2021-11-29 18:46:48.510799 (Thread-1): Error running SQL: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    /*
SELECT * FROM "defaultdb"."resby_puma_northeast" puma
inner join "defaultdb"."buildings" buildings
on puma.bldg_id=buildings.bldg_fid

limit 10;
*/

/* select * from dbt.Region_Table */

/* In plain english: select all from the "buildings" table where the state value is in the Region_Table state column.  */

SELECT * FROM "defaultdb"."buildings" buildings
left join dbt.Region_Table1 region
on buildings.state=region.state
limit 10;

2021-11-29 18:46:48.513423 (Thread-1): finished collecting timing info
2021-11-29 18:46:48.515957 (Thread-1): On model.my_new_project.test_model1: Close
2021-11-29 18:46:48.518319 (Thread-1): Runtime Error in model test_model1 (models/test_model1.sql)
  com.facebook.presto.v217.sql.analyzer.SemanticException: line 2:1: Column name 'state' specified more than once
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 100, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 90, in execute
    raise OperationalError(query_execution.state_change_reason)
pyathena.error.OperationalError: com.facebook.presto.v217.sql.analyzer.SemanticException: line 2:1: Column name 'state' specified more than once

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 66, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 103, in exception_handler
    raise RuntimeException(str(e)) from e
dbt.exceptions.RuntimeException: Runtime Error in model test_model1 (models/test_model1.sql)
  com.facebook.presto.v217.sql.analyzer.SemanticException: line 2:1: Column name 'state' specified more than once
2021-11-29 18:46:48.521809 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a8c01a9-c904-4667-9d92-d582cb0e8dad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3ee0d00>]}
2021-11-29 18:46:48.523175 (Thread-1): 18:46:48 | 1 of 5 ERROR creating view model dbt.test_model1..................... [ERROR in 1.59s]
2021-11-29 18:46:48.524774 (Thread-1): Finished running node model.my_new_project.test_model1
2021-11-29 18:46:48.526816 (Thread-1): Began running node model.my_new_project.test_model2
2021-11-29 18:46:48.528378 (Thread-1): 18:46:48 | 2 of 5 START view model dbt.test_model2.............................. [RUN]
2021-11-29 18:46:48.529984 (Thread-1): Acquiring new athena connection "model.my_new_project.test_model2".
2021-11-29 18:46:48.531277 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 55674), raddr=('54.164.216.24', 443)>
2021-11-29 18:46:48.533039 (Thread-1): Compiling model.my_new_project.test_model2
2021-11-29 18:46:48.535790 (Thread-1): Writing injected SQL for node "model.my_new_project.test_model2"
2021-11-29 18:46:48.541024 (Thread-1): finished collecting timing info
2021-11-29 18:46:48.544627 (Thread-1): Writing runtime SQL for node "model.my_new_project.test_model2"
2021-11-29 18:46:48.548069 (Thread-1): Using athena connection "model.my_new_project.test_model2".
2021-11-29 18:46:48.548802 (Thread-1): On model.my_new_project.test_model2: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    SELECT * FROM "defaultdb"."buildings" buildings
inner join dbt.Random_Small_Towns region
on buildings.state=region.state
limit 10;

2021-11-29 18:46:48.550182 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 18:46:48.566701 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    SELECT * FROM "defaultdb"."buildings" buildings
inner join dbt.Random_Small_Towns region
on buildings.state=region.state
limit 10;
2021-11-29 18:46:50.074987 (Thread-1): Error running SQL: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    SELECT * FROM "defaultdb"."buildings" buildings
inner join dbt.Random_Small_Towns region
on buildings.state=region.state
limit 10;

2021-11-29 18:46:50.082584 (Thread-1): finished collecting timing info
2021-11-29 18:46:50.089456 (Thread-1): On model.my_new_project.test_model2: Close
2021-11-29 18:46:50.095498 (Thread-1): Runtime Error in model test_model2 (models/test_model2.sql)
  com.facebook.presto.v217.sql.analyzer.SemanticException: line 2:1: Column name 'city' specified more than once
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 100, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 90, in execute
    raise OperationalError(query_execution.state_change_reason)
pyathena.error.OperationalError: com.facebook.presto.v217.sql.analyzer.SemanticException: line 2:1: Column name 'city' specified more than once

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 66, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 103, in exception_handler
    raise RuntimeException(str(e)) from e
dbt.exceptions.RuntimeException: Runtime Error in model test_model2 (models/test_model2.sql)
  com.facebook.presto.v217.sql.analyzer.SemanticException: line 2:1: Column name 'city' specified more than once
2021-11-29 18:46:50.102596 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a8c01a9-c904-4667-9d92-d582cb0e8dad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2b0f250>]}
2021-11-29 18:46:50.108538 (Thread-1): 18:46:50 | 2 of 5 ERROR creating view model dbt.test_model2..................... [ERROR in 1.57s]
2021-11-29 18:46:50.112112 (Thread-1): Finished running node model.my_new_project.test_model2
2021-11-29 18:46:50.117196 (Thread-1): Began running node model.my_new_project.test_model3
2021-11-29 18:46:50.120815 (Thread-1): 18:46:50 | 3 of 5 SKIP relation dbt.test_model3................................. [SKIP]
2021-11-29 18:46:50.124072 (Thread-1): Finished running node model.my_new_project.test_model3
2021-11-29 18:46:50.127868 (Thread-1): Began running node model.my_new_project.test_model4
2021-11-29 18:46:50.130843 (Thread-1): 18:46:50 | 4 of 5 SKIP relation dbt.test_model4................................. [SKIP]
2021-11-29 18:46:50.134246 (Thread-1): Finished running node model.my_new_project.test_model4
2021-11-29 18:46:50.139194 (Thread-1): Began running node model.my_new_project.test_model5
2021-11-29 18:46:50.142547 (Thread-1): 18:46:50 | 5 of 5 SKIP relation dbt.test_model5................................. [SKIP]
2021-11-29 18:46:50.145757 (Thread-1): Finished running node model.my_new_project.test_model5
2021-11-29 18:46:50.150006 (MainThread): Acquiring new athena connection "master".
2021-11-29 18:46:50.151186 (MainThread): 18:46:50 | 
2021-11-29 18:46:50.153426 (MainThread): 18:46:50 | Finished running 5 view models in 9.32s.
2021-11-29 18:46:50.156818 (MainThread): Connection 'master' was properly closed.
2021-11-29 18:46:50.159070 (MainThread): Connection 'model.my_new_project.test_model2' was properly closed.
2021-11-29 18:46:50.160669 (MainThread): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 55676), raddr=('54.164.216.24', 443)>
2021-11-29 18:46:50.175153 (MainThread): 
2021-11-29 18:46:50.176512 (MainThread): Completed with 2 errors and 0 warnings:
2021-11-29 18:46:50.178359 (MainThread): 
2021-11-29 18:46:50.180743 (MainThread): Runtime Error in model test_model1 (models/test_model1.sql)
2021-11-29 18:46:50.182640 (MainThread):   com.facebook.presto.v217.sql.analyzer.SemanticException: line 2:1: Column name 'state' specified more than once
2021-11-29 18:46:50.185062 (MainThread): 
2021-11-29 18:46:50.186829 (MainThread): Runtime Error in model test_model2 (models/test_model2.sql)
2021-11-29 18:46:50.189742 (MainThread):   com.facebook.presto.v217.sql.analyzer.SemanticException: line 2:1: Column name 'city' specified more than once
2021-11-29 18:46:50.192663 (MainThread): 
Done. PASS=0 WARN=0 ERROR=2 SKIP=3 TOTAL=5
2021-11-29 18:46:50.194723 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3e305b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5cb9f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5d39520>]}
2021-11-29 18:46:50.196753 (MainThread): Flushing usage events
2021-11-29 18:49:23.048132 (MainThread): Running with dbt=0.21.0
2021-11-29 18:49:23.124546 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/vscode/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-29 18:49:23.129754 (MainThread): Tracking: tracking
2021-11-29 18:49:23.132730 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d379610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ec15c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ec15e20>]}
2021-11-29 18:49:23.142447 (MainThread): Partial parsing not enabled
2021-11-29 18:49:23.160085 (MainThread): Parsing macros/catalog.sql
2021-11-29 18:49:23.162713 (MainThread): Parsing macros/adapters.sql
2021-11-29 18:49:23.171676 (MainThread): Parsing macros/materializations/seed.sql
2021-11-29 18:49:23.174730 (MainThread): Parsing macros/materializations/snapshot.sql
2021-11-29 18:49:23.176110 (MainThread): Parsing macros/materializations/table.sql
2021-11-29 18:49:23.179796 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-29 18:49:23.193396 (MainThread): Parsing macros/materializations/view.sql
2021-11-29 18:49:23.197773 (MainThread): Parsing macros/core.sql
2021-11-29 18:49:23.201027 (MainThread): Parsing macros/materializations/test.sql
2021-11-29 18:49:23.205241 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-29 18:49:23.211878 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-29 18:49:23.215649 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-29 18:49:23.220240 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-29 18:49:23.221830 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-29 18:49:23.228671 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-29 18:49:23.239115 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-29 18:49:23.252056 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-29 18:49:23.257507 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-29 18:49:23.265851 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-29 18:49:23.284081 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-29 18:49:23.294820 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-29 18:49:23.296547 (MainThread): Parsing macros/etc/query.sql
2021-11-29 18:49:23.298052 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-29 18:49:23.300567 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-29 18:49:23.302308 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-29 18:49:23.303789 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-29 18:49:23.305295 (MainThread): Parsing macros/etc/datetime.sql
2021-11-29 18:49:23.311349 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-29 18:49:23.312982 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-29 18:49:23.315629 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-29 18:49:23.317416 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-29 18:49:23.318696 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-29 18:49:23.320753 (MainThread): Parsing macros/adapters/common.sql
2021-11-29 18:49:23.425746 (MainThread): Acquiring new athena connection "model.my_new_project.test_model1".
2021-11-29 18:49:23.433723 (MainThread): Acquiring new athena connection "model.my_new_project.test_model2".
2021-11-29 18:49:23.436905 (MainThread): Acquiring new athena connection "model.my_new_project.test_model3".
2021-11-29 18:49:23.439695 (MainThread): Acquiring new athena connection "model.my_new_project.test_model4".
2021-11-29 18:49:23.442359 (MainThread): Acquiring new athena connection "model.my_new_project.test_model5".
2021-11-29 18:49:23.470134 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-11-29 18:49:23.474427 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '26c93967-4201-4801-a2d4-349663dfde35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cd83850>]}
2021-11-29 18:49:23.486920 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-11-29 18:49:23.488800 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '26c93967-4201-4801-a2d4-349663dfde35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cd83070>]}
2021-11-29 18:49:23.489688 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 4 seed files, 0 sources, 0 exposures
2021-11-29 18:49:23.492688 (MainThread): 
2021-11-29 18:49:23.493995 (MainThread): Acquiring new athena connection "master".
2021-11-29 18:49:23.496703 (ThreadPoolExecutor-0_0): Acquiring new athena connection "list_awsdatacatalog".
2021-11-29 18:49:23.504001 (ThreadPoolExecutor-0_0): Using athena connection "list_awsdatacatalog".
2021-11-29 18:49:23.505125 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
  
2021-11-29 18:49:23.506944 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-29 18:49:23.536731 (ThreadPoolExecutor-0_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
2021-11-29 18:49:25.403607 (ThreadPoolExecutor-0_0): SQL status: OK -1 in 1.90 seconds
2021-11-29 18:49:25.408003 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: Close
2021-11-29 18:49:25.410454 (ThreadPoolExecutor-2_0): Acquiring new athena connection "list_awsdatacatalog_dbt".
2021-11-29 18:49:25.412474 (ThreadPoolExecutor-2_0): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 33884), raddr=('52.1.206.68', 443)>
2021-11-29 18:49:25.418691 (ThreadPoolExecutor-2_0): Using athena connection "list_awsdatacatalog_dbt".
2021-11-29 18:49:25.419495 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
2021-11-29 18:49:25.423265 (ThreadPoolExecutor-2_0): Opening a new connection, currently in state closed
2021-11-29 18:49:25.441008 (ThreadPoolExecutor-2_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
2021-11-29 18:49:29.436773 (ThreadPoolExecutor-2_0): SQL status: OK -1 in 4.01 seconds
2021-11-29 18:49:29.449571 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: Close
2021-11-29 18:49:29.454792 (MainThread): 18:49:29 | Concurrency: 1 threads (target='dev')
2021-11-29 18:49:29.460482 (MainThread): 18:49:29 | 
2021-11-29 18:49:29.473075 (Thread-1): Began running node model.my_new_project.test_model1
2021-11-29 18:49:29.475481 (Thread-1): 18:49:29 | 1 of 5 START view model dbt.test_model1.............................. [RUN]
2021-11-29 18:49:29.479667 (Thread-1): Acquiring new athena connection "model.my_new_project.test_model1".
2021-11-29 18:49:29.483698 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 33886), raddr=('52.1.206.68', 443)>
2021-11-29 18:49:29.487486 (Thread-1): Compiling model.my_new_project.test_model1
2021-11-29 18:49:29.493562 (Thread-1): Writing injected SQL for node "model.my_new_project.test_model1"
2021-11-29 18:49:29.501884 (Thread-1): finished collecting timing info
2021-11-29 18:49:29.517305 (Thread-1): Writing runtime SQL for node "model.my_new_project.test_model1"
2021-11-29 18:49:29.522259 (Thread-1): Using athena connection "model.my_new_project.test_model1".
2021-11-29 18:49:29.523686 (Thread-1): On model.my_new_project.test_model1: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    /*
SELECT * FROM "defaultdb"."resby_puma_northeast" puma
inner join "defaultdb"."buildings" buildings
on puma.bldg_id=buildings.bldg_fid

limit 10;
*/

/* select * from dbt.Region_Table */

/* In plain english: select all from the "buildings" table where the state value is in the Region_Table state column.  */

SELECT * FROM "defaultdb"."buildings" buildings
left join dbt.Region_Table2 region
on buildings.state=region.state1
limit 10;

2021-11-29 18:49:29.525425 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 18:49:29.541568 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    /*
SELECT * FROM "defaultdb"."resby_puma_northeast" puma
inner join "defaultdb"."buildings" buildings
on puma.bldg_id=buildings.bldg_fid

limit 10;
*/

/* select * from dbt.Region_Table */

/* In plain english: select all from the "buildings" table where the state value is in the Region_Table state column.  */

SELECT * FROM "defaultdb"."buildings" buildings
left join dbt.Region_Table2 region
on buildings.state=region.state1
limit 10;
2021-11-29 18:49:31.047273 (Thread-1): Error running SQL: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    /*
SELECT * FROM "defaultdb"."resby_puma_northeast" puma
inner join "defaultdb"."buildings" buildings
on puma.bldg_id=buildings.bldg_fid

limit 10;
*/

/* select * from dbt.Region_Table */

/* In plain english: select all from the "buildings" table where the state value is in the Region_Table state column.  */

SELECT * FROM "defaultdb"."buildings" buildings
left join dbt.Region_Table2 region
on buildings.state=region.state1
limit 10;

2021-11-29 18:49:31.057226 (Thread-1): finished collecting timing info
2021-11-29 18:49:31.063594 (Thread-1): On model.my_new_project.test_model1: Close
2021-11-29 18:49:31.070448 (Thread-1): Runtime Error in model test_model1 (models/test_model1.sql)
  com.facebook.presto.v217.sql.analyzer.SemanticException: line 18:11: Table 459120389451.dbt.region_table2 does not exist
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 100, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 90, in execute
    raise OperationalError(query_execution.state_change_reason)
pyathena.error.OperationalError: com.facebook.presto.v217.sql.analyzer.SemanticException: line 18:11: Table 459120389451.dbt.region_table2 does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 66, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 103, in exception_handler
    raise RuntimeException(str(e)) from e
dbt.exceptions.RuntimeException: Runtime Error in model test_model1 (models/test_model1.sql)
  com.facebook.presto.v217.sql.analyzer.SemanticException: line 18:11: Table 459120389451.dbt.region_table2 does not exist
2021-11-29 18:49:31.082382 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26c93967-4201-4801-a2d4-349663dfde35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c04a2b0>]}
2021-11-29 18:49:31.086995 (Thread-1): 18:49:31 | 1 of 5 ERROR creating view model dbt.test_model1..................... [ERROR in 1.60s]
2021-11-29 18:49:31.091199 (Thread-1): Finished running node model.my_new_project.test_model1
2021-11-29 18:49:31.094548 (Thread-1): Began running node model.my_new_project.test_model2
2021-11-29 18:49:31.098061 (Thread-1): 18:49:31 | 2 of 5 START view model dbt.test_model2.............................. [RUN]
2021-11-29 18:49:31.103567 (Thread-1): Acquiring new athena connection "model.my_new_project.test_model2".
2021-11-29 18:49:31.105651 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 33888), raddr=('52.1.206.68', 443)>
2021-11-29 18:49:31.108280 (Thread-1): Compiling model.my_new_project.test_model2
2021-11-29 18:49:31.113054 (Thread-1): Writing injected SQL for node "model.my_new_project.test_model2"
2021-11-29 18:49:31.119475 (Thread-1): finished collecting timing info
2021-11-29 18:49:31.122634 (Thread-1): Writing runtime SQL for node "model.my_new_project.test_model2"
2021-11-29 18:49:31.126530 (Thread-1): Using athena connection "model.my_new_project.test_model2".
2021-11-29 18:49:31.128279 (Thread-1): On model.my_new_project.test_model2: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    SELECT * FROM "defaultdb"."buildings" buildings
inner join dbt.Random_Small_Towns region
on buildings.state=region.state
limit 10;

2021-11-29 18:49:31.130102 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 18:49:31.148278 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    SELECT * FROM "defaultdb"."buildings" buildings
inner join dbt.Random_Small_Towns region
on buildings.state=region.state
limit 10;
2021-11-29 18:49:32.625624 (Thread-1): Error running SQL: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    SELECT * FROM "defaultdb"."buildings" buildings
inner join dbt.Random_Small_Towns region
on buildings.state=region.state
limit 10;

2021-11-29 18:49:32.630353 (Thread-1): finished collecting timing info
2021-11-29 18:49:32.638852 (Thread-1): On model.my_new_project.test_model2: Close
2021-11-29 18:49:32.645303 (Thread-1): Runtime Error in model test_model2 (models/test_model2.sql)
  com.facebook.presto.v217.sql.analyzer.SemanticException: line 2:1: Column name 'city' specified more than once
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 100, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 90, in execute
    raise OperationalError(query_execution.state_change_reason)
pyathena.error.OperationalError: com.facebook.presto.v217.sql.analyzer.SemanticException: line 2:1: Column name 'city' specified more than once

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 66, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 103, in exception_handler
    raise RuntimeException(str(e)) from e
dbt.exceptions.RuntimeException: Runtime Error in model test_model2 (models/test_model2.sql)
  com.facebook.presto.v217.sql.analyzer.SemanticException: line 2:1: Column name 'city' specified more than once
2021-11-29 18:49:32.648193 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26c93967-4201-4801-a2d4-349663dfde35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c305ca0>]}
2021-11-29 18:49:32.650822 (Thread-1): 18:49:32 | 2 of 5 ERROR creating view model dbt.test_model2..................... [ERROR in 1.54s]
2021-11-29 18:49:32.654432 (Thread-1): Finished running node model.my_new_project.test_model2
2021-11-29 18:49:32.658164 (Thread-1): Began running node model.my_new_project.test_model3
2021-11-29 18:49:32.659983 (Thread-1): 18:49:32 | 3 of 5 SKIP relation dbt.test_model3................................. [SKIP]
2021-11-29 18:49:32.663449 (Thread-1): Finished running node model.my_new_project.test_model3
2021-11-29 18:49:32.666844 (Thread-1): Began running node model.my_new_project.test_model4
2021-11-29 18:49:32.669038 (Thread-1): 18:49:32 | 4 of 5 SKIP relation dbt.test_model4................................. [SKIP]
2021-11-29 18:49:32.671841 (Thread-1): Finished running node model.my_new_project.test_model4
2021-11-29 18:49:32.674608 (Thread-1): Began running node model.my_new_project.test_model5
2021-11-29 18:49:32.679088 (Thread-1): 18:49:32 | 5 of 5 SKIP relation dbt.test_model5................................. [SKIP]
2021-11-29 18:49:32.682492 (Thread-1): Finished running node model.my_new_project.test_model5
2021-11-29 18:49:32.687632 (MainThread): Acquiring new athena connection "master".
2021-11-29 18:49:32.693374 (MainThread): 18:49:32 | 
2021-11-29 18:49:32.697176 (MainThread): 18:49:32 | Finished running 5 view models in 9.20s.
2021-11-29 18:49:32.700865 (MainThread): Connection 'master' was properly closed.
2021-11-29 18:49:32.705057 (MainThread): Connection 'model.my_new_project.test_model2' was properly closed.
2021-11-29 18:49:32.710228 (MainThread): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 33890), raddr=('52.1.206.68', 443)>
2021-11-29 18:49:32.731808 (MainThread): 
2021-11-29 18:49:32.733703 (MainThread): Completed with 2 errors and 0 warnings:
2021-11-29 18:49:32.737618 (MainThread): 
2021-11-29 18:49:32.742771 (MainThread): Runtime Error in model test_model1 (models/test_model1.sql)
2021-11-29 18:49:32.746833 (MainThread):   com.facebook.presto.v217.sql.analyzer.SemanticException: line 18:11: Table 459120389451.dbt.region_table2 does not exist
2021-11-29 18:49:32.750383 (MainThread): 
2021-11-29 18:49:32.753844 (MainThread): Runtime Error in model test_model2 (models/test_model2.sql)
2021-11-29 18:49:32.758578 (MainThread):   com.facebook.presto.v217.sql.analyzer.SemanticException: line 2:1: Column name 'city' specified more than once
2021-11-29 18:49:32.761532 (MainThread): 
Done. PASS=0 WARN=0 ERROR=2 SKIP=3 TOTAL=5
2021-11-29 18:49:32.765566 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ce68100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ebb5e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ec35220>]}
2021-11-29 18:49:32.769632 (MainThread): Flushing usage events
2021-11-29 18:49:38.884331 (MainThread): Running with dbt=0.21.0
2021-11-29 18:49:38.949199 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/vscode/.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', select=None, selector_name=None, show=False, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='seed', write_json=True)
2021-11-29 18:49:38.954230 (MainThread): Tracking: tracking
2021-11-29 18:49:38.956770 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb903d5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba8d9190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba8d9dc0>]}
2021-11-29 18:49:38.966102 (MainThread): Partial parsing not enabled
2021-11-29 18:49:38.981127 (MainThread): Parsing macros/catalog.sql
2021-11-29 18:49:38.983741 (MainThread): Parsing macros/adapters.sql
2021-11-29 18:49:38.992487 (MainThread): Parsing macros/materializations/seed.sql
2021-11-29 18:49:38.996251 (MainThread): Parsing macros/materializations/snapshot.sql
2021-11-29 18:49:38.998416 (MainThread): Parsing macros/materializations/table.sql
2021-11-29 18:49:39.001840 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-29 18:49:39.014552 (MainThread): Parsing macros/materializations/view.sql
2021-11-29 18:49:39.018390 (MainThread): Parsing macros/core.sql
2021-11-29 18:49:39.021453 (MainThread): Parsing macros/materializations/test.sql
2021-11-29 18:49:39.026081 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-29 18:49:39.032296 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-29 18:49:39.035533 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-29 18:49:39.039840 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-29 18:49:39.041397 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-29 18:49:39.047581 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-29 18:49:39.059334 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-29 18:49:39.072495 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-29 18:49:39.076992 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-29 18:49:39.084713 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-29 18:49:39.101028 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-29 18:49:39.110972 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-29 18:49:39.112458 (MainThread): Parsing macros/etc/query.sql
2021-11-29 18:49:39.114335 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-29 18:49:39.117181 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-29 18:49:39.118724 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-29 18:49:39.120111 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-29 18:49:39.121729 (MainThread): Parsing macros/etc/datetime.sql
2021-11-29 18:49:39.128023 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-29 18:49:39.130301 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-29 18:49:39.132138 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-29 18:49:39.133545 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-29 18:49:39.135001 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-29 18:49:39.136578 (MainThread): Parsing macros/adapters/common.sql
2021-11-29 18:49:39.243580 (MainThread): Acquiring new athena connection "model.my_new_project.test_model1".
2021-11-29 18:49:39.253947 (MainThread): Acquiring new athena connection "model.my_new_project.test_model2".
2021-11-29 18:49:39.257769 (MainThread): Acquiring new athena connection "model.my_new_project.test_model3".
2021-11-29 18:49:39.261474 (MainThread): Acquiring new athena connection "model.my_new_project.test_model4".
2021-11-29 18:49:39.264302 (MainThread): Acquiring new athena connection "model.my_new_project.test_model5".
2021-11-29 18:49:39.287765 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-11-29 18:49:39.292163 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3a7fb8b4-57ff-4515-8a11-5bf8a324280a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8a4c280>]}
2021-11-29 18:49:39.303656 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-11-29 18:49:39.305642 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3a7fb8b4-57ff-4515-8a11-5bf8a324280a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8a4c490>]}
2021-11-29 18:49:39.308114 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 4 seed files, 0 sources, 0 exposures
2021-11-29 18:49:39.311578 (MainThread): 
2021-11-29 18:49:39.313077 (MainThread): Acquiring new athena connection "master".
2021-11-29 18:49:39.316292 (ThreadPoolExecutor-0_0): Acquiring new athena connection "list_awsdatacatalog".
2021-11-29 18:49:39.323242 (ThreadPoolExecutor-0_0): Using athena connection "list_awsdatacatalog".
2021-11-29 18:49:39.324137 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
  
2021-11-29 18:49:39.325709 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-29 18:49:39.344734 (ThreadPoolExecutor-0_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
2021-11-29 18:49:41.146339 (ThreadPoolExecutor-0_0): SQL status: OK -1 in 1.82 seconds
2021-11-29 18:49:41.157776 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: Close
2021-11-29 18:49:41.164714 (ThreadPoolExecutor-2_0): Acquiring new athena connection "list_awsdatacatalog_dbt".
2021-11-29 18:49:41.167311 (ThreadPoolExecutor-2_0): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 33894), raddr=('52.1.206.68', 443)>
2021-11-29 18:49:41.183015 (ThreadPoolExecutor-2_0): Using athena connection "list_awsdatacatalog_dbt".
2021-11-29 18:49:41.185116 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
2021-11-29 18:49:41.189978 (ThreadPoolExecutor-2_0): Opening a new connection, currently in state closed
2021-11-29 18:49:41.217532 (ThreadPoolExecutor-2_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
2021-11-29 18:49:45.150160 (ThreadPoolExecutor-2_0): SQL status: OK -1 in 3.96 seconds
2021-11-29 18:49:45.162778 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: Close
2021-11-29 18:49:45.168100 (MainThread): 18:49:45 | Concurrency: 1 threads (target='dev')
2021-11-29 18:49:45.174261 (MainThread): 18:49:45 | 
2021-11-29 18:49:45.186683 (Thread-1): Began running node seed.my_new_project.Random_Small_Towns
2021-11-29 18:49:45.188727 (Thread-1): 18:49:45 | 1 of 4 START seed file dbt.Random_Small_Towns........................ [RUN]
2021-11-29 18:49:45.193902 (Thread-1): Acquiring new athena connection "seed.my_new_project.Random_Small_Towns".
2021-11-29 18:49:45.197745 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 33896), raddr=('52.1.206.68', 443)>
2021-11-29 18:49:45.204862 (Thread-1): finished collecting timing info
2021-11-29 18:49:45.219972 (Thread-1): finished collecting timing info
2021-11-29 18:49:45.221301 (Thread-1): Compilation Error in seed Random_Small_Towns (data/Random_Small_Towns.csv)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete dbt.random_small_towns, or rename it to be less ambiguous.
  Searched for: dbt.Random_Small_Towns
  Found: dbt.random_small_towns
  
  > in macro materialization_seed_default (macros/materializations/seed/seed.sql)
  > called by seed Random_Small_Towns (data/Random_Small_Towns.csv)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 39, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 734, in get_relation
    matches = self._make_match(relations_list, database, schema,
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 723, in _make_match
    if relation.matches(**search):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/relation.py", line 99, in matches
    dbt.exceptions.approximate_relation_match(target, self)
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 741, in approximate_relation_match
    raise_compiler_error(
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 444, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in seed Random_Small_Towns (data/Random_Small_Towns.csv)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete dbt.random_small_towns, or rename it to be less ambiguous.
  Searched for: dbt.Random_Small_Towns
  Found: dbt.random_small_towns
  
  > in macro materialization_seed_default (macros/materializations/seed/seed.sql)
  > called by seed Random_Small_Towns (data/Random_Small_Towns.csv)
2021-11-29 18:49:45.226030 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a7fb8b4-57ff-4515-8a11-5bf8a324280a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3fa4b50>]}
2021-11-29 18:49:45.228978 (Thread-1): 18:49:45 | 1 of 4 ERROR loading seed file dbt.Random_Small_Towns................ [ERROR in 0.03s]
2021-11-29 18:49:45.231788 (Thread-1): Finished running node seed.my_new_project.Random_Small_Towns
2021-11-29 18:49:45.235102 (Thread-1): Began running node seed.my_new_project.Region_Table
2021-11-29 18:49:45.237672 (Thread-1): 18:49:45 | 2 of 4 START seed file dbt.Region_Table.............................. [RUN]
2021-11-29 18:49:45.240850 (Thread-1): Acquiring new athena connection "seed.my_new_project.Region_Table".
2021-11-29 18:49:45.242807 (Thread-1): finished collecting timing info
2021-11-29 18:49:45.245749 (Thread-1): finished collecting timing info
2021-11-29 18:49:45.246646 (Thread-1): Compilation Error in seed Region_Table (data/Region_Table.csv)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete dbt.region_table, or rename it to be less ambiguous.
  Searched for: dbt.Region_Table
  Found: dbt.region_table
  
  > in macro materialization_seed_default (macros/materializations/seed/seed.sql)
  > called by seed Region_Table (data/Region_Table.csv)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 39, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 734, in get_relation
    matches = self._make_match(relations_list, database, schema,
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 723, in _make_match
    if relation.matches(**search):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/relation.py", line 99, in matches
    dbt.exceptions.approximate_relation_match(target, self)
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 741, in approximate_relation_match
    raise_compiler_error(
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 444, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in seed Region_Table (data/Region_Table.csv)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete dbt.region_table, or rename it to be less ambiguous.
  Searched for: dbt.Region_Table
  Found: dbt.region_table
  
  > in macro materialization_seed_default (macros/materializations/seed/seed.sql)
  > called by seed Region_Table (data/Region_Table.csv)
2021-11-29 18:49:45.249251 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a7fb8b4-57ff-4515-8a11-5bf8a324280a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb35083a0>]}
2021-11-29 18:49:45.250928 (Thread-1): 18:49:45 | 2 of 4 ERROR loading seed file dbt.Region_Table...................... [ERROR in 0.01s]
2021-11-29 18:49:45.252248 (Thread-1): Finished running node seed.my_new_project.Region_Table
2021-11-29 18:49:45.254210 (Thread-1): Began running node seed.my_new_project.Region_Table1
2021-11-29 18:49:45.256915 (Thread-1): 18:49:45 | 3 of 4 START seed file dbt.Region_Table1............................. [RUN]
2021-11-29 18:49:45.258944 (Thread-1): Acquiring new athena connection "seed.my_new_project.Region_Table1".
2021-11-29 18:49:45.261046 (Thread-1): finished collecting timing info
2021-11-29 18:49:45.263811 (Thread-1): finished collecting timing info
2021-11-29 18:49:45.264870 (Thread-1): Compilation Error in seed Region_Table1 (data/Region_Table1.csv)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete dbt.region_table1, or rename it to be less ambiguous.
  Searched for: dbt.Region_Table1
  Found: dbt.region_table1
  
  > in macro materialization_seed_default (macros/materializations/seed/seed.sql)
  > called by seed Region_Table1 (data/Region_Table1.csv)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 39, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 734, in get_relation
    matches = self._make_match(relations_list, database, schema,
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 723, in _make_match
    if relation.matches(**search):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/relation.py", line 99, in matches
    dbt.exceptions.approximate_relation_match(target, self)
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 741, in approximate_relation_match
    raise_compiler_error(
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 444, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in seed Region_Table1 (data/Region_Table1.csv)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete dbt.region_table1, or rename it to be less ambiguous.
  Searched for: dbt.Region_Table1
  Found: dbt.region_table1
  
  > in macro materialization_seed_default (macros/materializations/seed/seed.sql)
  > called by seed Region_Table1 (data/Region_Table1.csv)
2021-11-29 18:49:45.267280 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a7fb8b4-57ff-4515-8a11-5bf8a324280a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3fa4b50>]}
2021-11-29 18:49:45.268828 (Thread-1): 18:49:45 | 3 of 4 ERROR loading seed file dbt.Region_Table1..................... [ERROR in 0.01s]
2021-11-29 18:49:45.270267 (Thread-1): Finished running node seed.my_new_project.Region_Table1
2021-11-29 18:49:45.272670 (Thread-1): Began running node seed.my_new_project.Region_Table2
2021-11-29 18:49:45.275548 (Thread-1): 18:49:45 | 4 of 4 START seed file dbt.Region_Table2............................. [RUN]
2021-11-29 18:49:45.277907 (Thread-1): Acquiring new athena connection "seed.my_new_project.Region_Table2".
2021-11-29 18:49:45.279636 (Thread-1): finished collecting timing info
2021-11-29 18:49:45.292364 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-11-29 18:49:45.293719 (Thread-1): * Deprecation Warning: The quote_columns parameter was not set for seeds, so the
default value of False was chosen. The default will change to True in a future
release.

For more information, see:
https://docs.getdbt.com/v0.15/docs/seeds#section-specify-column-quoting
2021-11-29 18:49:45.295339 (Thread-1): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3a7fb8b4-57ff-4515-8a11-5bf8a324280a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2458e80>]}
2021-11-29 18:49:45.297563 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-11-29 18:49:45.300083 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 18:49:45.316879 (Thread-1): Using athena connection "seed.my_new_project.Region_Table2".
2021-11-29 18:49:45.318006 (Thread-1): On seed.my_new_project.Region_Table2: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "seed.my_new_project.Region_Table2"} */

    create external table dbt.Region_Table2 (State1 string, Region string)
    stored as parquet
    location 's3://justin-dbt-testing/Targettables/9aa6236f-1b80-4150-bf56-4f4acc2561ae/'
    tblproperties ('classification'='parquet')
  
2021-11-29 18:49:45.319869 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "seed.my_new_project.Region_Table2"} */

    create external table dbt.Region_Table2 (State1 string, Region string)
    stored as parquet
    location 's3://justin-dbt-testing/Targettables/9aa6236f-1b80-4150-bf56-4f4acc2561ae/'
    tblproperties ('classification'='parquet')
2021-11-29 18:49:47.023431 (Thread-1): SQL status: OK -1 in 1.70 seconds
2021-11-29 18:49:47.039728 (Thread-1): Using athena connection "seed.my_new_project.Region_Table2".
2021-11-29 18:49:47.040687 (Thread-1): On seed.my_new_project.Region_Table2: 
          insert into dbt.Region_Table2 (State1, Region) values
          (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s)
      ...
2021-11-29 18:49:47.044893 (Thread-1): insert into dbt.Region_Table2 (State1, Region) values
          ('ME','Northeast'),('NH','Northeast'),('VT','Northeast'),('MA','Northeast'),('CT','Northeast'),('RI','Northeast')
2021-11-29 18:49:49.681006 (Thread-1): SQL status: OK -1 in 2.64 seconds
2021-11-29 18:49:49.697824 (Thread-1): Writing runtime SQL for node "seed.my_new_project.Region_Table2"
2021-11-29 18:49:49.728169 (Thread-1): finished collecting timing info
2021-11-29 18:49:49.729611 (Thread-1): On seed.my_new_project.Region_Table2: Close
2021-11-29 18:49:49.732789 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a7fb8b4-57ff-4515-8a11-5bf8a324280a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb244f0a0>]}
2021-11-29 18:49:49.735822 (Thread-1): 18:49:49 | 4 of 4 OK loaded seed file dbt.Region_Table2......................... [INSERT 6 in 4.45s]
2021-11-29 18:49:49.738967 (Thread-1): Finished running node seed.my_new_project.Region_Table2
2021-11-29 18:49:49.743623 (MainThread): Acquiring new athena connection "master".
2021-11-29 18:49:49.745005 (MainThread): 18:49:49 | 
2021-11-29 18:49:49.747053 (MainThread): 18:49:49 | Finished running 4 seeds in 10.43s.
2021-11-29 18:49:49.751252 (MainThread): Connection 'master' was properly closed.
2021-11-29 18:49:49.753739 (MainThread): Connection 'seed.my_new_project.Region_Table2' was properly closed.
2021-11-29 18:49:49.755930 (MainThread): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 33898), raddr=('52.1.206.68', 443)>
2021-11-29 18:49:49.772543 (MainThread): 
2021-11-29 18:49:49.773555 (MainThread): Completed with 3 errors and 0 warnings:
2021-11-29 18:49:49.775215 (MainThread): 
2021-11-29 18:49:49.776591 (MainThread): Compilation Error in seed Random_Small_Towns (data/Random_Small_Towns.csv)
2021-11-29 18:49:49.778717 (MainThread):   When searching for a relation, dbt found an approximate match. Instead of guessing 
2021-11-29 18:49:49.782019 (MainThread):   which relation to use, dbt will move on. Please delete dbt.random_small_towns, or rename it to be less ambiguous.
2021-11-29 18:49:49.784573 (MainThread):   Searched for: dbt.Random_Small_Towns
2021-11-29 18:49:49.786334 (MainThread):   Found: dbt.random_small_towns
2021-11-29 18:49:49.788274 (MainThread):   
2021-11-29 18:49:49.791334 (MainThread):   > in macro materialization_seed_default (macros/materializations/seed/seed.sql)
2021-11-29 18:49:49.792746 (MainThread):   > called by seed Random_Small_Towns (data/Random_Small_Towns.csv)
2021-11-29 18:49:49.794477 (MainThread): 
2021-11-29 18:49:49.796142 (MainThread): Compilation Error in seed Region_Table (data/Region_Table.csv)
2021-11-29 18:49:49.797972 (MainThread):   When searching for a relation, dbt found an approximate match. Instead of guessing 
2021-11-29 18:49:49.800275 (MainThread):   which relation to use, dbt will move on. Please delete dbt.region_table, or rename it to be less ambiguous.
2021-11-29 18:49:49.804300 (MainThread):   Searched for: dbt.Region_Table
2021-11-29 18:49:49.807981 (MainThread):   Found: dbt.region_table
2021-11-29 18:49:49.810783 (MainThread):   
2021-11-29 18:49:49.812596 (MainThread):   > in macro materialization_seed_default (macros/materializations/seed/seed.sql)
2021-11-29 18:49:49.814501 (MainThread):   > called by seed Region_Table (data/Region_Table.csv)
2021-11-29 18:49:49.816968 (MainThread): 
2021-11-29 18:49:49.818806 (MainThread): Compilation Error in seed Region_Table1 (data/Region_Table1.csv)
2021-11-29 18:49:49.820616 (MainThread):   When searching for a relation, dbt found an approximate match. Instead of guessing 
2021-11-29 18:49:49.822178 (MainThread):   which relation to use, dbt will move on. Please delete dbt.region_table1, or rename it to be less ambiguous.
2021-11-29 18:49:49.825873 (MainThread):   Searched for: dbt.Region_Table1
2021-11-29 18:49:49.828703 (MainThread):   Found: dbt.region_table1
2021-11-29 18:49:49.830630 (MainThread):   
2021-11-29 18:49:49.832886 (MainThread):   > in macro materialization_seed_default (macros/materializations/seed/seed.sql)
2021-11-29 18:49:49.835145 (MainThread):   > called by seed Region_Table1 (data/Region_Table1.csv)
2021-11-29 18:49:49.837278 (MainThread): 
Done. PASS=1 WARN=0 ERROR=3 SKIP=0 TOTAL=4
2021-11-29 18:49:49.839448 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8ac4970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb89f2d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba8f9280>]}
2021-11-29 18:49:49.842066 (MainThread): Flushing usage events
2021-11-29 18:49:52.920431 (MainThread): Running with dbt=0.21.0
2021-11-29 18:49:52.986165 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/vscode/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-29 18:49:52.991534 (MainThread): Tracking: tracking
2021-11-29 18:49:52.993968 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff995d5940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ae71b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ae71d90>]}
2021-11-29 18:49:53.003434 (MainThread): Partial parsing not enabled
2021-11-29 18:49:53.019027 (MainThread): Parsing macros/catalog.sql
2021-11-29 18:49:53.021563 (MainThread): Parsing macros/adapters.sql
2021-11-29 18:49:53.031576 (MainThread): Parsing macros/materializations/seed.sql
2021-11-29 18:49:53.035258 (MainThread): Parsing macros/materializations/snapshot.sql
2021-11-29 18:49:53.036704 (MainThread): Parsing macros/materializations/table.sql
2021-11-29 18:49:53.040007 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-29 18:49:53.052763 (MainThread): Parsing macros/materializations/view.sql
2021-11-29 18:49:53.056719 (MainThread): Parsing macros/core.sql
2021-11-29 18:49:53.060136 (MainThread): Parsing macros/materializations/test.sql
2021-11-29 18:49:53.064905 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-29 18:49:53.070408 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-29 18:49:53.074580 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-29 18:49:53.079096 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-29 18:49:53.080761 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-29 18:49:53.087060 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-29 18:49:53.098123 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-29 18:49:53.109876 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-29 18:49:53.114461 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-29 18:49:53.122464 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-29 18:49:53.139694 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-29 18:49:53.148831 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-29 18:49:53.150214 (MainThread): Parsing macros/etc/query.sql
2021-11-29 18:49:53.151537 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-29 18:49:53.156097 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-29 18:49:53.157738 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-29 18:49:53.159195 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-29 18:49:53.161822 (MainThread): Parsing macros/etc/datetime.sql
2021-11-29 18:49:53.167099 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-29 18:49:53.168525 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-29 18:49:53.170523 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-29 18:49:53.172464 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-29 18:49:53.174745 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-29 18:49:53.176262 (MainThread): Parsing macros/adapters/common.sql
2021-11-29 18:49:53.284197 (MainThread): Acquiring new athena connection "model.my_new_project.test_model1".
2021-11-29 18:49:53.292467 (MainThread): Acquiring new athena connection "model.my_new_project.test_model2".
2021-11-29 18:49:53.295125 (MainThread): Acquiring new athena connection "model.my_new_project.test_model3".
2021-11-29 18:49:53.298075 (MainThread): Acquiring new athena connection "model.my_new_project.test_model4".
2021-11-29 18:49:53.300896 (MainThread): Acquiring new athena connection "model.my_new_project.test_model5".
2021-11-29 18:49:53.324943 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-11-29 18:49:53.329090 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e1992469-ce2d-47ec-b1a6-1cdaf153e9b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98fe5f10>]}
2021-11-29 18:49:53.341031 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-11-29 18:49:53.342585 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e1992469-ce2d-47ec-b1a6-1cdaf153e9b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98fe5d00>]}
2021-11-29 18:49:53.343778 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 4 seed files, 0 sources, 0 exposures
2021-11-29 18:49:53.346307 (MainThread): 
2021-11-29 18:49:53.347109 (MainThread): Acquiring new athena connection "master".
2021-11-29 18:49:53.349062 (ThreadPoolExecutor-0_0): Acquiring new athena connection "list_awsdatacatalog".
2021-11-29 18:49:53.356072 (ThreadPoolExecutor-0_0): Using athena connection "list_awsdatacatalog".
2021-11-29 18:49:53.357430 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
  
2021-11-29 18:49:53.358899 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-29 18:49:53.378667 (ThreadPoolExecutor-0_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
2021-11-29 18:49:55.149503 (ThreadPoolExecutor-0_0): SQL status: OK -1 in 1.79 seconds
2021-11-29 18:49:55.160144 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: Close
2021-11-29 18:49:55.169744 (ThreadPoolExecutor-2_0): Acquiring new athena connection "list_awsdatacatalog_dbt".
2021-11-29 18:49:55.172819 (ThreadPoolExecutor-2_0): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 33902), raddr=('52.1.206.68', 443)>
2021-11-29 18:49:55.190176 (ThreadPoolExecutor-2_0): Using athena connection "list_awsdatacatalog_dbt".
2021-11-29 18:49:55.191812 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
2021-11-29 18:49:55.197771 (ThreadPoolExecutor-2_0): Opening a new connection, currently in state closed
2021-11-29 18:49:55.224201 (ThreadPoolExecutor-2_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
2021-11-29 18:49:59.269753 (ThreadPoolExecutor-2_0): SQL status: OK -1 in 4.07 seconds
2021-11-29 18:49:59.282747 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: Close
2021-11-29 18:49:59.289736 (MainThread): 18:49:59 | Concurrency: 1 threads (target='dev')
2021-11-29 18:49:59.291757 (MainThread): 18:49:59 | 
2021-11-29 18:49:59.303650 (Thread-1): Began running node model.my_new_project.test_model1
2021-11-29 18:49:59.306767 (Thread-1): 18:49:59 | 1 of 5 START view model dbt.test_model1.............................. [RUN]
2021-11-29 18:49:59.313180 (Thread-1): Acquiring new athena connection "model.my_new_project.test_model1".
2021-11-29 18:49:59.316179 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 33904), raddr=('52.1.206.68', 443)>
2021-11-29 18:49:59.320763 (Thread-1): Compiling model.my_new_project.test_model1
2021-11-29 18:49:59.326453 (Thread-1): Writing injected SQL for node "model.my_new_project.test_model1"
2021-11-29 18:49:59.333491 (Thread-1): finished collecting timing info
2021-11-29 18:49:59.349642 (Thread-1): Writing runtime SQL for node "model.my_new_project.test_model1"
2021-11-29 18:49:59.354854 (Thread-1): Using athena connection "model.my_new_project.test_model1".
2021-11-29 18:49:59.356349 (Thread-1): On model.my_new_project.test_model1: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    /*
SELECT * FROM "defaultdb"."resby_puma_northeast" puma
inner join "defaultdb"."buildings" buildings
on puma.bldg_id=buildings.bldg_fid

limit 10;
*/

/* select * from dbt.Region_Table */

/* In plain english: select all from the "buildings" table where the state value is in the Region_Table state column.  */

SELECT * FROM "defaultdb"."buildings" buildings
left join dbt.Region_Table2 region
on buildings.state=region.state1
limit 10;

2021-11-29 18:49:59.358036 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 18:49:59.373926 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    /*
SELECT * FROM "defaultdb"."resby_puma_northeast" puma
inner join "defaultdb"."buildings" buildings
on puma.bldg_id=buildings.bldg_fid

limit 10;
*/

/* select * from dbt.Region_Table */

/* In plain english: select all from the "buildings" table where the state value is in the Region_Table state column.  */

SELECT * FROM "defaultdb"."buildings" buildings
left join dbt.Region_Table2 region
on buildings.state=region.state1
limit 10;
2021-11-29 18:50:01.226436 (Thread-1): SQL status: OK -1 in 1.87 seconds
2021-11-29 18:50:01.230434 (Thread-1): Using athena connection "model.my_new_project.test_model1".
2021-11-29 18:50:01.231558 (Thread-1): On model.my_new_project.test_model1: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
alter table dbt.test_model1 set tblproperties ('classification' = 'view')
2021-11-29 18:50:01.233154 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
alter table dbt.test_model1 set tblproperties ('classification' = 'view')
2021-11-29 18:50:03.103703 (Thread-1): SQL status: OK -1 in 1.87 seconds
2021-11-29 18:50:03.115662 (Thread-1): finished collecting timing info
2021-11-29 18:50:03.116804 (Thread-1): On model.my_new_project.test_model1: Close
2021-11-29 18:50:03.119819 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1992469-ce2d-47ec-b1a6-1cdaf153e9b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98295fa0>]}
2021-11-29 18:50:03.122592 (Thread-1): 18:50:03 | 1 of 5 OK created view model dbt.test_model1......................... [OK -1 in 3.81s]
2021-11-29 18:50:03.124949 (Thread-1): Finished running node model.my_new_project.test_model1
2021-11-29 18:50:03.127055 (Thread-1): Began running node model.my_new_project.test_model2
2021-11-29 18:50:03.129451 (Thread-1): 18:50:03 | 2 of 5 START view model dbt.test_model2.............................. [RUN]
2021-11-29 18:50:03.131797 (Thread-1): Acquiring new athena connection "model.my_new_project.test_model2".
2021-11-29 18:50:03.133998 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 33906), raddr=('52.1.206.68', 443)>
2021-11-29 18:50:03.136148 (Thread-1): Compiling model.my_new_project.test_model2
2021-11-29 18:50:03.140042 (Thread-1): Writing injected SQL for node "model.my_new_project.test_model2"
2021-11-29 18:50:03.144223 (Thread-1): finished collecting timing info
2021-11-29 18:50:03.147573 (Thread-1): Writing runtime SQL for node "model.my_new_project.test_model2"
2021-11-29 18:50:03.151061 (Thread-1): Using athena connection "model.my_new_project.test_model2".
2021-11-29 18:50:03.152337 (Thread-1): On model.my_new_project.test_model2: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    SELECT * FROM "defaultdb"."buildings" buildings
inner join dbt.Random_Small_Towns region
on buildings.state=region.state
limit 10;

2021-11-29 18:50:03.153686 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 18:50:03.170243 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    SELECT * FROM "defaultdb"."buildings" buildings
inner join dbt.Random_Small_Towns region
on buildings.state=region.state
limit 10;
2021-11-29 18:50:04.612798 (Thread-1): Error running SQL: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    SELECT * FROM "defaultdb"."buildings" buildings
inner join dbt.Random_Small_Towns region
on buildings.state=region.state
limit 10;

2021-11-29 18:50:04.615612 (Thread-1): finished collecting timing info
2021-11-29 18:50:04.618210 (Thread-1): On model.my_new_project.test_model2: Close
2021-11-29 18:50:04.621631 (Thread-1): Runtime Error in model test_model2 (models/test_model2.sql)
  com.facebook.presto.v217.sql.analyzer.SemanticException: line 2:1: Column name 'city' specified more than once
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 100, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 90, in execute
    raise OperationalError(query_execution.state_change_reason)
pyathena.error.OperationalError: com.facebook.presto.v217.sql.analyzer.SemanticException: line 2:1: Column name 'city' specified more than once

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 66, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 103, in exception_handler
    raise RuntimeException(str(e)) from e
dbt.exceptions.RuntimeException: Runtime Error in model test_model2 (models/test_model2.sql)
  com.facebook.presto.v217.sql.analyzer.SemanticException: line 2:1: Column name 'city' specified more than once
2021-11-29 18:50:04.625829 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1992469-ce2d-47ec-b1a6-1cdaf153e9b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98469fa0>]}
2021-11-29 18:50:04.628006 (Thread-1): 18:50:04 | 2 of 5 ERROR creating view model dbt.test_model2..................... [ERROR in 1.49s]
2021-11-29 18:50:04.629927 (Thread-1): Finished running node model.my_new_project.test_model2
2021-11-29 18:50:04.633340 (Thread-1): Began running node model.my_new_project.test_model3
2021-11-29 18:50:04.635239 (Thread-1): 18:50:04 | 3 of 5 SKIP relation dbt.test_model3................................. [SKIP]
2021-11-29 18:50:04.637491 (Thread-1): Finished running node model.my_new_project.test_model3
2021-11-29 18:50:04.639719 (Thread-1): Began running node model.my_new_project.test_model4
2021-11-29 18:50:04.641651 (Thread-1): 18:50:04 | 4 of 5 SKIP relation dbt.test_model4................................. [SKIP]
2021-11-29 18:50:04.643981 (Thread-1): Finished running node model.my_new_project.test_model4
2021-11-29 18:50:04.646355 (Thread-1): Began running node model.my_new_project.test_model5
2021-11-29 18:50:04.648748 (Thread-1): 18:50:04 | 5 of 5 SKIP relation dbt.test_model5................................. [SKIP]
2021-11-29 18:50:04.649565 (Thread-1): Finished running node model.my_new_project.test_model5
2021-11-29 18:50:04.652225 (MainThread): Acquiring new athena connection "master".
2021-11-29 18:50:04.653773 (MainThread): 18:50:04 | 
2021-11-29 18:50:04.655227 (MainThread): 18:50:04 | Finished running 5 view models in 11.31s.
2021-11-29 18:50:04.658077 (MainThread): Connection 'master' was properly closed.
2021-11-29 18:50:04.660814 (MainThread): Connection 'model.my_new_project.test_model2' was properly closed.
2021-11-29 18:50:04.663296 (MainThread): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 33908), raddr=('52.1.206.68', 443)>
2021-11-29 18:50:04.677485 (MainThread): 
2021-11-29 18:50:04.679217 (MainThread): Completed with 1 error and 0 warnings:
2021-11-29 18:50:04.680202 (MainThread): 
2021-11-29 18:50:04.681786 (MainThread): Runtime Error in model test_model2 (models/test_model2.sql)
2021-11-29 18:50:04.683510 (MainThread):   com.facebook.presto.v217.sql.analyzer.SemanticException: line 2:1: Column name 'city' specified more than once
2021-11-29 18:50:04.685354 (MainThread): 
Done. PASS=1 WARN=0 ERROR=1 SKIP=3 TOTAL=5
2021-11-29 18:50:04.686967 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98561d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ae13d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff980d5d00>]}
2021-11-29 18:50:04.690119 (MainThread): Flushing usage events
2021-11-29 18:55:14.940060 (MainThread): Running with dbt=0.21.0
2021-11-29 18:55:15.014719 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/vscode/.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', select=None, selector_name=None, show=False, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='seed', write_json=True)
2021-11-29 18:55:15.021719 (MainThread): Tracking: tracking
2021-11-29 18:55:15.027904 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83e805e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8571c1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8571cdf0>]}
2021-11-29 18:55:15.036791 (MainThread): Partial parsing not enabled
2021-11-29 18:55:15.080035 (MainThread): Parsing macros/catalog.sql
2021-11-29 18:55:15.082934 (MainThread): Parsing macros/adapters.sql
2021-11-29 18:55:15.092128 (MainThread): Parsing macros/materializations/seed.sql
2021-11-29 18:55:15.095153 (MainThread): Parsing macros/materializations/snapshot.sql
2021-11-29 18:55:15.096333 (MainThread): Parsing macros/materializations/table.sql
2021-11-29 18:55:15.099411 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-29 18:55:15.112017 (MainThread): Parsing macros/materializations/view.sql
2021-11-29 18:55:15.115434 (MainThread): Parsing macros/core.sql
2021-11-29 18:55:15.118042 (MainThread): Parsing macros/materializations/test.sql
2021-11-29 18:55:15.123056 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-29 18:55:15.129153 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-29 18:55:15.133119 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-29 18:55:15.137560 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-29 18:55:15.139326 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-29 18:55:15.145774 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-29 18:55:15.156337 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-29 18:55:15.167970 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-29 18:55:15.172395 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-29 18:55:15.180494 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-29 18:55:15.198933 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-29 18:55:15.209090 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-29 18:55:15.210832 (MainThread): Parsing macros/etc/query.sql
2021-11-29 18:55:15.212034 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-29 18:55:15.215703 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-29 18:55:15.217757 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-29 18:55:15.220675 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-29 18:55:15.222141 (MainThread): Parsing macros/etc/datetime.sql
2021-11-29 18:55:15.228236 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-29 18:55:15.229911 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-29 18:55:15.232621 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-29 18:55:15.234026 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-29 18:55:15.236333 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-29 18:55:15.238489 (MainThread): Parsing macros/adapters/common.sql
2021-11-29 18:55:15.344223 (MainThread): Acquiring new athena connection "model.my_new_project.test_model1".
2021-11-29 18:55:15.352272 (MainThread): Acquiring new athena connection "model.my_new_project.test_model2".
2021-11-29 18:55:15.354959 (MainThread): Acquiring new athena connection "model.my_new_project.test_model3".
2021-11-29 18:55:15.359591 (MainThread): Acquiring new athena connection "model.my_new_project.test_model4".
2021-11-29 18:55:15.362764 (MainThread): Acquiring new athena connection "model.my_new_project.test_model5".
2021-11-29 18:55:15.389749 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-11-29 18:55:15.393699 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7eec1a07-27d2-4493-981d-0221a05efc61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83890b50>]}
2021-11-29 18:55:15.406088 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-11-29 18:55:15.407961 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7eec1a07-27d2-4493-981d-0221a05efc61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff838907f0>]}
2021-11-29 18:55:15.409115 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 5 seed files, 0 sources, 0 exposures
2021-11-29 18:55:15.411527 (MainThread): 
2021-11-29 18:55:15.412383 (MainThread): Acquiring new athena connection "master".
2021-11-29 18:55:15.414412 (ThreadPoolExecutor-0_0): Acquiring new athena connection "list_awsdatacatalog".
2021-11-29 18:55:15.421664 (ThreadPoolExecutor-0_0): Using athena connection "list_awsdatacatalog".
2021-11-29 18:55:15.423044 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
  
2021-11-29 18:55:15.425071 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-29 18:55:15.454505 (ThreadPoolExecutor-0_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
2021-11-29 18:55:17.348596 (ThreadPoolExecutor-0_0): SQL status: OK -1 in 1.92 seconds
2021-11-29 18:55:17.359403 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: Close
2021-11-29 18:55:17.368109 (ThreadPoolExecutor-2_0): Acquiring new athena connection "list_awsdatacatalog_dbt".
2021-11-29 18:55:17.371881 (ThreadPoolExecutor-2_0): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 44328), raddr=('18.208.66.56', 443)>
2021-11-29 18:55:17.389535 (ThreadPoolExecutor-2_0): Using athena connection "list_awsdatacatalog_dbt".
2021-11-29 18:55:17.391003 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
2021-11-29 18:55:17.395380 (ThreadPoolExecutor-2_0): Opening a new connection, currently in state closed
2021-11-29 18:55:17.424887 (ThreadPoolExecutor-2_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
2021-11-29 18:55:21.378921 (ThreadPoolExecutor-2_0): SQL status: OK -1 in 3.98 seconds
2021-11-29 18:55:21.387915 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: Close
2021-11-29 18:55:21.395519 (MainThread): 18:55:21 | Concurrency: 1 threads (target='dev')
2021-11-29 18:55:21.398602 (MainThread): 18:55:21 | 
2021-11-29 18:55:21.405887 (Thread-1): Began running node seed.my_new_project.Random_Small_Towns
2021-11-29 18:55:21.409366 (Thread-1): 18:55:21 | 1 of 5 START seed file dbt.Random_Small_Towns........................ [RUN]
2021-11-29 18:55:21.414102 (Thread-1): Acquiring new athena connection "seed.my_new_project.Random_Small_Towns".
2021-11-29 18:55:21.417841 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 44330), raddr=('18.208.66.56', 443)>
2021-11-29 18:55:21.422301 (Thread-1): finished collecting timing info
2021-11-29 18:55:21.436887 (Thread-1): finished collecting timing info
2021-11-29 18:55:21.437944 (Thread-1): Compilation Error in seed Random_Small_Towns (data/Random_Small_Towns.csv)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete dbt.random_small_towns, or rename it to be less ambiguous.
  Searched for: dbt.Random_Small_Towns
  Found: dbt.random_small_towns
  
  > in macro materialization_seed_default (macros/materializations/seed/seed.sql)
  > called by seed Random_Small_Towns (data/Random_Small_Towns.csv)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 39, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 734, in get_relation
    matches = self._make_match(relations_list, database, schema,
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 723, in _make_match
    if relation.matches(**search):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/relation.py", line 99, in matches
    dbt.exceptions.approximate_relation_match(target, self)
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 741, in approximate_relation_match
    raise_compiler_error(
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 444, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in seed Random_Small_Towns (data/Random_Small_Towns.csv)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete dbt.random_small_towns, or rename it to be less ambiguous.
  Searched for: dbt.Random_Small_Towns
  Found: dbt.random_small_towns
  
  > in macro materialization_seed_default (macros/materializations/seed/seed.sql)
  > called by seed Random_Small_Towns (data/Random_Small_Towns.csv)
2021-11-29 18:55:21.444853 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7eec1a07-27d2-4493-981d-0221a05efc61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff837eff10>]}
2021-11-29 18:55:21.447694 (Thread-1): 18:55:21 | 1 of 5 ERROR loading seed file dbt.Random_Small_Towns................ [ERROR in 0.03s]
2021-11-29 18:55:21.449512 (Thread-1): Finished running node seed.my_new_project.Random_Small_Towns
2021-11-29 18:55:21.451089 (Thread-1): Began running node seed.my_new_project.Random_Small_Towns1
2021-11-29 18:55:21.453295 (Thread-1): 18:55:21 | 2 of 5 START seed file dbt.Random_Small_Towns1....................... [RUN]
2021-11-29 18:55:21.455647 (Thread-1): Acquiring new athena connection "seed.my_new_project.Random_Small_Towns1".
2021-11-29 18:55:21.458022 (Thread-1): finished collecting timing info
2021-11-29 18:55:21.473968 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-11-29 18:55:21.476597 (Thread-1): * Deprecation Warning: The quote_columns parameter was not set for seeds, so the
default value of False was chosen. The default will change to True in a future
release.

For more information, see:
https://docs.getdbt.com/v0.15/docs/seeds#section-specify-column-quoting
2021-11-29 18:55:21.479682 (Thread-1): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7eec1a07-27d2-4493-981d-0221a05efc61', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff812b09d0>]}
2021-11-29 18:55:21.482532 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-11-29 18:55:21.487897 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-11-29 18:55:21.490445 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-11-29 18:55:21.492486 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-11-29 18:55:21.494808 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 18:55:21.513469 (Thread-1): Using athena connection "seed.my_new_project.Random_Small_Towns1".
2021-11-29 18:55:21.514605 (Thread-1): On seed.my_new_project.Random_Small_Towns1: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "seed.my_new_project.Random_Small_Towns1"} */

    create external table dbt.Random_Small_Towns1 (Zip integer, City1 string, County string, State1 string, Region string)
    stored as parquet
    location 's3://justin-dbt-testing/Targettables/2f6b97d4-522b-47b6-b203-4b7f77a84211/'
    tblproperties ('classification'='parquet')
  
2021-11-29 18:55:21.516850 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "seed.my_new_project.Random_Small_Towns1"} */

    create external table dbt.Random_Small_Towns1 (Zip integer, City1 string, County string, State1 string, Region string)
    stored as parquet
    location 's3://justin-dbt-testing/Targettables/2f6b97d4-522b-47b6-b203-4b7f77a84211/'
    tblproperties ('classification'='parquet')
2021-11-29 18:55:23.251694 (Thread-1): SQL status: OK -1 in 1.73 seconds
2021-11-29 18:55:23.299784 (Thread-1): Using athena connection "seed.my_new_project.Random_Small_Towns1".
2021-11-29 18:55:23.301755 (Thread-1): On seed.my_new_project.Random_Small_Towns1: 
          insert into dbt.Random_Small_Towns1 (Zip, City1, County, State1, Region) values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s)
      ...
2021-11-29 18:55:23.306179 (Thread-1): insert into dbt.Random_Small_Towns1 (Zip, City1, County, State1, Region) values
          (4101,'Portland','Cumberland','ME','Northeast'),(4027,'Lebanon','York','ME','Northeast'),(4430,'Millinocket','Penobscot','ME','Northeast'),(33514,'Center Hill','Sumter','FL','Southeast'),(33935,'Muce','Glades','FL','Southeast'),(33040,'Key West','Monroe','FL','Southeast'),(54751,'Menomonie','Dunn','WI','Midwest'),(54011,'El Paso','Pierce','WI','Midwest'),(55043,'Lakeland','Washington','MN','Midwest'),(86321,'Bagdad','Yavapai','AZ','Southwest'),(85937,'Snowflake','Navajo','AZ','Southwest'),(85539,'Miami','Gila','AZ','Southwest'),(98851,'Soap Lake','Grant','WA','Northwest'),(99022,'Medical Lake','Spokane','WA','Northwest'),(99148,'Loon Lake','Stevens','WA','Northwest'),(99723,'Utqiagvik','North Slope','AK','Alaska'),(99762,'Nome','Unorganized','AK','Alaska'),(99686,'Valdez','Chugach','AK','Alaska'),(96777,'Phala','Hawaii','HI','Hawaii'),(96761,'Kapalua','Maui','HI','Hawaii'),(96769,'Puuwai','Kauai','HI','Hawaii')
2021-11-29 18:55:25.971790 (Thread-1): SQL status: OK -1 in 2.67 seconds
2021-11-29 18:55:25.987972 (Thread-1): Writing runtime SQL for node "seed.my_new_project.Random_Small_Towns1"
2021-11-29 18:55:26.018006 (Thread-1): finished collecting timing info
2021-11-29 18:55:26.019746 (Thread-1): On seed.my_new_project.Random_Small_Towns1: Close
2021-11-29 18:55:26.023361 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7eec1a07-27d2-4493-981d-0221a05efc61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff838e44c0>]}
2021-11-29 18:55:26.026081 (Thread-1): 18:55:26 | 2 of 5 OK loaded seed file dbt.Random_Small_Towns1................... [INSERT 21 in 4.57s]
2021-11-29 18:55:26.029370 (Thread-1): Finished running node seed.my_new_project.Random_Small_Towns1
2021-11-29 18:55:26.031824 (Thread-1): Began running node seed.my_new_project.Region_Table
2021-11-29 18:55:26.034647 (Thread-1): 18:55:26 | 3 of 5 START seed file dbt.Region_Table.............................. [RUN]
2021-11-29 18:55:26.037502 (Thread-1): Acquiring new athena connection "seed.my_new_project.Region_Table".
2021-11-29 18:55:26.039738 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 44332), raddr=('18.208.66.56', 443)>
2021-11-29 18:55:26.041579 (Thread-1): finished collecting timing info
2021-11-29 18:55:26.045134 (Thread-1): finished collecting timing info
2021-11-29 18:55:26.047802 (Thread-1): Compilation Error in seed Region_Table (data/Region_Table.csv)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete dbt.region_table, or rename it to be less ambiguous.
  Searched for: dbt.Region_Table
  Found: dbt.region_table
  
  > in macro materialization_seed_default (macros/materializations/seed/seed.sql)
  > called by seed Region_Table (data/Region_Table.csv)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 39, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 734, in get_relation
    matches = self._make_match(relations_list, database, schema,
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 723, in _make_match
    if relation.matches(**search):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/relation.py", line 99, in matches
    dbt.exceptions.approximate_relation_match(target, self)
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 741, in approximate_relation_match
    raise_compiler_error(
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 444, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in seed Region_Table (data/Region_Table.csv)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete dbt.region_table, or rename it to be less ambiguous.
  Searched for: dbt.Region_Table
  Found: dbt.region_table
  
  > in macro materialization_seed_default (macros/materializations/seed/seed.sql)
  > called by seed Region_Table (data/Region_Table.csv)
2021-11-29 18:55:26.051694 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7eec1a07-27d2-4493-981d-0221a05efc61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81295280>]}
2021-11-29 18:55:26.053904 (Thread-1): 18:55:26 | 3 of 5 ERROR loading seed file dbt.Region_Table...................... [ERROR in 0.01s]
2021-11-29 18:55:26.057376 (Thread-1): Finished running node seed.my_new_project.Region_Table
2021-11-29 18:55:26.059634 (Thread-1): Began running node seed.my_new_project.Region_Table1
2021-11-29 18:55:26.061111 (Thread-1): 18:55:26 | 4 of 5 START seed file dbt.Region_Table1............................. [RUN]
2021-11-29 18:55:26.062687 (Thread-1): Acquiring new athena connection "seed.my_new_project.Region_Table1".
2021-11-29 18:55:26.065348 (Thread-1): finished collecting timing info
2021-11-29 18:55:26.068531 (Thread-1): finished collecting timing info
2021-11-29 18:55:26.069374 (Thread-1): Compilation Error in seed Region_Table1 (data/Region_Table1.csv)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete dbt.region_table1, or rename it to be less ambiguous.
  Searched for: dbt.Region_Table1
  Found: dbt.region_table1
  
  > in macro materialization_seed_default (macros/materializations/seed/seed.sql)
  > called by seed Region_Table1 (data/Region_Table1.csv)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 39, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 734, in get_relation
    matches = self._make_match(relations_list, database, schema,
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 723, in _make_match
    if relation.matches(**search):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/relation.py", line 99, in matches
    dbt.exceptions.approximate_relation_match(target, self)
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 741, in approximate_relation_match
    raise_compiler_error(
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 444, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in seed Region_Table1 (data/Region_Table1.csv)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete dbt.region_table1, or rename it to be less ambiguous.
  Searched for: dbt.Region_Table1
  Found: dbt.region_table1
  
  > in macro materialization_seed_default (macros/materializations/seed/seed.sql)
  > called by seed Region_Table1 (data/Region_Table1.csv)
2021-11-29 18:55:26.072152 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7eec1a07-27d2-4493-981d-0221a05efc61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81102700>]}
2021-11-29 18:55:26.074545 (Thread-1): 18:55:26 | 4 of 5 ERROR loading seed file dbt.Region_Table1..................... [ERROR in 0.01s]
2021-11-29 18:55:26.075867 (Thread-1): Finished running node seed.my_new_project.Region_Table1
2021-11-29 18:55:26.077568 (Thread-1): Began running node seed.my_new_project.Region_Table2
2021-11-29 18:55:26.079521 (Thread-1): 18:55:26 | 5 of 5 START seed file dbt.Region_Table2............................. [RUN]
2021-11-29 18:55:26.081391 (Thread-1): Acquiring new athena connection "seed.my_new_project.Region_Table2".
2021-11-29 18:55:26.082963 (Thread-1): finished collecting timing info
2021-11-29 18:55:26.085970 (Thread-1): finished collecting timing info
2021-11-29 18:55:26.087316 (Thread-1): Compilation Error in seed Region_Table2 (data/Region_Table2.csv)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete dbt.region_table2, or rename it to be less ambiguous.
  Searched for: dbt.Region_Table2
  Found: dbt.region_table2
  
  > in macro materialization_seed_default (macros/materializations/seed/seed.sql)
  > called by seed Region_Table2 (data/Region_Table2.csv)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 39, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 734, in get_relation
    matches = self._make_match(relations_list, database, schema,
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 723, in _make_match
    if relation.matches(**search):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/relation.py", line 99, in matches
    dbt.exceptions.approximate_relation_match(target, self)
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 741, in approximate_relation_match
    raise_compiler_error(
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 444, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in seed Region_Table2 (data/Region_Table2.csv)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete dbt.region_table2, or rename it to be less ambiguous.
  Searched for: dbt.Region_Table2
  Found: dbt.region_table2
  
  > in macro materialization_seed_default (macros/materializations/seed/seed.sql)
  > called by seed Region_Table2 (data/Region_Table2.csv)
2021-11-29 18:55:26.090927 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7eec1a07-27d2-4493-981d-0221a05efc61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83810a00>]}
2021-11-29 18:55:26.093059 (Thread-1): 18:55:26 | 5 of 5 ERROR loading seed file dbt.Region_Table2..................... [ERROR in 0.01s]
2021-11-29 18:55:26.095345 (Thread-1): Finished running node seed.my_new_project.Region_Table2
2021-11-29 18:55:26.098961 (MainThread): Acquiring new athena connection "master".
2021-11-29 18:55:26.103358 (MainThread): 18:55:26 | 
2021-11-29 18:55:26.105121 (MainThread): 18:55:26 | Finished running 5 seeds in 10.69s.
2021-11-29 18:55:26.107738 (MainThread): Connection 'master' was properly closed.
2021-11-29 18:55:26.109445 (MainThread): Connection 'seed.my_new_project.Region_Table2' was properly closed.
2021-11-29 18:55:26.126179 (MainThread): 
2021-11-29 18:55:26.127049 (MainThread): Completed with 4 errors and 0 warnings:
2021-11-29 18:55:26.129318 (MainThread): 
2021-11-29 18:55:26.131505 (MainThread): Compilation Error in seed Random_Small_Towns (data/Random_Small_Towns.csv)
2021-11-29 18:55:26.133565 (MainThread):   When searching for a relation, dbt found an approximate match. Instead of guessing 
2021-11-29 18:55:26.135991 (MainThread):   which relation to use, dbt will move on. Please delete dbt.random_small_towns, or rename it to be less ambiguous.
2021-11-29 18:55:26.139244 (MainThread):   Searched for: dbt.Random_Small_Towns
2021-11-29 18:55:26.141914 (MainThread):   Found: dbt.random_small_towns
2021-11-29 18:55:26.145178 (MainThread):   
2021-11-29 18:55:26.147426 (MainThread):   > in macro materialization_seed_default (macros/materializations/seed/seed.sql)
2021-11-29 18:55:26.149828 (MainThread):   > called by seed Random_Small_Towns (data/Random_Small_Towns.csv)
2021-11-29 18:55:26.151646 (MainThread): 
2021-11-29 18:55:26.154673 (MainThread): Compilation Error in seed Region_Table (data/Region_Table.csv)
2021-11-29 18:55:26.156486 (MainThread):   When searching for a relation, dbt found an approximate match. Instead of guessing 
2021-11-29 18:55:26.158021 (MainThread):   which relation to use, dbt will move on. Please delete dbt.region_table, or rename it to be less ambiguous.
2021-11-29 18:55:26.159840 (MainThread):   Searched for: dbt.Region_Table
2021-11-29 18:55:26.161666 (MainThread):   Found: dbt.region_table
2021-11-29 18:55:26.163403 (MainThread):   
2021-11-29 18:55:26.167308 (MainThread):   > in macro materialization_seed_default (macros/materializations/seed/seed.sql)
2021-11-29 18:55:26.169354 (MainThread):   > called by seed Region_Table (data/Region_Table.csv)
2021-11-29 18:55:26.173041 (MainThread): 
2021-11-29 18:55:26.174717 (MainThread): Compilation Error in seed Region_Table1 (data/Region_Table1.csv)
2021-11-29 18:55:26.176668 (MainThread):   When searching for a relation, dbt found an approximate match. Instead of guessing 
2021-11-29 18:55:26.179089 (MainThread):   which relation to use, dbt will move on. Please delete dbt.region_table1, or rename it to be less ambiguous.
2021-11-29 18:55:26.181142 (MainThread):   Searched for: dbt.Region_Table1
2021-11-29 18:55:26.183161 (MainThread):   Found: dbt.region_table1
2021-11-29 18:55:26.184987 (MainThread):   
2021-11-29 18:55:26.187240 (MainThread):   > in macro materialization_seed_default (macros/materializations/seed/seed.sql)
2021-11-29 18:55:26.190151 (MainThread):   > called by seed Region_Table1 (data/Region_Table1.csv)
2021-11-29 18:55:26.191990 (MainThread): 
2021-11-29 18:55:26.194007 (MainThread): Compilation Error in seed Region_Table2 (data/Region_Table2.csv)
2021-11-29 18:55:26.195995 (MainThread):   When searching for a relation, dbt found an approximate match. Instead of guessing 
2021-11-29 18:55:26.197567 (MainThread):   which relation to use, dbt will move on. Please delete dbt.region_table2, or rename it to be less ambiguous.
2021-11-29 18:55:26.199395 (MainThread):   Searched for: dbt.Region_Table2
2021-11-29 18:55:26.201946 (MainThread):   Found: dbt.region_table2
2021-11-29 18:55:26.206076 (MainThread):   
2021-11-29 18:55:26.208404 (MainThread):   > in macro materialization_seed_default (macros/materializations/seed/seed.sql)
2021-11-29 18:55:26.212347 (MainThread):   > called by seed Region_Table2 (data/Region_Table2.csv)
2021-11-29 18:55:26.215005 (MainThread): 
Done. PASS=1 WARN=0 ERROR=4 SKIP=0 TOTAL=5
2021-11-29 18:55:26.218024 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82370c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff856bce50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8573c2b0>]}
2021-11-29 18:55:26.220303 (MainThread): Flushing usage events
2021-11-29 18:55:29.635968 (MainThread): Running with dbt=0.21.0
2021-11-29 18:55:29.700818 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/vscode/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-29 18:55:29.705410 (MainThread): Tracking: tracking
2021-11-29 18:55:29.708867 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e5b75e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fe53be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fe53e80>]}
2021-11-29 18:55:29.718376 (MainThread): Partial parsing not enabled
2021-11-29 18:55:29.735243 (MainThread): Parsing macros/catalog.sql
2021-11-29 18:55:29.737911 (MainThread): Parsing macros/adapters.sql
2021-11-29 18:55:29.746946 (MainThread): Parsing macros/materializations/seed.sql
2021-11-29 18:55:29.750442 (MainThread): Parsing macros/materializations/snapshot.sql
2021-11-29 18:55:29.751655 (MainThread): Parsing macros/materializations/table.sql
2021-11-29 18:55:29.755502 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-29 18:55:29.769258 (MainThread): Parsing macros/materializations/view.sql
2021-11-29 18:55:29.773121 (MainThread): Parsing macros/core.sql
2021-11-29 18:55:29.776449 (MainThread): Parsing macros/materializations/test.sql
2021-11-29 18:55:29.781328 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-29 18:55:29.787057 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-29 18:55:29.790305 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-29 18:55:29.794626 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-29 18:55:29.797240 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-29 18:55:29.803449 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-29 18:55:29.815950 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-29 18:55:29.829069 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-29 18:55:29.834357 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-29 18:55:29.842634 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-29 18:55:29.859953 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-29 18:55:29.869165 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-29 18:55:29.870590 (MainThread): Parsing macros/etc/query.sql
2021-11-29 18:55:29.872628 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-29 18:55:29.875581 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-29 18:55:29.877895 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-29 18:55:29.880155 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-29 18:55:29.881674 (MainThread): Parsing macros/etc/datetime.sql
2021-11-29 18:55:29.887852 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-29 18:55:29.889969 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-29 18:55:29.892791 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-29 18:55:29.894001 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-29 18:55:29.896406 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-29 18:55:29.898001 (MainThread): Parsing macros/adapters/common.sql
2021-11-29 18:55:30.004608 (MainThread): Acquiring new athena connection "model.my_new_project.test_model1".
2021-11-29 18:55:30.012843 (MainThread): Acquiring new athena connection "model.my_new_project.test_model2".
2021-11-29 18:55:30.015300 (MainThread): Acquiring new athena connection "model.my_new_project.test_model3".
2021-11-29 18:55:30.018427 (MainThread): Acquiring new athena connection "model.my_new_project.test_model4".
2021-11-29 18:55:30.021868 (MainThread): Acquiring new athena connection "model.my_new_project.test_model5".
2021-11-29 18:55:30.048661 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-11-29 18:55:30.052723 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0adb1892-9efa-416e-ba75-0110b781fef4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dfc6910>]}
2021-11-29 18:55:30.064899 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-11-29 18:55:30.066675 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0adb1892-9efa-416e-ba75-0110b781fef4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dfc6ac0>]}
2021-11-29 18:55:30.067685 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 5 seed files, 0 sources, 0 exposures
2021-11-29 18:55:30.071262 (MainThread): 
2021-11-29 18:55:30.072106 (MainThread): Acquiring new athena connection "master".
2021-11-29 18:55:30.074635 (ThreadPoolExecutor-0_0): Acquiring new athena connection "list_awsdatacatalog".
2021-11-29 18:55:30.081652 (ThreadPoolExecutor-0_0): Using athena connection "list_awsdatacatalog".
2021-11-29 18:55:30.082394 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
  
2021-11-29 18:55:30.084563 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-29 18:55:30.104391 (ThreadPoolExecutor-0_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
2021-11-29 18:55:31.895707 (ThreadPoolExecutor-0_0): SQL status: OK -1 in 1.81 seconds
2021-11-29 18:55:31.905123 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: Close
2021-11-29 18:55:31.911565 (ThreadPoolExecutor-2_0): Acquiring new athena connection "list_awsdatacatalog_dbt".
2021-11-29 18:55:31.916138 (ThreadPoolExecutor-2_0): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 44336), raddr=('18.208.66.56', 443)>
2021-11-29 18:55:31.930051 (ThreadPoolExecutor-2_0): Using athena connection "list_awsdatacatalog_dbt".
2021-11-29 18:55:31.931839 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
2021-11-29 18:55:31.935642 (ThreadPoolExecutor-2_0): Opening a new connection, currently in state closed
2021-11-29 18:55:31.962459 (ThreadPoolExecutor-2_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
2021-11-29 18:55:35.894467 (ThreadPoolExecutor-2_0): SQL status: OK -1 in 3.96 seconds
2021-11-29 18:55:35.902535 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: Close
2021-11-29 18:55:35.907770 (MainThread): 18:55:35 | Concurrency: 1 threads (target='dev')
2021-11-29 18:55:35.911373 (MainThread): 18:55:35 | 
2021-11-29 18:55:35.924775 (Thread-1): Began running node model.my_new_project.test_model1
2021-11-29 18:55:35.926884 (Thread-1): 18:55:35 | 1 of 5 START view model dbt.test_model1.............................. [RUN]
2021-11-29 18:55:35.931704 (Thread-1): Acquiring new athena connection "model.my_new_project.test_model1".
2021-11-29 18:55:35.936490 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 44338), raddr=('18.208.66.56', 443)>
2021-11-29 18:55:35.940631 (Thread-1): Compiling model.my_new_project.test_model1
2021-11-29 18:55:35.947513 (Thread-1): Writing injected SQL for node "model.my_new_project.test_model1"
2021-11-29 18:55:35.954058 (Thread-1): finished collecting timing info
2021-11-29 18:55:35.969842 (Thread-1): Writing runtime SQL for node "model.my_new_project.test_model1"
2021-11-29 18:55:35.973999 (Thread-1): Using athena connection "model.my_new_project.test_model1".
2021-11-29 18:55:35.974943 (Thread-1): On model.my_new_project.test_model1: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    /*
SELECT * FROM "defaultdb"."resby_puma_northeast" puma
inner join "defaultdb"."buildings" buildings
on puma.bldg_id=buildings.bldg_fid

limit 10;
*/

/* select * from dbt.Region_Table */

/* In plain english: select all from the "buildings" table where the state value is in the Region_Table state column.  */

SELECT * FROM "defaultdb"."buildings" buildings
left join dbt.Region_Table2 region
on buildings.state=region.state1
limit 10;

2021-11-29 18:55:35.976441 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 18:55:35.992890 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    /*
SELECT * FROM "defaultdb"."resby_puma_northeast" puma
inner join "defaultdb"."buildings" buildings
on puma.bldg_id=buildings.bldg_fid

limit 10;
*/

/* select * from dbt.Region_Table */

/* In plain english: select all from the "buildings" table where the state value is in the Region_Table state column.  */

SELECT * FROM "defaultdb"."buildings" buildings
left join dbt.Region_Table2 region
on buildings.state=region.state1
limit 10;
2021-11-29 18:55:37.702614 (Thread-1): SQL status: OK -1 in 1.73 seconds
2021-11-29 18:55:37.719657 (Thread-1): Using athena connection "model.my_new_project.test_model1".
2021-11-29 18:55:37.722498 (Thread-1): On model.my_new_project.test_model1: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
alter table dbt.test_model1 set tblproperties ('classification' = 'view')
2021-11-29 18:55:37.730715 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
alter table dbt.test_model1 set tblproperties ('classification' = 'view')
2021-11-29 18:55:39.257725 (Thread-1): SQL status: OK -1 in 1.53 seconds
2021-11-29 18:55:39.269288 (Thread-1): finished collecting timing info
2021-11-29 18:55:39.270667 (Thread-1): On model.my_new_project.test_model1: Close
2021-11-29 18:55:39.273945 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0adb1892-9efa-416e-ba75-0110b781fef4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ca70d00>]}
2021-11-29 18:55:39.277610 (Thread-1): 18:55:39 | 1 of 5 OK created view model dbt.test_model1......................... [OK -1 in 3.34s]
2021-11-29 18:55:39.282028 (Thread-1): Finished running node model.my_new_project.test_model1
2021-11-29 18:55:39.284604 (Thread-1): Began running node model.my_new_project.test_model2
2021-11-29 18:55:39.287750 (Thread-1): 18:55:39 | 2 of 5 START view model dbt.test_model2.............................. [RUN]
2021-11-29 18:55:39.289887 (Thread-1): Acquiring new athena connection "model.my_new_project.test_model2".
2021-11-29 18:55:39.292063 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 44340), raddr=('18.208.66.56', 443)>
2021-11-29 18:55:39.294103 (Thread-1): Compiling model.my_new_project.test_model2
2021-11-29 18:55:39.297643 (Thread-1): Writing injected SQL for node "model.my_new_project.test_model2"
2021-11-29 18:55:39.302929 (Thread-1): finished collecting timing info
2021-11-29 18:55:39.305649 (Thread-1): Writing runtime SQL for node "model.my_new_project.test_model2"
2021-11-29 18:55:39.311422 (Thread-1): Using athena connection "model.my_new_project.test_model2".
2021-11-29 18:55:39.312506 (Thread-1): On model.my_new_project.test_model2: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    SELECT * FROM "defaultdb"."buildings" buildings
inner join dbt.Random_Small_Towns1 region
on buildings.state=region.state1
limit 10;

2021-11-29 18:55:39.315360 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 18:55:39.331971 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    SELECT * FROM "defaultdb"."buildings" buildings
inner join dbt.Random_Small_Towns1 region
on buildings.state=region.state1
limit 10;
2021-11-29 18:55:41.027592 (Thread-1): SQL status: OK -1 in 1.71 seconds
2021-11-29 18:55:41.037844 (Thread-1): Using athena connection "model.my_new_project.test_model2".
2021-11-29 18:55:41.041718 (Thread-1): On model.my_new_project.test_model2: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
alter table dbt.test_model2 set tblproperties ('classification' = 'view')
2021-11-29 18:55:41.048445 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
alter table dbt.test_model2 set tblproperties ('classification' = 'view')
2021-11-29 18:55:42.583048 (Thread-1): SQL status: OK -1 in 1.54 seconds
2021-11-29 18:55:42.586052 (Thread-1): finished collecting timing info
2021-11-29 18:55:42.586821 (Thread-1): On model.my_new_project.test_model2: Close
2021-11-29 18:55:42.589076 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0adb1892-9efa-416e-ba75-0110b781fef4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d584640>]}
2021-11-29 18:55:42.590321 (Thread-1): 18:55:42 | 2 of 5 OK created view model dbt.test_model2......................... [OK -1 in 3.30s]
2021-11-29 18:55:42.592060 (Thread-1): Finished running node model.my_new_project.test_model2
2021-11-29 18:55:42.594236 (Thread-1): Began running node model.my_new_project.test_model3
2021-11-29 18:55:42.595683 (Thread-1): 18:55:42 | 3 of 5 START view model dbt.test_model3.............................. [RUN]
2021-11-29 18:55:42.597350 (Thread-1): Acquiring new athena connection "model.my_new_project.test_model3".
2021-11-29 18:55:42.598868 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 44342), raddr=('18.208.66.56', 443)>
2021-11-29 18:55:42.600261 (Thread-1): Compiling model.my_new_project.test_model3
2021-11-29 18:55:42.603387 (Thread-1): Writing injected SQL for node "model.my_new_project.test_model3"
2021-11-29 18:55:42.608609 (Thread-1): finished collecting timing info
2021-11-29 18:55:42.611369 (Thread-1): Writing runtime SQL for node "model.my_new_project.test_model3"
2021-11-29 18:55:42.616495 (Thread-1): Using athena connection "model.my_new_project.test_model3".
2021-11-29 18:55:42.617710 (Thread-1): On model.my_new_project.test_model3: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model3"} */
create or replace view
    dbt.test_model3
  as
    /*
left join (?) dbt.test_model2 with dbt.Region_Table

*/
select * dbt.test_model2 union select * dbt.test_model1

2021-11-29 18:55:42.619275 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 18:55:42.638112 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model3"} */
create or replace view
    dbt.test_model3
  as
    /*
left join (?) dbt.test_model2 with dbt.Region_Table

*/
select * dbt.test_model2 union select * dbt.test_model1
2021-11-29 18:55:42.884383 (Thread-1): Failed to execute query.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 307, in _execute
    query_id = retry_api_call(
  File "/usr/local/lib/python3.8/site-packages/pyathena/util.py", line 84, in retry_api_call
    return retry(func, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 404, in __call__
    do = self.iter(retry_state=retry_state)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 349, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 407, in __call__
    result = fn(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 276, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 586, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 9:10: mismatched input 'dbt'. Expecting: ',', 'EXCEPT', 'FROM', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OFFSET', 'ORDER', 'UNION', 'WHERE', <EOF>
2021-11-29 18:55:42.886682 (Thread-1): Error running SQL: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model3"} */
create or replace view
    dbt.test_model3
  as
    /*
left join (?) dbt.test_model2 with dbt.Region_Table

*/
select * dbt.test_model2 union select * dbt.test_model1

2021-11-29 18:55:42.890770 (Thread-1): finished collecting timing info
2021-11-29 18:55:42.893404 (Thread-1): On model.my_new_project.test_model3: Close
2021-11-29 18:55:42.896149 (Thread-1): Runtime Error in model test_model3 (models/test_model3.sql)
  An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 9:10: mismatched input 'dbt'. Expecting: ',', 'EXCEPT', 'FROM', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OFFSET', 'ORDER', 'UNION', 'WHERE', <EOF>
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 307, in _execute
    query_id = retry_api_call(
  File "/usr/local/lib/python3.8/site-packages/pyathena/util.py", line 84, in retry_api_call
    return retry(func, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 404, in __call__
    do = self.iter(retry_state=retry_state)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 349, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 407, in __call__
    result = fn(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 276, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 586, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 9:10: mismatched input 'dbt'. Expecting: ',', 'EXCEPT', 'FROM', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OFFSET', 'ORDER', 'UNION', 'WHERE', <EOF>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 100, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 72, in execute
    query_id = self._execute(
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 315, in _execute
    raise DatabaseError(*e.args) from e
pyathena.error.DatabaseError: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 9:10: mismatched input 'dbt'. Expecting: ',', 'EXCEPT', 'FROM', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OFFSET', 'ORDER', 'UNION', 'WHERE', <EOF>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 66, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 103, in exception_handler
    raise RuntimeException(str(e)) from e
dbt.exceptions.RuntimeException: Runtime Error in model test_model3 (models/test_model3.sql)
  An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 9:10: mismatched input 'dbt'. Expecting: ',', 'EXCEPT', 'FROM', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OFFSET', 'ORDER', 'UNION', 'WHERE', <EOF>
2021-11-29 18:55:42.900684 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0adb1892-9efa-416e-ba75-0110b781fef4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ee79970>]}
2021-11-29 18:55:42.904344 (Thread-1): 18:55:42 | 3 of 5 ERROR creating view model dbt.test_model3..................... [ERROR in 0.30s]
2021-11-29 18:55:42.906397 (Thread-1): Finished running node model.my_new_project.test_model3
2021-11-29 18:55:42.909224 (Thread-1): Began running node model.my_new_project.test_model4
2021-11-29 18:55:42.911216 (Thread-1): 18:55:42 | 4 of 5 SKIP relation dbt.test_model4................................. [SKIP]
2021-11-29 18:55:42.912958 (Thread-1): Finished running node model.my_new_project.test_model4
2021-11-29 18:55:42.915806 (Thread-1): Began running node model.my_new_project.test_model5
2021-11-29 18:55:42.917342 (Thread-1): 18:55:42 | 5 of 5 SKIP relation dbt.test_model5................................. [SKIP]
2021-11-29 18:55:42.919022 (Thread-1): Finished running node model.my_new_project.test_model5
2021-11-29 18:55:42.921627 (MainThread): Acquiring new athena connection "master".
2021-11-29 18:55:42.925522 (MainThread): 18:55:42 | 
2021-11-29 18:55:42.926282 (MainThread): 18:55:42 | Finished running 5 view models in 12.85s.
2021-11-29 18:55:42.927665 (MainThread): Connection 'master' was properly closed.
2021-11-29 18:55:42.929390 (MainThread): Connection 'model.my_new_project.test_model3' was properly closed.
2021-11-29 18:55:42.943659 (MainThread): 
2021-11-29 18:55:42.944529 (MainThread): Completed with 1 error and 0 warnings:
2021-11-29 18:55:42.946062 (MainThread): 
2021-11-29 18:55:42.947489 (MainThread): Runtime Error in model test_model3 (models/test_model3.sql)
2021-11-29 18:55:42.949105 (MainThread):   An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 9:10: mismatched input 'dbt'. Expecting: ',', 'EXCEPT', 'FROM', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OFFSET', 'ORDER', 'UNION', 'WHERE', <EOF>
2021-11-29 18:55:42.950680 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=2 TOTAL=5
2021-11-29 18:55:42.952919 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e0342e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fdf9ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d584640>]}
2021-11-29 18:55:42.957249 (MainThread): Flushing usage events
2021-11-29 19:01:12.766737 (MainThread): Running with dbt=0.21.0
2021-11-29 19:01:12.842289 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/vscode/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-29 19:01:12.847619 (MainThread): Tracking: tracking
2021-11-29 19:01:12.850103 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ea63910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0318b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0318d60>]}
2021-11-29 19:01:12.861339 (MainThread): Partial parsing not enabled
2021-11-29 19:01:12.897719 (MainThread): Parsing macros/catalog.sql
2021-11-29 19:01:12.900520 (MainThread): Parsing macros/adapters.sql
2021-11-29 19:01:12.909133 (MainThread): Parsing macros/materializations/seed.sql
2021-11-29 19:01:12.912021 (MainThread): Parsing macros/materializations/snapshot.sql
2021-11-29 19:01:12.913036 (MainThread): Parsing macros/materializations/table.sql
2021-11-29 19:01:12.916024 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-29 19:01:12.927540 (MainThread): Parsing macros/materializations/view.sql
2021-11-29 19:01:12.931033 (MainThread): Parsing macros/core.sql
2021-11-29 19:01:12.933798 (MainThread): Parsing macros/materializations/test.sql
2021-11-29 19:01:12.938037 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-29 19:01:12.943650 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-29 19:01:12.947839 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-29 19:01:12.952373 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-29 19:01:12.955514 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-29 19:01:12.961724 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-29 19:01:12.973053 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-29 19:01:12.985076 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-29 19:01:12.989893 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-29 19:01:12.997841 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-29 19:01:13.014665 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-29 19:01:13.024062 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-29 19:01:13.025586 (MainThread): Parsing macros/etc/query.sql
2021-11-29 19:01:13.028151 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-29 19:01:13.030056 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-29 19:01:13.031819 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-29 19:01:13.033282 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-29 19:01:13.034824 (MainThread): Parsing macros/etc/datetime.sql
2021-11-29 19:01:13.039816 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-29 19:01:13.041984 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-29 19:01:13.043752 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-29 19:01:13.045890 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-29 19:01:13.047163 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-29 19:01:13.049466 (MainThread): Parsing macros/adapters/common.sql
2021-11-29 19:01:13.155958 (MainThread): Acquiring new athena connection "model.my_new_project.test_model1".
2021-11-29 19:01:13.165151 (MainThread): Acquiring new athena connection "model.my_new_project.test_model2".
2021-11-29 19:01:13.168095 (MainThread): Acquiring new athena connection "model.my_new_project.test_model3".
2021-11-29 19:01:13.171303 (MainThread): Acquiring new athena connection "model.my_new_project.test_model4".
2021-11-29 19:01:13.174163 (MainThread): Acquiring new athena connection "model.my_new_project.test_model5".
2021-11-29 19:01:13.209332 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-11-29 19:01:13.214261 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3f55039d-6acd-469a-8445-3c248837b406', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e483250>]}
2021-11-29 19:01:13.226127 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-11-29 19:01:13.227754 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3f55039d-6acd-469a-8445-3c248837b406', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e483070>]}
2021-11-29 19:01:13.228931 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 5 seed files, 0 sources, 0 exposures
2021-11-29 19:01:13.232092 (MainThread): 
2021-11-29 19:01:13.232886 (MainThread): Acquiring new athena connection "master".
2021-11-29 19:01:13.235224 (ThreadPoolExecutor-0_0): Acquiring new athena connection "list_awsdatacatalog".
2021-11-29 19:01:13.242998 (ThreadPoolExecutor-0_0): Using athena connection "list_awsdatacatalog".
2021-11-29 19:01:13.244073 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
  
2021-11-29 19:01:13.246032 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-29 19:01:13.275516 (ThreadPoolExecutor-0_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
2021-11-29 19:01:15.216771 (ThreadPoolExecutor-0_0): SQL status: OK -1 in 1.97 seconds
2021-11-29 19:01:15.226202 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: Close
2021-11-29 19:01:15.236109 (ThreadPoolExecutor-2_0): Acquiring new athena connection "list_awsdatacatalog_dbt".
2021-11-29 19:01:15.240267 (ThreadPoolExecutor-2_0): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 34282), raddr=('3.222.16.146', 443)>
2021-11-29 19:01:15.256542 (ThreadPoolExecutor-2_0): Using athena connection "list_awsdatacatalog_dbt".
2021-11-29 19:01:15.258145 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
2021-11-29 19:01:15.263136 (ThreadPoolExecutor-2_0): Opening a new connection, currently in state closed
2021-11-29 19:01:15.288888 (ThreadPoolExecutor-2_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
2021-11-29 19:01:18.146765 (ThreadPoolExecutor-2_0): SQL status: OK -1 in 2.88 seconds
2021-11-29 19:01:18.151137 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: Close
2021-11-29 19:01:18.158655 (MainThread): 19:01:18 | Concurrency: 1 threads (target='dev')
2021-11-29 19:01:18.160726 (MainThread): 19:01:18 | 
2021-11-29 19:01:18.168713 (Thread-1): Began running node model.my_new_project.test_model1
2021-11-29 19:01:18.170574 (Thread-1): 19:01:18 | 1 of 5 START view model dbt.test_model1.............................. [RUN]
2021-11-29 19:01:18.174658 (Thread-1): Acquiring new athena connection "model.my_new_project.test_model1".
2021-11-29 19:01:18.177370 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 34284), raddr=('3.222.16.146', 443)>
2021-11-29 19:01:18.180099 (Thread-1): Compiling model.my_new_project.test_model1
2021-11-29 19:01:18.184769 (Thread-1): Writing injected SQL for node "model.my_new_project.test_model1"
2021-11-29 19:01:18.191029 (Thread-1): finished collecting timing info
2021-11-29 19:01:18.205695 (Thread-1): Writing runtime SQL for node "model.my_new_project.test_model1"
2021-11-29 19:01:18.212074 (Thread-1): Using athena connection "model.my_new_project.test_model1".
2021-11-29 19:01:18.218596 (Thread-1): On model.my_new_project.test_model1: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    /*
SELECT * FROM "defaultdb"."resby_puma_northeast" puma
inner join "defaultdb"."buildings" buildings
on puma.bldg_id=buildings.bldg_fid

limit 10;
*/

/* select * from dbt.Region_Table */

/* In plain english: select all from the "buildings" table where the state value is in the Region_Table state column.  */

SELECT * FROM "defaultdb"."buildings" buildings
left join dbt.Region_Table2 region
on buildings.state=region.state1
limit 10;

2021-11-29 19:01:18.220322 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 19:01:18.236053 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    /*
SELECT * FROM "defaultdb"."resby_puma_northeast" puma
inner join "defaultdb"."buildings" buildings
on puma.bldg_id=buildings.bldg_fid

limit 10;
*/

/* select * from dbt.Region_Table */

/* In plain english: select all from the "buildings" table where the state value is in the Region_Table state column.  */

SELECT * FROM "defaultdb"."buildings" buildings
left join dbt.Region_Table2 region
on buildings.state=region.state1
limit 10;
2021-11-29 19:01:19.994889 (Thread-1): SQL status: OK -1 in 1.77 seconds
2021-11-29 19:01:20.015794 (Thread-1): Using athena connection "model.my_new_project.test_model1".
2021-11-29 19:01:20.019150 (Thread-1): On model.my_new_project.test_model1: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
alter table dbt.test_model1 set tblproperties ('classification' = 'view')
2021-11-29 19:01:20.027248 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
alter table dbt.test_model1 set tblproperties ('classification' = 'view')
2021-11-29 19:01:21.667731 (Thread-1): SQL status: OK -1 in 1.64 seconds
2021-11-29 19:01:21.691785 (Thread-1): finished collecting timing info
2021-11-29 19:01:21.694194 (Thread-1): On model.my_new_project.test_model1: Close
2021-11-29 19:01:21.700142 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f55039d-6acd-469a-8445-3c248837b406', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cf0dfa0>]}
2021-11-29 19:01:21.704747 (Thread-1): 19:01:21 | 1 of 5 OK created view model dbt.test_model1......................... [OK -1 in 3.53s]
2021-11-29 19:01:21.708543 (Thread-1): Finished running node model.my_new_project.test_model1
2021-11-29 19:01:21.712548 (Thread-1): Began running node model.my_new_project.test_model2
2021-11-29 19:01:21.716653 (Thread-1): 19:01:21 | 2 of 5 START view model dbt.test_model2.............................. [RUN]
2021-11-29 19:01:21.719815 (Thread-1): Acquiring new athena connection "model.my_new_project.test_model2".
2021-11-29 19:01:21.722781 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 34286), raddr=('3.222.16.146', 443)>
2021-11-29 19:01:21.727665 (Thread-1): Compiling model.my_new_project.test_model2
2021-11-29 19:01:21.733381 (Thread-1): Writing injected SQL for node "model.my_new_project.test_model2"
2021-11-29 19:01:21.739249 (Thread-1): finished collecting timing info
2021-11-29 19:01:21.742882 (Thread-1): Writing runtime SQL for node "model.my_new_project.test_model2"
2021-11-29 19:01:21.747369 (Thread-1): Using athena connection "model.my_new_project.test_model2".
2021-11-29 19:01:21.748546 (Thread-1): On model.my_new_project.test_model2: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    SELECT * FROM "defaultdb"."buildings" buildings
inner join dbt.Random_Small_Towns1 region
on buildings.state=region.state1
limit 10;

2021-11-29 19:01:21.750073 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 19:01:21.766719 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    SELECT * FROM "defaultdb"."buildings" buildings
inner join dbt.Random_Small_Towns1 region
on buildings.state=region.state1
limit 10;
2021-11-29 19:01:23.496561 (Thread-1): SQL status: OK -1 in 1.75 seconds
2021-11-29 19:01:23.506897 (Thread-1): Using athena connection "model.my_new_project.test_model2".
2021-11-29 19:01:23.511310 (Thread-1): On model.my_new_project.test_model2: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
alter table dbt.test_model2 set tblproperties ('classification' = 'view')
2021-11-29 19:01:23.521725 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
alter table dbt.test_model2 set tblproperties ('classification' = 'view')
2021-11-29 19:01:25.094778 (Thread-1): SQL status: OK -1 in 1.57 seconds
2021-11-29 19:01:25.105228 (Thread-1): finished collecting timing info
2021-11-29 19:01:25.109063 (Thread-1): On model.my_new_project.test_model2: Close
2021-11-29 19:01:25.116164 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f55039d-6acd-469a-8445-3c248837b406', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cf41fd0>]}
2021-11-29 19:01:25.123330 (Thread-1): 19:01:25 | 2 of 5 OK created view model dbt.test_model2......................... [OK -1 in 3.40s]
2021-11-29 19:01:25.128918 (Thread-1): Finished running node model.my_new_project.test_model2
2021-11-29 19:01:25.134543 (Thread-1): Began running node model.my_new_project.test_model3
2021-11-29 19:01:25.139035 (Thread-1): 19:01:25 | 3 of 5 START view model dbt.test_model3.............................. [RUN]
2021-11-29 19:01:25.143309 (Thread-1): Acquiring new athena connection "model.my_new_project.test_model3".
2021-11-29 19:01:25.147014 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 34288), raddr=('3.222.16.146', 443)>
2021-11-29 19:01:25.151076 (Thread-1): Compiling model.my_new_project.test_model3
2021-11-29 19:01:25.157632 (Thread-1): Writing injected SQL for node "model.my_new_project.test_model3"
2021-11-29 19:01:25.165112 (Thread-1): finished collecting timing info
2021-11-29 19:01:25.168528 (Thread-1): Writing runtime SQL for node "model.my_new_project.test_model3"
2021-11-29 19:01:25.173181 (Thread-1): Using athena connection "model.my_new_project.test_model3".
2021-11-29 19:01:25.174143 (Thread-1): On model.my_new_project.test_model3: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model3"} */
create or replace view
    dbt.test_model3
  as
    /*
left join (?) dbt.test_model2 with dbt.Region_Table

*/
select * dbt.test_model2 union select * dbt.test_model1

2021-11-29 19:01:25.175652 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 19:01:25.194690 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model3"} */
create or replace view
    dbt.test_model3
  as
    /*
left join (?) dbt.test_model2 with dbt.Region_Table

*/
select * dbt.test_model2 union select * dbt.test_model1
2021-11-29 19:01:25.463736 (Thread-1): Failed to execute query.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 307, in _execute
    query_id = retry_api_call(
  File "/usr/local/lib/python3.8/site-packages/pyathena/util.py", line 84, in retry_api_call
    return retry(func, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 404, in __call__
    do = self.iter(retry_state=retry_state)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 349, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 407, in __call__
    result = fn(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 276, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 586, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 9:10: mismatched input 'dbt'. Expecting: ',', 'EXCEPT', 'FROM', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OFFSET', 'ORDER', 'UNION', 'WHERE', <EOF>
2021-11-29 19:01:25.465187 (Thread-1): Error running SQL: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model3"} */
create or replace view
    dbt.test_model3
  as
    /*
left join (?) dbt.test_model2 with dbt.Region_Table

*/
select * dbt.test_model2 union select * dbt.test_model1

2021-11-29 19:01:25.467963 (Thread-1): finished collecting timing info
2021-11-29 19:01:25.469604 (Thread-1): On model.my_new_project.test_model3: Close
2021-11-29 19:01:25.470998 (Thread-1): Runtime Error in model test_model3 (models/test_model3.sql)
  An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 9:10: mismatched input 'dbt'. Expecting: ',', 'EXCEPT', 'FROM', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OFFSET', 'ORDER', 'UNION', 'WHERE', <EOF>
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 307, in _execute
    query_id = retry_api_call(
  File "/usr/local/lib/python3.8/site-packages/pyathena/util.py", line 84, in retry_api_call
    return retry(func, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 404, in __call__
    do = self.iter(retry_state=retry_state)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 349, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 407, in __call__
    result = fn(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 276, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 586, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 9:10: mismatched input 'dbt'. Expecting: ',', 'EXCEPT', 'FROM', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OFFSET', 'ORDER', 'UNION', 'WHERE', <EOF>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 100, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 72, in execute
    query_id = self._execute(
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 315, in _execute
    raise DatabaseError(*e.args) from e
pyathena.error.DatabaseError: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 9:10: mismatched input 'dbt'. Expecting: ',', 'EXCEPT', 'FROM', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OFFSET', 'ORDER', 'UNION', 'WHERE', <EOF>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 66, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 103, in exception_handler
    raise RuntimeException(str(e)) from e
dbt.exceptions.RuntimeException: Runtime Error in model test_model3 (models/test_model3.sql)
  An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 9:10: mismatched input 'dbt'. Expecting: ',', 'EXCEPT', 'FROM', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OFFSET', 'ORDER', 'UNION', 'WHERE', <EOF>
2021-11-29 19:01:25.473818 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f55039d-6acd-469a-8445-3c248837b406', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c336f70>]}
2021-11-29 19:01:25.475804 (Thread-1): 19:01:25 | 3 of 5 ERROR creating view model dbt.test_model3..................... [ERROR in 0.33s]
2021-11-29 19:01:25.477383 (Thread-1): Finished running node model.my_new_project.test_model3
2021-11-29 19:01:25.482847 (Thread-1): Began running node model.my_new_project.test_model4
2021-11-29 19:01:25.483752 (Thread-1): 19:01:25 | 4 of 5 SKIP relation dbt.test_model4................................. [SKIP]
2021-11-29 19:01:25.485433 (Thread-1): Finished running node model.my_new_project.test_model4
2021-11-29 19:01:25.487280 (Thread-1): Began running node model.my_new_project.test_model5
2021-11-29 19:01:25.488768 (Thread-1): 19:01:25 | 5 of 5 SKIP relation dbt.test_model5................................. [SKIP]
2021-11-29 19:01:25.490537 (Thread-1): Finished running node model.my_new_project.test_model5
2021-11-29 19:01:25.495267 (MainThread): Acquiring new athena connection "master".
2021-11-29 19:01:25.496185 (MainThread): 19:01:25 | 
2021-11-29 19:01:25.497622 (MainThread): 19:01:25 | Finished running 5 view models in 12.26s.
2021-11-29 19:01:25.499025 (MainThread): Connection 'master' was properly closed.
2021-11-29 19:01:25.500514 (MainThread): Connection 'model.my_new_project.test_model3' was properly closed.
2021-11-29 19:01:25.513594 (MainThread): 
2021-11-29 19:01:25.514455 (MainThread): Completed with 1 error and 0 warnings:
2021-11-29 19:01:25.516055 (MainThread): 
2021-11-29 19:01:25.517549 (MainThread): Runtime Error in model test_model3 (models/test_model3.sql)
2021-11-29 19:01:25.520603 (MainThread):   An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 9:10: mismatched input 'dbt'. Expecting: ',', 'EXCEPT', 'FROM', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OFFSET', 'ORDER', 'UNION', 'WHERE', <EOF>
2021-11-29 19:01:25.522648 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=2 TOTAL=5
2021-11-29 19:01:25.524525 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e56c3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e433fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d111760>]}
2021-11-29 19:01:25.526331 (MainThread): Flushing usage events
2021-11-29 19:03:03.610108 (MainThread): Running with dbt=0.21.0
2021-11-29 19:03:03.683934 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/vscode/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-29 19:03:03.690571 (MainThread): Tracking: tracking
2021-11-29 19:03:03.693796 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac23f3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadad9dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadad9eb0>]}
2021-11-29 19:03:03.703518 (MainThread): Partial parsing not enabled
2021-11-29 19:03:03.728343 (MainThread): Parsing macros/catalog.sql
2021-11-29 19:03:03.731250 (MainThread): Parsing macros/adapters.sql
2021-11-29 19:03:03.739919 (MainThread): Parsing macros/materializations/seed.sql
2021-11-29 19:03:03.742958 (MainThread): Parsing macros/materializations/snapshot.sql
2021-11-29 19:03:03.744109 (MainThread): Parsing macros/materializations/table.sql
2021-11-29 19:03:03.747374 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-29 19:03:03.759870 (MainThread): Parsing macros/materializations/view.sql
2021-11-29 19:03:03.763193 (MainThread): Parsing macros/core.sql
2021-11-29 19:03:03.766421 (MainThread): Parsing macros/materializations/test.sql
2021-11-29 19:03:03.771484 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-29 19:03:03.778325 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-29 19:03:03.781385 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-29 19:03:03.786043 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-29 19:03:03.787669 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-29 19:03:03.793956 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-29 19:03:03.805651 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-29 19:03:03.818690 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-29 19:03:03.823389 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-29 19:03:03.831564 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-29 19:03:03.848646 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-29 19:03:03.858894 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-29 19:03:03.860762 (MainThread): Parsing macros/etc/query.sql
2021-11-29 19:03:03.861938 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-29 19:03:03.864777 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-29 19:03:03.866555 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-29 19:03:03.868132 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-29 19:03:03.870619 (MainThread): Parsing macros/etc/datetime.sql
2021-11-29 19:03:03.877426 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-29 19:03:03.879910 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-29 19:03:03.882340 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-29 19:03:03.883794 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-29 19:03:03.885826 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-29 19:03:03.887423 (MainThread): Parsing macros/adapters/common.sql
2021-11-29 19:03:03.998020 (MainThread): Acquiring new athena connection "model.my_new_project.test_model1".
2021-11-29 19:03:04.006415 (MainThread): Acquiring new athena connection "model.my_new_project.test_model2".
2021-11-29 19:03:04.009090 (MainThread): Acquiring new athena connection "model.my_new_project.test_model3".
2021-11-29 19:03:04.013079 (MainThread): Acquiring new athena connection "model.my_new_project.test_model4".
2021-11-29 19:03:04.016185 (MainThread): Acquiring new athena connection "model.my_new_project.test_model5".
2021-11-29 19:03:04.043375 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-11-29 19:03:04.047674 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f18001d3-cd1d-4651-bf1c-cd6573b85937', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabc66940>]}
2021-11-29 19:03:04.061673 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-11-29 19:03:04.063542 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f18001d3-cd1d-4651-bf1c-cd6573b85937', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabc66be0>]}
2021-11-29 19:03:04.064828 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 5 seed files, 0 sources, 0 exposures
2021-11-29 19:03:04.067512 (MainThread): 
2021-11-29 19:03:04.068533 (MainThread): Acquiring new athena connection "master".
2021-11-29 19:03:04.071422 (ThreadPoolExecutor-0_0): Acquiring new athena connection "list_awsdatacatalog".
2021-11-29 19:03:04.078279 (ThreadPoolExecutor-0_0): Using athena connection "list_awsdatacatalog".
2021-11-29 19:03:04.079124 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
  
2021-11-29 19:03:04.081815 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-29 19:03:04.107298 (ThreadPoolExecutor-0_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
2021-11-29 19:03:05.977752 (ThreadPoolExecutor-0_0): SQL status: OK -1 in 1.90 seconds
2021-11-29 19:03:05.987957 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: Close
2021-11-29 19:03:06.000562 (ThreadPoolExecutor-2_0): Acquiring new athena connection "list_awsdatacatalog_dbt".
2021-11-29 19:03:06.003826 (ThreadPoolExecutor-2_0): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 59886), raddr=('54.173.173.141', 443)>
2021-11-29 19:03:06.018346 (ThreadPoolExecutor-2_0): Using athena connection "list_awsdatacatalog_dbt".
2021-11-29 19:03:06.019996 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
2021-11-29 19:03:06.022807 (ThreadPoolExecutor-2_0): Opening a new connection, currently in state closed
2021-11-29 19:03:06.051672 (ThreadPoolExecutor-2_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
2021-11-29 19:03:08.963888 (ThreadPoolExecutor-2_0): SQL status: OK -1 in 2.94 seconds
2021-11-29 19:03:08.968640 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: Close
2021-11-29 19:03:08.974493 (MainThread): 19:03:08 | Concurrency: 1 threads (target='dev')
2021-11-29 19:03:08.980576 (MainThread): 19:03:08 | 
2021-11-29 19:03:08.989815 (Thread-1): Began running node model.my_new_project.test_model1
2021-11-29 19:03:08.992083 (Thread-1): 19:03:08 | 1 of 5 START view model dbt.test_model1.............................. [RUN]
2021-11-29 19:03:08.996574 (Thread-1): Acquiring new athena connection "model.my_new_project.test_model1".
2021-11-29 19:03:09.001345 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 59888), raddr=('54.173.173.141', 443)>
2021-11-29 19:03:09.006431 (Thread-1): Compiling model.my_new_project.test_model1
2021-11-29 19:03:09.010983 (Thread-1): Writing injected SQL for node "model.my_new_project.test_model1"
2021-11-29 19:03:09.019003 (Thread-1): finished collecting timing info
2021-11-29 19:03:09.031851 (Thread-1): Writing runtime SQL for node "model.my_new_project.test_model1"
2021-11-29 19:03:09.036664 (Thread-1): Using athena connection "model.my_new_project.test_model1".
2021-11-29 19:03:09.037454 (Thread-1): On model.my_new_project.test_model1: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    /*
SELECT * FROM "defaultdb"."resby_puma_northeast" puma
inner join "defaultdb"."buildings" buildings
on puma.bldg_id=buildings.bldg_fid

limit 10;
*/

/* select * from dbt.Region_Table */

/* In plain english: select all from the "buildings" table where the state value is in the Region_Table state column.  */

SELECT * FROM "defaultdb"."buildings" buildings
inner join dbt.Region_Table2 region
on buildings.state=region.state1
limit 10;

2021-11-29 19:03:09.039287 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 19:03:09.055027 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
create or replace view
    dbt.test_model1
  as
    /*
SELECT * FROM "defaultdb"."resby_puma_northeast" puma
inner join "defaultdb"."buildings" buildings
on puma.bldg_id=buildings.bldg_fid

limit 10;
*/

/* select * from dbt.Region_Table */

/* In plain english: select all from the "buildings" table where the state value is in the Region_Table state column.  */

SELECT * FROM "defaultdb"."buildings" buildings
inner join dbt.Region_Table2 region
on buildings.state=region.state1
limit 10;
2021-11-29 19:03:10.845544 (Thread-1): SQL status: OK -1 in 1.81 seconds
2021-11-29 19:03:10.858758 (Thread-1): Using athena connection "model.my_new_project.test_model1".
2021-11-29 19:03:10.861456 (Thread-1): On model.my_new_project.test_model1: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
alter table dbt.test_model1 set tblproperties ('classification' = 'view')
2021-11-29 19:03:10.867633 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model1"} */
alter table dbt.test_model1 set tblproperties ('classification' = 'view')
2021-11-29 19:03:12.418452 (Thread-1): SQL status: OK -1 in 1.55 seconds
2021-11-29 19:03:12.439529 (Thread-1): finished collecting timing info
2021-11-29 19:03:12.441258 (Thread-1): On model.my_new_project.test_model1: Close
2021-11-29 19:03:12.445096 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f18001d3-cd1d-4651-bf1c-cd6573b85937', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa8d2790>]}
2021-11-29 19:03:12.449327 (Thread-1): 19:03:12 | 1 of 5 OK created view model dbt.test_model1......................... [OK -1 in 3.45s]
2021-11-29 19:03:12.451743 (Thread-1): Finished running node model.my_new_project.test_model1
2021-11-29 19:03:12.454505 (Thread-1): Began running node model.my_new_project.test_model2
2021-11-29 19:03:12.457391 (Thread-1): 19:03:12 | 2 of 5 START view model dbt.test_model2.............................. [RUN]
2021-11-29 19:03:12.459801 (Thread-1): Acquiring new athena connection "model.my_new_project.test_model2".
2021-11-29 19:03:12.462338 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 59890), raddr=('54.173.173.141', 443)>
2021-11-29 19:03:12.464804 (Thread-1): Compiling model.my_new_project.test_model2
2021-11-29 19:03:12.469052 (Thread-1): Writing injected SQL for node "model.my_new_project.test_model2"
2021-11-29 19:03:12.476823 (Thread-1): finished collecting timing info
2021-11-29 19:03:12.481036 (Thread-1): Writing runtime SQL for node "model.my_new_project.test_model2"
2021-11-29 19:03:12.485845 (Thread-1): Using athena connection "model.my_new_project.test_model2".
2021-11-29 19:03:12.486951 (Thread-1): On model.my_new_project.test_model2: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    SELECT * FROM "defaultdb"."buildings" buildings
inner join dbt.Random_Small_Towns1 region
on buildings.state=region.state1
limit 10;

2021-11-29 19:03:12.488974 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 19:03:12.509337 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
create or replace view
    dbt.test_model2
  as
    SELECT * FROM "defaultdb"."buildings" buildings
inner join dbt.Random_Small_Towns1 region
on buildings.state=region.state1
limit 10;
2021-11-29 19:03:14.220706 (Thread-1): SQL status: OK -1 in 1.73 seconds
2021-11-29 19:03:14.234331 (Thread-1): Using athena connection "model.my_new_project.test_model2".
2021-11-29 19:03:14.237988 (Thread-1): On model.my_new_project.test_model2: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
alter table dbt.test_model2 set tblproperties ('classification' = 'view')
2021-11-29 19:03:14.243924 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model2"} */
alter table dbt.test_model2 set tblproperties ('classification' = 'view')
2021-11-29 19:03:15.836346 (Thread-1): SQL status: OK -1 in 1.59 seconds
2021-11-29 19:03:15.838559 (Thread-1): finished collecting timing info
2021-11-29 19:03:15.839630 (Thread-1): On model.my_new_project.test_model2: Close
2021-11-29 19:03:15.841809 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f18001d3-cd1d-4651-bf1c-cd6573b85937', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabbd0400>]}
2021-11-29 19:03:15.843397 (Thread-1): 19:03:15 | 2 of 5 OK created view model dbt.test_model2......................... [OK -1 in 3.38s]
2021-11-29 19:03:15.845006 (Thread-1): Finished running node model.my_new_project.test_model2
2021-11-29 19:03:15.847137 (Thread-1): Began running node model.my_new_project.test_model3
2021-11-29 19:03:15.848654 (Thread-1): 19:03:15 | 3 of 5 START view model dbt.test_model3.............................. [RUN]
2021-11-29 19:03:15.850292 (Thread-1): Acquiring new athena connection "model.my_new_project.test_model3".
2021-11-29 19:03:15.852182 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 59892), raddr=('54.173.173.141', 443)>
2021-11-29 19:03:15.855211 (Thread-1): Compiling model.my_new_project.test_model3
2021-11-29 19:03:15.858486 (Thread-1): Writing injected SQL for node "model.my_new_project.test_model3"
2021-11-29 19:03:15.863159 (Thread-1): finished collecting timing info
2021-11-29 19:03:15.865779 (Thread-1): Writing runtime SQL for node "model.my_new_project.test_model3"
2021-11-29 19:03:15.870395 (Thread-1): Using athena connection "model.my_new_project.test_model3".
2021-11-29 19:03:15.871232 (Thread-1): On model.my_new_project.test_model3: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model3"} */
create or replace view
    dbt.test_model3
  as
    /*
left join (?) dbt.test_model2 with dbt.Region_Table

*/
select * dbt.test_model2 union select * dbt.test_model1

2021-11-29 19:03:15.873213 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 19:03:15.893928 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model3"} */
create or replace view
    dbt.test_model3
  as
    /*
left join (?) dbt.test_model2 with dbt.Region_Table

*/
select * dbt.test_model2 union select * dbt.test_model1
2021-11-29 19:03:16.178673 (Thread-1): Failed to execute query.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 307, in _execute
    query_id = retry_api_call(
  File "/usr/local/lib/python3.8/site-packages/pyathena/util.py", line 84, in retry_api_call
    return retry(func, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 404, in __call__
    do = self.iter(retry_state=retry_state)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 349, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 407, in __call__
    result = fn(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 276, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 586, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 9:10: mismatched input 'dbt'. Expecting: ',', 'EXCEPT', 'FROM', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OFFSET', 'ORDER', 'UNION', 'WHERE', <EOF>
2021-11-29 19:03:16.183795 (Thread-1): Error running SQL: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.test_model3"} */
create or replace view
    dbt.test_model3
  as
    /*
left join (?) dbt.test_model2 with dbt.Region_Table

*/
select * dbt.test_model2 union select * dbt.test_model1

2021-11-29 19:03:16.187464 (Thread-1): finished collecting timing info
2021-11-29 19:03:16.190337 (Thread-1): On model.my_new_project.test_model3: Close
2021-11-29 19:03:16.193123 (Thread-1): Runtime Error in model test_model3 (models/test_model3.sql)
  An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 9:10: mismatched input 'dbt'. Expecting: ',', 'EXCEPT', 'FROM', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OFFSET', 'ORDER', 'UNION', 'WHERE', <EOF>
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 307, in _execute
    query_id = retry_api_call(
  File "/usr/local/lib/python3.8/site-packages/pyathena/util.py", line 84, in retry_api_call
    return retry(func, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 404, in __call__
    do = self.iter(retry_state=retry_state)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 349, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 407, in __call__
    result = fn(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 276, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 586, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 9:10: mismatched input 'dbt'. Expecting: ',', 'EXCEPT', 'FROM', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OFFSET', 'ORDER', 'UNION', 'WHERE', <EOF>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 100, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 72, in execute
    query_id = self._execute(
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 315, in _execute
    raise DatabaseError(*e.args) from e
pyathena.error.DatabaseError: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 9:10: mismatched input 'dbt'. Expecting: ',', 'EXCEPT', 'FROM', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OFFSET', 'ORDER', 'UNION', 'WHERE', <EOF>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 66, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 103, in exception_handler
    raise RuntimeException(str(e)) from e
dbt.exceptions.RuntimeException: Runtime Error in model test_model3 (models/test_model3.sql)
  An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 9:10: mismatched input 'dbt'. Expecting: ',', 'EXCEPT', 'FROM', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OFFSET', 'ORDER', 'UNION', 'WHERE', <EOF>
2021-11-29 19:03:16.198329 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f18001d3-cd1d-4651-bf1c-cd6573b85937', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa94dba30>]}
2021-11-29 19:03:16.200995 (Thread-1): 19:03:16 | 3 of 5 ERROR creating view model dbt.test_model3..................... [ERROR in 0.35s]
2021-11-29 19:03:16.204012 (Thread-1): Finished running node model.my_new_project.test_model3
2021-11-29 19:03:16.206647 (Thread-1): Began running node model.my_new_project.test_model4
2021-11-29 19:03:16.208882 (Thread-1): 19:03:16 | 4 of 5 SKIP relation dbt.test_model4................................. [SKIP]
2021-11-29 19:03:16.210840 (Thread-1): Finished running node model.my_new_project.test_model4
2021-11-29 19:03:16.213803 (Thread-1): Began running node model.my_new_project.test_model5
2021-11-29 19:03:16.215808 (Thread-1): 19:03:16 | 5 of 5 SKIP relation dbt.test_model5................................. [SKIP]
2021-11-29 19:03:16.219827 (Thread-1): Finished running node model.my_new_project.test_model5
2021-11-29 19:03:16.223815 (MainThread): Acquiring new athena connection "master".
2021-11-29 19:03:16.224763 (MainThread): 19:03:16 | 
2021-11-29 19:03:16.227183 (MainThread): 19:03:16 | Finished running 5 view models in 12.16s.
2021-11-29 19:03:16.230046 (MainThread): Connection 'master' was properly closed.
2021-11-29 19:03:16.234705 (MainThread): Connection 'model.my_new_project.test_model3' was properly closed.
2021-11-29 19:03:16.248323 (MainThread): 
2021-11-29 19:03:16.250382 (MainThread): Completed with 1 error and 0 warnings:
2021-11-29 19:03:16.252798 (MainThread): 
2021-11-29 19:03:16.254326 (MainThread): Runtime Error in model test_model3 (models/test_model3.sql)
2021-11-29 19:03:16.256782 (MainThread):   An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 9:10: mismatched input 'dbt'. Expecting: ',', 'EXCEPT', 'FROM', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OFFSET', 'ORDER', 'UNION', 'WHERE', <EOF>
2021-11-29 19:03:16.258994 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=2 TOTAL=5
2021-11-29 19:03:16.260984 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa8d2790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffada81eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa8cb6a0>]}
2021-11-29 19:03:16.263126 (MainThread): Flushing usage events
2021-11-29 20:20:14.620405 (MainThread): Running with dbt=0.21.0
2021-11-29 20:20:14.701517 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/vscode/.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', select=None, selector_name=None, show=False, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='seed', write_json=True)
2021-11-29 20:20:14.708917 (MainThread): Tracking: tracking
2021-11-29 20:20:14.711954 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a8c15e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c15dc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c15ddf0>]}
2021-11-29 20:20:14.720979 (MainThread): Partial parsing not enabled
2021-11-29 20:20:14.741570 (MainThread): Parsing macros/catalog.sql
2021-11-29 20:20:14.745259 (MainThread): Parsing macros/adapters.sql
2021-11-29 20:20:14.753739 (MainThread): Parsing macros/materializations/seed.sql
2021-11-29 20:20:14.756833 (MainThread): Parsing macros/materializations/snapshot.sql
2021-11-29 20:20:14.758247 (MainThread): Parsing macros/materializations/table.sql
2021-11-29 20:20:14.761533 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-29 20:20:14.774220 (MainThread): Parsing macros/materializations/view.sql
2021-11-29 20:20:14.777426 (MainThread): Parsing macros/core.sql
2021-11-29 20:20:14.780062 (MainThread): Parsing macros/materializations/test.sql
2021-11-29 20:20:14.784032 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-29 20:20:14.789872 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-29 20:20:14.793296 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-29 20:20:14.797534 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-29 20:20:14.799055 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-29 20:20:14.805760 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-29 20:20:14.816988 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-29 20:20:14.829507 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-29 20:20:14.834957 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-29 20:20:14.843535 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-29 20:20:14.860802 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-29 20:20:14.871061 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-29 20:20:14.872781 (MainThread): Parsing macros/etc/query.sql
2021-11-29 20:20:14.874077 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-29 20:20:14.876532 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-29 20:20:14.878151 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-29 20:20:14.879903 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-29 20:20:14.882142 (MainThread): Parsing macros/etc/datetime.sql
2021-11-29 20:20:14.887322 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-29 20:20:14.888866 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-29 20:20:14.891156 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-29 20:20:14.892543 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-29 20:20:14.894833 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-29 20:20:14.896274 (MainThread): Parsing macros/adapters/common.sql
2021-11-29 20:20:15.010768 (MainThread): Acquiring new athena connection "model.my_new_project.NE_and_SmallTowns".
2021-11-29 20:20:15.019135 (MainThread): Acquiring new athena connection "model.my_new_project.New_England".
2021-11-29 20:20:15.021955 (MainThread): Acquiring new athena connection "model.my_new_project.Small_Towns".
2021-11-29 20:20:15.035617 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a2e4790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a281790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a277f10>]}
2021-11-29 20:20:15.036535 (MainThread): Flushing usage events
2021-11-29 20:20:15.372521 (MainThread): Connection 'model.my_new_project.Small_Towns' was properly closed.
2021-11-29 20:20:15.374901 (MainThread): Encountered an error:
2021-11-29 20:20:15.378298 (MainThread): Compilation Error in model NE_and_SmallTowns (models/NE_and_SmallTowns.sql)
  Model 'model.my_new_project.NE_and_SmallTowns' (models/NE_and_SmallTowns.sql) depends on a node named 'test_model2' which was not found
2021-11-29 20:20:15.384000 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 433, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 149, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 87, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 74, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 182, in get_full_manifest
    manifest = loader.load()
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 355, in load
    self.process_refs(self.root_project.project_name)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 715, in process_refs
    _process_refs_for_node(self.manifest, current_project, node)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 1026, in _process_refs_for_node
    invalid_ref_fail_unless_test(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 799, in invalid_ref_fail_unless_test
    ref_target_not_found(
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 575, in ref_target_not_found
    raise_compiler_error(msg, model)
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 444, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model NE_and_SmallTowns (models/NE_and_SmallTowns.sql)
  Model 'model.my_new_project.NE_and_SmallTowns' (models/NE_and_SmallTowns.sql) depends on a node named 'test_model2' which was not found

2021-11-29 20:21:54.597236 (MainThread): Running with dbt=0.21.0
2021-11-29 20:21:54.669203 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/vscode/.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', select=None, selector_name=None, show=False, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='seed', write_json=True)
2021-11-29 20:21:54.676151 (MainThread): Tracking: tracking
2021-11-29 20:21:54.678980 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8a00370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba29b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba29be80>]}
2021-11-29 20:21:54.689576 (MainThread): Partial parsing not enabled
2021-11-29 20:21:54.711803 (MainThread): Parsing macros/catalog.sql
2021-11-29 20:21:54.714856 (MainThread): Parsing macros/adapters.sql
2021-11-29 20:21:54.723575 (MainThread): Parsing macros/materializations/seed.sql
2021-11-29 20:21:54.726717 (MainThread): Parsing macros/materializations/snapshot.sql
2021-11-29 20:21:54.728091 (MainThread): Parsing macros/materializations/table.sql
2021-11-29 20:21:54.731121 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-29 20:21:54.743718 (MainThread): Parsing macros/materializations/view.sql
2021-11-29 20:21:54.747179 (MainThread): Parsing macros/core.sql
2021-11-29 20:21:54.750690 (MainThread): Parsing macros/materializations/test.sql
2021-11-29 20:21:54.755053 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-29 20:21:54.760984 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-29 20:21:54.764203 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-29 20:21:54.768503 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-29 20:21:54.770241 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-29 20:21:54.777219 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-29 20:21:54.788575 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-29 20:21:54.801467 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-29 20:21:54.805887 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-29 20:21:54.814105 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-29 20:21:54.830482 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-29 20:21:54.840679 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-29 20:21:54.842429 (MainThread): Parsing macros/etc/query.sql
2021-11-29 20:21:54.843716 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-29 20:21:54.846491 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-29 20:21:54.848108 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-29 20:21:54.849447 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-29 20:21:54.851602 (MainThread): Parsing macros/etc/datetime.sql
2021-11-29 20:21:54.856787 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-29 20:21:54.858341 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-29 20:21:54.860074 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-29 20:21:54.861337 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-29 20:21:54.863236 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-29 20:21:54.865649 (MainThread): Parsing macros/adapters/common.sql
2021-11-29 20:21:54.970920 (MainThread): Acquiring new athena connection "model.my_new_project.NE_and_SmallTowns".
2021-11-29 20:21:54.979290 (MainThread): Acquiring new athena connection "model.my_new_project.New_England".
2021-11-29 20:21:54.982125 (MainThread): Acquiring new athena connection "model.my_new_project.Small_Towns".
2021-11-29 20:21:54.996574 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8422850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb83bf850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb83b5fd0>]}
2021-11-29 20:21:54.997378 (MainThread): Flushing usage events
2021-11-29 20:21:55.350952 (MainThread): Connection 'model.my_new_project.Small_Towns' was properly closed.
2021-11-29 20:21:55.352517 (MainThread): Encountered an error:
2021-11-29 20:21:55.354535 (MainThread): Compilation Error in model NE_and_SmallTowns (models/NE_and_SmallTowns.sql)
  Model 'model.my_new_project.NE_and_SmallTowns' (models/NE_and_SmallTowns.sql) depends on a node named 'test_model2' which was not found
2021-11-29 20:21:55.359210 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 433, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 149, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 87, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 74, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 182, in get_full_manifest
    manifest = loader.load()
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 355, in load
    self.process_refs(self.root_project.project_name)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 715, in process_refs
    _process_refs_for_node(self.manifest, current_project, node)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 1026, in _process_refs_for_node
    invalid_ref_fail_unless_test(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 799, in invalid_ref_fail_unless_test
    ref_target_not_found(
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 575, in ref_target_not_found
    raise_compiler_error(msg, model)
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 444, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model NE_and_SmallTowns (models/NE_and_SmallTowns.sql)
  Model 'model.my_new_project.NE_and_SmallTowns' (models/NE_and_SmallTowns.sql) depends on a node named 'test_model2' which was not found

2021-11-29 20:24:21.626695 (MainThread): Running with dbt=0.21.0
2021-11-29 20:24:21.701950 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/vscode/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-29 20:24:21.709248 (MainThread): Tracking: tracking
2021-11-29 20:24:21.712703 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86c185e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff884b4ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff884b4df0>]}
2021-11-29 20:24:21.721566 (MainThread): Partial parsing not enabled
2021-11-29 20:24:21.737185 (MainThread): Parsing macros/catalog.sql
2021-11-29 20:24:21.739904 (MainThread): Parsing macros/adapters.sql
2021-11-29 20:24:21.749041 (MainThread): Parsing macros/materializations/seed.sql
2021-11-29 20:24:21.752384 (MainThread): Parsing macros/materializations/snapshot.sql
2021-11-29 20:24:21.753426 (MainThread): Parsing macros/materializations/table.sql
2021-11-29 20:24:21.756370 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-29 20:24:21.769480 (MainThread): Parsing macros/materializations/view.sql
2021-11-29 20:24:21.772992 (MainThread): Parsing macros/core.sql
2021-11-29 20:24:21.775573 (MainThread): Parsing macros/materializations/test.sql
2021-11-29 20:24:21.779919 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-29 20:24:21.785652 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-29 20:24:21.788881 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-29 20:24:21.793147 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-29 20:24:21.795610 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-29 20:24:21.801908 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-29 20:24:21.812984 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-29 20:24:21.825862 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-29 20:24:21.831763 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-29 20:24:21.841101 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-29 20:24:21.860356 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-29 20:24:21.869364 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-29 20:24:21.870792 (MainThread): Parsing macros/etc/query.sql
2021-11-29 20:24:21.872524 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-29 20:24:21.874628 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-29 20:24:21.876240 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-29 20:24:21.877788 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-29 20:24:21.880145 (MainThread): Parsing macros/etc/datetime.sql
2021-11-29 20:24:21.886259 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-29 20:24:21.887906 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-29 20:24:21.891052 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-29 20:24:21.892907 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-29 20:24:21.894379 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-29 20:24:21.906207 (MainThread): Parsing macros/adapters/common.sql
2021-11-29 20:24:22.018606 (MainThread): Acquiring new athena connection "model.my_new_project.NE_and_SmallTowns".
2021-11-29 20:24:22.026575 (MainThread): Acquiring new athena connection "model.my_new_project.New_England".
2021-11-29 20:24:22.029389 (MainThread): Acquiring new athena connection "model.my_new_project.Small_Towns".
2021-11-29 20:24:22.054451 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-11-29 20:24:22.059016 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08d59406-87e1-410e-8a45-00095ebb156d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86610af0>]}
2021-11-29 20:24:22.068452 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff884d48e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86610a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff866105b0>]}
2021-11-29 20:24:22.069278 (MainThread): Flushing usage events
2021-11-29 20:24:22.388391 (MainThread): Connection 'model.my_new_project.Small_Towns' was properly closed.
2021-11-29 20:24:22.389683 (MainThread): Encountered an error:
2021-11-29 20:24:22.391718 (MainThread): Found a cycle: model.my_new_project.Small_Towns
2021-11-29 20:24:22.395631 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 433, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 149, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 88, in _runtime_initialize
    self.compile_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 84, in compile_manifest
    self.graph = compiler.compile(self.manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/compilation.py", line 505, in compile
    self.link_graph(linker, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/compilation.py", line 431, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.my_new_project.Small_Towns

2021-11-29 20:25:06.144382 (MainThread): Running with dbt=0.21.0
2021-11-29 20:25:06.209346 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/vscode/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-29 20:25:06.215235 (MainThread): Tracking: tracking
2021-11-29 20:25:06.217388 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ad1c580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c5b83a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c5b8e50>]}
2021-11-29 20:25:06.225571 (MainThread): Partial parsing not enabled
2021-11-29 20:25:06.238860 (MainThread): Parsing macros/catalog.sql
2021-11-29 20:25:06.242015 (MainThread): Parsing macros/adapters.sql
2021-11-29 20:25:06.250499 (MainThread): Parsing macros/materializations/seed.sql
2021-11-29 20:25:06.253950 (MainThread): Parsing macros/materializations/snapshot.sql
2021-11-29 20:25:06.255076 (MainThread): Parsing macros/materializations/table.sql
2021-11-29 20:25:06.257743 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-29 20:25:06.270683 (MainThread): Parsing macros/materializations/view.sql
2021-11-29 20:25:06.274259 (MainThread): Parsing macros/core.sql
2021-11-29 20:25:06.280262 (MainThread): Parsing macros/materializations/test.sql
2021-11-29 20:25:06.284997 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-29 20:25:06.290747 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-29 20:25:06.294013 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-29 20:25:06.298338 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-29 20:25:06.299870 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-29 20:25:06.305771 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-29 20:25:06.316538 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-29 20:25:06.329017 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-29 20:25:06.334404 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-29 20:25:06.342330 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-29 20:25:06.360139 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-29 20:25:06.369476 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-29 20:25:06.371044 (MainThread): Parsing macros/etc/query.sql
2021-11-29 20:25:06.372233 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-29 20:25:06.374973 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-29 20:25:06.376656 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-29 20:25:06.378201 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-29 20:25:06.380447 (MainThread): Parsing macros/etc/datetime.sql
2021-11-29 20:25:06.386209 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-29 20:25:06.387986 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-29 20:25:06.390834 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-29 20:25:06.392145 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-29 20:25:06.394430 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-29 20:25:06.396577 (MainThread): Parsing macros/adapters/common.sql
2021-11-29 20:25:06.501503 (MainThread): Acquiring new athena connection "model.my_new_project.NE_and_SmallTowns".
2021-11-29 20:25:06.510938 (MainThread): Acquiring new athena connection "model.my_new_project.New_England".
2021-11-29 20:25:06.514065 (MainThread): Acquiring new athena connection "model.my_new_project.Small_Towns".
2021-11-29 20:25:06.537999 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-11-29 20:25:06.541874 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6a270815-f0e4-48e8-a7b5-eb4f0361a1ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a713a00>]}
2021-11-29 20:25:06.553789 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-11-29 20:25:06.555817 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a270815-f0e4-48e8-a7b5-eb4f0361a1ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a713910>]}
2021-11-29 20:25:06.557137 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 2 seed files, 0 sources, 0 exposures
2021-11-29 20:25:06.559844 (MainThread): 
2021-11-29 20:25:06.561060 (MainThread): Acquiring new athena connection "master".
2021-11-29 20:25:06.563347 (ThreadPoolExecutor-0_0): Acquiring new athena connection "list_awsdatacatalog".
2021-11-29 20:25:06.571168 (ThreadPoolExecutor-0_0): Using athena connection "list_awsdatacatalog".
2021-11-29 20:25:06.572319 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
  
2021-11-29 20:25:06.574086 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-29 20:25:06.601311 (ThreadPoolExecutor-0_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
2021-11-29 20:25:08.526058 (ThreadPoolExecutor-0_0): SQL status: OK -1 in 1.95 seconds
2021-11-29 20:25:08.528110 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: Close
2021-11-29 20:25:08.531158 (ThreadPoolExecutor-2_0): Acquiring new athena connection "list_awsdatacatalog_dbt".
2021-11-29 20:25:08.532134 (ThreadPoolExecutor-2_0): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 47480), raddr=('35.170.169.204', 443)>
2021-11-29 20:25:08.537276 (ThreadPoolExecutor-2_0): Using athena connection "list_awsdatacatalog_dbt".
2021-11-29 20:25:08.538018 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
2021-11-29 20:25:08.539541 (ThreadPoolExecutor-2_0): Opening a new connection, currently in state closed
2021-11-29 20:25:08.556287 (ThreadPoolExecutor-2_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
2021-11-29 20:25:11.573544 (ThreadPoolExecutor-2_0): SQL status: OK -1 in 3.03 seconds
2021-11-29 20:25:11.583164 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: Close
2021-11-29 20:25:11.589127 (MainThread): 20:25:11 | Concurrency: 1 threads (target='dev')
2021-11-29 20:25:11.594173 (MainThread): 20:25:11 | 
2021-11-29 20:25:11.605957 (Thread-1): Began running node model.my_new_project.New_England
2021-11-29 20:25:11.608581 (Thread-1): 20:25:11 | 1 of 3 START view model dbt.New_England.............................. [RUN]
2021-11-29 20:25:11.613096 (Thread-1): Acquiring new athena connection "model.my_new_project.New_England".
2021-11-29 20:25:11.617161 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 47482), raddr=('35.170.169.204', 443)>
2021-11-29 20:25:11.620595 (Thread-1): Compiling model.my_new_project.New_England
2021-11-29 20:25:11.629393 (Thread-1): Writing injected SQL for node "model.my_new_project.New_England"
2021-11-29 20:25:11.651023 (Thread-1): finished collecting timing info
2021-11-29 20:25:11.664843 (Thread-1): Writing runtime SQL for node "model.my_new_project.New_England"
2021-11-29 20:25:11.669342 (Thread-1): Using athena connection "model.my_new_project.New_England".
2021-11-29 20:25:11.669942 (Thread-1): On model.my_new_project.New_England: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.New_England"} */
create or replace view
    dbt.New_England
  as
    /*
SELECT * FROM "defaultdb"."resby_puma_northeast" puma
inner join "defaultdb"."buildings" buildings
on puma.bldg_id=buildings.bldg_fid

limit 10;
*/

/* select * from dbt.Region_Table */

/* In plain english: select all from the "buildings" table where the state value is in the Region_Table state column.  */

SELECT * FROM "defaultdb"."buildings" buildings
inner join dbt.Region_Table region
on buildings.state=region.state1
limit 10;

2021-11-29 20:25:11.671308 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 20:25:11.688604 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.New_England"} */
create or replace view
    dbt.New_England
  as
    /*
SELECT * FROM "defaultdb"."resby_puma_northeast" puma
inner join "defaultdb"."buildings" buildings
on puma.bldg_id=buildings.bldg_fid

limit 10;
*/

/* select * from dbt.Region_Table */

/* In plain english: select all from the "buildings" table where the state value is in the Region_Table state column.  */

SELECT * FROM "defaultdb"."buildings" buildings
inner join dbt.Region_Table region
on buildings.state=region.state1
limit 10;
2021-11-29 20:25:13.184264 (Thread-1): Error running SQL: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.New_England"} */
create or replace view
    dbt.New_England
  as
    /*
SELECT * FROM "defaultdb"."resby_puma_northeast" puma
inner join "defaultdb"."buildings" buildings
on puma.bldg_id=buildings.bldg_fid

limit 10;
*/

/* select * from dbt.Region_Table */

/* In plain english: select all from the "buildings" table where the state value is in the Region_Table state column.  */

SELECT * FROM "defaultdb"."buildings" buildings
inner join dbt.Region_Table region
on buildings.state=region.state1
limit 10;

2021-11-29 20:25:13.194823 (Thread-1): finished collecting timing info
2021-11-29 20:25:13.202976 (Thread-1): On model.my_new_project.New_England: Close
2021-11-29 20:25:13.210327 (Thread-1): Runtime Error in model New_England (models/New_England.sql)
  com.facebook.presto.v217.sql.analyzer.SemanticException: line 18:12: Table 459120389451.dbt.region_table does not exist
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 100, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 90, in execute
    raise OperationalError(query_execution.state_change_reason)
pyathena.error.OperationalError: com.facebook.presto.v217.sql.analyzer.SemanticException: line 18:12: Table 459120389451.dbt.region_table does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 66, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 103, in exception_handler
    raise RuntimeException(str(e)) from e
dbt.exceptions.RuntimeException: Runtime Error in model New_England (models/New_England.sql)
  com.facebook.presto.v217.sql.analyzer.SemanticException: line 18:12: Table 459120389451.dbt.region_table does not exist
2021-11-29 20:25:13.219800 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a270815-f0e4-48e8-a7b5-eb4f0361a1ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89cae850>]}
2021-11-29 20:25:13.224931 (Thread-1): 20:25:13 | 1 of 3 ERROR creating view model dbt.New_England..................... [ERROR in 1.61s]
2021-11-29 20:25:13.228686 (Thread-1): Finished running node model.my_new_project.New_England
2021-11-29 20:25:13.234879 (Thread-1): Began running node model.my_new_project.Small_Towns
2021-11-29 20:25:13.236674 (Thread-1): 20:25:13 | 2 of 3 SKIP relation dbt.Small_Towns................................. [SKIP]
2021-11-29 20:25:13.239876 (Thread-1): Finished running node model.my_new_project.Small_Towns
2021-11-29 20:25:13.244476 (Thread-1): Began running node model.my_new_project.NE_and_SmallTowns
2021-11-29 20:25:13.247421 (Thread-1): 20:25:13 | 3 of 3 SKIP relation dbt.NE_and_SmallTowns........................... [SKIP]
2021-11-29 20:25:13.252869 (Thread-1): Finished running node model.my_new_project.NE_and_SmallTowns
2021-11-29 20:25:13.256673 (MainThread): Acquiring new athena connection "master".
2021-11-29 20:25:13.259311 (MainThread): 20:25:13 | 
2021-11-29 20:25:13.261675 (MainThread): 20:25:13 | Finished running 3 view models in 6.70s.
2021-11-29 20:25:13.263202 (MainThread): Connection 'master' was properly closed.
2021-11-29 20:25:13.265135 (MainThread): Connection 'model.my_new_project.New_England' was properly closed.
2021-11-29 20:25:13.267148 (MainThread): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 47484), raddr=('35.170.169.204', 443)>
2021-11-29 20:25:13.286612 (MainThread): 
2021-11-29 20:25:13.290322 (MainThread): Completed with 1 error and 0 warnings:
2021-11-29 20:25:13.292192 (MainThread): 
2021-11-29 20:25:13.294404 (MainThread): Runtime Error in model New_England (models/New_England.sql)
2021-11-29 20:25:13.296837 (MainThread):   com.facebook.presto.v217.sql.analyzer.SemanticException: line 18:12: Table 459120389451.dbt.region_table does not exist
2021-11-29 20:25:13.299412 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
2021-11-29 20:25:13.302717 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c55de80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c5d88b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a7c4460>]}
2021-11-29 20:25:13.306461 (MainThread): Flushing usage events
2021-11-29 20:25:31.673426 (MainThread): Running with dbt=0.21.0
2021-11-29 20:25:31.739412 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/vscode/.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', select=None, selector_name=None, show=False, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='seed', write_json=True)
2021-11-29 20:25:31.746559 (MainThread): Tracking: tracking
2021-11-29 20:25:31.749272 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85d23520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff875bfca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff875bfe20>]}
2021-11-29 20:25:31.758875 (MainThread): Partial parsing not enabled
2021-11-29 20:25:31.772705 (MainThread): Parsing macros/catalog.sql
2021-11-29 20:25:31.776059 (MainThread): Parsing macros/adapters.sql
2021-11-29 20:25:31.784498 (MainThread): Parsing macros/materializations/seed.sql
2021-11-29 20:25:31.787526 (MainThread): Parsing macros/materializations/snapshot.sql
2021-11-29 20:25:31.788589 (MainThread): Parsing macros/materializations/table.sql
2021-11-29 20:25:31.791607 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-29 20:25:31.805128 (MainThread): Parsing macros/materializations/view.sql
2021-11-29 20:25:31.808729 (MainThread): Parsing macros/core.sql
2021-11-29 20:25:31.811546 (MainThread): Parsing macros/materializations/test.sql
2021-11-29 20:25:31.816766 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-29 20:25:31.823034 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-29 20:25:31.826312 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-29 20:25:31.830642 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-29 20:25:31.832289 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-29 20:25:31.838205 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-29 20:25:31.849903 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-29 20:25:31.861962 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-29 20:25:31.866726 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-29 20:25:31.874771 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-29 20:25:31.891564 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-29 20:25:31.901433 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-29 20:25:31.903214 (MainThread): Parsing macros/etc/query.sql
2021-11-29 20:25:31.904290 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-29 20:25:31.907403 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-29 20:25:31.908908 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-29 20:25:31.910614 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-29 20:25:31.913122 (MainThread): Parsing macros/etc/datetime.sql
2021-11-29 20:25:31.918492 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-29 20:25:31.920895 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-29 20:25:31.923466 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-29 20:25:31.924665 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-29 20:25:31.926653 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-29 20:25:31.928132 (MainThread): Parsing macros/adapters/common.sql
2021-11-29 20:25:32.034547 (MainThread): Acquiring new athena connection "model.my_new_project.NE_and_SmallTowns".
2021-11-29 20:25:32.043053 (MainThread): Acquiring new athena connection "model.my_new_project.New_England".
2021-11-29 20:25:32.046597 (MainThread): Acquiring new athena connection "model.my_new_project.Small_Towns".
2021-11-29 20:25:32.071367 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-11-29 20:25:32.075767 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ed473571-8572-4b00-88f6-c418d634b484', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff857e74f0>]}
2021-11-29 20:25:32.087163 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-11-29 20:25:32.089461 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ed473571-8572-4b00-88f6-c418d634b484', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff858192b0>]}
2021-11-29 20:25:32.090552 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 2 seed files, 0 sources, 0 exposures
2021-11-29 20:25:32.093081 (MainThread): 
2021-11-29 20:25:32.093945 (MainThread): Acquiring new athena connection "master".
2021-11-29 20:25:32.095803 (ThreadPoolExecutor-0_0): Acquiring new athena connection "list_awsdatacatalog".
2021-11-29 20:25:32.103614 (ThreadPoolExecutor-0_0): Using athena connection "list_awsdatacatalog".
2021-11-29 20:25:32.104283 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
  
2021-11-29 20:25:32.106346 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-29 20:25:32.125053 (ThreadPoolExecutor-0_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
2021-11-29 20:25:33.969379 (ThreadPoolExecutor-0_0): SQL status: OK -1 in 1.86 seconds
2021-11-29 20:25:33.977743 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: Close
2021-11-29 20:25:33.985247 (ThreadPoolExecutor-2_0): Acquiring new athena connection "list_awsdatacatalog_dbt".
2021-11-29 20:25:33.989457 (ThreadPoolExecutor-2_0): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 47490), raddr=('35.170.169.204', 443)>
2021-11-29 20:25:34.003322 (ThreadPoolExecutor-2_0): Using athena connection "list_awsdatacatalog_dbt".
2021-11-29 20:25:34.004793 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
2021-11-29 20:25:34.008693 (ThreadPoolExecutor-2_0): Opening a new connection, currently in state closed
2021-11-29 20:25:34.038346 (ThreadPoolExecutor-2_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
2021-11-29 20:25:36.864747 (ThreadPoolExecutor-2_0): SQL status: OK -1 in 2.86 seconds
2021-11-29 20:25:36.868379 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: Close
2021-11-29 20:25:36.874378 (MainThread): 20:25:36 | Concurrency: 1 threads (target='dev')
2021-11-29 20:25:36.878556 (MainThread): 20:25:36 | 
2021-11-29 20:25:36.884823 (Thread-1): Began running node seed.my_new_project.Random_Small_Towns
2021-11-29 20:25:36.886833 (Thread-1): 20:25:36 | 1 of 2 START seed file dbt.Random_Small_Towns........................ [RUN]
2021-11-29 20:25:36.890468 (Thread-1): Acquiring new athena connection "seed.my_new_project.Random_Small_Towns".
2021-11-29 20:25:36.892897 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 47492), raddr=('35.170.169.204', 443)>
2021-11-29 20:25:36.895491 (Thread-1): finished collecting timing info
2021-11-29 20:25:36.918862 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-11-29 20:25:36.919786 (Thread-1): * Deprecation Warning: The quote_columns parameter was not set for seeds, so the
default value of False was chosen. The default will change to True in a future
release.

For more information, see:
https://docs.getdbt.com/v0.15/docs/seeds#section-specify-column-quoting
2021-11-29 20:25:36.921452 (Thread-1): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ed473571-8572-4b00-88f6-c418d634b484', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8425ceb0>]}
2021-11-29 20:25:36.923392 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-11-29 20:25:36.925113 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-11-29 20:25:36.927589 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-11-29 20:25:36.929381 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-11-29 20:25:36.931221 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 20:25:36.947151 (Thread-1): Using athena connection "seed.my_new_project.Random_Small_Towns".
2021-11-29 20:25:36.948287 (Thread-1): On seed.my_new_project.Random_Small_Towns: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "seed.my_new_project.Random_Small_Towns"} */

    create external table dbt.Random_Small_Towns (Zip integer, City1 string, County string, State1 string, Region string)
    stored as parquet
    location 's3://justin-dbt-testing/Targettables/6484a661-74ce-4058-af7c-8d6a544a7e0b/'
    tblproperties ('classification'='parquet')
  
2021-11-29 20:25:36.950314 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "seed.my_new_project.Random_Small_Towns"} */

    create external table dbt.Random_Small_Towns (Zip integer, City1 string, County string, State1 string, Region string)
    stored as parquet
    location 's3://justin-dbt-testing/Targettables/6484a661-74ce-4058-af7c-8d6a544a7e0b/'
    tblproperties ('classification'='parquet')
2021-11-29 20:25:38.691582 (Thread-1): SQL status: OK -1 in 1.74 seconds
2021-11-29 20:25:38.716484 (Thread-1): Using athena connection "seed.my_new_project.Random_Small_Towns".
2021-11-29 20:25:38.717767 (Thread-1): On seed.my_new_project.Random_Small_Towns: 
          insert into dbt.Random_Small_Towns (Zip, City1, County, State1, Region) values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s)
      ...
2021-11-29 20:25:38.721820 (Thread-1): insert into dbt.Random_Small_Towns (Zip, City1, County, State1, Region) values
          (4101,'Portland','Cumberland','ME','Northeast'),(4027,'Lebanon','York','ME','Northeast'),(4430,'Millinocket','Penobscot','ME','Northeast'),(33514,'Center Hill','Sumter','FL','Southeast'),(33935,'Muce','Glades','FL','Southeast'),(33040,'Key West','Monroe','FL','Southeast'),(54751,'Menomonie','Dunn','WI','Midwest'),(54011,'El Paso','Pierce','WI','Midwest'),(55043,'Lakeland','Washington','MN','Midwest'),(86321,'Bagdad','Yavapai','AZ','Southwest'),(85937,'Snowflake','Navajo','AZ','Southwest'),(85539,'Miami','Gila','AZ','Southwest'),(98851,'Soap Lake','Grant','WA','Northwest'),(99022,'Medical Lake','Spokane','WA','Northwest'),(99148,'Loon Lake','Stevens','WA','Northwest'),(99723,'Utqiagvik','North Slope','AK','Alaska'),(99762,'Nome','Unorganized','AK','Alaska'),(99686,'Valdez','Chugach','AK','Alaska'),(96777,'Phala','Hawaii','HI','Hawaii'),(96761,'Kapalua','Maui','HI','Hawaii'),(96769,'Puuwai','Kauai','HI','Hawaii')
2021-11-29 20:25:40.382372 (Thread-1): SQL status: OK -1 in 1.66 seconds
2021-11-29 20:25:40.400349 (Thread-1): Writing runtime SQL for node "seed.my_new_project.Random_Small_Towns"
2021-11-29 20:25:40.431376 (Thread-1): finished collecting timing info
2021-11-29 20:25:40.432852 (Thread-1): On seed.my_new_project.Random_Small_Towns: Close
2021-11-29 20:25:40.435853 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed473571-8572-4b00-88f6-c418d634b484', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84267cd0>]}
2021-11-29 20:25:40.438599 (Thread-1): 20:25:40 | 1 of 2 OK loaded seed file dbt.Random_Small_Towns.................... [INSERT 21 in 3.55s]
2021-11-29 20:25:40.440877 (Thread-1): Finished running node seed.my_new_project.Random_Small_Towns
2021-11-29 20:25:40.444124 (Thread-1): Began running node seed.my_new_project.Region_Table
2021-11-29 20:25:40.446571 (Thread-1): 20:25:40 | 2 of 2 START seed file dbt.Region_Table.............................. [RUN]
2021-11-29 20:25:40.449525 (Thread-1): Acquiring new athena connection "seed.my_new_project.Region_Table".
2021-11-29 20:25:40.452159 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 47494), raddr=('35.170.169.204', 443)>
2021-11-29 20:25:40.454644 (Thread-1): finished collecting timing info
2021-11-29 20:25:40.461583 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-11-29 20:25:40.462731 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-11-29 20:25:40.464205 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 20:25:40.481940 (Thread-1): Using athena connection "seed.my_new_project.Region_Table".
2021-11-29 20:25:40.482878 (Thread-1): On seed.my_new_project.Region_Table: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "seed.my_new_project.Region_Table"} */

    create external table dbt.Region_Table (State1 string, Region string)
    stored as parquet
    location 's3://justin-dbt-testing/Targettables/134fd67f-ced7-41d1-a09d-f1149cf5f15c/'
    tblproperties ('classification'='parquet')
  
2021-11-29 20:25:40.484797 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "seed.my_new_project.Region_Table"} */

    create external table dbt.Region_Table (State1 string, Region string)
    stored as parquet
    location 's3://justin-dbt-testing/Targettables/134fd67f-ced7-41d1-a09d-f1149cf5f15c/'
    tblproperties ('classification'='parquet')
2021-11-29 20:25:42.200945 (Thread-1): SQL status: OK -1 in 1.72 seconds
2021-11-29 20:25:42.216299 (Thread-1): Using athena connection "seed.my_new_project.Region_Table".
2021-11-29 20:25:42.219154 (Thread-1): On seed.my_new_project.Region_Table: 
          insert into dbt.Region_Table (State1, Region) values
          (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s)
      ...
2021-11-29 20:25:42.226802 (Thread-1): insert into dbt.Region_Table (State1, Region) values
          ('ME','Northeast'),('NH','Northeast'),('VT','Northeast'),('MA','Northeast'),('CT','Northeast'),('RI','Northeast')
2021-11-29 20:25:44.939137 (Thread-1): SQL status: OK -1 in 2.71 seconds
2021-11-29 20:25:44.942988 (Thread-1): Writing runtime SQL for node "seed.my_new_project.Region_Table"
2021-11-29 20:25:44.958203 (Thread-1): finished collecting timing info
2021-11-29 20:25:44.960233 (Thread-1): On seed.my_new_project.Region_Table: Close
2021-11-29 20:25:44.964000 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed473571-8572-4b00-88f6-c418d634b484', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ef80f10>]}
2021-11-29 20:25:44.966399 (Thread-1): 20:25:44 | 2 of 2 OK loaded seed file dbt.Region_Table.......................... [INSERT 6 in 4.51s]
2021-11-29 20:25:44.969297 (Thread-1): Finished running node seed.my_new_project.Region_Table
2021-11-29 20:25:44.974743 (MainThread): Acquiring new athena connection "master".
2021-11-29 20:25:44.977273 (MainThread): 20:25:44 | 
2021-11-29 20:25:44.979808 (MainThread): 20:25:44 | Finished running 2 seeds in 12.88s.
2021-11-29 20:25:44.981893 (MainThread): Connection 'master' was properly closed.
2021-11-29 20:25:44.983936 (MainThread): Connection 'seed.my_new_project.Region_Table' was properly closed.
2021-11-29 20:25:44.986303 (MainThread): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 47496), raddr=('35.170.169.204', 443)>
2021-11-29 20:25:45.001315 (MainThread): 
2021-11-29 20:25:45.002268 (MainThread): Completed successfully
2021-11-29 20:25:45.003667 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-11-29 20:25:45.005323 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff857466a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff875e0910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff857c6a00>]}
2021-11-29 20:25:45.008154 (MainThread): Flushing usage events
2021-11-29 20:25:48.056759 (MainThread): Running with dbt=0.21.0
2021-11-29 20:25:48.122235 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/vscode/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-29 20:25:48.127644 (MainThread): Tracking: tracking
2021-11-29 20:25:48.131232 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff828f45b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8418fb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8418fdc0>]}
2021-11-29 20:25:48.140261 (MainThread): Partial parsing not enabled
2021-11-29 20:25:48.151314 (MainThread): Parsing macros/catalog.sql
2021-11-29 20:25:48.153966 (MainThread): Parsing macros/adapters.sql
2021-11-29 20:25:48.162290 (MainThread): Parsing macros/materializations/seed.sql
2021-11-29 20:25:48.166266 (MainThread): Parsing macros/materializations/snapshot.sql
2021-11-29 20:25:48.167739 (MainThread): Parsing macros/materializations/table.sql
2021-11-29 20:25:48.170145 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-29 20:25:48.182142 (MainThread): Parsing macros/materializations/view.sql
2021-11-29 20:25:48.185743 (MainThread): Parsing macros/core.sql
2021-11-29 20:25:48.188614 (MainThread): Parsing macros/materializations/test.sql
2021-11-29 20:25:48.193395 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-29 20:25:48.199120 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-29 20:25:48.202279 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-29 20:25:48.206833 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-29 20:25:48.208406 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-29 20:25:48.215160 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-29 20:25:48.226023 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-29 20:25:48.238699 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-29 20:25:48.243382 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-29 20:25:48.251867 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-29 20:25:48.268618 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-29 20:25:48.277738 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-29 20:25:48.280341 (MainThread): Parsing macros/etc/query.sql
2021-11-29 20:25:48.282015 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-29 20:25:48.284683 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-29 20:25:48.287073 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-29 20:25:48.288535 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-29 20:25:48.289972 (MainThread): Parsing macros/etc/datetime.sql
2021-11-29 20:25:48.295671 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-29 20:25:48.297128 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-29 20:25:48.299627 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-29 20:25:48.300949 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-29 20:25:48.303220 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-29 20:25:48.304941 (MainThread): Parsing macros/adapters/common.sql
2021-11-29 20:25:48.411812 (MainThread): Acquiring new athena connection "model.my_new_project.NE_and_SmallTowns".
2021-11-29 20:25:48.420833 (MainThread): Acquiring new athena connection "model.my_new_project.New_England".
2021-11-29 20:25:48.423769 (MainThread): Acquiring new athena connection "model.my_new_project.Small_Towns".
2021-11-29 20:25:48.447351 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-11-29 20:25:48.451984 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b0c9482f-38f3-4437-9dc9-c21eca261727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff822e9eb0>]}
2021-11-29 20:25:48.462959 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-11-29 20:25:48.464694 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b0c9482f-38f3-4437-9dc9-c21eca261727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff822e9ac0>]}
2021-11-29 20:25:48.465586 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 2 seed files, 0 sources, 0 exposures
2021-11-29 20:25:48.468245 (MainThread): 
2021-11-29 20:25:48.469241 (MainThread): Acquiring new athena connection "master".
2021-11-29 20:25:48.472190 (ThreadPoolExecutor-0_0): Acquiring new athena connection "list_awsdatacatalog".
2021-11-29 20:25:48.479328 (ThreadPoolExecutor-0_0): Using athena connection "list_awsdatacatalog".
2021-11-29 20:25:48.480281 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
  
2021-11-29 20:25:48.481960 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-29 20:25:48.500398 (ThreadPoolExecutor-0_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
2021-11-29 20:25:50.356099 (ThreadPoolExecutor-0_0): SQL status: OK -1 in 1.87 seconds
2021-11-29 20:25:50.366282 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: Close
2021-11-29 20:25:50.372039 (ThreadPoolExecutor-2_0): Acquiring new athena connection "list_awsdatacatalog_dbt".
2021-11-29 20:25:50.386233 (ThreadPoolExecutor-2_0): Using athena connection "list_awsdatacatalog_dbt".
2021-11-29 20:25:50.387981 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
2021-11-29 20:25:50.392347 (ThreadPoolExecutor-2_0): Opening a new connection, currently in state init
2021-11-29 20:25:50.420180 (ThreadPoolExecutor-2_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
2021-11-29 20:25:53.229925 (ThreadPoolExecutor-2_0): SQL status: OK -1 in 2.84 seconds
2021-11-29 20:25:53.239873 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: Close
2021-11-29 20:25:53.245708 (MainThread): 20:25:53 | Concurrency: 1 threads (target='dev')
2021-11-29 20:25:53.249094 (MainThread): 20:25:53 | 
2021-11-29 20:25:53.263485 (Thread-1): Began running node model.my_new_project.New_England
2021-11-29 20:25:53.265830 (Thread-1): 20:25:53 | 1 of 3 START view model dbt.New_England.............................. [RUN]
2021-11-29 20:25:53.271938 (Thread-1): Acquiring new athena connection "model.my_new_project.New_England".
2021-11-29 20:25:53.276645 (Thread-1): unclosed <ssl.SSLSocket fd=6, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 47502), raddr=('35.170.169.204', 443)>
2021-11-29 20:25:53.279869 (Thread-1): Compiling model.my_new_project.New_England
2021-11-29 20:25:53.286306 (Thread-1): Writing injected SQL for node "model.my_new_project.New_England"
2021-11-29 20:25:53.293699 (Thread-1): finished collecting timing info
2021-11-29 20:25:53.309929 (Thread-1): Writing runtime SQL for node "model.my_new_project.New_England"
2021-11-29 20:25:53.315309 (Thread-1): Using athena connection "model.my_new_project.New_England".
2021-11-29 20:25:53.316353 (Thread-1): On model.my_new_project.New_England: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.New_England"} */
create or replace view
    dbt.New_England
  as
    /*
SELECT * FROM "defaultdb"."resby_puma_northeast" puma
inner join "defaultdb"."buildings" buildings
on puma.bldg_id=buildings.bldg_fid

limit 10;
*/

/* select * from dbt.Region_Table */

/* In plain english: select all from the "buildings" table where the state value is in the Region_Table state column.  */

SELECT * FROM "defaultdb"."buildings" buildings
inner join dbt.Region_Table region
on buildings.state=region.state1
limit 10;

2021-11-29 20:25:53.317685 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 20:25:53.333807 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.New_England"} */
create or replace view
    dbt.New_England
  as
    /*
SELECT * FROM "defaultdb"."resby_puma_northeast" puma
inner join "defaultdb"."buildings" buildings
on puma.bldg_id=buildings.bldg_fid

limit 10;
*/

/* select * from dbt.Region_Table */

/* In plain english: select all from the "buildings" table where the state value is in the Region_Table state column.  */

SELECT * FROM "defaultdb"."buildings" buildings
inner join dbt.Region_Table region
on buildings.state=region.state1
limit 10;
2021-11-29 20:25:55.114460 (Thread-1): SQL status: OK -1 in 1.80 seconds
2021-11-29 20:25:55.122120 (Thread-1): Using athena connection "model.my_new_project.New_England".
2021-11-29 20:25:55.124052 (Thread-1): On model.my_new_project.New_England: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.New_England"} */
alter table dbt.New_England set tblproperties ('classification' = 'view')
2021-11-29 20:25:55.128546 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.New_England"} */
alter table dbt.New_England set tblproperties ('classification' = 'view')
2021-11-29 20:25:56.722666 (Thread-1): SQL status: OK -1 in 1.59 seconds
2021-11-29 20:25:56.746307 (Thread-1): finished collecting timing info
2021-11-29 20:25:56.749956 (Thread-1): On model.my_new_project.New_England: Close
2021-11-29 20:25:56.755771 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0c9482f-38f3-4437-9dc9-c21eca261727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff849b68b0>]}
2021-11-29 20:25:56.760566 (Thread-1): 20:25:56 | 1 of 3 OK created view model dbt.New_England......................... [OK -1 in 3.48s]
2021-11-29 20:25:56.765229 (Thread-1): Finished running node model.my_new_project.New_England
2021-11-29 20:25:56.772063 (Thread-1): Began running node model.my_new_project.Small_Towns
2021-11-29 20:25:56.773779 (Thread-1): 20:25:56 | 2 of 3 START view model dbt.Small_Towns.............................. [RUN]
2021-11-29 20:25:56.777399 (Thread-1): Acquiring new athena connection "model.my_new_project.Small_Towns".
2021-11-29 20:25:56.781021 (Thread-1): unclosed <ssl.SSLSocket fd=6, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 47504), raddr=('35.170.169.204', 443)>
2021-11-29 20:25:56.784192 (Thread-1): Compiling model.my_new_project.Small_Towns
2021-11-29 20:25:56.791325 (Thread-1): Writing injected SQL for node "model.my_new_project.Small_Towns"
2021-11-29 20:25:56.797327 (Thread-1): finished collecting timing info
2021-11-29 20:25:56.801019 (Thread-1): Writing runtime SQL for node "model.my_new_project.Small_Towns"
2021-11-29 20:25:56.807292 (Thread-1): Using athena connection "model.my_new_project.Small_Towns".
2021-11-29 20:25:56.808272 (Thread-1): On model.my_new_project.Small_Towns: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.Small_Towns"} */
create or replace view
    dbt.Small_Towns
  as
    SELECT * FROM "defaultdb"."buildings" buildings
inner join dbt.New_England region
on buildings.state=region.state1
limit 10;

2021-11-29 20:25:56.810285 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 20:25:56.827304 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.Small_Towns"} */
create or replace view
    dbt.Small_Towns
  as
    SELECT * FROM "defaultdb"."buildings" buildings
inner join dbt.New_England region
on buildings.state=region.state1
limit 10;
2021-11-29 20:25:58.299277 (Thread-1): Error running SQL: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.Small_Towns"} */
create or replace view
    dbt.Small_Towns
  as
    SELECT * FROM "defaultdb"."buildings" buildings
inner join dbt.New_England region
on buildings.state=region.state1
limit 10;

2021-11-29 20:25:58.304128 (Thread-1): finished collecting timing info
2021-11-29 20:25:58.313190 (Thread-1): On model.my_new_project.Small_Towns: Close
2021-11-29 20:25:58.324069 (Thread-1): Runtime Error in model Small_Towns (models/Small_Towns.sql)
  com.facebook.presto.v217.sql.analyzer.SemanticException: line 2:1: Column name 'gid' specified more than once
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 100, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 90, in execute
    raise OperationalError(query_execution.state_change_reason)
pyathena.error.OperationalError: com.facebook.presto.v217.sql.analyzer.SemanticException: line 2:1: Column name 'gid' specified more than once

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 66, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 103, in exception_handler
    raise RuntimeException(str(e)) from e
dbt.exceptions.RuntimeException: Runtime Error in model Small_Towns (models/Small_Towns.sql)
  com.facebook.presto.v217.sql.analyzer.SemanticException: line 2:1: Column name 'gid' specified more than once
2021-11-29 20:25:58.333312 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0c9482f-38f3-4437-9dc9-c21eca261727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80d803d0>]}
2021-11-29 20:25:58.338030 (Thread-1): 20:25:58 | 2 of 3 ERROR creating view model dbt.Small_Towns..................... [ERROR in 1.56s]
2021-11-29 20:25:58.342594 (Thread-1): Finished running node model.my_new_project.Small_Towns
2021-11-29 20:25:58.346635 (Thread-1): Began running node model.my_new_project.NE_and_SmallTowns
2021-11-29 20:25:58.349976 (Thread-1): 20:25:58 | 3 of 3 SKIP relation dbt.NE_and_SmallTowns........................... [SKIP]
2021-11-29 20:25:58.353126 (Thread-1): Finished running node model.my_new_project.NE_and_SmallTowns
2021-11-29 20:25:58.358021 (MainThread): Acquiring new athena connection "master".
2021-11-29 20:25:58.360920 (MainThread): 20:25:58 | 
2021-11-29 20:25:58.362893 (MainThread): 20:25:58 | Finished running 3 view models in 9.89s.
2021-11-29 20:25:58.365307 (MainThread): Connection 'master' was properly closed.
2021-11-29 20:25:58.367496 (MainThread): Connection 'list_awsdatacatalog' was properly closed.
2021-11-29 20:25:58.369952 (MainThread): Connection 'model.my_new_project.Small_Towns' was properly closed.
2021-11-29 20:25:58.372869 (MainThread): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 47500), raddr=('35.170.169.204', 443)>
2021-11-29 20:25:58.377071 (MainThread): unclosed <ssl.SSLSocket fd=6, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 47506), raddr=('35.170.169.204', 443)>
2021-11-29 20:25:58.390188 (MainThread): 
2021-11-29 20:25:58.391294 (MainThread): Completed with 1 error and 0 warnings:
2021-11-29 20:25:58.394352 (MainThread): 
2021-11-29 20:25:58.396473 (MainThread): Runtime Error in model Small_Towns (models/Small_Towns.sql)
2021-11-29 20:25:58.398044 (MainThread):   com.facebook.presto.v217.sql.analyzer.SemanticException: line 2:1: Column name 'gid' specified more than once
2021-11-29 20:25:58.399808 (MainThread): 
Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
2021-11-29 20:25:58.402183 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80399fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8034cf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80db5520>]}
2021-11-29 20:25:58.404222 (MainThread): Flushing usage events
2021-11-29 20:28:10.426402 (MainThread): Running with dbt=0.21.0
2021-11-29 20:28:10.498623 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/vscode/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-29 20:28:10.503787 (MainThread): Tracking: tracking
2021-11-29 20:28:10.505967 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89e6f5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b6ebc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b6ebdc0>]}
2021-11-29 20:28:10.515135 (MainThread): Partial parsing not enabled
2021-11-29 20:28:10.528630 (MainThread): Parsing macros/catalog.sql
2021-11-29 20:28:10.531746 (MainThread): Parsing macros/adapters.sql
2021-11-29 20:28:10.540442 (MainThread): Parsing macros/materializations/seed.sql
2021-11-29 20:28:10.543397 (MainThread): Parsing macros/materializations/snapshot.sql
2021-11-29 20:28:10.544429 (MainThread): Parsing macros/materializations/table.sql
2021-11-29 20:28:10.547393 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-29 20:28:10.559579 (MainThread): Parsing macros/materializations/view.sql
2021-11-29 20:28:10.562996 (MainThread): Parsing macros/core.sql
2021-11-29 20:28:10.566017 (MainThread): Parsing macros/materializations/test.sql
2021-11-29 20:28:10.570349 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-29 20:28:10.576416 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-29 20:28:10.579639 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-29 20:28:10.584408 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-29 20:28:10.586897 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-29 20:28:10.593184 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-29 20:28:10.603851 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-29 20:28:10.616389 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-29 20:28:10.621339 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-29 20:28:10.629265 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-29 20:28:10.646251 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-29 20:28:10.655305 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-29 20:28:10.656783 (MainThread): Parsing macros/etc/query.sql
2021-11-29 20:28:10.657958 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-29 20:28:10.661280 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-29 20:28:10.663463 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-29 20:28:10.665158 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-29 20:28:10.667388 (MainThread): Parsing macros/etc/datetime.sql
2021-11-29 20:28:10.674142 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-29 20:28:10.677810 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-29 20:28:10.680066 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-29 20:28:10.682063 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-29 20:28:10.683953 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-29 20:28:10.685916 (MainThread): Parsing macros/adapters/common.sql
2021-11-29 20:28:10.793596 (MainThread): Acquiring new athena connection "model.my_new_project.NE_and_SmallTowns".
2021-11-29 20:28:10.803144 (MainThread): Acquiring new athena connection "model.my_new_project.New_England".
2021-11-29 20:28:10.806841 (MainThread): Acquiring new athena connection "model.my_new_project.Small_Towns".
2021-11-29 20:28:10.832196 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-11-29 20:28:10.836440 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c2fd2818-7e71-413b-a805-550d65554953', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff898c8340>]}
2021-11-29 20:28:10.848690 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-11-29 20:28:10.850576 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c2fd2818-7e71-413b-a805-550d65554953', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff898e84f0>]}
2021-11-29 20:28:10.852103 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 2 seed files, 0 sources, 0 exposures
2021-11-29 20:28:10.854636 (MainThread): 
2021-11-29 20:28:10.855805 (MainThread): Acquiring new athena connection "master".
2021-11-29 20:28:10.857849 (ThreadPoolExecutor-0_0): Acquiring new athena connection "list_awsdatacatalog".
2021-11-29 20:28:10.866538 (ThreadPoolExecutor-0_0): Using athena connection "list_awsdatacatalog".
2021-11-29 20:28:10.867994 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
  
2021-11-29 20:28:10.869761 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-29 20:28:10.904516 (ThreadPoolExecutor-0_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
2021-11-29 20:28:12.941676 (ThreadPoolExecutor-0_0): SQL status: OK -1 in 2.07 seconds
2021-11-29 20:28:12.951349 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: Close
2021-11-29 20:28:12.957479 (ThreadPoolExecutor-2_0): Acquiring new athena connection "list_awsdatacatalog_dbt".
2021-11-29 20:28:12.962108 (ThreadPoolExecutor-2_0): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 37498), raddr=('54.172.149.137', 443)>
2021-11-29 20:28:12.976971 (ThreadPoolExecutor-2_0): Using athena connection "list_awsdatacatalog_dbt".
2021-11-29 20:28:12.978528 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
2021-11-29 20:28:12.983320 (ThreadPoolExecutor-2_0): Opening a new connection, currently in state closed
2021-11-29 20:28:13.011199 (ThreadPoolExecutor-2_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
2021-11-29 20:28:15.935545 (ThreadPoolExecutor-2_0): SQL status: OK -1 in 2.95 seconds
2021-11-29 20:28:15.942542 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: Close
2021-11-29 20:28:15.947470 (MainThread): 20:28:15 | Concurrency: 1 threads (target='dev')
2021-11-29 20:28:15.954505 (MainThread): 20:28:15 | 
2021-11-29 20:28:15.963120 (Thread-1): Began running node model.my_new_project.New_England
2021-11-29 20:28:15.965909 (Thread-1): 20:28:15 | 1 of 3 START view model dbt.New_England.............................. [RUN]
2021-11-29 20:28:15.970625 (Thread-1): Acquiring new athena connection "model.my_new_project.New_England".
2021-11-29 20:28:15.975056 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 37500), raddr=('54.172.149.137', 443)>
2021-11-29 20:28:15.978567 (Thread-1): Compiling model.my_new_project.New_England
2021-11-29 20:28:15.984376 (Thread-1): Writing injected SQL for node "model.my_new_project.New_England"
2021-11-29 20:28:15.991299 (Thread-1): finished collecting timing info
2021-11-29 20:28:16.001500 (Thread-1): finished collecting timing info
2021-11-29 20:28:16.002892 (Thread-1): Compilation Error in model New_England (models/New_England.sql)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete dbt.new_england, or rename it to be less ambiguous.
  Searched for: dbt.New_England
  Found: dbt.new_england
  
  > in macro create_or_replace_view (macros/materializations/view.sql)
  > called by macro materialization_view_athena (macros/materializations/view.sql)
  > called by model New_England (models/New_England.sql)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 734, in get_relation
    matches = self._make_match(relations_list, database, schema,
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 723, in _make_match
    if relation.matches(**search):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/relation.py", line 99, in matches
    dbt.exceptions.approximate_relation_match(target, self)
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 741, in approximate_relation_match
    raise_compiler_error(
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 444, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model New_England (models/New_England.sql)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete dbt.new_england, or rename it to be less ambiguous.
  Searched for: dbt.New_England
  Found: dbt.new_england
  
  > in macro create_or_replace_view (macros/materializations/view.sql)
  > called by macro materialization_view_athena (macros/materializations/view.sql)
  > called by model New_England (models/New_England.sql)
2021-11-29 20:28:16.005890 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2fd2818-7e71-413b-a805-550d65554953', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88dd7820>]}
2021-11-29 20:28:16.007908 (Thread-1): 20:28:16 | 1 of 3 ERROR creating view model dbt.New_England..................... [ERROR in 0.04s]
2021-11-29 20:28:16.009412 (Thread-1): Finished running node model.my_new_project.New_England
2021-11-29 20:28:16.011095 (Thread-1): Began running node model.my_new_project.Small_Towns
2021-11-29 20:28:16.012971 (Thread-1): 20:28:16 | 2 of 3 START view model dbt.Small_Towns.............................. [RUN]
2021-11-29 20:28:16.014489 (Thread-1): Acquiring new athena connection "model.my_new_project.Small_Towns".
2021-11-29 20:28:16.016073 (Thread-1): Compiling model.my_new_project.Small_Towns
2021-11-29 20:28:16.019360 (Thread-1): Writing injected SQL for node "model.my_new_project.Small_Towns"
2021-11-29 20:28:16.023628 (Thread-1): finished collecting timing info
2021-11-29 20:28:16.029321 (Thread-1): Writing runtime SQL for node "model.my_new_project.Small_Towns"
2021-11-29 20:28:16.033286 (Thread-1): Using athena connection "model.my_new_project.Small_Towns".
2021-11-29 20:28:16.034414 (Thread-1): On model.my_new_project.Small_Towns: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.Small_Towns"} */
create or replace view
    dbt.Small_Towns
  as
    SELECT * FROM "defaultdb"."buildings" buildings
inner join dbt.Random_Small_Towns region
on buildings.state=region.state1
limit 10;

2021-11-29 20:28:16.036518 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 20:28:16.052153 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.Small_Towns"} */
create or replace view
    dbt.Small_Towns
  as
    SELECT * FROM "defaultdb"."buildings" buildings
inner join dbt.Random_Small_Towns region
on buildings.state=region.state1
limit 10;
2021-11-29 20:28:17.717865 (Thread-1): SQL status: OK -1 in 1.68 seconds
2021-11-29 20:28:17.724458 (Thread-1): Using athena connection "model.my_new_project.Small_Towns".
2021-11-29 20:28:17.725647 (Thread-1): On model.my_new_project.Small_Towns: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.Small_Towns"} */
alter table dbt.Small_Towns set tblproperties ('classification' = 'view')
2021-11-29 20:28:17.728905 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.Small_Towns"} */
alter table dbt.Small_Towns set tblproperties ('classification' = 'view')
2021-11-29 20:28:19.264597 (Thread-1): SQL status: OK -1 in 1.54 seconds
2021-11-29 20:28:19.288910 (Thread-1): finished collecting timing info
2021-11-29 20:28:19.292351 (Thread-1): On model.my_new_project.Small_Towns: Close
2021-11-29 20:28:19.299105 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2fd2818-7e71-413b-a805-550d65554953', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff882f15e0>]}
2021-11-29 20:28:19.306408 (Thread-1): 20:28:19 | 2 of 3 OK created view model dbt.Small_Towns......................... [OK -1 in 3.28s]
2021-11-29 20:28:19.312691 (Thread-1): Finished running node model.my_new_project.Small_Towns
2021-11-29 20:28:19.316206 (Thread-1): Began running node model.my_new_project.NE_and_SmallTowns
2021-11-29 20:28:19.318643 (Thread-1): 20:28:19 | 3 of 3 SKIP relation dbt.NE_and_SmallTowns........................... [SKIP]
2021-11-29 20:28:19.321425 (Thread-1): Finished running node model.my_new_project.NE_and_SmallTowns
2021-11-29 20:28:19.328510 (MainThread): Acquiring new athena connection "master".
2021-11-29 20:28:19.330412 (MainThread): 20:28:19 | 
2021-11-29 20:28:19.333523 (MainThread): 20:28:19 | Finished running 3 view models in 8.47s.
2021-11-29 20:28:19.337323 (MainThread): Connection 'master' was properly closed.
2021-11-29 20:28:19.339934 (MainThread): Connection 'model.my_new_project.Small_Towns' was properly closed.
2021-11-29 20:28:19.341869 (MainThread): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 37502), raddr=('54.172.149.137', 443)>
2021-11-29 20:28:19.357720 (MainThread): 
2021-11-29 20:28:19.359036 (MainThread): Completed with 1 error and 0 warnings:
2021-11-29 20:28:19.360503 (MainThread): 
2021-11-29 20:28:19.363381 (MainThread): Compilation Error in model New_England (models/New_England.sql)
2021-11-29 20:28:19.365137 (MainThread):   When searching for a relation, dbt found an approximate match. Instead of guessing 
2021-11-29 20:28:19.368557 (MainThread):   which relation to use, dbt will move on. Please delete dbt.new_england, or rename it to be less ambiguous.
2021-11-29 20:28:19.370876 (MainThread):   Searched for: dbt.New_England
2021-11-29 20:28:19.372618 (MainThread):   Found: dbt.new_england
2021-11-29 20:28:19.374919 (MainThread):   
2021-11-29 20:28:19.376664 (MainThread):   > in macro create_or_replace_view (macros/materializations/view.sql)
2021-11-29 20:28:19.379093 (MainThread):   > called by macro materialization_view_athena (macros/materializations/view.sql)
2021-11-29 20:28:19.382351 (MainThread):   > called by model New_England (models/New_England.sql)
2021-11-29 20:28:19.384254 (MainThread): 
Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
2021-11-29 20:28:19.386784 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b70b8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b68ce20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff898bd970>]}
2021-11-29 20:28:19.389264 (MainThread): Flushing usage events
2021-11-29 20:29:08.645510 (MainThread): Running with dbt=0.21.0
2021-11-29 20:29:08.723428 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/vscode/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-29 20:29:08.743304 (MainThread): Tracking: tracking
2021-11-29 20:29:08.745675 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf6df910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0f9aa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0f9ad30>]}
2021-11-29 20:29:08.755624 (MainThread): Partial parsing not enabled
2021-11-29 20:29:08.769381 (MainThread): Parsing macros/catalog.sql
2021-11-29 20:29:08.772201 (MainThread): Parsing macros/adapters.sql
2021-11-29 20:29:08.781015 (MainThread): Parsing macros/materializations/seed.sql
2021-11-29 20:29:08.784217 (MainThread): Parsing macros/materializations/snapshot.sql
2021-11-29 20:29:08.785521 (MainThread): Parsing macros/materializations/table.sql
2021-11-29 20:29:08.788404 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-29 20:29:08.801115 (MainThread): Parsing macros/materializations/view.sql
2021-11-29 20:29:08.804552 (MainThread): Parsing macros/core.sql
2021-11-29 20:29:08.807611 (MainThread): Parsing macros/materializations/test.sql
2021-11-29 20:29:08.812473 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-29 20:29:08.818172 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-29 20:29:08.821515 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-29 20:29:08.826550 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-29 20:29:08.828028 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-29 20:29:08.834177 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-29 20:29:08.845375 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-29 20:29:08.857427 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-29 20:29:08.862142 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-29 20:29:08.870680 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-29 20:29:08.887101 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-29 20:29:08.896437 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-29 20:29:08.897898 (MainThread): Parsing macros/etc/query.sql
2021-11-29 20:29:08.899918 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-29 20:29:08.905774 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-29 20:29:08.910174 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-29 20:29:08.911797 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-29 20:29:08.913997 (MainThread): Parsing macros/etc/datetime.sql
2021-11-29 20:29:08.920355 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-29 20:29:08.921873 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-29 20:29:08.924632 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-29 20:29:08.925792 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-29 20:29:08.927757 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-29 20:29:08.929504 (MainThread): Parsing macros/adapters/common.sql
2021-11-29 20:29:09.041775 (MainThread): Acquiring new athena connection "model.my_new_project.NE_and_SmallTowns".
2021-11-29 20:29:09.049423 (MainThread): Acquiring new athena connection "model.my_new_project.New_England".
2021-11-29 20:29:09.052310 (MainThread): Acquiring new athena connection "model.my_new_project.Small_Towns".
2021-11-29 20:29:09.078793 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-11-29 20:29:09.082731 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '98e3b148-8cc0-4a17-9f5d-0d9c4976fb2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf1086d0>]}
2021-11-29 20:29:09.097483 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-11-29 20:29:09.100405 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '98e3b148-8cc0-4a17-9f5d-0d9c4976fb2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf108520>]}
2021-11-29 20:29:09.101326 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 2 seed files, 0 sources, 0 exposures
2021-11-29 20:29:09.103843 (MainThread): 
2021-11-29 20:29:09.104713 (MainThread): Acquiring new athena connection "master".
2021-11-29 20:29:09.106689 (ThreadPoolExecutor-0_0): Acquiring new athena connection "list_awsdatacatalog".
2021-11-29 20:29:09.114366 (ThreadPoolExecutor-0_0): Using athena connection "list_awsdatacatalog".
2021-11-29 20:29:09.115377 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
  
2021-11-29 20:29:09.116964 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-29 20:29:09.145096 (ThreadPoolExecutor-0_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
2021-11-29 20:29:10.892241 (ThreadPoolExecutor-0_0): SQL status: OK -1 in 1.78 seconds
2021-11-29 20:29:10.909839 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: Close
2021-11-29 20:29:10.921686 (ThreadPoolExecutor-2_0): Acquiring new athena connection "list_awsdatacatalog_dbt".
2021-11-29 20:29:10.927640 (ThreadPoolExecutor-2_0): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 37506), raddr=('54.172.149.137', 443)>
2021-11-29 20:29:10.939232 (ThreadPoolExecutor-2_0): Using athena connection "list_awsdatacatalog_dbt".
2021-11-29 20:29:10.940647 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
2021-11-29 20:29:10.945107 (ThreadPoolExecutor-2_0): Opening a new connection, currently in state closed
2021-11-29 20:29:10.970202 (ThreadPoolExecutor-2_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
2021-11-29 20:29:14.010767 (ThreadPoolExecutor-2_0): SQL status: OK -1 in 3.07 seconds
2021-11-29 20:29:14.016673 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: Close
2021-11-29 20:29:14.021855 (MainThread): 20:29:14 | Concurrency: 1 threads (target='dev')
2021-11-29 20:29:14.027222 (MainThread): 20:29:14 | 
2021-11-29 20:29:14.034966 (Thread-1): Began running node model.my_new_project.New_England
2021-11-29 20:29:14.036986 (Thread-1): 20:29:14 | 1 of 3 START view model dbt.New_England.............................. [RUN]
2021-11-29 20:29:14.039635 (Thread-1): Acquiring new athena connection "model.my_new_project.New_England".
2021-11-29 20:29:14.043875 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 37508), raddr=('54.172.149.137', 443)>
2021-11-29 20:29:14.052775 (Thread-1): Compiling model.my_new_project.New_England
2021-11-29 20:29:14.057045 (Thread-1): Writing injected SQL for node "model.my_new_project.New_England"
2021-11-29 20:29:14.066538 (Thread-1): finished collecting timing info
2021-11-29 20:29:14.079869 (Thread-1): Writing runtime SQL for node "model.my_new_project.New_England"
2021-11-29 20:29:14.085577 (Thread-1): Using athena connection "model.my_new_project.New_England".
2021-11-29 20:29:14.086934 (Thread-1): On model.my_new_project.New_England: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.New_England"} */
create or replace view
    dbt.New_England
  as
    /*
SELECT * FROM "defaultdb"."resby_puma_northeast" puma
inner join "defaultdb"."buildings" buildings
on puma.bldg_id=buildings.bldg_fid

limit 10;
*/

/* select * from dbt.Region_Table */

/* In plain english: select all from the "buildings" table where the state value is in the Region_Table state column.  */

SELECT * FROM "defaultdb"."buildings" buildings
inner join dbt.Region_Table region
on buildings.state=region.state1
limit 10;

2021-11-29 20:29:14.089333 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 20:29:14.106813 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.New_England"} */
create or replace view
    dbt.New_England
  as
    /*
SELECT * FROM "defaultdb"."resby_puma_northeast" puma
inner join "defaultdb"."buildings" buildings
on puma.bldg_id=buildings.bldg_fid

limit 10;
*/

/* select * from dbt.Region_Table */

/* In plain english: select all from the "buildings" table where the state value is in the Region_Table state column.  */

SELECT * FROM "defaultdb"."buildings" buildings
inner join dbt.Region_Table region
on buildings.state=region.state1
limit 10;
2021-11-29 20:29:15.911763 (Thread-1): SQL status: OK -1 in 1.82 seconds
2021-11-29 20:29:15.919699 (Thread-1): Using athena connection "model.my_new_project.New_England".
2021-11-29 20:29:15.922728 (Thread-1): On model.my_new_project.New_England: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.New_England"} */
alter table dbt.New_England set tblproperties ('classification' = 'view')
2021-11-29 20:29:15.931299 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.New_England"} */
alter table dbt.New_England set tblproperties ('classification' = 'view')
2021-11-29 20:29:17.430477 (Thread-1): SQL status: OK -1 in 1.50 seconds
2021-11-29 20:29:17.451946 (Thread-1): finished collecting timing info
2021-11-29 20:29:17.470508 (Thread-1): On model.my_new_project.New_England: Close
2021-11-29 20:29:17.476185 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98e3b148-8cc0-4a17-9f5d-0d9c4976fb2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadbfbfa0>]}
2021-11-29 20:29:17.481324 (Thread-1): 20:29:17 | 1 of 3 OK created view model dbt.New_England......................... [OK -1 in 3.44s]
2021-11-29 20:29:17.484746 (Thread-1): Finished running node model.my_new_project.New_England
2021-11-29 20:29:17.487127 (Thread-1): Began running node model.my_new_project.Small_Towns
2021-11-29 20:29:17.491107 (Thread-1): 20:29:17 | 2 of 3 START view model dbt.Small_Towns.............................. [RUN]
2021-11-29 20:29:17.494331 (Thread-1): Acquiring new athena connection "model.my_new_project.Small_Towns".
2021-11-29 20:29:17.497711 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 37510), raddr=('54.172.149.137', 443)>
2021-11-29 20:29:17.501996 (Thread-1): Compiling model.my_new_project.Small_Towns
2021-11-29 20:29:17.506933 (Thread-1): Writing injected SQL for node "model.my_new_project.Small_Towns"
2021-11-29 20:29:17.519960 (Thread-1): finished collecting timing info
2021-11-29 20:29:17.524097 (Thread-1): Writing runtime SQL for node "model.my_new_project.Small_Towns"
2021-11-29 20:29:17.535884 (Thread-1): Using athena connection "model.my_new_project.Small_Towns".
2021-11-29 20:29:17.538541 (Thread-1): On model.my_new_project.Small_Towns: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.Small_Towns"} */
create or replace view
    dbt.Small_Towns
  as
    SELECT * FROM "defaultdb"."buildings" buildings
inner join dbt.Random_Small_Towns region
on buildings.state=region.state1
limit 10;

2021-11-29 20:29:17.540556 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 20:29:17.564649 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.Small_Towns"} */
create or replace view
    dbt.Small_Towns
  as
    SELECT * FROM "defaultdb"."buildings" buildings
inner join dbt.Random_Small_Towns region
on buildings.state=region.state1
limit 10;
2021-11-29 20:29:19.250926 (Thread-1): SQL status: OK -1 in 1.71 seconds
2021-11-29 20:29:19.256996 (Thread-1): Using athena connection "model.my_new_project.Small_Towns".
2021-11-29 20:29:19.264643 (Thread-1): On model.my_new_project.Small_Towns: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.Small_Towns"} */
alter table dbt.Small_Towns set tblproperties ('classification' = 'view')
2021-11-29 20:29:19.271489 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.Small_Towns"} */
alter table dbt.Small_Towns set tblproperties ('classification' = 'view')
2021-11-29 20:29:20.780277 (Thread-1): SQL status: OK -1 in 1.51 seconds
2021-11-29 20:29:20.781767 (Thread-1): finished collecting timing info
2021-11-29 20:29:20.784570 (Thread-1): On model.my_new_project.Small_Towns: Close
2021-11-29 20:29:20.785915 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98e3b148-8cc0-4a17-9f5d-0d9c4976fb2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae65b370>]}
2021-11-29 20:29:20.787719 (Thread-1): 20:29:20 | 2 of 3 OK created view model dbt.Small_Towns......................... [OK -1 in 3.29s]
2021-11-29 20:29:20.789869 (Thread-1): Finished running node model.my_new_project.Small_Towns
2021-11-29 20:29:20.792917 (Thread-1): Began running node model.my_new_project.NE_and_SmallTowns
2021-11-29 20:29:20.794177 (Thread-1): 20:29:20 | 3 of 3 START view model dbt.NE_and_SmallTowns........................ [RUN]
2021-11-29 20:29:20.795798 (Thread-1): Acquiring new athena connection "model.my_new_project.NE_and_SmallTowns".
2021-11-29 20:29:20.797723 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 37512), raddr=('54.172.149.137', 443)>
2021-11-29 20:29:20.799920 (Thread-1): Compiling model.my_new_project.NE_and_SmallTowns
2021-11-29 20:29:20.803550 (Thread-1): Writing injected SQL for node "model.my_new_project.NE_and_SmallTowns"
2021-11-29 20:29:20.812277 (Thread-1): finished collecting timing info
2021-11-29 20:29:20.814943 (Thread-1): Writing runtime SQL for node "model.my_new_project.NE_and_SmallTowns"
2021-11-29 20:29:20.819808 (Thread-1): Using athena connection "model.my_new_project.NE_and_SmallTowns".
2021-11-29 20:29:20.821062 (Thread-1): On model.my_new_project.NE_and_SmallTowns: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.NE_and_SmallTowns"} */
create or replace view
    dbt.NE_and_SmallTowns
  as
    /* select * dbt.New_England union select * dbt.Small_Towns */

2021-11-29 20:29:20.823206 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 20:29:20.861117 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.NE_and_SmallTowns"} */
create or replace view
    dbt.NE_and_SmallTowns
  as
    /* select * dbt.New_England union select * dbt.Small_Towns */
2021-11-29 20:29:21.100436 (Thread-1): Failed to execute query.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 307, in _execute
    query_id = retry_api_call(
  File "/usr/local/lib/python3.8/site-packages/pyathena/util.py", line 84, in retry_api_call
    return retry(func, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 404, in __call__
    do = self.iter(retry_state=retry_state)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 349, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 407, in __call__
    result = fn(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 276, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 586, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 5:66: mismatched input '<EOF>'. Expecting: <query>
2021-11-29 20:29:21.101997 (Thread-1): Error running SQL: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.NE_and_SmallTowns"} */
create or replace view
    dbt.NE_and_SmallTowns
  as
    /* select * dbt.New_England union select * dbt.Small_Towns */

2021-11-29 20:29:21.104648 (Thread-1): finished collecting timing info
2021-11-29 20:29:21.105979 (Thread-1): On model.my_new_project.NE_and_SmallTowns: Close
2021-11-29 20:29:21.107715 (Thread-1): Runtime Error in model NE_and_SmallTowns (models/NE_and_SmallTowns.sql)
  An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 5:66: mismatched input '<EOF>'. Expecting: <query>
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 307, in _execute
    query_id = retry_api_call(
  File "/usr/local/lib/python3.8/site-packages/pyathena/util.py", line 84, in retry_api_call
    return retry(func, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 404, in __call__
    do = self.iter(retry_state=retry_state)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 349, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 407, in __call__
    result = fn(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 276, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 586, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 5:66: mismatched input '<EOF>'. Expecting: <query>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 100, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 72, in execute
    query_id = self._execute(
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 315, in _execute
    raise DatabaseError(*e.args) from e
pyathena.error.DatabaseError: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 5:66: mismatched input '<EOF>'. Expecting: <query>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 66, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 103, in exception_handler
    raise RuntimeException(str(e)) from e
dbt.exceptions.RuntimeException: Runtime Error in model NE_and_SmallTowns (models/NE_and_SmallTowns.sql)
  An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 5:66: mismatched input '<EOF>'. Expecting: <query>
2021-11-29 20:29:21.110649 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98e3b148-8cc0-4a17-9f5d-0d9c4976fb2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadbdf520>]}
2021-11-29 20:29:21.112240 (Thread-1): 20:29:21 | 3 of 3 ERROR creating view model dbt.NE_and_SmallTowns............... [ERROR in 0.31s]
2021-11-29 20:29:21.113654 (Thread-1): Finished running node model.my_new_project.NE_and_SmallTowns
2021-11-29 20:29:21.116419 (MainThread): Acquiring new athena connection "master".
2021-11-29 20:29:21.117498 (MainThread): 20:29:21 | 
2021-11-29 20:29:21.120121 (MainThread): 20:29:21 | Finished running 3 view models in 12.01s.
2021-11-29 20:29:21.121580 (MainThread): Connection 'master' was properly closed.
2021-11-29 20:29:21.123157 (MainThread): Connection 'model.my_new_project.NE_and_SmallTowns' was properly closed.
2021-11-29 20:29:21.136729 (MainThread): 
2021-11-29 20:29:21.137613 (MainThread): Completed with 1 error and 0 warnings:
2021-11-29 20:29:21.139429 (MainThread): 
2021-11-29 20:29:21.140739 (MainThread): Runtime Error in model NE_and_SmallTowns (models/NE_and_SmallTowns.sql)
2021-11-29 20:29:21.142624 (MainThread):   An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 5:66: mismatched input '<EOF>'. Expecting: <query>
2021-11-29 20:29:21.143947 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2021-11-29 20:29:21.145278 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0f37d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf1370d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadb86640>]}
2021-11-29 20:29:21.149843 (MainThread): Flushing usage events
2021-11-29 22:49:10.190677 (MainThread): Running with dbt=0.21.0
2021-11-29 22:49:10.262885 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.list.ListTask'>, debug=False, defer=None, exclude=None, greedy=False, log_cache_events=False, log_format='default', models=None, output='selector', output_keys=None, partial_parse=None, profile=None, profiles_dir='/home/vscode/.dbt', project_dir=None, record_timing_info=None, resource_types=[], rpc_method=None, select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', warn_error=False, which='list', write_json=True)
2021-11-29 22:49:10.263730 (MainThread): Tracking: tracking
2021-11-29 22:49:10.264640 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d461ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bb490a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d3f7430>]}
2021-11-29 22:49:10.272707 (MainThread): Partial parsing not enabled
2021-11-29 22:49:10.278441 (MainThread): Parsing macros/catalog.sql
2021-11-29 22:49:10.281809 (MainThread): Parsing macros/adapters.sql
2021-11-29 22:49:10.290597 (MainThread): Parsing macros/materializations/seed.sql
2021-11-29 22:49:10.292886 (MainThread): Parsing macros/materializations/snapshot.sql
2021-11-29 22:49:10.293283 (MainThread): Parsing macros/materializations/table.sql
2021-11-29 22:49:10.294748 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-29 22:49:10.311734 (MainThread): Parsing macros/materializations/view.sql
2021-11-29 22:49:10.316883 (MainThread): Parsing macros/core.sql
2021-11-29 22:49:10.319232 (MainThread): Parsing macros/materializations/test.sql
2021-11-29 22:49:10.323486 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-29 22:49:10.329180 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-29 22:49:10.332729 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-29 22:49:10.336727 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-29 22:49:10.337632 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-29 22:49:10.343070 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-29 22:49:10.354988 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-29 22:49:10.367281 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-29 22:49:10.374479 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-29 22:49:10.387717 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-29 22:49:10.412089 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-29 22:49:10.421553 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-29 22:49:10.422598 (MainThread): Parsing macros/etc/query.sql
2021-11-29 22:49:10.423223 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-29 22:49:10.424393 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-29 22:49:10.425381 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-29 22:49:10.426218 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-29 22:49:10.427276 (MainThread): Parsing macros/etc/datetime.sql
2021-11-29 22:49:10.433747 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-29 22:49:10.434591 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-29 22:49:10.435724 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-29 22:49:10.436302 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-29 22:49:10.437005 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-29 22:49:10.437873 (MainThread): Parsing macros/adapters/common.sql
2021-11-29 22:49:10.546059 (MainThread): Acquiring new athena connection "model.my_new_project.New_England".
2021-11-29 22:49:10.552512 (MainThread): Acquiring new athena connection "model.my_new_project.NE_and_SmallTowns".
2021-11-29 22:49:10.554348 (MainThread): Acquiring new athena connection "model.my_new_project.Small_Towns".
2021-11-29 22:49:10.569697 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-11-29 22:49:10.572405 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b37bfead-eae2-4984-b159-83fe1c5b076c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b55be20>]}
2021-11-29 22:49:10.575094 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b543b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b543cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b543400>]}
2021-11-29 22:49:10.575251 (MainThread): Flushing usage events
2021-11-29 22:49:10.872380 (MainThread): Connection 'model.my_new_project.Small_Towns' was properly closed.
2021-11-29 22:49:10.872853 (MainThread): Encountered an error:
2021-11-29 22:49:10.873123 (MainThread): [Errno 13] Permission denied: 'target/graph.gpickle'
2021-11-29 22:49:10.875587 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/list.py", line 122, in run
    ManifestTask._runtime_initialize(self)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 88, in _runtime_initialize
    self.compile_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 84, in compile_manifest
    self.graph = compiler.compile(self.manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/compilation.py", line 510, in compile
    self.write_graph_file(linker, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/compilation.py", line 399, in write_graph_file
    linker.write_graph(graph_path, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/compilation.py", line 160, in write_graph
    nx.write_gpickle(out_graph, outfile)
  File "/usr/local/lib/python3.8/site-packages/networkx/utils/decorators.py", line 795, in func
    return argmap._lazy_compile(__wrapper)(*args, **kwargs)
  File "<class 'networkx.utils.decorators.argmap'> compilation 5", line 3, in argmap_write_gpickle_1
    from contextlib import contextmanager
  File "/usr/local/lib/python3.8/site-packages/networkx/utils/decorators.py", line 188, in _open_file
    fobj = _dispatch_dict[ext](path, mode=mode)
PermissionError: [Errno 13] Permission denied: 'target/graph.gpickle'

2021-11-29 22:59:43.893952 (MainThread): Running with dbt=0.21.0
2021-11-29 22:59:43.982288 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/vscode/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-29 22:59:43.989756 (MainThread): Tracking: tracking
2021-11-29 22:59:43.992582 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82c98550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84585070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84585ee0>]}
2021-11-29 22:59:44.004014 (MainThread): Partial parsing not enabled
2021-11-29 22:59:44.036375 (MainThread): Parsing macros/catalog.sql
2021-11-29 22:59:44.039702 (MainThread): Parsing macros/adapters.sql
2021-11-29 22:59:44.048981 (MainThread): Parsing macros/materializations/seed.sql
2021-11-29 22:59:44.052672 (MainThread): Parsing macros/materializations/snapshot.sql
2021-11-29 22:59:44.054631 (MainThread): Parsing macros/materializations/table.sql
2021-11-29 22:59:44.057814 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-29 22:59:44.070527 (MainThread): Parsing macros/materializations/view.sql
2021-11-29 22:59:44.074458 (MainThread): Parsing macros/core.sql
2021-11-29 22:59:44.077539 (MainThread): Parsing macros/materializations/test.sql
2021-11-29 22:59:44.082055 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-29 22:59:44.087924 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-29 22:59:44.091975 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-29 22:59:44.096930 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-29 22:59:44.098936 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-29 22:59:44.105529 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-29 22:59:44.116018 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-29 22:59:44.128537 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-29 22:59:44.133493 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-29 22:59:44.141736 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-29 22:59:44.158352 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-29 22:59:44.167549 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-29 22:59:44.169382 (MainThread): Parsing macros/etc/query.sql
2021-11-29 22:59:44.171079 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-29 22:59:44.173554 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-29 22:59:44.175267 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-29 22:59:44.177125 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-29 22:59:44.179218 (MainThread): Parsing macros/etc/datetime.sql
2021-11-29 22:59:44.184839 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-29 22:59:44.186767 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-29 22:59:44.189446 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-29 22:59:44.191365 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-29 22:59:44.193228 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-29 22:59:44.195410 (MainThread): Parsing macros/adapters/common.sql
2021-11-29 22:59:44.302538 (MainThread): Acquiring new athena connection "model.my_new_project.NE_and_SmallTowns".
2021-11-29 22:59:44.311304 (MainThread): Acquiring new athena connection "model.my_new_project.New_England".
2021-11-29 22:59:44.314931 (MainThread): Acquiring new athena connection "model.my_new_project.Small_Towns".
2021-11-29 22:59:44.344033 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-11-29 22:59:44.349151 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8d78961c-c185-4d8e-947b-064cd4ebf3ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82716670>]}
2021-11-29 22:59:44.364601 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-11-29 22:59:44.366892 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8d78961c-c185-4d8e-947b-064cd4ebf3ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82670a90>]}
2021-11-29 22:59:44.368395 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 2 seed files, 0 sources, 0 exposures
2021-11-29 22:59:44.370458 (MainThread): 
2021-11-29 22:59:44.371975 (MainThread): Acquiring new athena connection "master".
2021-11-29 22:59:44.374111 (ThreadPoolExecutor-0_0): Acquiring new athena connection "list_awsdatacatalog".
2021-11-29 22:59:44.382027 (ThreadPoolExecutor-0_0): Using athena connection "list_awsdatacatalog".
2021-11-29 22:59:44.384008 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
  
2021-11-29 22:59:44.385676 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-29 22:59:44.423917 (ThreadPoolExecutor-0_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
2021-11-29 22:59:46.309421 (ThreadPoolExecutor-0_0): SQL status: OK -1 in 1.92 seconds
2021-11-29 22:59:46.321234 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: Close
2021-11-29 22:59:46.329348 (ThreadPoolExecutor-2_0): Acquiring new athena connection "list_awsdatacatalog_dbt".
2021-11-29 22:59:46.333862 (ThreadPoolExecutor-2_0): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 47824), raddr=('100.24.148.241', 443)>
2021-11-29 22:59:46.347447 (ThreadPoolExecutor-2_0): Using athena connection "list_awsdatacatalog_dbt".
2021-11-29 22:59:46.350286 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
2021-11-29 22:59:46.353601 (ThreadPoolExecutor-2_0): Opening a new connection, currently in state closed
2021-11-29 22:59:46.385851 (ThreadPoolExecutor-2_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
2021-11-29 22:59:49.236866 (ThreadPoolExecutor-2_0): SQL status: OK -1 in 2.88 seconds
2021-11-29 22:59:49.250128 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: Close
2021-11-29 22:59:49.258638 (MainThread): 22:59:49 | Concurrency: 1 threads (target='dev')
2021-11-29 22:59:49.264124 (MainThread): 22:59:49 | 
2021-11-29 22:59:49.274118 (Thread-1): Began running node model.my_new_project.New_England
2021-11-29 22:59:49.277947 (Thread-1): 22:59:49 | 1 of 3 START view model dbt.New_England.............................. [RUN]
2021-11-29 22:59:49.283030 (Thread-1): Acquiring new athena connection "model.my_new_project.New_England".
2021-11-29 22:59:49.287509 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 47826), raddr=('100.24.148.241', 443)>
2021-11-29 22:59:49.290461 (Thread-1): Compiling model.my_new_project.New_England
2021-11-29 22:59:49.297083 (Thread-1): Writing injected SQL for node "model.my_new_project.New_England"
2021-11-29 22:59:49.305659 (Thread-1): finished collecting timing info
2021-11-29 22:59:49.316795 (Thread-1): finished collecting timing info
2021-11-29 22:59:49.319301 (Thread-1): Compilation Error in model New_England (models/New_England.sql)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete dbt.new_england, or rename it to be less ambiguous.
  Searched for: dbt.New_England
  Found: dbt.new_england
  
  > in macro create_or_replace_view (macros/materializations/view.sql)
  > called by macro materialization_view_athena (macros/materializations/view.sql)
  > called by model New_England (models/New_England.sql)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 734, in get_relation
    matches = self._make_match(relations_list, database, schema,
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 723, in _make_match
    if relation.matches(**search):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/relation.py", line 99, in matches
    dbt.exceptions.approximate_relation_match(target, self)
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 741, in approximate_relation_match
    raise_compiler_error(
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 444, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model New_England (models/New_England.sql)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete dbt.new_england, or rename it to be less ambiguous.
  Searched for: dbt.New_England
  Found: dbt.new_england
  
  > in macro create_or_replace_view (macros/materializations/view.sql)
  > called by macro materialization_view_athena (macros/materializations/view.sql)
  > called by model New_England (models/New_England.sql)
2021-11-29 22:59:49.323448 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d78961c-c185-4d8e-947b-064cd4ebf3ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81bfe8b0>]}
2021-11-29 22:59:49.325065 (Thread-1): 22:59:49 | 1 of 3 ERROR creating view model dbt.New_England..................... [ERROR in 0.04s]
2021-11-29 22:59:49.326378 (Thread-1): Finished running node model.my_new_project.New_England
2021-11-29 22:59:49.328021 (Thread-1): Began running node model.my_new_project.Small_Towns
2021-11-29 22:59:49.330150 (Thread-1): 22:59:49 | 2 of 3 START view model dbt.Small_Towns.............................. [RUN]
2021-11-29 22:59:49.332269 (Thread-1): Acquiring new athena connection "model.my_new_project.Small_Towns".
2021-11-29 22:59:49.333872 (Thread-1): Compiling model.my_new_project.Small_Towns
2021-11-29 22:59:49.336437 (Thread-1): Writing injected SQL for node "model.my_new_project.Small_Towns"
2021-11-29 22:59:49.340813 (Thread-1): finished collecting timing info
2021-11-29 22:59:49.343233 (Thread-1): finished collecting timing info
2021-11-29 22:59:49.344993 (Thread-1): Compilation Error in model Small_Towns (models/Small_Towns.sql)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete dbt.small_towns, or rename it to be less ambiguous.
  Searched for: dbt.Small_Towns
  Found: dbt.small_towns
  
  > in macro create_or_replace_view (macros/materializations/view.sql)
  > called by macro materialization_view_athena (macros/materializations/view.sql)
  > called by model Small_Towns (models/Small_Towns.sql)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 734, in get_relation
    matches = self._make_match(relations_list, database, schema,
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 723, in _make_match
    if relation.matches(**search):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/relation.py", line 99, in matches
    dbt.exceptions.approximate_relation_match(target, self)
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 741, in approximate_relation_match
    raise_compiler_error(
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 444, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model Small_Towns (models/Small_Towns.sql)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete dbt.small_towns, or rename it to be less ambiguous.
  Searched for: dbt.Small_Towns
  Found: dbt.small_towns
  
  > in macro create_or_replace_view (macros/materializations/view.sql)
  > called by macro materialization_view_athena (macros/materializations/view.sql)
  > called by model Small_Towns (models/Small_Towns.sql)
2021-11-29 22:59:49.347326 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d78961c-c185-4d8e-947b-064cd4ebf3ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff811a9f10>]}
2021-11-29 22:59:49.349205 (Thread-1): 22:59:49 | 2 of 3 ERROR creating view model dbt.Small_Towns..................... [ERROR in 0.02s]
2021-11-29 22:59:49.350429 (Thread-1): Finished running node model.my_new_project.Small_Towns
2021-11-29 22:59:49.352447 (Thread-1): Began running node model.my_new_project.NE_and_SmallTowns
2021-11-29 22:59:49.353757 (Thread-1): 22:59:49 | 3 of 3 SKIP relation dbt.NE_and_SmallTowns........................... [SKIP]
2021-11-29 22:59:49.356114 (Thread-1): Finished running node model.my_new_project.NE_and_SmallTowns
2021-11-29 22:59:49.358384 (MainThread): Acquiring new athena connection "master".
2021-11-29 22:59:49.359850 (MainThread): 22:59:49 | 
2021-11-29 22:59:49.361108 (MainThread): 22:59:49 | Finished running 3 view models in 4.99s.
2021-11-29 22:59:49.363070 (MainThread): Connection 'master' was properly closed.
2021-11-29 22:59:49.365642 (MainThread): Connection 'model.my_new_project.Small_Towns' was properly closed.
2021-11-29 22:59:49.379462 (MainThread): 
2021-11-29 22:59:49.381112 (MainThread): Completed with 2 errors and 0 warnings:
2021-11-29 22:59:49.382280 (MainThread): 
2021-11-29 22:59:49.384343 (MainThread): Compilation Error in model New_England (models/New_England.sql)
2021-11-29 22:59:49.385778 (MainThread):   When searching for a relation, dbt found an approximate match. Instead of guessing 
2021-11-29 22:59:49.389950 (MainThread):   which relation to use, dbt will move on. Please delete dbt.new_england, or rename it to be less ambiguous.
2021-11-29 22:59:49.391638 (MainThread):   Searched for: dbt.New_England
2021-11-29 22:59:49.395455 (MainThread):   Found: dbt.new_england
2021-11-29 22:59:49.398580 (MainThread):   
2021-11-29 22:59:49.400582 (MainThread):   > in macro create_or_replace_view (macros/materializations/view.sql)
2021-11-29 22:59:49.402278 (MainThread):   > called by macro materialization_view_athena (macros/materializations/view.sql)
2021-11-29 22:59:49.403811 (MainThread):   > called by model New_England (models/New_England.sql)
2021-11-29 22:59:49.405428 (MainThread): 
2021-11-29 22:59:49.407513 (MainThread): Compilation Error in model Small_Towns (models/Small_Towns.sql)
2021-11-29 22:59:49.410905 (MainThread):   When searching for a relation, dbt found an approximate match. Instead of guessing 
2021-11-29 22:59:49.413315 (MainThread):   which relation to use, dbt will move on. Please delete dbt.small_towns, or rename it to be less ambiguous.
2021-11-29 22:59:49.414999 (MainThread):   Searched for: dbt.Small_Towns
2021-11-29 22:59:49.416957 (MainThread):   Found: dbt.small_towns
2021-11-29 22:59:49.418549 (MainThread):   
2021-11-29 22:59:49.420117 (MainThread):   > in macro create_or_replace_view (macros/materializations/view.sql)
2021-11-29 22:59:49.421754 (MainThread):   > called by macro materialization_view_athena (macros/materializations/view.sql)
2021-11-29 22:59:49.423783 (MainThread):   > called by model Small_Towns (models/Small_Towns.sql)
2021-11-29 22:59:49.426337 (MainThread): 
Done. PASS=0 WARN=0 ERROR=2 SKIP=1 TOTAL=3
2021-11-29 22:59:49.429587 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82660fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff812f8c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84533a30>]}
2021-11-29 22:59:49.431626 (MainThread): Flushing usage events
2021-11-29 23:01:33.036069 (MainThread): Running with dbt=0.21.0
2021-11-29 23:01:33.122947 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/vscode/.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', select=None, selector_name=None, show=False, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='seed', write_json=True)
2021-11-29 23:01:33.129799 (MainThread): Tracking: tracking
2021-11-29 23:01:33.132028 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e9885e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90224190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90224e80>]}
2021-11-29 23:01:33.141502 (MainThread): Partial parsing not enabled
2021-11-29 23:01:33.158591 (MainThread): Parsing macros/catalog.sql
2021-11-29 23:01:33.162460 (MainThread): Parsing macros/adapters.sql
2021-11-29 23:01:33.171585 (MainThread): Parsing macros/materializations/seed.sql
2021-11-29 23:01:33.175277 (MainThread): Parsing macros/materializations/snapshot.sql
2021-11-29 23:01:33.177409 (MainThread): Parsing macros/materializations/table.sql
2021-11-29 23:01:33.179971 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-29 23:01:33.192553 (MainThread): Parsing macros/materializations/view.sql
2021-11-29 23:01:33.196043 (MainThread): Parsing macros/core.sql
2021-11-29 23:01:33.199396 (MainThread): Parsing macros/materializations/test.sql
2021-11-29 23:01:33.204804 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-29 23:01:33.211511 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-29 23:01:33.215487 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-29 23:01:33.221109 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-29 23:01:33.223197 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-29 23:01:33.229398 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-29 23:01:33.239926 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-29 23:01:33.251855 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-29 23:01:33.257054 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-29 23:01:33.265266 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-29 23:01:33.282273 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-29 23:01:33.292120 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-29 23:01:33.294625 (MainThread): Parsing macros/etc/query.sql
2021-11-29 23:01:33.296565 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-29 23:01:33.299015 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-29 23:01:33.301108 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-29 23:01:33.302963 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-29 23:01:33.305065 (MainThread): Parsing macros/etc/datetime.sql
2021-11-29 23:01:33.310888 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-29 23:01:33.313244 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-29 23:01:33.315660 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-29 23:01:33.318005 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-29 23:01:33.320060 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-29 23:01:33.322017 (MainThread): Parsing macros/adapters/common.sql
2021-11-29 23:01:33.430604 (MainThread): Acquiring new athena connection "model.my_new_project.NE_and_SmallTowns".
2021-11-29 23:01:33.438864 (MainThread): Acquiring new athena connection "model.my_new_project.New_England".
2021-11-29 23:01:33.442642 (MainThread): Acquiring new athena connection "model.my_new_project.Small_Towns".
2021-11-29 23:01:33.472693 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-11-29 23:01:33.477249 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd3ca37c1-89b7-4358-8c88-b005fd013242', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e3d2d00>]}
2021-11-29 23:01:33.492924 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-11-29 23:01:33.496182 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd3ca37c1-89b7-4358-8c88-b005fd013242', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e42aa00>]}
2021-11-29 23:01:33.498141 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 2 seed files, 0 sources, 0 exposures
2021-11-29 23:01:33.500678 (MainThread): 
2021-11-29 23:01:33.502690 (MainThread): Acquiring new athena connection "master".
2021-11-29 23:01:33.504958 (ThreadPoolExecutor-0_0): Acquiring new athena connection "list_awsdatacatalog".
2021-11-29 23:01:33.512333 (ThreadPoolExecutor-0_0): Using athena connection "list_awsdatacatalog".
2021-11-29 23:01:33.514321 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
  
2021-11-29 23:01:33.516620 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-29 23:01:33.545846 (ThreadPoolExecutor-0_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
2021-11-29 23:01:35.503739 (ThreadPoolExecutor-0_0): SQL status: OK -1 in 1.99 seconds
2021-11-29 23:01:35.518586 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: Close
2021-11-29 23:01:35.527046 (ThreadPoolExecutor-2_0): Acquiring new athena connection "list_awsdatacatalog_dbt".
2021-11-29 23:01:35.534017 (ThreadPoolExecutor-2_0): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 45996), raddr=('34.192.156.240', 443)>
2021-11-29 23:01:35.548581 (ThreadPoolExecutor-2_0): Using athena connection "list_awsdatacatalog_dbt".
2021-11-29 23:01:35.551867 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
2021-11-29 23:01:35.555596 (ThreadPoolExecutor-2_0): Opening a new connection, currently in state closed
2021-11-29 23:01:35.592898 (ThreadPoolExecutor-2_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
2021-11-29 23:01:38.443591 (ThreadPoolExecutor-2_0): SQL status: OK -1 in 2.89 seconds
2021-11-29 23:01:38.455175 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: Close
2021-11-29 23:01:38.462784 (MainThread): 23:01:38 | Concurrency: 1 threads (target='dev')
2021-11-29 23:01:38.467550 (MainThread): 23:01:38 | 
2021-11-29 23:01:38.477822 (Thread-1): Began running node seed.my_new_project.Random_Small_Towns
2021-11-29 23:01:38.482939 (Thread-1): 23:01:38 | 1 of 2 START seed file dbt.Random_Small_Towns........................ [RUN]
2021-11-29 23:01:38.488315 (Thread-1): Acquiring new athena connection "seed.my_new_project.Random_Small_Towns".
2021-11-29 23:01:38.492220 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 45998), raddr=('34.192.156.240', 443)>
2021-11-29 23:01:38.497131 (Thread-1): finished collecting timing info
2021-11-29 23:01:38.528102 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-11-29 23:01:38.530795 (Thread-1): * Deprecation Warning: The quote_columns parameter was not set for seeds, so the
default value of False was chosen. The default will change to True in a future
release.

For more information, see:
https://docs.getdbt.com/v0.15/docs/seeds#section-specify-column-quoting
2021-11-29 23:01:38.533441 (Thread-1): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd3ca37c1-89b7-4358-8c88-b005fd013242', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cec98b0>]}
2021-11-29 23:01:38.534878 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-11-29 23:01:38.536597 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-11-29 23:01:38.538033 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-11-29 23:01:38.539442 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-11-29 23:01:38.540686 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 23:01:38.557188 (Thread-1): Using athena connection "seed.my_new_project.Random_Small_Towns".
2021-11-29 23:01:38.559647 (Thread-1): On seed.my_new_project.Random_Small_Towns: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "seed.my_new_project.Random_Small_Towns"} */

    create external table dbt.Random_Small_Towns (Zip integer, City1 string, County string, State1 string, Region string)
    stored as parquet
    location 's3://justin-dbt-testing/Targettables/3eb3cfba-cf6b-4136-bcec-fb0ddce53c96/'
    tblproperties ('classification'='parquet')
  
2021-11-29 23:01:38.561801 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "seed.my_new_project.Random_Small_Towns"} */

    create external table dbt.Random_Small_Towns (Zip integer, City1 string, County string, State1 string, Region string)
    stored as parquet
    location 's3://justin-dbt-testing/Targettables/3eb3cfba-cf6b-4136-bcec-fb0ddce53c96/'
    tblproperties ('classification'='parquet')
2021-11-29 23:01:40.308605 (Thread-1): SQL status: OK -1 in 1.75 seconds
2021-11-29 23:01:40.364413 (Thread-1): Using athena connection "seed.my_new_project.Random_Small_Towns".
2021-11-29 23:01:40.367104 (Thread-1): On seed.my_new_project.Random_Small_Towns: 
          insert into dbt.Random_Small_Towns (Zip, City1, County, State1, Region) values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s)
      ...
2021-11-29 23:01:40.370262 (Thread-1): insert into dbt.Random_Small_Towns (Zip, City1, County, State1, Region) values
          (4101,'Portland','Cumberland','ME','Northeast'),(4027,'Lebanon','York','ME','Northeast'),(4430,'Millinocket','Penobscot','ME','Northeast'),(33514,'Center Hill','Sumter','FL','Southeast'),(33935,'Muce','Glades','FL','Southeast'),(33040,'Key West','Monroe','FL','Southeast'),(54751,'Menomonie','Dunn','WI','Midwest'),(54011,'El Paso','Pierce','WI','Midwest'),(55043,'Lakeland','Washington','MN','Midwest'),(86321,'Bagdad','Yavapai','AZ','Southwest'),(85937,'Snowflake','Navajo','AZ','Southwest'),(85539,'Miami','Gila','AZ','Southwest'),(98851,'Soap Lake','Grant','WA','Northwest'),(99022,'Medical Lake','Spokane','WA','Northwest'),(99148,'Loon Lake','Stevens','WA','Northwest'),(99723,'Utqiagvik','North Slope','AK','Alaska'),(99762,'Nome','Unorganized','AK','Alaska'),(99686,'Valdez','Chugach','AK','Alaska'),(96777,'Phala','Hawaii','HI','Hawaii'),(96761,'Kapalua','Maui','HI','Hawaii'),(96769,'Puuwai','Kauai','HI','Hawaii')
2021-11-29 23:01:43.086994 (Thread-1): SQL status: OK -1 in 2.72 seconds
2021-11-29 23:01:43.107009 (Thread-1): Writing runtime SQL for node "seed.my_new_project.Random_Small_Towns"
2021-11-29 23:01:43.139935 (Thread-1): finished collecting timing info
2021-11-29 23:01:43.142286 (Thread-1): On seed.my_new_project.Random_Small_Towns: Close
2021-11-29 23:01:43.144704 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3ca37c1-89b7-4358-8c88-b005fd013242', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cecdd00>]}
2021-11-29 23:01:43.147060 (Thread-1): 23:01:43 | 1 of 2 OK loaded seed file dbt.Random_Small_Towns.................... [INSERT 21 in 4.66s]
2021-11-29 23:01:43.149920 (Thread-1): Finished running node seed.my_new_project.Random_Small_Towns
2021-11-29 23:01:43.152316 (Thread-1): Began running node seed.my_new_project.Region_Table
2021-11-29 23:01:43.154507 (Thread-1): 23:01:43 | 2 of 2 START seed file dbt.Region_Table.............................. [RUN]
2021-11-29 23:01:43.156511 (Thread-1): Acquiring new athena connection "seed.my_new_project.Region_Table".
2021-11-29 23:01:43.158834 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 46000), raddr=('34.192.156.240', 443)>
2021-11-29 23:01:43.161121 (Thread-1): finished collecting timing info
2021-11-29 23:01:43.168003 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-11-29 23:01:43.169967 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-11-29 23:01:43.171435 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 23:01:43.188548 (Thread-1): Using athena connection "seed.my_new_project.Region_Table".
2021-11-29 23:01:43.191031 (Thread-1): On seed.my_new_project.Region_Table: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "seed.my_new_project.Region_Table"} */

    create external table dbt.Region_Table (State1 string, Region string)
    stored as parquet
    location 's3://justin-dbt-testing/Targettables/f5d46640-edf3-4a3f-bcf5-f3ff83a65335/'
    tblproperties ('classification'='parquet')
  
2021-11-29 23:01:43.192854 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "seed.my_new_project.Region_Table"} */

    create external table dbt.Region_Table (State1 string, Region string)
    stored as parquet
    location 's3://justin-dbt-testing/Targettables/f5d46640-edf3-4a3f-bcf5-f3ff83a65335/'
    tblproperties ('classification'='parquet')
2021-11-29 23:01:45.020159 (Thread-1): SQL status: OK -1 in 1.83 seconds
2021-11-29 23:01:45.036075 (Thread-1): Using athena connection "seed.my_new_project.Region_Table".
2021-11-29 23:01:45.041283 (Thread-1): On seed.my_new_project.Region_Table: 
          insert into dbt.Region_Table (State1, Region) values
          (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s)
      ...
2021-11-29 23:01:45.047779 (Thread-1): insert into dbt.Region_Table (State1, Region) values
          ('ME','Northeast'),('NH','Northeast'),('VT','Northeast'),('MA','Northeast'),('CT','Northeast'),('RI','Northeast')
2021-11-29 23:01:46.567250 (Thread-1): SQL status: OK -1 in 1.52 seconds
2021-11-29 23:01:46.575715 (Thread-1): Writing runtime SQL for node "seed.my_new_project.Region_Table"
2021-11-29 23:01:46.593215 (Thread-1): finished collecting timing info
2021-11-29 23:01:46.597351 (Thread-1): On seed.my_new_project.Region_Table: Close
2021-11-29 23:01:46.601083 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3ca37c1-89b7-4358-8c88-b005fd013242', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c43ac40>]}
2021-11-29 23:01:46.604344 (Thread-1): 23:01:46 | 2 of 2 OK loaded seed file dbt.Region_Table.......................... [INSERT 6 in 3.44s]
2021-11-29 23:01:46.608476 (Thread-1): Finished running node seed.my_new_project.Region_Table
2021-11-29 23:01:46.613373 (MainThread): Acquiring new athena connection "master".
2021-11-29 23:01:46.617785 (MainThread): 23:01:46 | 
2021-11-29 23:01:46.621003 (MainThread): 23:01:46 | Finished running 2 seeds in 13.12s.
2021-11-29 23:01:46.624317 (MainThread): Connection 'master' was properly closed.
2021-11-29 23:01:46.628505 (MainThread): Connection 'seed.my_new_project.Region_Table' was properly closed.
2021-11-29 23:01:46.631533 (MainThread): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 46002), raddr=('34.192.156.240', 443)>
2021-11-29 23:01:46.649110 (MainThread): 
2021-11-29 23:01:46.650504 (MainThread): Completed successfully
2021-11-29 23:01:46.652239 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-11-29 23:01:46.654312 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e3a9700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e42a970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c43ac40>]}
2021-11-29 23:01:46.655931 (MainThread): Flushing usage events
2021-11-29 23:02:42.747274 (MainThread): Running with dbt=0.21.0
2021-11-29 23:02:42.818913 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/vscode/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-11-29 23:02:42.826572 (MainThread): Tracking: tracking
2021-11-29 23:02:42.828573 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f4645e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80d00c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80d00df0>]}
2021-11-29 23:02:42.837432 (MainThread): Partial parsing not enabled
2021-11-29 23:02:42.851650 (MainThread): Parsing macros/catalog.sql
2021-11-29 23:02:42.855020 (MainThread): Parsing macros/adapters.sql
2021-11-29 23:02:42.863973 (MainThread): Parsing macros/materializations/seed.sql
2021-11-29 23:02:42.867408 (MainThread): Parsing macros/materializations/snapshot.sql
2021-11-29 23:02:42.869998 (MainThread): Parsing macros/materializations/table.sql
2021-11-29 23:02:42.873339 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-29 23:02:42.886645 (MainThread): Parsing macros/materializations/view.sql
2021-11-29 23:02:42.890818 (MainThread): Parsing macros/core.sql
2021-11-29 23:02:42.894190 (MainThread): Parsing macros/materializations/test.sql
2021-11-29 23:02:42.899194 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-29 23:02:42.905577 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-29 23:02:42.909188 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-29 23:02:42.914133 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-29 23:02:42.916501 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-29 23:02:42.923050 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-29 23:02:42.933899 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-29 23:02:42.945996 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-29 23:02:42.950944 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-29 23:02:42.960437 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-29 23:02:42.978980 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-29 23:02:42.988843 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-29 23:02:42.990707 (MainThread): Parsing macros/etc/query.sql
2021-11-29 23:02:42.992380 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-29 23:02:42.995560 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-29 23:02:42.997592 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-29 23:02:42.999560 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-29 23:02:43.001669 (MainThread): Parsing macros/etc/datetime.sql
2021-11-29 23:02:43.006819 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-29 23:02:43.008778 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-29 23:02:43.011213 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-29 23:02:43.013059 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-29 23:02:43.015010 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-29 23:02:43.017192 (MainThread): Parsing macros/adapters/common.sql
2021-11-29 23:02:43.124114 (MainThread): Acquiring new athena connection "model.my_new_project.NE_and_SmallTowns".
2021-11-29 23:02:43.132682 (MainThread): Acquiring new athena connection "model.my_new_project.New_England".
2021-11-29 23:02:43.135990 (MainThread): Acquiring new athena connection "model.my_new_project.Small_Towns".
2021-11-29 23:02:43.161917 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-11-29 23:02:43.166942 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8ecc1aa3-3e6b-4942-a77f-ad15ef125049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ee2d8e0>]}
2021-11-29 23:02:43.179429 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-11-29 23:02:43.181142 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8ecc1aa3-3e6b-4942-a77f-ad15ef125049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ef30940>]}
2021-11-29 23:02:43.182535 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 2 seed files, 0 sources, 0 exposures
2021-11-29 23:02:43.184556 (MainThread): 
2021-11-29 23:02:43.186381 (MainThread): Acquiring new athena connection "master".
2021-11-29 23:02:43.188407 (ThreadPoolExecutor-0_0): Acquiring new athena connection "list_awsdatacatalog".
2021-11-29 23:02:43.196304 (ThreadPoolExecutor-0_0): Using athena connection "list_awsdatacatalog".
2021-11-29 23:02:43.198491 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
  
2021-11-29 23:02:43.199657 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-11-29 23:02:43.218446 (ThreadPoolExecutor-0_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog"} */

    select
        distinct schema_name

    from awsdatacatalog.INFORMATION_SCHEMA.schemata
2021-11-29 23:02:44.996884 (ThreadPoolExecutor-0_0): SQL status: OK -1 in 1.80 seconds
2021-11-29 23:02:45.008997 (ThreadPoolExecutor-0_0): On list_awsdatacatalog: Close
2021-11-29 23:02:45.018890 (ThreadPoolExecutor-2_0): Acquiring new athena connection "list_awsdatacatalog_dbt".
2021-11-29 23:02:45.025869 (ThreadPoolExecutor-2_0): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 46006), raddr=('34.192.156.240', 443)>
2021-11-29 23:02:45.038816 (ThreadPoolExecutor-2_0): Using athena connection "list_awsdatacatalog_dbt".
2021-11-29 23:02:45.044319 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
  
2021-11-29 23:02:45.047601 (ThreadPoolExecutor-2_0): Opening a new connection, currently in state closed
2021-11-29 23:02:45.072179 (ThreadPoolExecutor-2_0): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "connection_name": "list_awsdatacatalog_dbt"} */
WITH views AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema
      from "awsdatacatalog".INFORMATION_SCHEMA.views
      where LOWER(table_schema) = LOWER('dbt')
    ), tables AS (
      select
        table_catalog as database,
        table_name as name,
        table_schema as schema

      from "awsdatacatalog".INFORMATION_SCHEMA.tables
      where LOWER(table_schema) = LOWER('dbt')

      -- Views appear in both `tables` and `views`, so excluding them from tables
      EXCEPT 

      select * from views
    )
    select views.*, 'view' AS table_type FROM views
    UNION ALL
    select tables.*, 'table' AS table_type FROM tables
2021-11-29 23:02:47.941490 (ThreadPoolExecutor-2_0): SQL status: OK -1 in 2.89 seconds
2021-11-29 23:02:47.951945 (ThreadPoolExecutor-2_0): On list_awsdatacatalog_dbt: Close
2021-11-29 23:02:47.959328 (MainThread): 23:02:47 | Concurrency: 1 threads (target='dev')
2021-11-29 23:02:47.966175 (MainThread): 23:02:47 | 
2021-11-29 23:02:47.975202 (Thread-1): Began running node model.my_new_project.New_England
2021-11-29 23:02:47.979729 (Thread-1): 23:02:47 | 1 of 3 START view model dbt.New_England.............................. [RUN]
2021-11-29 23:02:47.983630 (Thread-1): Acquiring new athena connection "model.my_new_project.New_England".
2021-11-29 23:02:47.987307 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 46008), raddr=('34.192.156.240', 443)>
2021-11-29 23:02:47.990679 (Thread-1): Compiling model.my_new_project.New_England
2021-11-29 23:02:47.996654 (Thread-1): Writing injected SQL for node "model.my_new_project.New_England"
2021-11-29 23:02:48.004528 (Thread-1): finished collecting timing info
2021-11-29 23:02:48.019301 (Thread-1): Writing runtime SQL for node "model.my_new_project.New_England"
2021-11-29 23:02:48.025348 (Thread-1): Using athena connection "model.my_new_project.New_England".
2021-11-29 23:02:48.026851 (Thread-1): On model.my_new_project.New_England: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.New_England"} */
create or replace view
    dbt.New_England
  as
    /*
SELECT * FROM "defaultdb"."resby_puma_northeast" puma
inner join "defaultdb"."buildings" buildings
on puma.bldg_id=buildings.bldg_fid

limit 10;
*/

/* select * from dbt.Region_Table */

/* In plain english: select all from the "buildings" table where the state value is in the Region_Table state column.  */

SELECT * FROM "defaultdb"."buildings" buildings
inner join dbt.Region_Table region
on buildings.state=region.state1
limit 10;

2021-11-29 23:02:48.029101 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 23:02:48.045234 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.New_England"} */
create or replace view
    dbt.New_England
  as
    /*
SELECT * FROM "defaultdb"."resby_puma_northeast" puma
inner join "defaultdb"."buildings" buildings
on puma.bldg_id=buildings.bldg_fid

limit 10;
*/

/* select * from dbt.Region_Table */

/* In plain english: select all from the "buildings" table where the state value is in the Region_Table state column.  */

SELECT * FROM "defaultdb"."buildings" buildings
inner join dbt.Region_Table region
on buildings.state=region.state1
limit 10;
2021-11-29 23:02:49.806243 (Thread-1): SQL status: OK -1 in 1.78 seconds
2021-11-29 23:02:49.824152 (Thread-1): Using athena connection "model.my_new_project.New_England".
2021-11-29 23:02:49.830426 (Thread-1): On model.my_new_project.New_England: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.New_England"} */
alter table dbt.New_England set tblproperties ('classification' = 'view')
2021-11-29 23:02:49.834893 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.New_England"} */
alter table dbt.New_England set tblproperties ('classification' = 'view')
2021-11-29 23:02:51.429398 (Thread-1): SQL status: OK -1 in 1.59 seconds
2021-11-29 23:02:51.437136 (Thread-1): finished collecting timing info
2021-11-29 23:02:51.439128 (Thread-1): On model.my_new_project.New_England: Close
2021-11-29 23:02:51.440872 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ecc1aa3-3e6b-4942-a77f-ad15ef125049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d9471c0>]}
2021-11-29 23:02:51.442572 (Thread-1): 23:02:51 | 1 of 3 OK created view model dbt.New_England......................... [OK -1 in 3.46s]
2021-11-29 23:02:51.444087 (Thread-1): Finished running node model.my_new_project.New_England
2021-11-29 23:02:51.445898 (Thread-1): Began running node model.my_new_project.Small_Towns
2021-11-29 23:02:51.447433 (Thread-1): 23:02:51 | 2 of 3 START view model dbt.Small_Towns.............................. [RUN]
2021-11-29 23:02:51.449201 (Thread-1): Acquiring new athena connection "model.my_new_project.Small_Towns".
2021-11-29 23:02:51.451166 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 46010), raddr=('34.192.156.240', 443)>
2021-11-29 23:02:51.452816 (Thread-1): Compiling model.my_new_project.Small_Towns
2021-11-29 23:02:51.455524 (Thread-1): Writing injected SQL for node "model.my_new_project.Small_Towns"
2021-11-29 23:02:51.459397 (Thread-1): finished collecting timing info
2021-11-29 23:02:51.463834 (Thread-1): Writing runtime SQL for node "model.my_new_project.Small_Towns"
2021-11-29 23:02:51.468259 (Thread-1): Using athena connection "model.my_new_project.Small_Towns".
2021-11-29 23:02:51.469500 (Thread-1): On model.my_new_project.Small_Towns: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.Small_Towns"} */
create or replace view
    dbt.Small_Towns
  as
    SELECT * FROM "defaultdb"."buildings" buildings
inner join dbt.Random_Small_Towns region
on buildings.state=region.state1
limit 10;

2021-11-29 23:02:51.470704 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 23:02:51.486746 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.Small_Towns"} */
create or replace view
    dbt.Small_Towns
  as
    SELECT * FROM "defaultdb"."buildings" buildings
inner join dbt.Random_Small_Towns region
on buildings.state=region.state1
limit 10;
2021-11-29 23:02:53.311794 (Thread-1): SQL status: OK -1 in 1.84 seconds
2021-11-29 23:02:53.323434 (Thread-1): Using athena connection "model.my_new_project.Small_Towns".
2021-11-29 23:02:53.329932 (Thread-1): On model.my_new_project.Small_Towns: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.Small_Towns"} */
alter table dbt.Small_Towns set tblproperties ('classification' = 'view')
2021-11-29 23:02:53.337300 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.Small_Towns"} */
alter table dbt.Small_Towns set tblproperties ('classification' = 'view')
2021-11-29 23:02:54.855162 (Thread-1): SQL status: OK -1 in 1.52 seconds
2021-11-29 23:02:54.867706 (Thread-1): finished collecting timing info
2021-11-29 23:02:54.872367 (Thread-1): On model.my_new_project.Small_Towns: Close
2021-11-29 23:02:54.878857 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ecc1aa3-3e6b-4942-a77f-ad15ef125049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d8ee1c0>]}
2021-11-29 23:02:54.883857 (Thread-1): 23:02:54 | 2 of 3 OK created view model dbt.Small_Towns......................... [OK -1 in 3.43s]
2021-11-29 23:02:54.887473 (Thread-1): Finished running node model.my_new_project.Small_Towns
2021-11-29 23:02:54.893156 (Thread-1): Began running node model.my_new_project.NE_and_SmallTowns
2021-11-29 23:02:54.896140 (Thread-1): 23:02:54 | 3 of 3 START view model dbt.NE_and_SmallTowns........................ [RUN]
2021-11-29 23:02:54.898561 (Thread-1): Acquiring new athena connection "model.my_new_project.NE_and_SmallTowns".
2021-11-29 23:02:54.902407 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('172.17.0.2', 49248), raddr=('34.196.212.32', 443)>
2021-11-29 23:02:54.905945 (Thread-1): Compiling model.my_new_project.NE_and_SmallTowns
2021-11-29 23:02:54.911114 (Thread-1): Writing injected SQL for node "model.my_new_project.NE_and_SmallTowns"
2021-11-29 23:02:54.919299 (Thread-1): finished collecting timing info
2021-11-29 23:02:54.923545 (Thread-1): Writing runtime SQL for node "model.my_new_project.NE_and_SmallTowns"
2021-11-29 23:02:54.929509 (Thread-1): Using athena connection "model.my_new_project.NE_and_SmallTowns".
2021-11-29 23:02:54.931569 (Thread-1): On model.my_new_project.NE_and_SmallTowns: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.NE_and_SmallTowns"} */
create or replace view
    dbt.NE_and_SmallTowns
  as
    /* select * dbt.New_England union select * dbt.Small_Towns */

2021-11-29 23:02:54.933089 (Thread-1): Opening a new connection, currently in state closed
2021-11-29 23:02:54.950238 (Thread-1): /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.NE_and_SmallTowns"} */
create or replace view
    dbt.NE_and_SmallTowns
  as
    /* select * dbt.New_England union select * dbt.Small_Towns */
2021-11-29 23:02:55.198673 (Thread-1): Failed to execute query.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 307, in _execute
    query_id = retry_api_call(
  File "/usr/local/lib/python3.8/site-packages/pyathena/util.py", line 84, in retry_api_call
    return retry(func, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 404, in __call__
    do = self.iter(retry_state=retry_state)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 349, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 407, in __call__
    result = fn(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 276, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 586, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 5:66: mismatched input '<EOF>'. Expecting: <query>
2021-11-29 23:02:55.205923 (Thread-1): Error running SQL: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "athena", "target_name": "dev", "node_id": "model.my_new_project.NE_and_SmallTowns"} */
create or replace view
    dbt.NE_and_SmallTowns
  as
    /* select * dbt.New_England union select * dbt.Small_Towns */

2021-11-29 23:02:55.209479 (Thread-1): finished collecting timing info
2021-11-29 23:02:55.212156 (Thread-1): On model.my_new_project.NE_and_SmallTowns: Close
2021-11-29 23:02:55.214746 (Thread-1): Runtime Error in model NE_and_SmallTowns (models/NE_and_SmallTowns.sql)
  An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 5:66: mismatched input '<EOF>'. Expecting: <query>
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 307, in _execute
    query_id = retry_api_call(
  File "/usr/local/lib/python3.8/site-packages/pyathena/util.py", line 84, in retry_api_call
    return retry(func, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 404, in __call__
    do = self.iter(retry_state=retry_state)
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 349, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/site-packages/tenacity/__init__.py", line 407, in __call__
    result = fn(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 276, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/usr/local/lib/python3.8/site-packages/botocore/client.py", line 586, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 5:66: mismatched input '<EOF>'. Expecting: <query>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 100, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 72, in execute
    query_id = self._execute(
  File "/usr/local/lib/python3.8/site-packages/pyathena/common.py", line 315, in _execute
    raise DatabaseError(*e.args) from e
pyathena.error.DatabaseError: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 5:66: mismatched input '<EOF>'. Expecting: <query>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 66, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 103, in exception_handler
    raise RuntimeException(str(e)) from e
dbt.exceptions.RuntimeException: Runtime Error in model NE_and_SmallTowns (models/NE_and_SmallTowns.sql)
  An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 5:66: mismatched input '<EOF>'. Expecting: <query>
2021-11-29 23:02:55.220217 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ecc1aa3-3e6b-4942-a77f-ad15ef125049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d947670>]}
2021-11-29 23:02:55.222292 (Thread-1): 23:02:55 | 3 of 3 ERROR creating view model dbt.NE_and_SmallTowns............... [ERROR in 0.32s]
2021-11-29 23:02:55.224171 (Thread-1): Finished running node model.my_new_project.NE_and_SmallTowns
2021-11-29 23:02:55.227334 (MainThread): Acquiring new athena connection "master".
2021-11-29 23:02:55.229403 (MainThread): 23:02:55 | 
2021-11-29 23:02:55.231177 (MainThread): 23:02:55 | Finished running 3 view models in 12.04s.
2021-11-29 23:02:55.232932 (MainThread): Connection 'master' was properly closed.
2021-11-29 23:02:55.234157 (MainThread): Connection 'model.my_new_project.NE_and_SmallTowns' was properly closed.
2021-11-29 23:02:55.248359 (MainThread): 
2021-11-29 23:02:55.249752 (MainThread): Completed with 1 error and 0 warnings:
2021-11-29 23:02:55.251258 (MainThread): 
2021-11-29 23:02:55.252664 (MainThread): Runtime Error in model NE_and_SmallTowns (models/NE_and_SmallTowns.sql)
2021-11-29 23:02:55.254216 (MainThread):   An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 5:66: mismatched input '<EOF>'. Expecting: <query>
2021-11-29 23:02:55.255701 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2021-11-29 23:02:55.257414 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80d1f1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ee86640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e3c88b0>]}
2021-11-29 23:02:55.259497 (MainThread): Flushing usage events
2021-11-29 23:12:48.725475 (MainThread): Running with dbt=0.21.0
2021-11-29 23:12:48.789826 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.list.ListTask'>, debug=False, defer=None, exclude=None, greedy=False, log_cache_events=False, log_format='default', models=None, output='selector', output_keys=None, partial_parse=None, profile=None, profiles_dir='/home/vscode/.dbt', project_dir=None, record_timing_info=None, resource_types=[], rpc_method=None, select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', warn_error=False, which='list', write_json=True)
2021-11-29 23:12:48.796024 (MainThread): Tracking: tracking
2021-11-29 23:12:48.798774 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff948c9df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92fb0070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9485f430>]}
2021-11-29 23:12:48.807519 (MainThread): Partial parsing not enabled
2021-11-29 23:12:48.819857 (MainThread): Parsing macros/catalog.sql
2021-11-29 23:12:48.822417 (MainThread): Parsing macros/adapters.sql
2021-11-29 23:12:48.830956 (MainThread): Parsing macros/materializations/seed.sql
2021-11-29 23:12:48.834240 (MainThread): Parsing macros/materializations/snapshot.sql
2021-11-29 23:12:48.835412 (MainThread): Parsing macros/materializations/table.sql
2021-11-29 23:12:48.839447 (MainThread): Parsing macros/materializations/incremental.sql
2021-11-29 23:12:48.852312 (MainThread): Parsing macros/materializations/view.sql
2021-11-29 23:12:48.856350 (MainThread): Parsing macros/core.sql
2021-11-29 23:12:48.859018 (MainThread): Parsing macros/materializations/test.sql
2021-11-29 23:12:48.864129 (MainThread): Parsing macros/materializations/helpers.sql
2021-11-29 23:12:48.870208 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-11-29 23:12:48.873714 (MainThread): Parsing macros/materializations/view/view.sql
2021-11-29 23:12:48.878252 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-11-29 23:12:48.879828 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-11-29 23:12:48.885546 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-11-29 23:12:48.896473 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-11-29 23:12:48.909300 (MainThread): Parsing macros/materializations/table/table.sql
2021-11-29 23:12:48.914287 (MainThread): Parsing macros/materializations/common/merge.sql
2021-11-29 23:12:48.922763 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-11-29 23:12:48.940032 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-11-29 23:12:48.951650 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-11-29 23:12:48.953765 (MainThread): Parsing macros/etc/query.sql
2021-11-29 23:12:48.956906 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-11-29 23:12:48.959331 (MainThread): Parsing macros/etc/where_subquery.sql
2021-11-29 23:12:48.961898 (MainThread): Parsing macros/etc/is_incremental.sql
2021-11-29 23:12:48.963879 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-11-29 23:12:48.966048 (MainThread): Parsing macros/etc/datetime.sql
2021-11-29 23:12:48.973028 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-11-29 23:12:48.974971 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-11-29 23:12:48.976891 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-11-29 23:12:48.978057 (MainThread): Parsing macros/schema_tests/unique.sql
2021-11-29 23:12:48.979841 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-11-29 23:12:48.982421 (MainThread): Parsing macros/adapters/common.sql
2021-11-29 23:12:49.093065 (MainThread): Acquiring new athena connection "model.my_new_project.NE_and_SmallTowns".
2021-11-29 23:12:49.101515 (MainThread): Acquiring new athena connection "model.my_new_project.New_England".
2021-11-29 23:12:49.104703 (MainThread): Acquiring new athena connection "model.my_new_project.Small_Towns".
2021-11-29 23:12:49.128830 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-11-29 23:12:49.132501 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c23c896-0b89-4377-9d7e-fd51a987a4d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff929c20a0>]}
2021-11-29 23:12:49.145967 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-11-29 23:12:49.147478 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c23c896-0b89-4377-9d7e-fd51a987a4d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff929c29a0>]}
2021-11-29 23:12:49.148264 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 2 seed files, 0 sources, 0 exposures
2021-11-29 23:12:49.149997 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff929c2340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff929c2190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff929c2fd0>]}
2021-11-29 23:12:49.150776 (MainThread): Flushing usage events
2021-11-29 23:12:49.497398 (MainThread): Connection 'model.my_new_project.Small_Towns' was properly closed.
